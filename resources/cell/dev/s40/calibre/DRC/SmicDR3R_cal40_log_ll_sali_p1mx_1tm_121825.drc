//********************************************************************************
//                           CALIBRE DRC PROGRAM
//********************************************************************************


//=================================================================================
//|                                                                               |
//|  40nm 1PxM single topmetal Calibre DRC rule file for                          |
//|                                                                               |
//|                                                                               |
//|       SMIC:       40nm Logic 1P10M Salicide 0.9/1.1/1.2/1.8/2.5V Low Leakage  |
//|                   and Generic Design Rule                                     |
//|                                                                               |
//|       Doc. No:       TD-LO40-DR-2001         Rev: 3R       Tech Dev Rev: 1.0  |
//|       SMIC:        40nm Logic Design Rule check special notes                 | 
//|       Doc. No:      TD-LO40-DR-2014          Rev: 6R        Tech Dev Rev: 1.0  |
//|                                                                               |
//|                                                                               |
//| Calibre Tool Version : 2009.4_16.13	                 			  |
//|                                                                               |
//|       SMIC Technologies                                                       |
//|                                                                               |
//|===============================================================================|
//|										  |
//|  Release Note :								  |
//|										  |
//|	I. Skip following rules check, please manually check them :		  |
//|	    1) RESP1.1					  |
//|	    2) CDR rule.							  |
//|	    							          |
//|===============================================================================|
//|                                                                               |
//|    DISCLAIMER                                                                 |
//|                                                                               |
//|   SMIC hereby provides the quality information to you but makes no claims,    |
//| promises or guarantees about the accuracy, completeness, or adequacy of the   |
//| information herein. The information contained herein is provided on an "AS IS"|
//| basis without any warranty, and SMIC assumes no obligation to provide support |
//| of any kind or otherwise maintain the information.                            |
//|                                                                               |
//|   SMIC disclaims any representation that the information does not infringe any|
//| intellectual property rights or proprietary rights of any third parties.SMIC  |
//| makes no other warranty, whether express, implied or statutory as to any      |
//| matter whatsoever, including but not limited to the accuracy or sufficiency of|
//| any information or the merchantability and fitness for a particular purpose.  |
//| Neither SMIC nor any of its representatives shall be liable for any cause of  |
//| action incurred to connect to this service.                                   |
//|                                                                               |
//|===============================================================================|
//|                                                                               |
//|    STATEMENT OF USE AND CONFIDENTIALITY                                       |
//|                                                                               |
//|   The following/attached material contains confidential and proprietary       |
//| information of SMIC. This material is based upon information which SMIC       |
//| considers reliable, but SMIC neither represents nor warrants that such        |
//| information is accurate or complete, and it must not be relied upon as such.  |
//| This information was prepared for informational purposes and is for the use by|
//| SMIC's customer only. SMIC reserves the right to make changes in the          |
//| information at any time without notice.                                       |
//|   No part of this information may be reproduced, transmitted, transcribed,    |
//| stored in a retrieval system, or translated into any human or computer        |
//| language, in any form or by any means, electronic, mechanical, magnetic,      |
//| optical, chemical, manual, or otherwise, without the prior written consent of |
//| SMIC. Any unauthorized use or disclosure of this material is strictly         |
//| prohibited and may be unlawful. By accepting this material, the receiving     |
//| party shall be deemed to have acknowledged, accepted, and agreed to be bound  |
//| by the foregoing limitations and restrictions. Thank you.                     |
//|                                                                               |
//|===============================================================================|
//|                                                                               |
//|   This file includes SVRF/TVF Technology under license by Mentor Graphics     |
//| Corporation.  "SVRF/TVF Technology" shall mean Mentor Graphics' Standard      |
//| Verification Rule Format ("SVRF") and Tcl Verification Format ("TVF")         |
//| proprietary syntaxes for expressing process rules.  You shall not use SVRF/TVF|
//| Technology unless you are a Mentor Graphics customer with a license to use the|
//| applicable Mentor Graphics software. The exact terms of your obligations and  |
//| rights are governed by your respective license.  You shall not use SVRF/TVF   |
//| Technology except: (a) for your internal business purposes and (b) for use    |
//| with Mentor Graphics' Calibre tools. All SVRF/TVF Technology constitutes or   |
//| contains trade secrets and confidential information of Mentor Graphics or its |
//| licensors. You shall not make SVRF/TVF Technology available in any form to any|
//| person other than your employees and on-site contractors, excluding Mentor    |
//| Graphics competitors, whose job performance requires access and who are under |
//| obligations of confidentiality.                                               |
//|                                                                               |
//|===============================================================================|
//|                                                                               |
//| Validated with Calibre version      2009.4_16.13                              |
//|                                                                               |
//| Revision History :                                                            |
//|                                                                               |
//|   Rev         Date          Who                      What                     |
//| -------  -------------  ------ ------  ----------------------------------------|
//|V1.0_4R   Aug-23-2013      Liu Li        Update TG.3/4/5/6/11,ULVT.4,ULVT.6,Mn.6a,Mn.6c,DG.3/4/5/6/11,GT.3c,GT.6,GT.6a |
//|                                         RESAA.5,RESAA.6,AA.4d,DNW.7,PSUB.7,RESP1.5/6/11,SP.14,SN.14,SAB.4/6/7/8/11/15,
//|                                         TM2.9,DUMC.6/16/20/26/26a/28,MTT2.2
//|                                       Change Mn.12,NW.11,NW.12,AA.C.5 to recommend rule,and set default status in design rule check as off, 
//|                                       GT.2b_R,GT.6a_R MD.4_R MD.6_R ESD.9a_R change default status in design rule check as off,
//|                                        Delete ULVT.3,ULVT.5,CT.19,DFM.5,ALPA.11     |  
//|
//|V1.0_3R   May-07-2013     Liu Li        Update MTT2_5/7b,SP.3a/3b/4/15, SN.3a/3b/4/15,SRSN.3a/3b coding
//|                                        V1.17,Vn.17,MTT2.7b                                        |
//|                                         
//|V1.0_2R   Apr-17-2013     Liu Li       Update RESP1.12,RESP1.13 V1.3,Vn.3,    |
//|                                           Mn.7d,Mn.7e,V1.17,Vn.17              |
//|                                         modify the SRAM marking layer form DPSRAM to RFSRAM
//|
//|V1.0_1.1R     Oct-26-2012    Liu Li       Add BORDER rule switch   
//|                                        update input layer exclude MARKS  
//|                                        RESAA.14,RESP1.15,NW.12,TG.5,DG.5,GT.6a,SP.20a/21a,CT.3,CT.3a    
//|                                        CT.6abd/6acd,CT.7ab,CT.19,M1.3,M1.7e,V1.6abc/7abc,V1.8,V1.17  
//|                                        Vn.17,Mn.12,Vn.6abc/7abc,DFM.5/13/19,DUMCN.21/22,DUP.1/5,MTT2.5
//|V1.0_1R     Sep-26-2012    Liu Li       Define AA/PLOY/HRP resistor area 
//|                                        Update RESNWST rule, AA.11/14/14a/18/19,RESAA.3/5/6/9a/10,AAC.5,
//|                                        RESNWAA_2_3/8,TG.11,BORDER4,GT.1b/2b/3c/6/20c/20d/22,RESP1.5/6/9/10,	. 
//|                                        SP.9/10/12/14/15/20a/21a,SN.3a/3b/9/10/14,SAB.15,M1.13,M1.14,V1.16/17
//|                                        Vn.16/Vn.17,Mn.9,ALPA.2/5,HRP.9,MTT2.2/5,DFM.3,DUMC.18/22/27/35,NW.13                                   
//|                                        Add DUP rule, RESAA.14,DNW.7,PSUB.3e,GT.1h,RESP1.15,ESD.9/9a,BUMP.1
//|                                        Delete layer ALRDL(83;3)
//|
//|                                          Update NW.11,NW.12 
//|                                       
//|
//|                                           Update V1.17,Vn.17
//|                                         
//|                                           Update V1.16,Vn.16,V1.17,Vn.17,TM1.7,TM2.7 coding,according to DR team request who will update design rule next DR version.   
//|
//|                                           Update rule description in runset,according to design rule in TECN(TECN NO.:TD1208070001)
//|                                         Update Mn.11,GT.6a,M1.6,Mn.6,MTT2.7b 
//|                                     
//|                                           
//|                                        define ULVT BUMP OCOVL GT end 
//|                                       add AA.4d/16/17/18/19, NW.9/11/12/13/14/15/16, BORDER.4, GT.3c/6a/8a/27/28,7a/7d/7e 
//|                                       SP.7c/8c,AA.C.5,MTT2.7b,DUMC.21a,DFM.29,EFU rule coding,ULVT rule coding,BUMP rule coding    
//|                                       Delete AA.5/6/7/8,SRGT.103,SRGT.19,V1.5b/6d/7d,Vn.5b/6d/7d,TM1.6,TM2.6,DFM.11
//|                                       Update AA.9a/14a/14,NW.1,rename RESNWAA7/10/11/12/13/14 to RESNWAA.9/10/11/12/13
//|                                       PSUB.2/3a/3b/3cd,TG.11,GT.5/6/8/20c/20d/21/25a/26/22,RESP1.7,PLRES.5,SP.1/6/7a/10,
//|                                       SRSP.3a,SN.1/6/7a/10,SAB.3/7/8,CT.1a/2a,11/12,SRCT.2a,SRM1.7ab,M1.6a/6b/6c/8/8a/13,
//|                                       V1.3/5/5a/17,SRM2.3,M2.3,Mn.6a/6b/6c/7/7a/7d/7e/10a/10b,Vn.3/5/5a/16/17,TM2.7,
//|                                        HRP.12,DFM.1/2/20/21/24/25,DUMC.20/21/30,SRNW.1,DIFRES.7,RESNWST.4,GT.8,PLRES.7
//|                                        V1.16,Vn.16,DUMC.21,DFM.10
//|                                       
//|                                            According to design rule DOC:TD-LO40-DR-2001 3R draft 2012-07-11v1 
//|                                       Add RESNWAA rule coding, SRAM Device Dimension Check Rule coding,SRMarker rules coding ,DRDOP.105 coding      
//|                                       Update SRAA.4a,SRAA.4c,SRNW.1,SRGT.3/7/10,SRDOP.102/103,SRSN.3a/3b/10,SRSP.3a/3b/10,SRRCT.104c,/106/107/107a/108
//|                                       SRM1.7ab,SRV1.6ac,SRM2.4,M1.8b,Mn.7b,Mn.11,DFM.3/5/9,MD.11
//|                                       Delete SRAA.4,SRNW.3,SRGT.5/7/9,SRSN.1/2/6/7,SRSP.1/2/6/7,SRCT.105/3/6a,SRRCT.104,SRV1.7,SRM1.3
//|                                       
//|                                               According to design rule DOC:TD-LO40-DR-2001 3R draft 2012-06-21v1 
//|                                        Add V1.16,V1.17,Vn.16,Vn.17;Update GT.4
//|                                             According to design rule DOC:TD-LO40-DR-2001 3R pre-Release design rule.doc 
//|                                       Update AA.4b/4a,AA.4c,AA.14,AA,9,AA.12, GT.1a~GT.1g,GT.3/4/9/10/5/6/7/8/17/20b,
//|                                         TG.4/3/5,TG.6,DG.3/4/5,DG.6,M1.7abc,M1.8,M1.8a,M1.9 Mn.8,Mn.7,Mn.7a,TM1.10,TM2.10,MTT_8,M1_2/3, 
//|               	                    TM1.5 TM2.5,TM1.13 TM2.12,M1.11a,M1.11b,M1.11c,Mn.10a,Mn.10b,M1.7bc_M1.7bc_M1.7e,TM1.8,TM2.8.
//|                                          MTT.2a,Mn.10c,M1.10,M1.4,M1.5,Mn.4,Mn.5,Mn.9,CT.3a,CT.6abd,6acd,CT.7ab,CT.1,CT.1a,CT.10,CT.2a,CT.4,
//|                                          V1.6d,V1.7d,V1.7abc,Vn.7abc,V1.6abc,Vn.6abc,V1.5,V1.5a,Vn.5,Vn.5a,V1.3,Vn.3,TV1.13,TV1.4,TV2.4, 
//|                                          LVT.6/9/10,HVT.6/9/10,PA.3,ALPA.1/9/10 HRP.2, SN.7b,MD.6,DFM.1,DFM.1a,DFM.2,DFM.2a,DFM_5_Mn,
//|                                        SRAA.4a,SRAA.1#a,SRAA.4/5/6/7/9,SRNW.1,SRGT.3/4/5/6/8/9/10,SRSP.1/12,SRM1_1,
//|                                       SRM1.4,SRMn.4,SAB.7/11,DUMC.6/16,NW.10, DUMC.22,PSUB_Note1/2/3/5 renamed as PSUB_10/11/12/13 ,PSUB.6,
//|                                       Add AA.14a,M1.13,M1.12,Mn.11,GT.20c,GT.20d,DFM1a,DFM2a, M1.11a,M1.11b,M1.11c,Mn.10a,Mn.10b,Mn.10c,V1.5b,Vn.5b      
//|                                       ,RESNWST,PLRES,DIFRES and LD rule coding,TV2.13,CORN.2,V1_5a/Vn_5a/M1_7e,CT.6c,HRP.1   
//|                                       Delete GT.16,M1.11c,Mn.10c,AA.C.5,SRCT.101,DUMBA/P/M from DUMC_2/6, 12/16,18/26,SRAA.101,DNW.5,DNW.6,SRCT.2a,SRSN.7b,DUMC.9 
//|                                                                               | 
//| V0.22=V0.0_0R Dec-27-2011 Zhitao_Chen  Rename file and version number.        |
//|                                                                               |
//|*******************************************************************************|
//| Old file name: SmicDR1T_cal40_log_ll_sali_p1mx_1tm_121825.drc                 |
//|                                                                               |
//| V0.22=V0.0_2R Dec-23-2011 Zhitao_Chen  M1_7c rule changed in doc 0.02==>0.015.|
//| V0.21=V0.0_2R Dec-20-2011 Zhitao_Chen  Update definition of MARKG and MARKS.  |
//|                                      Update code following change of rules:   |
//|                                       DUMC_2/12/23, M1_6/M1_6abc/Mn_6/Mn_6abc,|
//|                                       V1_6abcd/Vn6_abcd, V1_7abcd/Vn_7abcd,   |
//|                                       CT_10, M1_7abc, DFM_28, RESAA_12/13,    |
//|                                       PA_1, MD_11, TM1_13, TM2_12, DUMCN_13,  |
//|                                       CT_1, CT_6ab, CT_7ab, GT_2b.            |
//|                                       SRDOP_101, SRGT_7, SRCT_6a/7a.          |
//|                                      Add new groups of rules for HRP and MTT. |
//|                                      Add 6 new severity options.              |
//|                                      Code optimization of following items:    |
//|                                       Remove definition of *ING *BAR layers.  |
//|                                       OVERDR changed into 125:3,              |
//|                                       AA_4b, AA_7, PSUB_Note5, LVT_13, Vn_5,  |
//|                                       ALPA_7, PA_10, MD_6, MD_10, DFM_9, M1_3,|
//|                                       M2_3, AAC_5, DNW_4, DFM_4.              |
//|                                      Remove following rules:                  |
//|                                       DG_10, RESP1_10, RESAA_8/11, V1_4/Vn_4, |
//|                                       DUMCN_5, GT_13, SN_20, SP_20, SRGT_13,  |
//|                                       GSRNC, GSRPC, SRSM_1, LVT_3/14, HVT_3/14|
//|                                       SRAA_1.                                 |
//|                                                                               |
//|   0.20   Sept-9-2011    Zhitao_Chen  Add definition of layer LDBK (216:150).  |
//|                                      Exclude LDBK in AA_5/7/8/11 GT_5.        |
//|                                      Exclude PSUB in AA_6.                    |
//|                                      Exclude INDMY in PSUB_5/6/7/9/Note3.     |
//|                                      Update macros Mn_6 Mn_6a_6c Mn_6b follow |
//|                                       Li_Liu's fix in her local version 0.19a.|
//|                                      Update macro TM7.                        |
//|                                      Update MD_11 to avoid some false alarms. |
//|                                      Remove following groups of rules:        |
//|                                       NLL, LVN, VTNH, NLH, NLHT,              |
//|                                       PLL, LVP, VTPH, PLH, PLHT.              |
//|                                      Remove dummy/CT checks from BORDER rules.|
//|                                      Update TG_5/DG_5 to include all devices. |
//|                                      Update AA_12 to include all MOS.         |
//|                                      Change GT_1b from 0.2 into 0.15 .        |
//|                                      Add OPPOSITE in NW_3 SP_2 SN_2.          |
//|                                      Merge the content of SAB_12 into SAB_7,  |
//|                                       and disable check in SRAM by this rule. |
//|                                      Comment out GT_23, covered by SP_SN_17.  |
//|                                      Implement CT_2a/3a following document.   |
//|                                      Update CT_6ab CT_7ab to highlight CT     |
//|                                       partially in AA or partially in GT also.|
//|                                      Update GT_1fg to check NMOS also.        |
//|                                      Update GT_22.                            |
//|                                      Add option SRAM_GT_DIRECTION and GT_26.  |
//|                                      Update definition of MDA for AAC_4,      |
//|                                       because it was >=0.1 <0.2 in same line. |
//|                                               |
//|                                                                       Remove PA_9 ALPA_6 RESP1_14 TG_10        |
//|                                       GT_24a/25a.                             |
//|                                      Remove option RECOMMENDED and RESAA/P1_8.|
//|                                      Change TM1_13 TM2_12 from 12um to 30um.  |
//|                                       Notice that TM1_13 is for 2TM case only.|
//|                                      Change NOT INST into NOT INSIDE INST in: |
//|                                       AA_1a/4a/4b/4c/5/6/7 NW_3 GT_3~10/13    |
//|                                       SP_3a/3b/6/7a/7b/10/12/15/20            |
//|                                       SN_3a/3b/4/6/7a/7b/10 CT_4/5/6ab/7ab    |
//|                                       M1_3/7ab V1_6abc/7abc/8 M2_3 V2_6abc    |
//|                                       DFM_5_M1/M2 DFM_8/19 DFM_22_M2 DFM_23_M2|
//|                                       and layers AAconerdfm/GTconerdfm.       |
//|                                      Change NOT EXCLU into                    |
//|                                         NOT INSIDE (EXCLU OR MARKG)           |
//|                                       in all layer definitions.               |
//|                                      Disable MARKG area in following rules:   |
//|                                       AA_14a/b _15a/b AAC_3 GT_20l/h _20bl/h  |
//|                                       M1_8/8a/8b/8c M2~M8_7/7a~7e             |
//|                                       TM1_10a/10b/11/12 TM2_10a/10b/11        |
//|                                       ALPA_1/2/5/7/9/10/11 PA_1~4             |
//|                                       Convention_BAD_IMP                      |
//|                                      Update M4_7~M8_7 depending on option     |
//|                                       of TOPMETAL, to avoid using >0 <0.2 .   |
//|                                      Update definition of V1_array Vn_array.  |
//|                                      Add rule ALPA_12 (must be drawn layer.)  |
//|                                      Splited M1_7ab to M1_7ab_AA and M1_7ab_GT|
//|                                       and add code to check CT enclosure by   |
//|                                       M1 with width > 0.14.                   |
//|                                      Replace INSIDE OF LAYER in density rules:|
//|                                       AA_15a/b ALPA_5                         |
//|                                      Use DENSITY ... [area()/area()] ... in   |
//|                                       GT_20bl/h                               |
//|                                      Update DNW_4 to fin                       |
//|                                                         d DNW NW touching also|
//|                                      Add BORDER_3 (DNW enclosure by BORDER)   |
//|                                      Change layer DG from all 29 into 29:0 .  |
//|                                      Add layer ESD1 (41:0) and ESD1 rules.    |
//|                                      Rename PSUB_3c into PSUB_3cd.            |
//|                                      Implement DFM4 following 65nm style.     |
//|                                      Update DFM26 following 65nm DFM21 style. |
//|                                      Following rule codes added by Jane_Zeng: |
//|                                       LVT_2/3/4a/5a/10/14,HVT_2/3/4a/5a/10/14.|
//|                                      Update code HVT_5 following Jane_Zeng.   |
//|                                      Change L/HVT_9 from 0.19 to 0.1, remove  |
//|                                       L/HVT_3a/7/12.                          |
//|                                      TV space change from 0.36 to 0.34.       |
//|                                      Add metal option of 3 inter metals.      |
//|                                      Optimize DFM_5 following Li_Liu's code.  |
//|                                      Add seal ring rules.                     |
//|                                      Update DFM priority1 rules to check SRAM.|
//|                                      For 2TM, update TV1_Note into TV1_13.    |
//|                                      Copy DUMC DUMCN rules from Hu_Tang.      |
//|                                      Update V1_6/7d Vn_6/7d.                  |
//|                                      Update V1_4/Vn_4 to exclude MOMDMY.      |
//|                                      Border and DUMC_31 interpret BORDER as   |
//|                                       holes being filled.                     |
//|                                      Add Calibre version of validation.       |
//|   0.19    20-Jul-2011    Hu_Tang      DR update:                              |
//|                                       Update GT_16,                           |
//|                                       Add back definitions of M1W~M8W         |
//|   0.18    18-Jul-2011    Hu_Tang      DR update:                              |
//|                                       change corn size from 78 to 74 in CORN.1|
//|   0.17    12-Jul-2011    Hu_Tang      DR update to 1T(2011-06-29v1):          | 
//|                                      Update BORDER rules and change its switch|                   
//|                                      Add CORN.1 and define its switch         |
//|                                      Add MD.11                                |  
//|                                      Delete CT14~CT18,V11~V15,Vn.11~Vn.15,    | 
//|                                             TV2.8~TV2.12                      |
//|                                             PA.5~PA.8, MD.7,MD.9              |                   
//|                                      Modify M1.6,M1.6a,M1.6b,M1.6c            |
//|                                             Mn.6,Mn.6a,Mn.6b,Mn.6c            |
//|                                             TM2.5,TM2.6,TM2.7                 | 
//|   0.15    15-Feb-2011    Carolyn Y     DR update to 1T(2011-01-31v2) :	  |
//|					   Changed back LVT.4,HVT.4,LVN.4,LVP.4,  |
//|					      VTNH.4,VTPH.4 to 0.14 from 0.18.	  |
//|   0.14    20-Jan-2011    Carolyn Y     DR update to 1T(2011-01-09v1) :	  |
//|					   Modify GT.9&10(0.14->0.13).		  |
//|					      TM1.5&6, TM2.5&6(">="->">").	  |
//|					      DFM.9(0.11->0.09),DFM.13(0.30->0.18)|
//|					      LVT.4,HVT.4,LVN.4,LVP.4,VTNH.4,     |
//|					      VTPH.4(0.14->0.18).		  |
//|					   Add the BORDER rules and a swicth.	  |
//|					      DFM.26.				  |
//|					   Delete ALPA.4.			  |
//|					   Correct AA.10(AA->MOS).		  |
//|					   Optimize Vn.6d&7d(with edge->enclose   |
//|					      rectangle).			  |
//|   0.13    16-Dec-2010    Carolyn Y     DR update to 1T(2010-12-14) :	  |
//|					   Modify NW.3&4(potential to net), delete|
//|					   NW.5&6 and "VIRTUAL CONNECT "VDD" ..". |
//|					   GT.1c(0.26->0.27),PSUB.3c(0.5->1.20).  |
//|					   PSUB.3b(0.45->0.8).			  |
//|   0.12    15-Sep-2010    Carolyn Y     DR update to 1T(20100915) :   	  |
//|					   SRAM rule update to 0T(20100913) :	  |
//|					   Dummy check rule(20100908) :		  |
//|					   1.Modify SRPW_1(generative PW->original PW) 
//|					   SN.10/SP.10, LVT.7/HVT.7(include S/D   |
//|					   direction check, exclude pickup).      |
//|					   LVT.4/HVT.4, NLL.4/PLL.4, LVN.4/LVP.4, |
//|					   VTNH.4/VTPH.4, NLH.4/PLH.4, NLHT.4/PLHT.4|
//|					   (0.22->0.18).			  |
//|					   The description of LVT.5/HVT.5,  
//|					   NLL.5&7/PLL.5&7, LVN.5&7/LVP5&7,       |
//|					   VTNH.5&7/VTPH.5&7, NLH.5&7/PLH5&7,	  |
//|					   NLHT.4/PLHT.4; CT.11.		  |
//|					   Modify well, LDD, S/D implant rules's  |
//|					   width, space to be with run length > 0.|
//|					   Seperated HVT.3 to HVT.3a and HVT.3b,  |
//|					   LVT/HVT.3 to LVT/HVT.3a and LVT/HVT.3b,|
//|					   NLL/PLL.3 to NLL/PLL.3a and NLL/PLL.3b,|
//|					   LVN/LVP.3 to LVN/LVP.3a and LVN/LVP.3b,|
//|					   NLH/PLH.3 to NLH/PLH.3a and NLH/PLH.3b,|
//|					   VTN/PH.3 to VTN/PH.3a and VTN/PH.3b,	  |
//|					   N/PLHT.3 to N/PLHT.3a and N/PLHT.3b,   | 
//|					   SN.3/SP.3 tp SN.3/SP.3a and SN.3/SP.3b.|
//|					   HVT.5(0.18->0.08).                     |
//|					   SAB.10(0.32->0.20).			  |
//|					   GT.2b(extend AA 0.6->2.5).		  |
//|					   GT.18(0.042->0.04).			  |
//|					   CT.3(0.23->0.11).			  |
//|					   Vn.6d/Vn.7d(intersection area->width.  |
//|					   Convention_BPMO(exclude Varactor MOS). |
//|					   AA.1/AA.9, NW.1, SN.1/SN.16, SP.1/SP.16|
//|					   M1.4/M2.4(The region coross INST are   |
//|					   checked by SRAM rules.)		  | 
//|					   2.Add DFM_5_M8, DFM_7_M8.		  |
//|					   Dummy check rules.			  |
//|					   3.Delete grid selection option, there's|
//|					   only 0.001um grid size allowed.	  |
//|					   SN.19, SP.19, SRGT.102.		  |
//|					   4.Optimize Convention_latchup.a/b to   |
//|				           reduce the run time.			  |
//|					   SN.16(NOT->NOT IN INST).		  |
//|					   5.Correct the definition of SQCT.	  |
//|   0.11    09-Aug-2010    Carolyn Y     Optimize deck :                        |
//|                                        DFM_24_Mn(EXCINS->EXCLU).              |
//|                                        LVT_11/HVT_11(PACT->PTAP,NACT->NTAP).  |
//|   0.10    26-Jul-2010    Carolyn Y     Add SRAM rules.			  |
//|					   Modify (main rules exclude SRAM cell   |
//|					   check) to (main rules include SRAM cell|
//|					   check).				  |
//|   0.9     23-Jul-2010    Carolyn Y     Add convention rules.		  |
//|					   Fixed V5/6_8/9/10 bugs(modify the      |
//|					   connect via are V5/V6).		  |
//|   0.8     20-Jul-2010    Carolyn Y     Optimize POLY_2b to avoid false alarm. |
//|   0.7     19-Jul-2010    Carolyn Y     Update NW.1&NW.3(0.30->0.33);	  |
//|					   NW.4,NW.5&NW.6(0.50->0.60);		  |
//|					   PSUB.1&PSUB.4(0.30->0.33);		  |
//|					   CT.3(run_length 0.0->0.34).		  |
//|					   Optimize the description of SN.22.	  |
//|					   Delete M1.7cd.			  |
//|   0.6     15-Jul-2010    Carolyn Y     Update CT.8&CT.9(0.40->0.30). 	  |
//|					   Mn.6(0.105->0.10).			  |
//|					   Optimize V1.8.			  |
//|   0.5     14-Jul-2010    Carolyn Y     DR update to 1T(20100713).		  |
//|					   About deck :				  |
//|					   1.Add Vn.7d rules in advance.	  |
//|					   2.Optimize AA_4b.			  |
//|   0.4     08-Jul-2010    Carolyn Y     DR update to 1T(20100706).		  |
//|   0.3     01-Jul-2010    Carolyn Y     DR update to 1T(20100630). 		  |
//|					   1.Correct Vn_6abc&Vn_7abc, check the   |
//|					    via in Mn and Mn+1 intersection region.|
//|					   2.Redefine GT(execpt floating poly).	  |
//|   0.2     22-Jun-2010    Carolyn Y     DR update to 1T(201006111) :		  |
//|					   1.Add layer BORDER(127;0) as CHIPEDGE. |
//|					   2.Correct AA.10(for different VT).	  |		
//|					   DFM rule update to 1T :		  |
//|   0.1     22-Apr-2010    Carolyn Y     DR update to 1T(20100531) :		  |
//|   QA level : II								  |
//|										  |
//|*******************************************************************************|
//| Old file name : SmicDR0T_cal40_log_ll_sali_p1mt10_121825.drc		  |
//|   1.0     18-Jan-2010    Carolyn Y     Initiate version.			  |
//|   QA level : I								  |
//|                                                                               |
//|===============================================================================|


//#################################################
//#     Environmental Variables Setting           #
//#################################################

/*TOP Metal select. The value can be 9,8,7,6,5,4(include single top metals(TM2)).
  Default value is 9.*/
#DEFINE TOPMETAL 7

/*Recommended rules, if set to YES check recommended rules; defaults to NO*/
#DEFINE RECOMMENDED YES

/*Guideline rules, if set to YES check Guideline rules; defaults to YES*/
#DEFINE GUIDELINE  YES

/*DFM rule selection. Defaults to YES
  DFM rule contain three priority level rules :
  User should follow Priority 1 rules;
  User can set the "Priority2" and "Priority3" to decide whether will check these rules,"YES" is to check.*/
  #DEFINE DFM YES
  #DEFINE Priority2 YES
  #DEFINE Priority3  YES

/*Dummy pattern check rule selection. Defaults to SMIC to check rule DUMC .
  If you want to check following non-SMIC rule DUMCN, please change it into CUSTOMER.
  If you don't want to check them, please change it into NO.*/
#DEFINE DUMC SMIC


/* CORN rule selection. Defaults to YES.
  when check Chip without SEAL RING , please set it to "YES"; 
  when check Chip with SEAL RING, please set it to "NO".*/
#DEFINE CHK_CORN YES 

/*BORDER rule selection. Defaults to YES.
  If customer check the chip level , please set it to "YES"; 
  If customer check the IP level , please set it to "NO".*/
#DEFINE CHK_BORDER YES


/*SRAM GT direction selection. Default is H (horizontal).
  But it can also be changed into V (vertical). */
#DEFINE SRAM_GT_DIRECTION H

/*If top metal is layer TM2 (layer 122, top metal with regular thickness), then please use default value NO.
  If top metal is layer MTT2 (layer 231, top metal with ultra thickness), then please change it into YES.*/
#DEFINE UTM TM2


//*************************************
//     DIRECTIVE SECTION
//*************************************


LAYOUT PRIMARY "topcell"
LAYOUT PATH "*.gds"
LAYOUT SYSTEM GDSII

DRC RESULTS DATABASE "drc_CAL.OUT" ASCII
DRC SUMMARY REPORT "drc_CAL.SUM" HIER
PRECISION       1000
RESOLUTION      1

FLAG ACUTE YES
FLAG NONSIMPLE YES
FLAG SKEW YES
FLAG OFFGRID YES

skew_edge_check {
           @Skew edge check
           DRAWN SKEW }
// does not check layers that do not appear in other rule
// checks used in the run

DRC EXCLUDE FALSE NOTCH YES

TEXT DEPTH PRIMARY

LAYOUT BASE LAYER AAi GTi NWi DNWi SNi SPi CTi
//LVS POWER NAME "?VDD?" "?VCC?"

LAYOUT INPUT EXCEPTION SEVERITY PATH_NONSIMPLE 2
LAYOUT INPUT EXCEPTION SEVERITY PATH_CIRCULAR 6
LAYOUT INPUT EXCEPTION SEVERITY POLYGON_NONSIMPLE 2
LAYOUT INPUT EXCEPTION SEVERITY POLYGON_NOT_CLOSED 2
LAYOUT INPUT EXCEPTION SEVERITY PATH_ENDSEGMENT_SHORT 2
LAYOUT INPUT EXCEPTION SEVERITY PATH_ACUTE 4
LAYOUT INPUT EXCEPTION SEVERITY PATH_WIDTH_ZERO 2
LAYOUT INPUT EXCEPTION SEVERITY POLYGON_IS_RECTANGLE 2
LAYOUT INPUT EXCEPTION SEVERITY BOX_RECORD 4
LAYOUT INPUT EXCEPTION SEVERITY NODE_RECORD 4

#ENCRYPT

//************************************
//     INPUT LAYER STATEMENTS
//************************************

LAYER MAP 10 DATATYPE 0 1000
LAYER AAi	1000	// Active Area
LAYER MAP 10 DATATYPE 1 1010
LAYER AADUM     1010     // Dummy AA layer
LAYER MAP 14 DATATYPE 0 1400
LAYER NWi       1400
LAYER MAP 16 DATATYPE 0 1600
LAYER PCi       1600    // SRAM PMOS implant
LAYER MAP 19 DATATYPE 0 1900
LAYER DNWi      1900
//LAYER MAP 20 DATATYPE 0 2000
//LAYER PWi       2000
LAYER MAP 21 DATATYPE 0 2101
LAYER NCi       2101    // SRAM NMOS implant
LAYER MAP 26 DATATYPE 0 2600 
LAYER LOGO      2600      // L MARK area
LAYER MAP 29 DATATYPE 0 290
LAYER DGi	290
LAYER MAP 30 DATATYPE 0 300
LAYER GTi	300	// Poly Gate
LAYER MAP 30 DATATYPE 1 301
LAYER GTDUM	301	// GT Dummy
LAYER MAP 34 DATATYPE 0 3400
LAYER HRi       3400
LAYER MAP 35 DATATYPE 0 3500
LAYER NLLi	3500
LAYER MAP 36 DATATYPE 0 3600
LAYER NLHi	3600
LAYER MAP 37 DATATYPE 0 3700
LAYER PLHi	3700
LAYER MAP 38 DATATYPE 0 3800	
LAYER PLLi	3800
LAYER MAP 39 DATATYPE 0 390
LAYER HRPi      390
LAYER MAP 40 DATATYPE 0 400
LAYER SNi       400
LAYER MAP 41 DATATYPE 0 410
LAYER ESD1i 410
LAYER MAP 43 DATATYPE 0 430
LAYER SPi       430
LAYER MAP 46 DATATYPE 0 4600
LAYER VTPHi     4600
LAYER MAP 47 DATATYPE 0 4700
LAYER VTNHi     4700
LAYER MAP 48 DATATYPE 0 4800
LAYER SABi      4800
LAYER MAP	50 DATATYPE 0 500
LAYER CTi	500
LAYER MAP	60 DATATYPE 0 600
LAYER INST	600	// SRAM block layer
LAYER MAP       61 DATATYPE 0 610
LAYER M1i	610
LAYER MAP       61 DATATYPE 1 611
LAYER M1DUMi	611
LAYER MAP       62 DATATYPE 0 620
LAYER M2i	620
LAYER MAP       62 DATATYPE 1 621
LAYER M2DUMi	621
LAYER MAP       63 DATATYPE 0 630
LAYER M3i	630
LAYER MAP	63 DATATYPE 1 631
LAYER M3DUMi	631
LAYER MAP       64 DATATYPE 0 640
LAYER M4i	640
LAYER MAP       64 DATATYPE 1 641
LAYER M4DUMi	641
LAYER MAP       65 DATATYPE 0 650
LAYER M5i	650
LAYER MAP       65 DATATYPE 1 651
LAYER M5DUMi	651
LAYER MAP       66 DATATYPE 0 660
LAYER M6i	660
LAYER MAP       66 DATATYPE 1 661
LAYER M6DUMi	661
LAYER MAP       67 DATATYPE 0 670
LAYER M7i	670
LAYER MAP       67 DATATYPE 1 671
LAYER M7DUMi	671
LAYER MAP       68 DATATYPE 0 680
LAYER M8i	680
LAYER MAP       68 DATATYPE 1 681
LAYER M8DUMi	681
LAYER MAP       70 DATATYPE 0 700
LAYER V1i	700
LAYER MAP	70 DATATYPE 1 701
LAYER V1DUMi	701
LAYER MAP	70 DATATYPE 6 706
LAYER V1DUB	706
LAYER MAP       71 DATATYPE 0 710
LAYER V2i	710
LAYER MAP	71 DATATYPE 1 711
LAYER V2DUMi	711
LAYER MAP       71 DATATYPE 6 716
LAYER V2DUB     716
LAYER MAP       72 DATATYPE 0 720
LAYER V3i	720
LAYER MAP	72 DATATYPE 1 721
LAYER V3DUMi	721
LAYER MAP       72 DATATYPE 6 726
LAYER V3DUB     726
LAYER MAP	73 DATATYPE 0 730
LAYER V4i	730
LAYER MAP	73 DATATYPE 1 731
LAYER V4DUMi	731
LAYER MAP       73 DATATYPE 6 736
LAYER V4DUB     736
LAYER MAP	74 DATATYPE 0 740
LAYER V5i	740
LAYER MAP	74 DATATYPE 1 741
LAYER V5DUMi	741	
LAYER MAP       74 DATATYPE 6 746
LAYER V5DUB     746
LAYER MAP       75 DATATYPE 0 750
LAYER V6i	750
LAYER MAP	75 DATATYPE 1 751
LAYER V6DUMi	751	
LAYER MAP       75 DATATYPE 6 756
LAYER V6DUB     756
LAYER MAP       76 DATATYPE 0 760
LAYER V7i	760
LAYER MAP	76 DATATYPE 1 761
LAYER V7DUMi	761
LAYER MAP       76 DATATYPE 6 766
LAYER V7DUB     766
LAYER MAP       85 DATATYPE 0 850
LAYER PSUBi     850
LAYER MAP 	80 DATATYPE 0 800
LAYER PA        800     // Passivation / Pad
LAYER MAP	81 DATATYPE 0 810
LAYER FUSE      810     // Fuse Window
LAYER MAP	81 DATATYPE 1 811
LAYER GTFUSE	811
LAYER MAP       81 DATATYPE 2 812
LAYER EFUSE     812
LAYER MAP       83 DATATYPE 0 830
LAYER ALPAi      830     // AlGu bonding pad,Alfuse
LAYER MAP	83 DATATYPE 6 836
LAYER ALDUB	836
LAYER MAP	83 DATATYPE 11 8311
LAYER ALDUM	8311
LAYER MAP 90 DATATYPE 0 900
LAYER DUMBM     900     // Dummy Metal block layer
LAYER MAP 91 DATATYPE 0 910
LAYER DUMBA     910     // Dummy AA block layer
LAYER MAP 92 DATATYPE 0 920
LAYER DUMBP     920     // Dummy poly block layer
LAYER MAP	93 DATATYPE 0 930
LAYER VARMOS    930
LAYER MAP	95 DATATYPE 0 950
LAYER RESNW     950     // Dummy Pattern for NWELL Resistor
LAYER MAP	96 DATATYPE 0 960
LAYER RESP1     960     // Dummy Pattern for Poly-1 Resistor
LAYER MAP       96 DATATYPE 3 963
LAYER PLRES     963
LAYER MAP	97 DATATYPE 0 970
LAYER RESAA     970     // Dummy Pattern for AA Resistor
LAYER MAP       97 DATATYPE 3 973
LAYER DIFRES    973
LAYER MAP 99 DATATYPE 0 990
LAYER SDOPi	990     // SRAM PG implant
LAYER MAP 109 DATATYPE 0 1090
LAYER PWHTi	1090
LAYER MAP 110 DATATYPE 0 1100
LAYER NWHTi	1100
LAYER MAP 114 DATATYPE 0  1140 
LAYER NLHTi	1140
LAYER MAP 115 DATATYPE 0  1150
LAYER PLHTi	1150
LAYER MAP       123 DATATYPE 0 1230
LAYER TV2i      1230
LAYER MAP	122 DATATYPE 0 1220
LAYER TM2i      1220
LAYER MAP       122 DATATYPE 1 1221
LAYER TM2DUMi   1221
LAYER MAP       125 DATATYPE 0 1250
LAYER TGi	1250
LAYER MAP       125 DATATYPE 1 1251
LAYER TGV	1251	// Marking layer for 2.5V UD 1.8V device
LAYER MAP       125 DATATYPE 3 1253
LAYER OVERDR    1253	// Marking layer for 2.5V OD 3.3V device
LAYER MAP	127 DATATYPE 0 1270
LAYER BORDER    1270    // Top Structure's Border
LAYER MAP 130 DATATYPE 0 1300
LAYER MD	1300
LAYER MAP 132 DATATYPE 0 1320
LAYER EXCLU	1320    // Un-DRC region
LAYER MAP 137 DATATYPE 0 1370
LAYER CAPBP     1370    // Capacitor Dummy
LAYER MAP       138 DATATYPE 0 1380
LAYER DSTR      1380
LAYER MAP	151 DATATYPE 1 1511
LAYER M1DUB     1511
LAYER MAP	152 DATATYPE 1 1521
LAYER M2DUB     1521
LAYER MAP	153 DATATYPE 1 1531
LAYER M3DUB	1531	
LAYER MAP       154 DATATYPE 1 1541
LAYER M4DUB     1541
LAYER MAP       155 DATATYPE 1 1551
LAYER M5DUB     1551
LAYER MAP       156 DATATYPE 1 1561
LAYER M6DUB     1561
LAYER MAP       157 DATATYPE 1 1571
LAYER M7DUB     1571
LAYER MAP       158 DATATYPE 1 1581
LAYER M8DUB     1581
LAYER MAP 	159 DATATYPE 12 1592
LAYER LVT	1592	// Low-Vt devices
LAYER MAP	159 DATATYPE 11 1591
LAYER HVT	1591	// High-Vt devices
LAYER MAP	159 DATATYPE 7 1597
LAYER PTCT	1597
LAYER MAP       159 DATATYPE 1 1590
LAYER BIPOLA    1590
LAYER MAP       171 DATATYPE 0 1710
LAYER M1R       1710  // Dummy for Metal1 Resistor
LAYER MAP       172 DATATYPE 0 1720
LAYER M2R       1720  // Dummy for Metal2 Resistor
LAYER MAP       173 DATATYPE 0 1730
LAYER M3R       1730  // Dummy for Metal3 Resistor
LAYER MAP       174 DATATYPE 0 1740
LAYER M4R       1740  // Dummy for Metal4 Resistor
LAYER MAP       175 DATATYPE 0 1750
LAYER M5R       1750  // Dummy for Metal5 Resistor
LAYER MAP       176 DATATYPE 0 1760
LAYER M6R       1760  // Dummy for Metal6 Resistor
LAYER MAP       177 DATATYPE 0 1770
LAYER M7R       1770  // Dummy for Metal7 Resistor
LAYER MAP       178 DATATYPE 0 1780
LAYER M8R       1780  // Dummy for Metal8 Resistor
LAYER MAP       189 DATATYPE 151 1891
LAYER MARKS     1891
LAYER MAP	193 DATATYPE 1 1931
LAYER TM1DUB	1931
LAYER MAP	194 DATATYPE 1 1941
LAYER TM2DUB    1941
LAYER MAP       194 DATATYPE 2 1942
LAYER MTT2DB    1942
LAYER MAP       201 DATATYPE 0 2010
LAYER TM1R      2010  // Dummy for Top Metal1 Resistor
LAYER MAP       202 DATATYPE 0 2020
LAYER TM2R      2020 // Dummy for Top Metal2 Resistor
LAYER MAP       131 DATATYPE 4 1314
LAYER PLDMK     1314
LAYER MAP       134 DATATYPE 0 1340
LAYER DMPNP     1340
LAYER WNi       203     // NFET Tensile SiN film Cap
LAYER MAP       210 DATATYPE 0 2100
LAYER HRPDMY    2100
LAYER MAP	211 DATATYPE 1 2111
LAYER MOMDMY    2111
LAYER MAP	212 DATATYPE 0 2120
LAYER INDMY     2120     // IN Dummy Layer
LAYER MAP       216 DATATYPE 150 516
LAYER LDBK      516     //      Identify LDMOS function area and do related
LAYER MAP       218 DATATYPE 0 2180 
LAYER LVPi	2180
LAYER MAP       219 DATATYPE 0 2190
LAYER LVNi	2190
LAYER MAP       231 DATATYPE 0 2310
LAYER MTT2i     2310
LAYER MAP       89 DATATYPE 160 8916
LAYER OTPMK1     8916

LAYER   MAP     61   DATATYPE 7 6170
LAYER   M1DOP   6170
LAYER   MAP     62   DATATYPE 7 6270
LAYER   M2DOP   6270
LAYER   MAP     63   DATATYPE 7 6370
LAYER   M3DOP   6370
LAYER   MAP     64   DATATYPE 7 6470
LAYER   M4DOP   6470
LAYER   MAP     65   DATATYPE 7 6570
LAYER   M5DOP   6570
LAYER   MAP     66   DATATYPE 7 6670
LAYER   M6DOP   6670
LAYER   MAP     67   DATATYPE 7 6770
LAYER   M7DOP   6770
LAYER   MAP     68   DATATYPE 7 6870
LAYER   M8DOP   6870
LAYER   MAP     70   DATATYPE 7 7070
LAYER   V1DOP   7070
LAYER   MAP     71   DATATYPE 7 7170
LAYER   V2DOP   7170
LAYER   MAP     72   DATATYPE 7 7270
LAYER   V3DOP   7270
LAYER   MAP     73   DATATYPE 7 7370
LAYER   V4DOP   7370
LAYER   MAP     74   DATATYPE 7 7470
LAYER   V5DOP   7470
LAYER   MAP     75   DATATYPE 7 7570
LAYER   V6DOP   7570
LAYER   MAP     76   DATATYPE 7 7670
LAYER   V7DOP   7670
LAYER   MAP     231  DATATYPE 1 2311
LAYER   MTT2DMi 2311
LAYER MAP       61 DATATYPE 251 6151
LAYER M1PIN	6151
LAYER MAP       62 DATATYPE 251 6251
LAYER M2PIN	6251
LAYER MAP       63 DATATYPE 251 6351
LAYER M3PIN	6351
LAYER MAP       64 DATATYPE 251 6451
LAYER M4PIN	6451
LAYER MAP       65 DATATYPE 251 6551
LAYER M5PIN	6551
LAYER MAP       66 DATATYPE 251 6651
LAYER M6PIN	6651
LAYER MAP       67 DATATYPE 251 6751
LAYER M7PIN	6751
LAYER MAP       68 DATATYPE 251 6851
LAYER M8PIN	6851
LAYER MAP       60 DATATYPE 2  622
LAYER DNSRAM	622
LAYER MAP       60 DATATYPE 4  624
LAYER DPSRAM	624

LAYER MAP       60 DATATYPE 5  625
LAYER LRSRAM	625
LAYER MAP       60 DATATYPE 11  6211
LAYER D2SRAM	6211

LAYER MAP       60 DATATYPE 9  629
LAYER RFSRAM	629
LAYER MAP       60 DATATYPE 150 6015
LAYER HPBL	6015

LAYER MAP       159 DATATYPE 152 15952 
LAYER ULVTi	15952
LAYER MAP       168 DATATYPE 0 1680 
LAYER BUMPi	1680
LAYER MAP       91 DATATYPE 5  9150 
LAYER OCOVLi	9150
LAYER MAP       29 DATATYPE 1  2901 
LAYER DGV	2901
LAYER MAP       89 DATATYPE 156  8956 
LAYER DUPMK1i	8956
LAYER MAP       83 DATATYPE 1  8319 
LAYER ALPAR	8319

MARKG   = COPY MARKS
M1DUM   = (M1DUMi OR M1DOP) NOT   MARKG
M2DUM   = (M2DUMi OR M2DOP) NOT   MARKG
M3DUM   = (M3DUMi OR M3DOP) NOT  MARKG
M4DUM   = (M4DUMi OR M4DOP) NOT  MARKG
M5DUM   = (M5DUMi OR M5DOP) NOT  MARKG
M6DUM   = (M6DUMi OR M6DOP) NOT   MARKG
M7DUM   = (M7DUMi OR M7DOP) NOT  MARKG
M8DUM   = (M8DUMi OR M8DOP) NOT MARKG
V1DUM   = (V1DUMi OR V1DOP) NOT   MARKG
V2DUM   = (V2DUMi OR V2DOP) NOT   MARKG
V3DUM   = (V3DUMi OR V3DOP) NOT   MARKG
V4DUM   = (V4DUMi OR V4DOP) NOT   MARKG
V5DUM   = (V5DUMi OR V5DOP) NOT   MARKG
V6DUM   = (V6DUMi OR V6DOP) NOT  MARKG
V7DUM   = (V7DUMi OR V7DOP) NOT   MARKG
TM2DUM  = TM2DUMi NOT  MARKG
MTT2DM  = MTT2DMi NOT  MARKG

AA	= AAi NOT   MARKG
NW	= NWi NOT   MARKG
PC	= PCi NOT   MARKG
DNW	= DNWi NOT   MARKG
NC	= NCi NOT   MARKG
DG	= DGi NOT   MARKG
GT	= GTi NOT   MARKG
NLL	= NLLi NOT   MARKG
NLH	= NLHi NOT  MARKG
PLH	= PLHi NOT   MARKG
PLL	= PLLi NOT  MARKG
SN	= SNi NOT   MARKG
SP	= SPi NOT   MARKG
VTPH	= VTPHi NOT   MARKG
VTNH	= VTNHi NOT   MARKG
SAB	= SABi NOT   MARKG
CT	= CTi NOT   MARKG
M1      = M1i NOT   MARKG
V1      = V1i NOT  MARKG
M2	= M2i NOT   MARKG
V2	= V2i NOT   MARKG
M3	= M3i NOT  MARKG
V3	= V3i NOT   MARKG
M4	= M4i NOT  MARKG
V4	= V4i NOT   MARKG
M5	= M5i NOT   MARKG
V5	= V5i NOT   MARKG
M6	= M6i NOT  MARKG
V6	= V6i NOT   MARKG
M7	= M7i NOT   MARKG
V7	= V7i NOT   MARKG
M8	= M8i NOT   MARKG
TV2	= TV2i NOT   MARKG
TM2	= TM2i NOT   MARKG
MTT2    = MTT2i NOT   MARKG
WN      = WNi NOT   MARKG
SDOP	= SDOPi NOT   MARKG
PWHT	= PWHTi NOT   MARKG
NWHT	= NWHTi NOT   MARKG
NLHT	= NLHTi NOT  MARKG
PLHT	= PLHTi NOT   MARKG
TG	= TGi NOT   MARKG
LVP	= LVPi NOT   MARKG
LVN	= LVNi NOT   MARKG
PSUB	= PSUBi NOT  MARKG
HRP	= HRPi NOT   MARKG
ULVT	= ULVTi NOT  MARKG
BUMP	= BUMPi NOT  MARKG
OCOVL	= OCOVLi NOT  MARKG
DUPMK1  = DUPMK1i  NOT  MARKG
ESD1    =  ESD1i   NOT  MARKG
BD_HOLE = HOLES BORDER
BD_WITHHOLE = BORDER OR BD_HOLE

SRAM =((DNSRAM OR LRSRAM) OR D2SRAM) OR RFSRAM 

#IFDEF TOPMETAL 9
CONNECT MTT2i M8i BY TV2i
CONNECT TM2i M8i BY TV2i
CONNECT M8i M7i BY V7i
CONNECT M7i M6i BY V6i
CONNECT M6i M5i BY V5i
CONNECT M5i M4i BY V4i
CONNECT M4i M3i BY V3i
#ENDIF
#IFDEF TOPMETAL 8
CONNECT MTT2i M7i BY TV2i
CONNECT TM2i M7i BY TV2i
CONNECT M7i M6i BY V6i
CONNECT M6i M5i BY V5i
CONNECT M5i M4i BY V4i
CONNECT M4i M3i BY V3i
#ENDIF
#IFDEF TOPMETAL 7
CONNECT MTT2i M6i BY TV2i
CONNECT TM2i M6i BY TV2i
CONNECT M6i M5i BY V5i
CONNECT M5i M4i BY V4i
CONNECT M4i M3i BY V3i
#ENDIF
#IFDEF TOPMETAL 6
CONNECT MTT2i M5i BY TV2i
CONNECT TM2i M5i BY TV2i
CONNECT M5i M4i BY V4i
CONNECT M4i M3i BY V3i
#ENDIF
#IFDEF TOPMETAL 5
CONNECT MTT2i M4i BY TV2i
CONNECT TM2i M4i BY TV2i
CONNECT M4i M3i BY V3i
#ENDIF
#IFDEF TOPMETAL 4
CONNECT MTT2i M3i BY TV2i
CONNECT TM2i M3i BY TV2i
#ENDIF
CONNECT M3i M2i BY V2i
CONNECT M2i M1i BY V1i
CONNECT CT M1
CONNECT M1i GTi NTAPi PTAPi PSDi NSDi BY CTi
CONNECT NTAPi NWi
CONNECT NW NWi
CONNECT LVNW NWi
CONNECT HMVNW NWi
#IFDEF TOPMETAL 9
LABEL ORDER MTT2i TM2i M8i M7i M6i M5i M4i M3i M2i M1i NTAPi PTAPi NSDi PSDi GTi NWi
#ENDIF
#IFDEF TOPMETAL 8
LABEL ORDER MTT2i TM2i M7i M6i M5i M4i M3i M2i M1i NTAPi PTAPi NSDi PSDi GTi NWi
#ENDIF
#IFDEF TOPMETAL 7
LABEL ORDER MTT2i TM2i M6i M5i M4i M3i M2i M1i NTAPi PTAPi NSDi PSDi GTi NWi
#ENDIF
#IFDEF TOPMETAL 6
LABEL ORDER MTT2i TM2i M5i M4i M3i M2i M1i NTAPi PTAPi NSDi PSDi GTi NWi
#ENDIF
#IFDEF TOPMETAL 5
LABEL ORDER MTT2i TM2i M4i M3i M2i M1i NTAPi PTAPi NSDi PSDi GTi NWi
#ENDIF
#IFDEF TOPMETAL 4
LABEL ORDER MTT2i TM2i M3i M2i M1i NTAPi PTAPi NSDi PSDi GTi NWi
#ENDIF

/*
VIRTUAL CONNECT NAME "?VDD?" "?VCC?" "?VSS?" "?GND?"
VIRTUAL CONNECT COLON YES
*/


//******************************************
//    LAYER DERIVATIONS AND OPERATIONS
//******************************************


//==================
// For Connectivity
//==================

PACTi   = SPi AND AAi
NACTi   = SNi AND AAi

PTAPi   = PACTi NOT NWi
NTAPi   = NACTi AND NWi

PGATEi  = PACTi AND GTi
NGATEi  = NACTi AND GTi

PSDii   = (PACTi NOT PGATEi) TOUCH PGATEi
NSDii   = (NACTi NOT NGATEi) TOUCH NGATEi
PSDi	= PACTi NOT PGATEi
NSDi    = NACTi NOT NGATEi

PMOSii  = PGATEi OR PSDii
NMOSii  = NGATEi OR NSDii
PMOSi   = PGATEi OR PSDi
NMOSi   = NGATEi OR NSDi


//==================
// Transistor Def
//==================

DRC:1   = EXTENT DRAWN ORIGINAL
BULK    = SIZE DRC:1 BY 1.0

PW      = BULK NOT (NWi OR PSUBi)

PACT    = SP AND AA
NACT    = SN AND AA
ACT	= PACT OR NACT

PGT     = SP AND GT
NGT     = SN AND GT

PTAP    = PACT NOT NW
NTAP    = NACT AND NW
TAP     = PTAP OR NTAP

GATE0 = (GT INTERACT CT) AND AA   
AA1 = (AA INTERACT GATE0) NOT GATE0 
AA2 = AA1 TOUCH GATE0 > 1  
AA3 = AA1 INTERACT CT     
AA4 = AA2 OR AA3   
GATE1 = GATE0 TOUCH AA4 == 2  
GATE2 = GATE0 AND LDBK  
GATE = GATE1 OR GATE2

PGATE   =  GATE AND SP 
NGATE   = SN AND GATE
//GATE    = (AA AND GT) NOT PLDMK
PSD     = (PACT NOT PGATE) TOUCH PGATE
NSD     = (NACT NOT NGATE) TOUCH NGATE

PMOS    = PGATE OR PSD
NMOS    = NGATE OR NSD
MOS     = PMOS OR NMOS
MOS12   = MOS OUTSIDE (DG OR TG)
MOS18   = MOS INTERACT DG
MOS25   = MOS INTERACT TG

PBAA    = AA AND PSUB
PBGT    = GT INTERACT PSUB

NAAEIGT = NACT IN EDGE GT
PAAEIGT = PACT IN EDGE GT
NGTEIAA = GT IN EDGE NACT
PGTEIAA = GT IN EDGE PACT
GTEIAA  = GT IN EDGE AA

INTERGT = GT NOT GATE
//GT_end  = CONVEX EDGE GT ANGLE1 <180 ANGLE2 <180 WITH LENGTH < 0.120
/*GT_nonend = GT NOT COIN EDGE GT_end_head1
GT_end = ENC AA GT < 0.12 OPPOSITE REGION
GT_end_head = GT_end COIN EDGE ((GT INTERACT GATE) NOT TOUCH EDGE GATE)
GT_end_head1 =(GT INTERACT GATE) NOT TOUCH EDGE GATE*/

GT_end_head1 = CONVEX EDGE GT  ANGLE1 ==90  LENGTH1 >=0.08 ANGLE2 ==90  LENGTH2 >=0.08 WITH LENGTH <=0.11
GT_end_head =  ENC (AA ENCLOSE GATE) [GT_end_head1] < 0.12 OPPOSITE
GT_nonend = GT NOT COIN EDGE GT_end_head1
FTGT    = GT NOT INTERACT CTi
FTAA	= AA NOT INTERACT CTi

//==================
//  Resistor Def
//==================

AAR     = AA AND RESAA
GTR     = GT AND RESP1
AASABR  = AAR INTERACT SAB
GTSABR  = GTR INTERACT SAB
NWR     = NW AND RESNW
//NWR_AA  = AA AND RESNW
NWR_AA  = AA AND NWR
NWR_CT  = CT AND NWR_AA
NWR_SN  = SN INTERACT NWR
NWR_SP  = SP INTERACT NWR

//AAR_body = (AA INSIDE RESAA) AND SAB
AAR_body = AAR AND SAB

//=============
//   HRP Def
//=============

HRPR    = GT AND HRPDMY
HR_GT    = HRPR AND HRPDMY
SAB_GT   = HRPR AND SAB

//==============
//  Well Def
//==============

HVNW = NW NOT OUTSIDE TG
MVNW = NW NOT OUTSIDE DG
HMVNW = HVNW OR MVNW
LVNW = NW NOT HMVNW


//=====================
// CT / Wide Metal Def
//=====================

ACT_CT   = CT AND AA
INTERCT  = CT AND INTERGT
CTAAM1   = CT INTERACT (AA AND M1)
CTGTM1   = CT INTERACT (GT AND M1)
CTM1     = CTAAM1 OR CTGTM1

TM2SLOT1 = HOLES TM2 INNER EMPTY
TM2_SL  = (TM2 INTERACT TM2SLOT1) OR TM2SLOT1


//================================================
// CORN / Chamfer area size at the chip corner Def
//================================================

CORN = INT DRC:1 < 74 ABUT REGION

EXCLU_1 {
@ report DRC alert if EXCLU is used
COPY EXCLU  
}
//===========================
//  AA - Active Area DRC
//===========================

GROUP GAA AA_?

AA_1 {
@ AA minimum width(The INST connected area apply SRAMdesign rule) is 0.06
 X= INT AA  < 0.06 ABUT<90 SINGULAR REGION
 X OUTSIDE INST
}

SRAA_1sa {
@ AA inner vertex to inner vertex distance is 0.046
    X= EXT AA  < 0.046 ABUT<90 OPPOSITE REGION NOTCH 
 X NOT OUT INST
}

AA_1a {
@ AA minimum width of NMOS/PMOS for 0.9/1.1/1.2V transistor is 0.12
 X= INT (MOS12 IN EDGE GT) < 0.12 ABUT<90 REGION
 X OUTSIDE INST

}
/*
#IFDEF RECOMMENDED YES
AA_1R {
@ AA minimum width of NMOS/PMOS for 1.2V transistor is 0.12
  INT MOS12 < 0.12 ABUT<90 SINGULAR REGION
}
#ENDIF
*/
AA_2 {
@ AA (enclosure by TG or DG) minimum width of NMOS/PMOS for 1.8/2.5v transistor is 0.32
  INT ((MOS AND (DG OR TG)) IN EDGE GT) < 0.32 ABUT<90 REGION
}
/*
AA_3 {
@ AA minimum width for interconnect is 0.08
  INT AA < 0.08 ABUT<90 SINGULAR REGION
}
*/
AA_4a {
@ AA minimum space  is 0.08
 X= EXT AA < 0.08  SINGULAR REGION 
 X OUTSIDE INST
}
SRAA_4a {
@ AA min space is 0.065
X=EXT AA  < 0.065 ABUT<90 SINGULAR REGION 
X NOT OUTSIDE INST 
}

GATE14 = GATE WITH EDGE (LENGTH (GT IN EDGE AA) >= 0.14)
EDGE1 = AA TOUCH EDGE GATE
EDGE2 = (AA ENCLOSE GATE14) TOUCH EDGE GATE
/*AA_4b {
@ AA for transistor minimum space if one of AA width(W2) >= 0.14um, and AA to AA overlap(run length)
@ which along S/D direction Y1>=0.14, S >= 0.1
  AA_INGT=AA INTERACT GATE
  AA12 = AA_INGT WITH WIDTH >= 0.14
  AA_TCHGTX1 =AA_INGT TOUCH EDGE GATE
  AA_TCHGTX2 =AA12 TOUCH EDGE GATE 
  AA_TCHGTY1= EXPAND EDGE AA_TCHGTX1 OUTSIDE BY 0.001
  AA_TCHGTY2= EXPAND EDGE AA_TCHGTX2 OUTSIDE BY 0.001
  AA_edge1 = LENGTH AA_INGT > 0
  AA_edge11 = EXPAND EDGE AA_edge1 OUTSIDE BY 0.001
  AA_edgeZ1 = AA_edge11 NOT AA_TCHGTY1
  AA_edgeZ2 = AA_edge11 NOT AA_TCHGTY2
  AAspace = EXT AA_edgeZ1 AA_edgeZ2 < 0.098 OPPOSITE REGION
 ((AAspace OUTSIDE INST) WITH EDGE (LENGTH (AAspace NOT INSIDE INST) >= 0.14)) NOT AA_INGT
}*/
SRAA_4c {
@ AA with gate minimum space along gate poly direction is 0.085, if one of AA width (W3)>=0.14um, and AA to AA overlap (run length) Y2 >=0.14um
AA_INGT=AA INTERACT GATE
AA12 = AA_INGT WITH WIDTH >= 0.14
AA_TCHGTX1 =AA_INGT TOUCH EDGE GATE
AA_TCHGTX2 =AA12 TOUCH EDGE GATE
AAspace = EXT  AA_TCHGTX1  AA_TCHGTX2 <0.085 OPPOSITE REGION
(AAspace NOT OUTSIDE INST) WITH EDGE (LENGTH (AAspace NOT OUTSIDE INST) >= 0.14)

}
AA_4b_4c {
@ The space between two AA with gate along source/drain direction is >=0.1 , if one of AA width (W2) >= 0.14m, and AA to AA run length Y1>=0.14m
@ The space between two AA with gate along gate poly direction is >=0.1, if one of AA width (W3)>=0.14m, and AA to AA run length Y2 >=0.14m
  AA_INGT=AA INTERACT GATE
  AA12 = AA_INGT WITH WIDTH >= 0.14
   AAspace = EXT AA_INGT AA12 < 0.1 OPPOSITE REGION
  (AAspace OUTSIDE INST) WITH EDGE (LENGTH AAspace >= 0.14)
}
AA_4d{
@ Space between two AAs inside (DG OR TG) is 0.13
EXT (AA INSIDE (DG OR TG))<0.13 ABUT<90 SINGULAR REGION
}
AA_9 {
@ AA minimum area except floating AA is 0.02
 X=AREA (AA NOT FTAA)  < 0.02
 X OUT INST
}
SRAA_9 {
@ AA minimum area is 0.015
 X= AREA AA < 0.015  
 X NOT OUTSIDE INST
}
AA_9a {
@ AA minimum area at floating AA is 0.015
  X = AREA FTAA < 0.015
 X  OUTSIDE  INST
}
AA_10 {
@ DG, TG or core transistors mixed in the same AA are prohibited
  MOS CUT DG
  MOS CUT TG
  (MOS INTERACT DG) INTERACT TG
}
AA_11 {
@ It is not allow if N+AA/P+AA crossing the NW, excluding LDMOS area.waive the AA interact with RESNW
  ((NACT CUT NW) NOT LDBK) NOT (AA INTERACT RESNW)
  ((PACT CUT NW) NOT LDBK) NOT (AA INTERACT RESNW)
}
AA_12 {
@ AA channel width of NMOS/PMOS for 0.9/1.1/1.2V transistor is <=50. Waive transistor inside VARMOS
  X = LENGTH (GT IN EDGE ((MOS NOT (DG OR TG)) NOT VARMOS)) > 50
 EXPAND EDGE X INSIDE BY 0.01
}
AA_13 {
@ AA minimum enclosed area(um2) is 0.045
  AAHOLE = HOLES AA INNER
  AREA (AAHOLE NOT AA) < 0.045
}
AA_14_a {
@ For area excluding (DG or TG), AA density (including dummy)is 25%. Density check window size: 200m*200m with step size: 100m.
@ Waive RESNW, LOGO, seal ring(MARKS) areas
@ DRC check with the said window size and rule number and highlight as X. Y = X not (DG or TG), Z= (Y area)/(100*100)  
@ If Z > 25%, highlight Y for AA density inside of Y that cannot meet of rule value requirement.
  AA_ALL= AAi OR AADUM
  X = DENSITY (AAi OR AADUM) < 0.25 WINDOW 200 STEP 100 BACKUP RDB density_report_AA_14_a1.db
  Y = X NOT (DG OR TG)
  Z= COPY Y
  M = DENSITY Y  [area(Y)/(100*100)]>0.25  INSIDE OF LAYER Z  RDB density_report_AA_14_a2.db
  N = COPY M
 W =DENSITY AA_ALL M [area(AA_ALL)/area(M)] < 0.25 INSIDE OF LAYER N BY POLYGON PRINT density_report_AA_14_a.log RDB density_report_AA_14_a.db
 (( W NOT MARKG ) NOT RESNW) NOT LOGO
}
AA_14_b {
@ For area excluding (DG or TG), AA density (including dummy)is 80%. Density check window size: 200m*200m with step size: 100m.
@ Waive RESNW, LOGO, seal ring(MARKS) areas
@ DRC check with the said window size and rule number and highlight as X. Y = X not (DG or TG), Z= (Y area)/(100*100)  
@ If Z > 25%, highlight Y for AA density inside of Y that cannot meet of rule value requirement.
   AA_ALL= AAi OR AADUM
  X = DENSITY (AAi OR AADUM) >0.8 WINDOW 200 STEP 100 BACKUP RDB density_report_AA_14_b1.db
  Y = X NOT (DG OR TG)
  Z= COPY Y
  M = DENSITY Y  [area(Y)/(100*100)]>0.25  INSIDE OF LAYER Z  RDB density_report_AA_14_b2.db
  N = COPY M
  W =DENSITY AA_ALL M [area(AA_ALL)/area(M)]> 0.80  INSIDE OF LAYER N BY POLYGON PRINT density_report_AA_14_b.log RDB density_report_AA_14_b.db
 (( W NOT MARKG ) NOT RESNW) NOT LOGO
}
AA_14a_a{
@ For area in of (DG or TG), AA density (including dummy). Density check window size: 200m*200m with step size 100m
@ DRC check with the said window size and rule number and highlight as X.  Y = X and (DG or TG), Z= (Y area)/(100*100)  If Z > 25%,
@ highlight Y for AA density inside of Y outside of rule value requirement
AA_ALL= AAi OR AADUM
X = DENSITY AA_ALL < 0.25 WINDOW 200  STEP 100 BACKUP  RDB density_report_AA_14a_a1.db
Y = X AND (DG OR TG)
Z= COPY Y 
M = DENSITY Y  [area(Y)/(100*100)]>0.25  INSIDE OF LAYER Z  RDB density_report_AA_14a_a2.db
N = COPY M
W =DENSITY AA_ALL M [area(AA_ALL)/area(M)] < 0.25 INSIDE OF LAYER N BY POLYGON PRINT density_report_AA_14a_a.log RDB density_report_AA_14a_a.db
W NOT MARKG
}
AA_14a_b{
@ For area in of (DG or TG), AA density (including dummy). Density check window size: 200um*200um, step size: 100um	Min: 25% Max: 90%
@ DRC check with the said window size and rule number and highlight as X.  Y = X and (DG or TG)  Highlight AA density inside of Y outside of rule value requires
AA_ALL= AAi OR AADUM
X = DENSITY  AA_ALL > 0.9 WINDOW 200 STEP 100 BACKUP RDB density_report_AA_14a_b1.db 
Y = X AND (DG OR TG)
Z= COPY Y
M = DENSITY Y  [area(Y)/(100*100)]>0.25  INSIDE OF LAYER Z  RDB density_report_AA_14a_b2.db
N = COPY M
W = DENSITY AA_ALL M [area(AA_ALL)/area(M)] >0.9 INSIDE OF LAYER N BY POLYGON PRINT density_report_AA_14a_a.log RDB density_report_AA_14a_b.db
W NOT MARKG
}

AA_15a {
@ AA density overlap by DUMBA min. is 20%. Density check window size: 200um*200um, step size: 100um
  X = DENSITY (AAi OR AADUM) < 0.20 WINDOW 200 STEP 100 BACKUP PRINT density_report_AA15a.log RDB density_report_AA15a.db
  (X AND DUMBA) NOT MARKG
}
AA_15b {
@ AA density overlap by DUMBA max. is 80%. Density check window size: 200um*200um, step size: 100um
  X = DENSITY (AAi OR AADUM) > 0.80 WINDOW 200 STEP 100 BACKUP PRINT density_report_AA15b.log RDB density_report_AA15b.db 
  (X AND DUMBA) NOT MARKG
}
AA_16 {
@ Bent 45 degree AA width is >= 0.16
X = ANGLE AA ==45 
INT X <0.16  ABUT <90 REGION 
}
AA_17 {
@ 45 degree AA space to parallel AA is >=0.16
X = ANGLE AA ==45
EXT X AA <0.16 REGION  PARA ONLY
}

AA_18{
@ AA space for of U shape (notch) is >=0.15. Waive for extrusion E <= 0.03  or U shape bottom AA width W0 > 0.08um
X =CONVEX EDGE AA ANGLE1>269.9<271.1 ANGLE2>269.9<271.1 WITH LENGTH<0.15
Y= CONVEX EDGE AA ANGLE1>89.9<90.1 ANGLE2>269.9<271.1 WITH LENGTH>0.03
Z= EXT X Y <0.001  ABUT == 90 INTERSECTING ONLY REGION
M = INT X AA <=0.08 OPPOSITE REGION 
(((EXPAND EDGE X OUTSIDE BY 0.001) INTERACT Z) INTERACT M) OUTSIDE INST
}
AA_19 {
@ AA must be fully covered by (SN OR SP).
@ Waive the violations inside (AA INTERACT RESNW ) 
(AA NOT INSIDE (SN OR SP)) NOT (AA INTERACT RESNW )
}	
/*SRAA_101 {
@ AA min width with space on both side <0.15um is 0.046
  AAspace = EXT (AA AND INST) < 0.150 ABUT <90 OPPOSITE REGION
  AAspace_edge1 = AA COIN EDGE AAspace
  AAspace_edge2 = AA NOT COIN EDGE AAspace_edge1
  INT AAspace_edge2 < 0.046 ABUT <90 REGION
}*/


//=============================
//   RESAA - AA Resistor DRC
//=============================

GROUP GRESAA RESAA_?

//Skip RESAA_1 : AA resistor must within RESAA layer
RESAA_2 {
@ AA resistor minimum width is 0.40; AA resistor mean AA with RESAA overlap SAB.
  INT (AAR INSIDE EDGE SAB) < 0.40 ABUT<90 REGION
}
/*
#IFDEF RECOMMENDED YES
RESAA_2R {
@ AA resistor minimum width is 0.40
  INT (AAR IN EDGE SAB) < 0.40 ABUT<90 REGION
}
#ENDIF
*/
RESAA_3 {
@ AA resistor minimum length is 0.40
  INT (SAB COIN EDGE AAR) < 0.40 ABUT<90 REGION
}
/*
#IFDEF RECOMMENDED YES
RESAA_3R {
@ AA resistor minimum length is 0.80
  INT (SAB IN EDGE AAR) < 0.80 ABUT<90 REGION
}
#ENDIF
*/
RESAA_4 {
@ AA resistor must be orthogonal
  ANGLE AAR >0 <90
}
RESAA_5 {
@ CT to SAB minimum space is 0.180
  EXT (CT INSIDE (AA INTERACT AAR)) SAB < 0.180 ABUT<90 SINGULAR REGION
}
RESAA_6 {
@ Extension of RESAA outside of AA minimum distance is 0.15
  ENC AA RESAA < 0.15 ABUT<90 SINGULAR REGION
}
RESAA_7 {
@ The minimum separation between resistors with un-related implant region is 0.16
  EXT AAR SN < 0.16 ABUT<90 SINGULAR REGION 
  EXT AAR SP < 0.16 ABUT<90 SINGULAR REGION
  EXT AAR ESD1 < 0.16 ABUT<90 SINGULAR REGION
}
/*
RESAA_8 {
@ Dog-bone design at the end of AA resistor for contact pick-up is not suggested.
  X = CONVEX EDGE AAR == 1
  EXPAND EDGE X INSIDE BY 0.01
}
*/
RESAA_9 {
@ For AA resistor, make sure the AA be covered by SAB and implanted by either SN or SP
  (AA AND RESAA) NOT SAB
  (AAR NOT IN SP) NOT IN SN
}
RESAA_10 {
@ AA SAB resistor with SP must lay on NW
  (AAR  AND SP) NOT NW
}
/*
RESAA_11 {
@ Minimum AA extension of SAB is 0.40 
  ENC SAB AAR < 0.40 ABUT<90 SINGULAR REGION
}
*/
RESAA_12 {
@ Minimum Space RESAA to non-related AA is 0.08
  EXT RESAA AA < 0.08 ABUT<90 SINGULAR REGION
}
RESAA_13 {
@ Minimum Space RESAA to non-related Poly is 0.08
  EXT RESAA GT < 0.08 ABUT<90 SINGULAR REGION
}
RESAA_14{
@ RESAA and SAB on AA should have coincident edge
X =SAB  INSIDE EDGE AA 
Y = RESAA INSIDE EDGE AA
Y NOT COIN EDGE X    
RESAA ENCLOSE AA
}


  
//===========================
//  AAC - AA Density Rules
//===========================

GROUP GAAC AA_C_?

HDA = DENSITY (AAi OR AADUM) > 0.85 WINDOW 250 STEP 25
LDA = DENSITY (AAi OR AADUM) < 0.10 WINDOW 25 STEP 25
MDA = (DENSITY (AAi OR AADUM) < 0.20 WINDOW 25 STEP 25) NOT LDA

AA_C_1 {
@ Maximum containing rectangle of HDA is 250*250
  HDA WITH WIDTH > 250
}
/*
AAC_2 {
@ Minimum space between HDAs is 80
  EXT HDA < 80 ABUT<90 SINGULAR REGION
}
*/
AA_C_3 {
@ Maximum containing rectangle of LDA is 50*50
  (LDA WITH WIDTH > 50) NOT MARKG
}
AA_C_4 {
@ Maximum containing rectangle of MDA is 125*125
  MDA WITH WIDTH > 125
}
#IFDEF RECOMMENDED YES
AA_C_5_R {
@ Minimum space between gate and minimum 50*50um LDA is 20
@ Waive if the gate channel length >= 0.06um
  X = LDA WITH WIDTH >= 50
  Y = SIZE X BY 20
  Z =LENGTH ( AA COIN EDGE GATE)<0.06  
  ((GATE WITH EDGE Z)  NOT X) AND Y
}
#ENDIF

//===========================
//  AA silicide resistor DRC
//===========================

GROUP GDIFRES DIFRES_?

AAD =AA AND DIFRES

DIFRES_1{
@AA Silicide resistor minimum width is 0.2
 INT AAD <0.2  ABUT<90  REGION
}
DIFRES_2{
@DIFRES can not overlap with RESAA
DIFRES AND RESAA
}
DIFRES_3{
@AA Silicide resistor minimum square number is 1
 X = DIFRES INTERACT AA
  Y = AA AND DIFRES
  L = LENGTH Y >0
  L1 = EXPAND EDGE L OUTSIDE BY 0.001 
  W = INSIDE EDGE X AA
  W1 =  EXPAND EDGE W OUTSIDE BY 0.001
  L_RE =L1 NOT W1
  L_EDGE = L_RE COIN EDGE Y 
  DFM PROPERTY Y L_EDGE W OVERLAP ABUT ALSO MULTI [WIDTH = LENGTH(W)] >0 [SQUARES = LENGTH(L_EDGE)/LENGTH(W)] < 1
}
DIFRES_4{
@AA Silicide resistor must be orthogonal
ANGLE AAD >0 <90
}
DIFRES_5{
@CT to DIFRES space fix is 0.01
 //(SIZE (CT INSIDE (AA INTERACT AAD)) BY 0.01) NOT TOUCH  DIFRES
 X1 = EXT CT DIFRES <= 0.07 ABUT<90 REGION OPPOSITE 
X2 = EXT CT DIFRES == 0.01 ABUT<90 REGION OPPOSITE
 (X1 NOT (X2 NOT (X2 ENCLOSE CT))) OR (CT INTERACT DIFRES)
}
DIFRES_6{
@Extension of DIFRES outside of AA minimum distance is 0
X =AAD TOUCH (DIFRES NOT AAD) >1
 Y = DIFRES COIN EDGE AA
 Z =EXPAND EDGE Y INSIDE BY 0.001 
 DIFRES NOT INTERACT (X OR (DIFRES INTERACT Z))
}
DIFRES_7{
@The minimum separation between AA resistors and un-related implant region is 0.16
 EXT AAD SN < 0.16 ABUT<90 SINGULAR REGION
  EXT AAD SP < 0.16 ABUT<90 SINGULAR REGION
  EXT AAD ESD1 < 0.16 ABUT<90 SINGULAR REGION
}
DIFRES_8{
@For AA Silicide resistor, make sure the AA be implanted by either SN or SP. Minimum enclosure by SN or SP is 0.18
((AA ENCLOSE AAD) NOT IN SP) NOT IN SN
ENC (AA ENCLOSE AAD) SN <0.18 ABUT<90 SINGULAR REGION
 ENC (AA ENCLOSE AAD) SP <0.18 ABUT<90 SINGULAR REGION
}
DIFRES_9{
@AA Silicide resistor with SP must lay on NW
 (AAD AND SP) NOT NW  
}
DIFRES_10{
@AA Silicide resistor with SN must lay on PW
(AAD AND SN) NOT PW
}
DIFRES_11{
@Minimum Space between DIFRES and non-related AA is 0.08
EXT DIFRES AA < 0.08 ABUT<90 SINGULAR REGION
}
DIFRES_12{
@Minimum Space between DIFRES and non-related Poly is 0.08
EXT DIFRES GT < 0.08 ABUT<90 SINGULAR REGION
}

//==========================
//  DNW - Deep N-Well DRC
//==========================
  
GROUP GDNW DNW_?

DNW_1 {
@ DNW minimum width is 0.52
  INT DNW < 0.52 ABUT<90 REGION
}
DNW_2 {
@ Minimum space between two DNW regions is 0.80
  EXT DNW < 0.80 ABUT<90 REGION
}
DNW_3 {
@ Minimum overlap of NW and DNW region is 0
  DNW OUT EDGE NW
}
DNW_4 {
@ Minimum space between a DNW and a NW is 0.565
  X = NW NOT COIN EDGE DNW
  EXT X DNW < 0.565 ABUT<90 REGION
}
/*DNW_5 {
@ Minimum space between P+AA to DNW is 0.21
  EXT DNW PACT < 0.21 ABUT<90 SINGULAR REGION
}
DNW_6 {
@ Minimum space between N+AA enclosed by DNW to NW is 0.21
  EXT (NACT AND DNW) NW  < 0.21 ABUT<90 SINGULAR REGION
}*/
DNW_7{
@ Space between DNW and (N+AA outside of (DNW or NW)) 	>= 1.4
 EXT (NACT OUTSIDE (DNW OR NW)) DNW<1.4 ABUT<90 SINGULAR REGION
}
  


//===================================
//   NW - N-Well Implant Layer DRC
//===================================

GROUP GNW NW_?

NW_1 {
@ NW minimum width(parallel side to side width, The INST connected area apply SRAM design rule) is 0.33
 X= INT NW  < 0.33 ABUT<90 REGION PARA ONLY 
 X OUT INST
}
SRNW_1 {
@ NW minimum width is 0.27
  X =INT NW  < 0.27 ABUT<90 REGION
 X NOT OUTSIDE INST
}
/*
NW_2 {
@ NW width for NW resistor is 1.2
  INT NWR < 1.20 ABUT<90 OPPOSITE REGION
}
*/
NW_3 {
@ Minimum space between two NW regions at the same net (with run length > 0) is 0.33.
  X = EXT NW < 0.33 OPPOSITE ABUT<90 REGION CONNECTED
  X OUTSIDE INST
}
/*SRNW_3 {
@ Minimum space between two 0.9/1.1/1.2v NW regions at the same potential is 0.324
  X = EXT NW < 0.324 ABUT<90 SINGULAR REGION CONNECTED
  X NOT OUTSIDE INST
}*/
NW_4 {
@ Minimum space between two NW regions at different net is 0.60
  EXT NW < 0.60 ABUT<90 SINGULAR REGION NOT CONNECTED
}
NW_7 {
@ NW minimum area is 0.70
  AREA NW < 0.70
}
NW_8 {
@ NW minimum enclosed area is 0.70
  NWHOLE = HOLES NW INNER
  AREA (NWHOLE NOT NW) < 0.70
}
NW_9 {
@ NW minimum space to N+AA (enclosure by TG or DG) is 0.22
  EXT NW (NACT INSIDE (TG OR DG)) < 0.22 ABUT<90 SINGULAR REGION
}
NW_10 {
@ NW enclosure of P+AA (enclosed by TG or DG)is 0.22
ENC (PACT INSIDE (TG OR DG)) NW < 0.22 ABUT<90 SINGULAR REGION
}
/*NW_11{
@ N+AA adjacent both two edges space opposite to NW is >=0.16. Both of two adjacent edges space to NW smaller than rule value is not permitted.
X = EXT [NACT] NW <0.16 ABUT<90 OPPOSITE  
Y=NACT TOUCH EDGE X 
Z =INT Y <0.002 ABUT  REGION
Z NOT SRAM
}
*/
#IFDEF RECOMMENDED YES
NW_11_R{
@ N+AA adjacent both two edges space opposite to NW is >=0.16. Both of two adjacent edges space to NW smaller than rule value is not permitted.
@ In schematic rule check method, E = 0.08, D=0.16
NACT_EDGE = LENGTH NACT >0
Eregion = EXPAND EDGE NACT_EDGE INSIDE BY 0.08  EXTEND BY 0.001 
Eregion_EDGE = NACT INSIDE EDGE  Eregion 
Eregion_=EXT [Eregion_EDGE] NW <0.16  OPPOSITE  PERP ALSO OBTUSE ALSO
Eregion_EDGE_1 = Eregion_EDGE TOUCH EDGE Eregion_
INT Eregion_EDGE_1 <0.002 ABUT REGION  
}
#ENDIF
/*NW_12{
@ NW enclosure opposite of P+AA adjacent both two edges is >= 0.16. Both of two adjacent edges enclosed by NW smaller than rule value is not permitted.
X = ENC [PACT] NW <0.16 ABUT<90 OPPOSITE    
Y =PACT TOUCH EDGE X  
Z =INT Y <0.002 ABUT  REGION
Z NOT SRAM
}*/
#IFDEF RECOMMENDED YES
NW_12_R{
@ NW enclosure opposite of P+AA adjacent both two edges is >= 0.16. Both of two adjacent edges enclosed by NW smaller than rule value is not permitted.
@In schematic rule check method, E = 0.08, D=0.16
PACT_EDGE = LENGTH PACT >0
Eregion = EXPAND EDGE PACT_EDGE INSIDE BY 0.08  EXTEND BY 0.001 
Eregion_EDGE = PACT INSIDE EDGE  Eregion 
Eregion_=ENC [Eregion_EDGE] NW <0.16  OPPOSITE  PERP ALSO OBTUSE ALSO
Eregion_EDGE_1 = Eregion_EDGE TOUCH EDGE Eregion_
ERROR = INT Eregion_EDGE_1 <0.002 ABUT REGION
ERROR OUTSIDE SRAM
}
#ENDIF
SRNW_13{
@ N+AA enclosure by NW is 0.027
 X = ENC NTAP NW < 0.027 ABUT<90 SINGULAR REGION
 X NOT OUTSIDE INST
}

SRNW_14 {
@ Space between NW and N+AA inside PW is 0.04
@ Minimum space between NW outter vertex and N+AA inside PW outter vertex is 0.037
  (EXT NACT NW < 0.04 ABUT<90 OPPOSITE REGION) NOT OUTSIDE INST 
 ( EXT NACT NW < 0.037 ABUT<90 CORNER TO CORNER REGION) NOT OUTSIDE INST
}

SRNW_15 {
@ P+AA enclosure by NW is 0.037
 X= ENC PACT NW < 0.037 ABUT<90 SINGULAR REGION INSIDE ALSO
 X NOT OUTSIDE INST
}

NW_13 {
@ N+AA Minimum enclosure by NW is 0.08, excluding LDMOS area.Waive ((AA interact RESNW) and SN)
  ENC ((NACT  OUTSIDE (INST OR LDBK)) NOT ((AA INTERACT RESNW) AND SN)) NW < 0.08 ABUT<90 SINGULAR REGION
}
NW_14 {
@ Minimum Space between NW and N+AA inside PW is 0.08
  EXT (NACT  OUTSIDE (INST OR PSUB)) (NW OUTSIDE INST) < 0.08 ABUT<90 SINGULAR REGION
}
NW_15 {
@ P+AA minimum enclosure by NW is 0.08, excluding LDMOS area.
  ENC (PACT  OUTSIDE (INST OR LDBK)) NW < 0.08 ABUT<90 SINGULAR REGION
}
NW_16 {
@ Minimum Space between NW and P+AA inside PW is 0.08, excluding LDMOS area.
  EXT (PTAP NOT (LDBK OR PSUB)) NW < 0.08 ABUT<90 SINGULAR REGION
}
//================================
//  RESNWST  DRC
//================================

GROUP GRESNWS RESNWST_?

NWRSTI =(NW AND RESNW) NOT AA

RESNWST_1_2 {
@ NW-Resistor width is >=1.2 
@ NW-Resistor minimum length is >=10
INT (NWRSTI TOUCH EDGE AA) <10 ABUT<90 OPPOSITE REGION 
NOT ENCLOSE RECTANGLE NWRSTI 1.2 10
}
RESNWST_3{
@ NW-Resistor and NW space S1 >=1
EXT NWRSTI NW <1 ABUT<90 SINGULAR REGION
}
RESNWST_4{
@ The nearest CT space to (AA edge touch RESNW)	S2=0.3
X0 = RESNW INTERACT NWRSTI
X01 = (RESNW COIN EDGE NWRSTI) TOUCH EDGE AA
X1 = EXT X01 CT  <= 0.36 ABUT<90 REGION OPPOSITE 
X2 = EXT X01 CT == 0.3 ABUT<90 REGION OPPOSITE
(X1 NOT (X2 NOT (X2 ENCLOSE CT))) OR (CT INTERACT X0)
}

RESNWST_5 {
@ Minimum space between NWSTI resistor and adjacent AA is 0.44um.
  EXT NWRSTI (AA NOT INTERACT NWRSTI) < 0.44 ABUT<90 SINGULAR REGION
}
RESNWST_6 {
@ Space between RESNW to silicided AA area.	S4	=	0.00
@ DRC check by (RESNW AND NW) touch AA edge with count 2.
   (RESNW AND NW) TOUCH AA < 2  
} 
RESNWST_7{
@ SN enclosure of AA	EN1		0.4
ENC (AA TOUCH NWRSTI) SN <0.4  ABUT<90 REGION
}
RESNWST_8{
@ AA enclosure of NW(the NW interacted with RESNW)	EN2	>=	0.3
ENC (NW INTERACT RESNW) AA <0.3 ABUT<90 REGION
}
RESNWST_9{
@ CT should be in (NW AND ( pick up AA))	R1	
((AA TOUCH NWRSTI) NOT NTAP) AND CT 

}	
RESNWST_10{
@ NW resistor under STI must not overlap with AADUM	R2
NWRSTI AND AADUM 
}		
RESNWST_11{
@ (RESNW AND NW) must be an orthogonal rectangle shape to have good simulation accuracy	R3		
NOT RECTANGLE (RESNW AND NW) ORTHOGONAL ONLY
}

//================================
//  RESNW - N-Well Resistor DRC
//================================

GROUP GRESNWAA RESNWAA_?

RESNWAA= (NW AND RESNW) AND AA

RESNWAA_1{
@ RESNW must be an orthogonal rectangle
NOT RECTANGLE (RESNW INTERACT RESNWAA) ORTHOGONAL ONLY
}
RESNWAA_2_3{
@ NW-Resistor minimum length (SMIC 2R)>=10
@ NW-Resistor width (SMIC 2R, 65nm rule 1.6um)>=1.2
INT (RESNWAA TOUCH EDGE SN) <10 ABUT<90 OPPOSITE REGION
NOT ENCLOSE RECTANGLE RESNWAA 1.2 10 
}
RESNWAA_4{
@ AA enclosure of RESNWAA (SMIC 2R no rule, 65nm rule number)>=0.3
ENC RESNWAA AA < 0.3 ABUT<90 REGION
}
RESNWAA_5{
@ NW enclosure of CT (65nm rule, included in SMIC 2R)>=0.20
ENC CT (NW ENCLOSE RESNWAA)  <0.2 ABUT<90 REGION   
}
RESNWAA_6 {
@ Enclosure of SAB beyond related NW (65nm rule)>=0.20
 X1 = HOLES SAB
 X2 = SAB TOUCH X1
 ENC (NW INTERACT RESNWAA)  X1 < 0.2 ABUT<90 SINGULAR REGION
 ENC (NW INTERACT RESNWAA)  X2 < 0.2 ABUT<90 SINGULAR REGION
 (((NW INTERACT RESNWAA) INTERACT X1) NOT X1) NOT SAB
}
RESNWAA_7{
@ RESNW must not overlap with other implant layers (except NW) in the NW-Resistor area.
  RESNWAA AND SN
  RESNWAA AND SP
  RESNWAA AND ESD1
}
RESNWAA_8{
@ Space between RESNW and CT inside (AA interact RESNW) =0.70
X0 = RESNW INTERACT RESNWAA
X01 = (RESNW INTERACT RESNWAA) COIN EDGE SN
X = CT INSIDE (AA INTERACT RESNW)
X1 = EXT X01 X <= 0.76 ABUT<90 REGION OPPOSITE 
X2 = EXT X01 X == 0.7 ABUT<90 REGION OPPOSITE
(X1 NOT (X2 NOT (X2 ENCLOSE CT))) OR (CT INTERACT X0)
}
RESNWAA_9{
@ Extension of RESNW outside of NW (65nm 0.2um, SMIC 2R RESNW within NW) >= 0.00
 X =RESNWAA TOUCH (RESNW NOT RESNWAA) >1
 Y = RESNW COIN EDGE NW
 Z =EXPAND EDGE Y INSIDE BY 0.001 
RESNW NOT INTERACT (X OR (RESNW INTERACT Z))
}
RESNWAA.10{ 
@ SAB must include NW resistor except CT area
  X = RESNW ENCLOSE (RESNW AND AA)
  Y = (SAB OR (HOLES SAB)) INTERACT X
  Y NOT ENCLOSE RESNWAA
}		
RESNWAA_11{
@ Space between RESNW to SN (SMIC 2R no rule, 65nm no rule)=0.00
(RESNW INTERACT RESNWAA) NOT TOUCH SN
}
RESNWAA_12{
@ SAB enclosure of AA (SMIC 2R no rule, 65nm rule 0.2um, 0.18um is SMIC SAB main rule)>=0.18
ENC (AA INTERACT RESNWAA) SAB < 0.18 ABUT<90 REGION
}
RESNWAA_13{
@ SAB overlap of SN =0.4. Use exact value on sides touch RESNW.(65nm rule 0.2, 40nm WAT TK 0.4um)
X = SN COIN EDGE RESNW 
Y = EXPAND EDGE X INSIDE BY 0.4     
Y NOT TOUCH (HOLES SAB) 
}
  

//===================================
//   PW - P-Well Implant Layer DRC
//===================================
/*
GROUP GSRPW SRPW_?

SRPW_1 {
@ PW minimum width is 0.268
  INT PWi < 0.268 ABUT<90 SINGULAR REGION
}
*/


//==========================================
//  PSUB - Native NMOS blocked implant DRC
//==========================================

GROUP GPSUB PSUB_?

PSUB_1 {
@ PSUB width is 0.33
  INT PSUB < 0.33 ABUT<90 REGION
}
PSUB_2 {
@ Minimum width of an AA to define the width of native NMOS for 0.9/1.1/1.2/1.8/2.5v transistors is 0.4
  INT ((PBAA IN EDGE GT) COIN EDGE GATE)< 0.40 ABUT<90 REGION
}
PSUB_3a {
@ 0.9/1.1/1.2V minimum gate length enclosed by PSUB is 0.30
  X = (PBGT INSIDE EDGE PBAA) COIN EDGE GATE
  INT X < 0.30 ABUT<90 REGION
}
PSUB_3b {
@ 1.8V minimum gate length enclosed  by PSUB(enclosed by DG) is 0.80
  X = (PBGT INSIDE EDGE (PBAA INTERACT DG)) COIN EDGE GATE
  INT X < 0.80 ABUT<90 REGION
}
PSUB_3cde {
@ 2.5V minimum gate length enclosed by PSUB(enclosed by TG) is 1.20
@ 2.5V overdrive 3.3V gate length enclosed by PSUB (enclosed by TG)is 1.20
@ 2.5V underdrive 1.8V gate length enclosure by PSUB( enclosed by TG)is 1.20	
  X =( PBGT INSIDE EDGE (PBAA INTERACT TG)) COIN EDGE GATE
  INT X < 1.20 ABUT<90 REGION
}
PSUB_4 {
@ Space between two PSUB regions is 0.33
  EXT PSUB < 0.33 ABUT<90 REGION
}
PSUB_5 {
@ AA enclosure by PSUB is min 0.20, max 0.26, inductor does not need to follow.
@ Note7:it is recommended that PSUB should be conformal to AA edge
  //X1 = SIZE (PBAA NOT INTERACT CAPBP) BY 0.20  //not PSUB CAP
  //X2 = SIZE (PBAA NOT INTERACT CAPBP) BY 0.26
  X1 = SIZE PBAA BY 0.20
  X2 = SIZE PBAA BY 0.26
  X3 = X2 NOT X1
  Y = (PSUB INTERACT PBAA) NOT INDMY
  OUTSIDE EDGE Y X3
}
PSUB_6 {
@ Space between PSUB and AA is 0.08, inductor does not need to follow.
  (EXT PSUB AA < 0.08 ABUT<90 SINGULAR REGION) NOT INDMY
}
PSUB_7 {
@ Space between PSUB and NW is 0.63, inductor does not need to follow.
  (EXT PSUB NW < 0.63 ABUT<90 SINGULAR REGION) NOT INDMY
}
/*
PSUB_8 {
@ Extension of native NMOS poly gate outside of AA(poly endcap) is 0.20
  X = PBAA INSIDE EDGE PBGT
  ENC X PBGT < 0.20 ABUT<90 REGION
}
*/
PSUB_9 {
@ Minimum space between a PSUB outside INDMY and an unrelated Gate region is 0.37
  EXT (PSUB NOT INSIDE INDMY) GATE < 0.37 ABUT<90 SINGULAR REGION
}
PSUB_10 {
@ PSUB inside or cross over a NW area is not allowed  
  PSUB AND NW
}
PSUB_11 {
@ PSUB inside or cross over a Deep N-Well is not allowed
  PSUB AND DNW
}
PSUB_12 {
@ Only one AA region is allowed to put in PSUB region outside INDMY
  X= (PSUB NOT INTERACT INDMY) INTERACT AA
  X NOT INTERACT (AA NOT INTERACT CAPBP) == 1
}
/*PSUB_Note4 {
@ SP, P+ implant area, is not allowed to exist in a PSUB region
 (PSUB NOT INDMY) AND SP
}*/
PSUB_13 {
@ Bent Poly is not allowed to exist on AA in a PSUB region
  X = GT INSIDE EDGE PBAA
  INT X < 0.01 ABUT < 180 REGION
  EXT X < 0.01 ABUT < 180 REGION
}



/*
//=====================================
//  SDOP - SRAM PG Implant Layer DRC
//=====================================

GROUP GSDOP SDOP_?

SDOP_1 {
@ SDOP width is 0.18
  INT SDOP < 0.18 ABUT<90 SINGULAR REGION
}
SDOP_2 {
@ Space between two SDOP is 0.18. Merge if the space is less than this rule
  EXT SDOP < 0.18 ABUT<90 SINGULAR REGION
}
SDOP_3 {
@ Space between SDOP and N+/AA in PW or P+ AA in NW is 0.09
  EXT SDOP NTAP < 0.09 ABUT<90 SINGULAR REGION
  EXT SDOP PTAP < 0.09 ABUT<90 SINGULAR REGION
}
SDOP_4 {
@ SDOP extension outside of poly gate for NMOS along source drain direction is 0.18
  ENC NGTEIAA SDOP < 0.18 ABUT<90 REGION
}
SDOP_5 {
@ Space between SDOP and P-channel poly gate is 0.2
  EXT SDOP PGATE < 0.20 ABUT<90 SINGULAR REGION
}
SDOP_6 {
@ Space between SDOP SAB poly and AA resistor is 0.2
  EXT SDOP (GTR INTERACT SAB) < 0.2 ABUT<90 SINGULAR REGION
  EXT SDOP (AAR INTERACT SAB) < 0.2 ABUT<90 SINGULAR REGION
}
SDOP_7 {
@ N+AA enclosure by SDOP is 0.08 if the distance to the poly gate w >0.16um
  X = (NMOS AND SDOP) TOUCH EDGE NAAEIGT 
  ENC X SDOP < 0.08 ABUT<90 REGION
}
SDOP_8 {
@ N+AA enclosure by SDOP is 0.18 if the distance to the poly gate w<=0.16um
  X = EXPAND EDGE (GT IN EDGE (AA AND SDOP)) OUTSIDE BY 0.16 EXTEND BY 0.18 
  X NOT SDOP
}
SDOP_9 {
@ SDOP area is 0.1
  AREA SDOP < 0.10
}
SDOP_10 {
@ SDOP minimum enclosed area is 0.1
  SDOPHOLE = HOLES SDOP INNER
  AREA (SDOPHOLE NOT SDOP) < 0.10
}
SDOP_11 {
@ SDOP can not overlap with P+ pickup AA or butted P+AA
  SDOP AND PACT
}
SDOP_12 {
@ SDOP shapes must be orthogonal
  ANGLE SDOP >0<90
}
SDOP_13 {
@ (SDOP over AA) over (TG, DG, LVN, VTNH) is prohibited
  SDAA = AA AND SDOP
  SDAA AND TG
  SDAA AND DG
  SDAA AND LVN
  SDAA AND VTNH
}
*/
//================================
//  SRDOP - SRAM Pass Gate DRC
//================================

GROUP GSRDOP SRDOP_?

SRDOP_101 {
@ Gate touching SDOP must be covered by SDOP
  (GATE NOT OUTSIDE SDOP) NOT SDOP
}
SRDOP_102 {
@ SDOP min. width is 0.18
  INT SDOP < 0.18 ABUT<90 SINGULAR REGION
}
SRDOP_103 {
@ SDOP min. area is 0.1
  AREA SDOP < 0.1
}
SRDOP_104 {
@ SDOP is must be in INST
  SDOP NOT INST
}
SRDOP_105{
@ SDOP must enclose gate is 0.056
ENC GATE SDOP < 0.056 ABUT<90 SINGULAR REGION

}



//==================================================
//   TG - Triple Gate DRC (Define 2.5V IO region)
//==================================================

GROUP GTG TG_?

TG_1 {
@ TG minimum width is 0.33
  INT TG < 0.33 ABUT<90 REGION
}
TG_2 {
@ Minimum space between two TGs is 0.33
  EXT TG < 0.33 ABUT<90 REGION
}
TG_3 {
@ AA with transistor minimum enclosure by TG is 0.19(include AA area not under poly)
  ENC MOS TG < 0.19 ABUT<90 SINGULAR REGION 
}
TG_4 {
@Gate enclosure by TG is 0.19
  ENC GATE TG < 0.19 ABUT<90 SINGULAR REGION
}
TG_5 {
@ Minimum space between TG and AA with device is 0.19
@ Prohibit overlap of TG and other voltage AA with transistor
  X_MOS = AA INTERACT (GT INTERACT GATE)
  X_RES = AA INTERACT (DIFRES OR RESAA)
  X_DIO1 = AA INTERACT (SIZE (DSTR NOT INTERACT PSUB) BY 0.3)
  X_DIO2 = AA INTERACT (SIZE (DSTR INTERACT PSUB) BY 0.4)
  X_NPN_PNP = AA INTERACT DMPNP
  X_ALL = (((X_MOS OR X_RES) OR (X_DIO1 OR X_DIO2)) OR X_NPN_PNP) NOT INST
  X =(AA AND ((SN AND NW) OR (SP NOT NW)))  NOT VARMOS
  EXT TG (X_ALL NOT X) < 0.19 ABUT<90 SINGULAR REGION
  (X_MOS CUT TG) AND TG
}
TG_6 {
@ Space between TG and gate is 0.19 (Don't be necessary for pick-up to follow these rules)
  EXT TG GATE < 0.19 ABUT<90 SINGULAR REGION
}
TG_7 {
@ Minimum area is 0.463
  AREA TG < 0.463
}
TG_8 {
@ Minimum enclosed area is 0.463
  TGHOLE = HOLES TG INNER
  AREA (TGHOLE NOT TG) < 0.463
}
/*
TG_9 {
@ AA (enclosure by TG) minimum width for 2.5V transistor is 0.32
  INT MOS25 < 0.32 ABUT<90 SINGULAR REGION
}
TG_10 {
@ TG shapes must be orthogonal
  ANGLE TG >0<90
}
*/
TG_11 {
@ Extension of AA in TG outside of gate is 0.15. Exclude gate within LDMOS region(within LDBK) and within inductor area(layer INDMY)
  //ENC MOS25 GT < 0.17 ABUT<90 SINGULAR REGION
  ENC (GATE NOT (LDBK OR INDMY))  (AA AND TG)  < 0.15 ABUT>0<90 SINGULAR REGION
}
TG_12 {
@ Space between TG and DG is 0.33
  EXT TG DG < 0.33 ABUT<90 SINGULAR REGION
}
TG_13 {
@ TG minimum overlap past NW with abutting permitted is 0.33
  ENC NW (TG NOT COIN EDGE NW) < 0.33 ABUT<90 REGION
}
TG_14 {
@ TG minimum overlap of NW with abutting permitted is 0.33
  INT NW (TG NOT COIN EDGE NW) < 0.33 ABUT<90 REGION
}
TG_15 {
@ NW minimum overlap past TG with abutting permitted is 0.33
  ENC (TG NOT COIN EDGE NW) NW < 0.33 ABUT<90 REGION
}

   

//================================================
//   DG - Dual Gate DRC (Define 1.8V IO region)
//================================================

GROUP GDG DG_?

DG_1 {
@ DG minimum width is 0.33
  INT DG < 0.33 ABUT<90 REGION
}
DG_2 {
@ Minmum space between two DGs is 0.33, merge if the space is less than rule
  EXT DG < 0.33 ABUT<90 REGION
}
DG_3 {
@ AA with transistor minimum enclosure by DG is 0.19 (include AA area not under poly)
  ENC MOS DG < 0.19 ABUT<90 SINGULAR REGION
}
DG_4 {
@ Gate minimum enclosure by DG is 0.19
  ENC GATE DG < 0.19 ABUT<90 SINGULAR REGION
}
DG_5 {
@ Minimum space between DG and AA with device is 0.19
@ Prohibit overlap of DG and other voltage AA with transistor
  X_MOS = AA INTERACT (GT INTERACT GATE)
  X_RES = AA INTERACT (DIFRES OR RESAA)
  X_DIO1 = AA INTERACT (SIZE (DSTR NOT INTERACT PSUB) BY 0.3)
  X_DIO2 = AA INTERACT (SIZE (DSTR INTERACT PSUB) BY 0.4) 
  X_NPN_PNP = AA INTERACT DMPNP
  X_ALL = (((X_MOS OR X_RES) OR (X_DIO1 OR X_DIO2)) OR X_NPN_PNP) NOT INST
  X =(AA AND ((SN AND NW) OR (SP NOT NW)))  NOT VARMOS
  EXT DG (X_ALL NOT X )< 0.19 ABUT<90 SINGULAR REGION
  (X_MOS CUT DG) AND DG
}
DG_6 {
@ Minimum space between DG and gate is 0.19
  EXT DG GATE < 0.19 ABUT<90 SINGULAR REGION
}
DG_7 {
@ Minimum area is 0.463
  AREA DG < 0.463
}
DG_8 {
@ Minimum enclosed area is 0.463
  DGHOLE = HOLES DG INNER
  AREA (DGHOLE NOT DG) < 0.463
}
/*
DG_9 {
@ AA (enclosure by DG) minimum width for 1.8V transistor is 0.32
  INT MOS18 < 0.32 ABUT<90 SINGULAR REGION
}
DG_10 {
@ DG shapes must be orthogonal
  ANGLE DG >0<90
}
*/
DG_11 {
@ AA (enclosed by DG) minimum overlap past poly is 0.15
  ENC GT MOS18 < 0.15 ABUT<90 SINGULAR REGION
}
DG_12 {
@ DG minimum overlap past NW with abutting permitted is 0.33
  ENC NW (DG NOT COIN EDGE NW) < 0.33 ABUT<90 REGION
}
DG_13 {
@ DG minimum overlap of NW with abutting permitted is 0.33
  INT NW (DG NOT COIN EDGE NW) < 0.33 ABUT<90 REGION
}
DG_14 {
@ NW minimum overlap past DG with abutting permitted is 0.33
  ENC (DG NOT COIN EDGE NW) NW < 0.33 ABUT<90 REGION
}


#IFDEF CHK_CORN YES
//==============================================
//    BORDER AND CORN - BORDER AND CORN Rule DRC
//==============================================

CORN_1 {
@ Chamfer area size at the chip corner is 74. The chip edge is defined to be the maximum boundary of all chip layers.
@ All layers include BORDER(127;0) should not interact with area A in the figure.This rule is applicable for chips gds
@ Note 1. The DRC executes this section rule check on following layers: AA, GT, CT, SP, SAB, CT, Vn n=1-7, Mn n=1-8, MnDUM n=1-8, TV1, TV2, TM1, TM2, BORDER.
@ Note 2. This rule section only applies for those chips that need to have chip level. The chip corner rule check option is default turned on in DRC script.
@ Note.3. In case for the building block level design, or the IP gds, please turn off the chip corner rule check option.
  CORN AND AAi
  CORN AND GTi
  CORN AND CTi
  CORN AND SPi
  CORN AND SABi
  CORN AND V1i
  CORN AND V2i
  CORN AND V3i
  CORN AND V4i
  CORN AND V5i
  CORN AND V6i
  CORN AND V7i
  CORN AND M1i
  CORN AND M2i
  CORN AND M3i
  CORN AND M4i
  CORN AND M5i
  CORN AND M6i
  CORN AND M7i
  CORN AND M8i
  CORN AND M1DUM
  CORN AND M2DUM
  CORN AND M3DUM
  CORN AND M4DUM
  CORN AND M5DUM
  CORN AND M6DUM
  CORN AND M7DUM
  CORN AND M8DUM
  CORN AND TV2i
  CORN AND TM2i
  CORN AND MTT2i
  CORN AND BORDER
}
CORN_2 {
@ For the chips needs SMIC mask shop insert dummy and seal ring, the corner area A(see this section figure) should be covered with (DUMBA, DUMBP, DUMBM).
 CORN NOT (( DUMBA OR DUMBP) OR DUMBM)
}
#ENDIF

/*Note for BORDER rules : 
This section is only used for the design which customer do not put the seal ring. 
If customer draw seal ring following design rule, chip edge BORDER layer can be skipped.
Chip edge BORDER layer and layout pattern rule is defined to avoid any layout pattern extend out to scribe lane region
Customer must draw border layer if they do not put the seal ring in the design.
*/

#IFDEF CHK_BORDER YES
BORDER_1 {
@ Designer need to add BORDER (CHIPEDGE) to define chip boundary and have all chip layout patterns inside BORDER
  (DRC:1 NOT BD_WITHHOLE) NOT CORN
}
//============
//BORDER_ER.2
//============

BORDER_2_AA {
@ AA enclosure by BORDER min. is 0.36
  ENC AAi BD_WITHHOLE < 0.36 ABUT<90 SINGULAR REGION
}
BORDER_2_GT {
@ GT enclosure by BORDER min. is 0.36
  ENC GTi BD_WITHHOLE < 0.36 ABUT<90 SINGULAR REGION
}
BORDER_2_CT {
@ CT enclosure by BORDER min. is 0.36
  ENC CTi BD_WITHHOLE < 0.36 ABUT<90 SINGULAR REGION
}
BORDER_2_M1 {
@ M1 enclosure by BORDER min. is 0.36
  ENC M1i BD_WITHHOLE < 0.36 ABUT<90 SINGULAR REGION
}
BORDER_2_M2 {
@ M2 enclosure by BORDER min. is 0.36
  ENC M2i BD_WITHHOLE < 0.36 ABUT<90 SINGULAR REGION
}
BORDER_2_M3 {
@ M3 enclosure by BORDER min. is 0.36
  ENC M3i BD_WITHHOLE < 0.36 ABUT<90 SINGULAR REGION
}
BORDER_2_M4 {
@ M4 enclosure by BORDER min. is 0.36
  ENC M4i BD_WITHHOLE < 0.36 ABUT<90 SINGULAR REGION
}
BORDER_2_M5 {
@ M5 enclosure by BORDER min. is 0.36
  ENC M5i BD_WITHHOLE < 0.36 ABUT<90 SINGULAR REGION
}
BORDER_2_M6 {
@ M6 enclosure by BORDER min. is 0.36
  ENC M6i BD_WITHHOLE < 0.36 ABUT<90 SINGULAR REGION
}
BORDER_2_M7 {
@ M7 enclosure by BORDER min. is 0.36
  ENC M7i BD_WITHHOLE < 0.36 ABUT<90 SINGULAR REGION
}
BORDER_2_M8 {
@ M8 enclosure by BORDER min. is 0.36
  ENC M8i BD_WITHHOLE < 0.36 ABUT<90 SINGULAR REGION
}
BORDER_2_V1 {
@ V1 enclosure by BORDER min. is 0.36
  ENC V1i BD_WITHHOLE < 0.36 ABUT<90 SINGULAR REGION
}
BORDER_2_V2 {
@ V2 enclosure by BORDER min. is 0.36
  ENC V2i BD_WITHHOLE < 0.36 ABUT<90 SINGULAR REGION
}
BORDER_2_V3 {
@ V3 enclosure by BORDER min. is 0.36
  ENC V3i BD_WITHHOLE < 0.36 ABUT<90 SINGULAR REGION
}
BORDER_2_V4 {
@ V4 enclosure by BORDER min. is 0.36
  ENC V4i BD_WITHHOLE < 0.36 ABUT<90 SINGULAR REGION
}
BORDER_2_V5 {
@ V5 enclosure by BORDER min. is 0.36
  ENC V5i BD_WITHHOLE < 0.36 ABUT<90 SINGULAR REGION
}
BORDER_2_V6 {
@ V6 enclosure by BORDER min. is 0.36
  ENC V6i BD_WITHHOLE < 0.36 ABUT<90 SINGULAR REGION
}
BORDER_2_V7 {
@ V7 enclosure by BORDER min. is 0.36
  ENC V7i BD_WITHHOLE < 0.36 ABUT<90 SINGULAR REGION
}

BORDER_3 {
@ DNW minimum enclosure by chip edge(BORDER layer) is 0.8
 ENC DNW BD_WITHHOLE < 0.8 ABUT<90 SINGULAR REGION
}

#IFDEF CHK_CORN YES
BORDER_4{
@ All designs should place a BORDER at the most outermost edge with straight lines from chip corner area to corner area.
BD_WITHHOLE NOT ( RECTANGLE (BD_WITHHOLE OR CORN))
} 
#ENDIF
#IFDEF CHK_CORN  NO
BORDER_4{
@ All designs should place a BORDER at the most outermost edge with straight lines from chip corner area to corner area.
BD_WITHHOLE NOT ( RECTANGLE BD_WITHHOLE )
} 
#ENDIF 
#ENDIF


//==========================
//    GT - Poly Rule DRC
//==========================

GROUP GGT GT_?

GT_1a {
@ Gate minimum channel length for 0.9/1.1/1.2V N/P MOS transistors (std, high, or low VT) is 0.04  
@ SRGT_1, Gate minimum length is 0.04
  X = (GT IN EDGE (AA NOT (DG OR TG))) COIN EDGE GATE
  INT X < 0.04 ABUT<90 REGION OPPOSITE
}
GT_1b {
@ GATE minimum channel length for 1.8V N/P MOS transistors is 0.15
  X = GT COIN EDGE ((GATE AND DG)  NOT DGV)
  INT X < 0.15 ABUT<90 REGION OPPOSITE
}
GT_1c {
@ GATE minimum channel length for 2.5V N/P MOS transistors is 0.27
  X = GT COIN EDGE ((GATE AND TG) NOT TGV)
  INT X < 0.27 ABUT<90 REGION OPPOSITE
}
GT_1d {
@ Gate minimum channel length for 2.5V overdrive 3.3V NMOS transistors is 0.55
  X = GT COIN EDGE ((NGATE AND TG) AND OVERDR)
  INT X < 0.55 ABUT<90 REGION OPPOSITE
}
GT_1e {
@ Gate minimum channel length for 2.5V overdrive 3.3V PMOS transistors is 0.44
  X = GT COIN EDGE ((PGATE AND TG) AND OVERDR)
  INT X < 0.44 ABUT<90 REGION OPPOSITE
}
GT_1fg {
@ Gate minimum channel length for 2.5V underdrive 1.8V NMOS transistors is 0.24
@ Gate minimum length for 2.5V underdrive 1.8V PMOS transistors is 0.24
  X = GT COIN EDGE ((GATE AND TG) AND TGV)
  INT X < 0.24 ABUT<90 REGION OPPOSITE
}
GT_1h{
@ Gate channel length for 1.8V underdrive 1.5V N/P MOS transistors	0.125
X = GT COIN EDGE ((GATE AND DG) AND DGV)
  INT X < 0.125 ABUT<90 REGION OPPOSITE
}

GT_2a {
@ Poly minimum width is 0.04
 INT GT < 0.04 ABUT<90 SINGULAR REGION
}
#IFDEF RECOMMENDED YES
GT_2b_R {
@ Non-floating poly outside of (extend AA W>= 2.5m) region minimum width is 0.06, This rule is not applicable for GT interacting with EFUSE(81;2).
  AAregion = SIZE AA BY 2.5
  GTout = (GT NOT FTGT) NOT AAregion
  err = (INT (GTout NOT COIN EDGE AAregion) < 0.06 ABUT<90 REGION) NOT EFUSE
 err NOT (GT WITH WIDTH >0.06)  
}
#ENDIF

GT_3 {
@ Space between two poly is 0.1
 EXT (GT OUTSIDE INST)< 0.10  SINGULAR REGION
}
GT_3c{
@ GT to GT space if one GTs width > 0.12um is >=0.14, parallel run length of the two GT > 0.14um
X =GT WITH WIDTH > 0.12  
Y = EXT X GT<0.14   REGION OPPOSITE
Y1 = EXT X [GT]<0.14  OPPOSITE  
Z = LENGTH Y1 >0.14  
Y WITH EDGE Z
}

SRGT_3 {
@ Space between two poly on field is 0.07
  X =EXT (GT NOT INDMY)< 0.07 ABUT<90 SINGULAR REGION
  X NOT OUTSIDE INST
}
GT_4 { 
@ Space between AA and poly on field oxide is 0.03
  X =EXT AA  GT < 0.03 ABUT==0 SINGULAR REGION
  X OUTSIDE INST
}
/*SRGT_4 {
@ Space between AA and non-floating poly on field oxide is 0.01
 X = EXT AA (GT NOT (FTGT OR INDMY)) < 0.01 ABUT<90 SINGULAR REGION
 X NOT OUTSIDE INST 

}*/
//skip SRGT.4

GT_5 {
@ Extension of AA outside of GATE is 0.06, excluding LDMOS and within inductor area(layer INDMY)
  ENC (GATE NOT (LDBK OR INDMY)) ( AA OUTSIDE INST)  < 0.06 ABUT>0<90 SINGULAR REGION
}
SRGT_5 {
@ Extension of AA outside of GATE is 0.045
 X =ENC (GATE NOT INDMY) AA < 0.045 ABUT>0<90 SINGULAR REGION
  X NOT OUTSIDE INST
}
GT_head = CONVEX EDGE GT ANGLE1 >89.9<90.1 ANGLE2>89.9<90.1 WITH LENGTH>0.001
GT_6 {
@ Extension of poly outside of AA to form poly end-cap is 0.09. Waive within LDBK area
 err= ENC (AA  COIN EDGE GATE) GT_head< 0.09 ABUT<90 REGION OPPOSITE
 err1=err NOT WITH EDGE ((err NOT COIN EDGE GT) NOT COIN EDGE GATE)
 ((err1 INSIDE GT ) NOT (LDBK OR INDMY)) OUTSIDE INST 
}
#IFDEF RECOMMENDED YES

GT_6a_R{
@ Extension E of GT outside of AA to form poly end-cap is 0.11.  The GT to L shape AA(in the same MOS) space S < 0.1um.  The L shape AA height h > 0.02um.
AA_L1  =CONVEX EDGE AA ANGLE1 == 270 ANGLE2 ==90 WITH LENGTH >0.02
AA_L =  AA_L1 NOT COIN EDGE (AA TOUCH EDGE GATE)
S1 = CONVEX EDGE (AA OR GT) ANGLE1 == 270 ANGLE2 == 270 WITH LENGTH <0.1
S = S1 COIN EDGE AA
SL_CORNER=EXT S AA_L< 0.002  ABUT==90 INTERSECTING ONLY REGION
S_region =( EXPAND EDGE  S INSIDE BY 0.001 EXTEND BY 0.001 ) INTERACT SL_CORNER
err =ENC (GATE TOUCH EDGE S_region)  GT_head   < 0.11 ABUT<90 REGION OPPOSITE
err1=err NOT WITH EDGE ((err NOT COIN EDGE GT) NOT COIN EDGE GATE)
(err1 INSIDE GT) OUTSIDE SRAM  
}
#ENDIF


SRGT_6 {
@ Extension of non-floating poly outside of AA to form poly end-cap is 0.055
@ area interacted with rectangle contact need not follow this rule
 X = ENC (AA COIN EDGE GATE) (GT NOT (FTGT OR INDMY))  < 0.055 ABUT<90 REGION
  (X NOT INTERACT RECT) NOT OUTSIDE INST
}
GT_7 {
@ (poly_end with length < 0.120) minimum space to (poly_end with length < 0.120)
@ (head to head space)  with run length > 0 must be is 0.1.
  X = EXT GT_end_head < 0.1 ABUT<90 REGION OPPOSITE
  X OUTSIDE INST
}
SRGT_7 {
@ (poly_end with length < 0.120) minimum space to (poly_end with length < 0.120),excluding floating poly
@ (head to head space) must be > 0.07
  X = EXT GT_end_head < 0.07 ABUT<90 REGION OPPOSITE
  (X NOT OUTSIDE INST) NOT INTERACT FTGT
}
GT_8 {
@ (poly_end with length < 0.120) minimum space to poly (head to side) must be > 0.1 ,This rule is not applicable for SRAM region check.
  X = EXT GT_end_head GT_nonend < 0.1 ABUT<90 REGION
 X  OUTSIDE INST 
}
GT_8a{
@ Space between GT line end to line (Dh) or GT line to line (Ds) when the layout structures meet the conditions of below: (Waive the GT small extrusion F<0.04m)
@ 1. GT line end definition: GT width W<0.065m
@ 2. Runlength of GT line to line or GT line to end: E1>=-0.03m
@ 3. Any one edge distance from the corner of the two edges: K1 <0.065m
@ Any one of Dh or Ds meet this rule value is ok.
@ This rule is not applicable for SRAM region check.		0.11
LINE_END = CONVEX EDGE GT ANGLE1 ==90 LENGTH1 >=0.04 ANGLE2  ==90 LENGTH2  >=0.04 WITH LENGTH  < 0.065
LINE_END_SHAPE = EXPAND EDGE LINE_END INSIDE BY 0.034
LINE_SIDE = (GT COIN EDGE LINE_END_SHAPE ) NOT COIN EDGE LINE_END
LINE_END_EXP = EXPAND EDGE LINE_END INSIDE BY 0.001 EXTEND BY 0.031
LINE_SIDE_EXP = EXPAND EDGE LINE_SIDE INSIDE BY 0.001 EXTEND BY 0.031
LINE_END_1 = LINE_END_EXP TOUCH EDGE LINE_END
LINE_SIDE_1 = LINE_SIDE_EXP TOUCH EDGE LINE_SIDE
E1 = EXT [LINE_END_1] GT < 0.11 OPPOSITE PERP ALSO OBTUSE ALSO
E2 = EXT [LINE_SIDE_1] GT < 0.11  OPPOSITE PERP ALSO OBTUSE ALSO
LINE_END_E1 = LINE_END_1 TOUCH EDGE E1
LINE_SIDE_E2 = LINE_SIDE_1 TOUCH EDGE E2
GT_CORNER = INT LINE_END_E1 LINE_SIDE_E2 <= 0.002 ABUT==90 REGION
(LINE_END_SHAPE INTERACT GT_CORNER) OUTSIDE INST
}
/*SRGT_8 {
@ (poly_end with length < 0.120) minimum space to poly (head to side) must be > 0.072,excluding floating poly
   X = GT AND AA 
  GT_nonend = GT NOT COIN EDGE GT_end_head1
   GT_end = ENC AA GT < 0.12 OPPOSITE REGION
   GT_end_head = GT_end COIN EDGE ((GT INTERACT X) NOT TOUCH EDGE X)
   GT_end_head1 = (GT INTERACT X) NOT TOUCH EDGE X
  Y = EXT GT_end_head GT_nonend < 0.072 ABUT<90 REGION
 (Y NOT OUTSIDE INST) NOT INTERACT FTGT
 }*/
GT_9 {
@ For GT channel length < 0.06, range of gate space to (GT or GTDUM) 0.12~0.33
@ The (GT or GTDUM) parallel to gate for GT.9 covers channel width >= 67% .
 X0= (GATE OUTSIDE INST) INSIDE EDGE ACT
 X = INT X0 < 0.06 ABUT<90 OPPOSITE REGION
 Y = EXT X (GT OR GTDUM) < 0.12 ABUT<90 OPPOSITE REGION
 Z1 = EXPAND EDGE X0 OUTSIDE BY 0.331
 Z2 = Z1 NOT GATE
 Z4 = EXT X (GT OR GTDUM) <= 0.33 ABUT<90 OPPOSITE REGION 
 Z5 = ((Z2 NOT INTERACT Z4)  INTERACT X ) OR Y

 B0 = GATE INSIDE EDGE ACT
  B1 = INT [B0] < 0.06 ABUT<90 OPPOSITE 
  B2 = EXT B1 (GT OR GTDUM) >= 0.12 <= 0.33 ABUT<90 OPPOSITE EXCLUDE SHIELDED 4
  B3 = DFM PROPERTY B1 B2 OVERLAP ABUT ALSO MULTI SPLIT
  [prop1 = EC(B2)/LENGTH(B1)] < 0.67
 B4= EXPAND EDGE B3 OUTSIDE BY 0.1 
 ((Z5 OR B4) OUTSIDE INST) OUTSIDE OTPMK1
}


GT_10 {
@ For GT channel length >= 0.06, minimum gate space to (GT or GTDUM) is 0.13
@ PFET gate minimum space over AA is 0.13
  X = LENGTH (ACT INSIDE EDGE (GT  OUTSIDE INST))>=0.06
  Y = GATE WITH EDGE X  
   EXT Y (GT OR GTDUM ) < 0.13 ABUT<90 OPPOSITE  REGION
}
SRGT_10 {
@ For GT channel length >= 0.06, minimum gate space to (GT or GTDUM) is 0.12
X = LENGTH (ACT INSIDE EDGE (GT NOT OUTSIDE INST))>=0.06
  Y = GATE WITH EDGE X  
  EXT Y (GT OR GTDUM ) < 0.12 ABUT<90 OPPOSITE  REGION
}
/*
GT_13 {
@ poly minimum overlap past AA is 0.09,when poly to AA inner vertex distance < 0.060
  gtextaa = ENC (AA NOT INSIDE INST) (GT NOT INSIDE INST) < 0.090 OPPOSITE REGION
  gatespcaa = EXT (GATE NOT INSIDE INST) (AA NOT INSIDE INST) < 0.06 ABUT==90 PERP ONLY REGION
  gtextaa WITH EDGE (gtextaa TOUCH EDGE gatespcaa)
}
SRGT_13 {
@ poly minimum overlap past AA is 0.05,when poly to AA inner vertex distance < 0.060
  gtextaa = ENC (AA AND INST) (GT AND INST) < 0.050 OPPOSITE REGION
  gatespcaa = EXT (GATE AND INST) (AA AND INST) < 0.06 ABUT==90 PERP ONLY REGION
  gtextaa WITH EDGE (gtextaa TOUCH EDGE gatespcaa)
}

GT_16 {
@ Poly maximum density(%) with 25um tiling withing whole GDS aread is 70(Max. density value)
  DENSITY (GTi OR GTDUM) > 0.70 WINDOW 25 STEP 12.5 BACKUP PRINT density_report_GT16.log
}*/
GT_17 {
@ minimum area is 0.012
@ SRGT_17, minimum area is 0.012
  AREA GT < 0.012
}
GT_18 {
@ poly minimum enclosed area is 0.040
  AREA ((HOLES GT INNER) NOT GT) < 0.040
}
GT_19 {
@ (GT AND AA) area GTAA.  GTAA enclose 200x200um area.  Maximum area for GTAA (um2) 50000
  X = ENCLOSE RECTANGLE GATE 200 200
  AREA X > 50000
}
GT_20l {
@ Poly min. density in whole chip is 15% 
  X = DENSITY (GTi OR GTDUM) <0.15 PRINT density_report_GT20l.log
  X NOT MARKG
}
GT_20h {
@ Poly max. density in whole chip is 40%
  X = DENSITY (GTi OR GTDUM) > 0.40 PRINT density_report_GT20h.log
  X NOT MARKG
}
GT_20bl {
@ Poly min. density overlap by DUMBP is 15%
  X = GTi OR GTDUM
  Y = COPY DUMBP
  Z = DENSITY X DUMBP [area(X)/area(DUMBP)] < 0.15 INSIDE OF LAYER Y PRINT density_report_GT20bl.log  RDB density_report_GT20bl.db
  Z NOT MARKG
}
GT_20bh {
@ Poly max. density overlap by DUMBP is 40%
  X = GTi OR GTDUM
  Y = COPY DUMBP
  Z = DENSITY X DUMBP [area(X)/area(DUMBP)] > 0.4 INSIDE OF LAYER Y PRINT density_report_GT20bh.log RDB density_report_GT20bh.db
  Z NOT MARKG
}
GT_ALL =GTi OR GTDUM
GT_20c {
@Poly density (including dummy) excluding (DG or TG)is 10%, check window 100x100m with step 50m.
@DRC check with the said window size and rule number and highlight as X.  Y = X not (DG or TG) , Z= (Y area)/(100*100)  
@If Z > 25%, highlight Y for GT density inside of Y smaller than rule value
 
 X =DENSITY (GTi OR GTDUM) < 0.1 WINDOW 100 STEP 50 BACKUP RDB density_report_GT20c1.db
 Y = X NOT (DG OR TG)
 Z= COPY Y
 M = DENSITY Y  [area(Y)/(100*100)]>0.25  INSIDE OF LAYER Z  RDB density_report_GT20c2.db
 N = COPY M
 W =DENSITY GT_ALL M [area(GT_ALL)/area(M)] < 0.1 INSIDE OF LAYER N BY POLYGON PRINT density_report_GT_20c.log RDB density_report_GT20c.db
 W NOT MARKG
}
GT_20d {
@Poly density (including dummy) in (DG or TG)is 5%, check window 100x100m with step 50m.
@DRC check with the said window size and rule number and highlight as X.  Y = X and (DG or TG) , Z= (Y area)/(100*100) 
@ If Z > 25%, highlight Y for GT density inside of Y smaller than rule value 
X =DENSITY (GTi OR GTDUM) < 0.05 WINDOW 100 STEP 50 BACKUP PRINT density_report_GT.20d.log RDB density_report_GT20d1.db
Y = X AND (DG OR TG) 
 Z= COPY Y
 M = DENSITY Y  [area(Y)/(100*100)]>0.25  INSIDE OF LAYER Z RDB density_report_GT20d2.db
 N = COPY M
  W =DENSITY GT_ALL M [area(GT_ALL)/area(M)] < 0.05 INSIDE OF LAYER N BY POLYGON PRINT density_report_GT_20d.log RDB density_report_GT20d.db
 W NOT MARKG
}


GT_21 {
@ No bent GATE (45 or 135 degree) on AA are allowed 
@ All gate patterns on AA have to be orthogonal to AA edge
@ and SRGT_21
 GTEIAA1 = GTEIAA COIN EDGE GATE
  (INT GTEIAA1 < 0.01 ABUT == 90 REGION) NOT OCOVL
  (EXT GTEIAA1 < 0.01 ABUT == 90 REGION) NOT OCOVL
  (INT GTEIAA1 < 0.01 ABUT == 45 REGION) NOT OCOVL
  (EXT GTEIAA1 < 0.01 ABUT == 45 REGION) NOT OCOVL
  (INT GTEIAA1 < 0.01 ABUT == 135 REGION) NOT OCOVL
  ( EXT GTEIAA1 < 0.01 ABUT == 135 REGION) NOT OCOVL
}
GT_22 {
@ GT must be enclosed by (SN or SP) except the MOM, GTFUSE and  (HRP AND GT). Exclude floating GT
 X = (((GT NOT FTGT) NOT INTERACT (HRP AND GT)) NOT INTERACT (MOMDMY OR GTFUSE)) NOT (SN OR SP)
 X NOT OCOVL
}
/* This rule is already covered by SP_SN_17.
GT_23 {
@ SN and SP overlap on gate over AA is not allowed
  (GATE AND SN) AND SP
}
*/
GTmergeAA = GT OR AA
U_edge = CONVEX EDGE GTmergeAA ANGLE1 == 270 ANGLE2 == 270
U_edge_ = EXPAND EDGE U_edge INSIDE BY 0.001
AAconer = EXT AA < 0.01 ABUT == 90 INTERSECTING ONLY REGION
GTconer = EXT GT < 0.01 ABUT == 90 INTERSECTING ONLY REGION
GT_24 {
@  L-shaped GT minimum space to AA is 0.04
   LGT_ = U_edge_ TOUCH GTconer == 1
   LGT = U_edge COIN EDGE LGT_
   LENGTH LGT < 0.04
}
GT_25 {
@ L-shape AA minimum space to poly(in same transistor) is 0.03
   LAA_ = U_edge_ TOUCH AAconer == 1
   LAA = U_edge COIN EDGE LAA_
   X = LENGTH LAA  <  0.03
   X COIN EDGE (AA TOUCH EDGE GATE)
}

#IFDEF SRAM_GT_DIRECTION V
GT_26 {
@ All memory cell transistor(transistors within INST layer),
@ gate GT direction should be unidirectional in one chip.
 X = (((GT INTERACT CT) NOT OUTSIDE INST) INSIDE EDGE AA) COIN EDGE GATE
 Y = ANGLE X != 90
 EXPAND EDGE Y INSIDE BY 0.01
}
#ENDIF
#IFDEF SRAM_GT_DIRECTION H
GT_26 {
@ All memory cell transistor(transistors within INST layer),
@ gate GT direction should be unidirectional in one chip.
 X = (((GT INTERACT CT) NOT OUTSIDE INST) INSIDE EDGE AA) COIN EDGE GATE
 Y = ANGLE X != 0
 EXPAND EDGE Y INSIDE BY 0.01
}
#ENDIF
GT_27 {
@ Bent 45 deg GT min width is 0.16
X = ANGLE GT ==45
INT X <0.16 ABUT<90 REGION 
}
GT_28 {
@ The space between two bent 45 degree GTs is 0.16
X = ANGLE GT ==45
EXT X <0.16  ABUT<90 REGION
}

/*
SRGT_102 {
@ Two poly segment with width < 0.045 must not share 1 vertex
  EXT ((GT AND INST) WITH WIDTH < 0.045) < 0.01 ABUT == 90 REGION
}

//Skip SRGT_101 : Poly in INST must be same orientation
SRGT_103 {
@ Non-flaoting Poly must devide AA into 2 or more regions
@ area interacted with share contact need not follow this rule
  GATE = (((GT NOT FTGT) AND AA) NOT OUTSIDE INST) NOT INTERACT RECT
  sized_gate = SIZE GATE BY 0.001
  GATE INTERACT (sized_gate AND (AA NOT GT))  < 2
}
*/



//==============================
//  RESP1 - Poly Resistor DRC
//==============================
  
GROUP GRESP1 RESP1_?

RESP1_2 {
@ POLY resistor minimum width is 0.4
  INT (GTR IN EDGE SAB) < 0.4 ABUT<90 REGION
}
/*
#IFDEF RECOMMENDED YES
RESP1_2R { 
@ POLY resistor minimum width is 0.39
  INT (GTR IN EDGE SAB) < 0.39 ABUT<90 REGION
}
#ENDIF
*/
RESP1_3 {
@ POLY resistor minimum length is 0.40
  INT (SAB COIN EDGE GTR) < 0.40 ABUT<90 REGION
}
/*
#IFDEF RECOMMENDED YES
RESP1_3R {
@ POLY resistor minimum length is 0.80
  INT (SAB IN EDGE GTR) < 0.80 ABUT<90 REGION
}
#ENDIF
*/
RESP1_4 {
@ POLY resistor must be orthogonal
  ANGLE GTR >0<90
}
RESP1_5 {
@ CT to SAB minimum space is 0.18
  EXT (CT AND (GT INTERACT GTR)) SAB < 0.18 ABUT<90 SINGULAR REGION
}
RESP1_6 {
@ Extension of RESP1 outside of POLY minimum distance is 0.15
  ENC (GT INTERACT GTR) RESP1 < 0.15 ABUT<90 SINGULAR REGION
}
RESP1_7 {
@ The separation minimum between resistors with un-related implant region is 0.16
  EXT GTR SN < 0.16 ABUT<90 SINGULAR REGION
  EXT GTR SP < 0.16 ABUT<90 SINGULAR REGION
  EXT GTR ESD1 < 0.16 ABUT<90 SINGULAR REGION
}
/*
RESP1_8 {
@ Dog-bone design at the end of POLY resistor for contact pick-up is not suggested
  X = CONVEX EDGE GTR == 1
  EXPAND EDGE X INSIDE BY 0.01
}
*/
RESP1_9 {
@ For POLY resistor, make sure the POLY be covered by SAB and implanted by either SN or SP
  GTR NOT SAB
  (GTR NOT IN SP) NOT IN SN
}
/*
RESP1_10 {
@ POLY SAB resistor with SP must lay on NW
  ((GTR INTERACT SAB) AND SP) NOT NW
}
*/
RESP1_11 {
@ Extension Poly to SAB is 0.3
  ENC SAB (GT INTERACT GTR)< 0.3 ABUT<90 SINGULAR REGION
}
RESP1_12 {
@ Minimum Space RESPl to non-related AA is 0.16
  EXT RESP1 (AA NOT INTERACT RESP1) < 0.16 ABUT<90 SINGULAR REGION
}
RESP1_13 {
@ Minimum Space RESPl to non-related Poly is 0.24
  EXT RESP1 (GT NOT INTERACT RESP1)  < 0.24 ABUT<90 SINGULAR REGION
}
/*
RESP1_14 {
@ If you have N_poly_resistor device, please confirm it with SMIC PIE
  ((RESP1 AND SN) AND SAB ) AND GT
}
*/
RESP1_15{
@ RESP1 and SAB on GT should have coincident edge
X = RESP1 INSIDE EDGE GT
Y = SAB INSIDE EDGE GT
X NOT COIN  EDGE Y
RESP1 ENCLOSE GT
}


//==============================
//  Poly silicide Resistor  DRC
//==============================
  
GROUP GPLRES PLRES_?

GTP =GT AND PLRES

PLRES_1{
@POLY Silicide resistor minimum width is 0.15  
INT GTP < 0.15 ABUT<90 REGION 
}
PLRES_2{
@PLRES can not overlap with RESP1
 PLRES AND RESP1
}
PLRES_3{
@POLY Silicide resistor minimum square number(length/width ratio) >= 1
  X = PLRES INTERACT GT
  Y = GT AND  PLRES
    L = LENGTH Y >0
  L1 = EXPAND EDGE L OUTSIDE BY 0.001 
  W = INSIDE EDGE X GT
  W1 =  EXPAND EDGE W OUTSIDE BY 0.001
  L_RE =L1 NOT W1
  L_EDGE = L_RE COIN EDGE Y 
  DFM PROPERTY Y L_EDGE W OVERLAP ABUT ALSO MULTI [WIDTH = LENGTH(W)] >0 [SQUARES = LENGTH(L_EDGE)/LENGTH(W)] < 1
 }
PLRES_4{
@POLY Silicide resistor must be orthogonal
  ANGLE GTP >0< 90
}
PLRES_5{
@CT to PLRES space: Fixed value is 0.01
//(SIZE (CT INSIDE (GT INTERACT GTP)) BY 0.01) NOT TOUCH PLRES
X1 = EXT CT GTP <= 0.07 ABUT<90 REGION OPPOSITE
X2 = EXT CT GTP == 0.01 ABUT<90 REGION OPPOSITE
(X1 NOT (X2 NOT (X2 ENCLOSE CT))) OR (CT INTERACT PLRES)
}
PLRES_6{
@min Extension of PLRES outside of POLY minimum distance is 0.0
 X =GTP TOUCH (PLRES NOT GTP) >1
 Y = PLRES COIN EDGE GT
 Z =EXPAND EDGE Y INSIDE BY 0.001 
 PLRES NOT INTERACT (X OR (PLRES INTERACT Z))
}
PLRES_7{
@The minimum separation between resistors with un-related implant region is 0.16
 EXT GTP SN < 0.16 ABUT<90 SINGULAR REGION
  EXT GTP SP < 0.16 ABUT<90 SINGULAR REGION
  EXT GTP ESD1 < 0.16 ABUT<90 SINGULAR REGION
}
PLRES_8{
@For POLY Silicide resistor, make sure the POLY be implanted by either SN or SP. Minimum enclosure by SN or SP is 0.18
 (GTP NOT IN SP) NOT IN SN
 ENC GTP SN <0.18 ABUT<90 SINGULAR REGION
  ENC GTP SP <0.18 ABUT<90 SINGULAR REGION
}
PLRES_9{
@Minimum Space PLRES to non-related AA is 0.16
EXT PLRES AA< 0.16 ABUT<90 SINGULAR REGION
}
PLRES_10 {
@Minimum Space PLRES to non-related Poly is 0.24 
EXT PLRES GT< 0.24 ABUT<90 SINGULAR REGION
}

/*
//=================================
//  SE - Short Edge Design Rules
//=================================

GROUP GSE SE_?

SE_1 {
@ AA vertex must not be connected to two short edge with length < 0.07
  CONVEX EDGE (LENGTH AA < 0.070) ANGLE1 >=0 ANGLE2 >0
}
SE_2 {
@ Poly vertex must not be connected to two short edge with length < 0.04
  CONVEX EDGE (LENGTH GT < 0.040) ANGLE1 >=0 ANGLE2 >0
}
#IFDEF RECOMMENDED YES
SE_2R {
@ Poly vertex must not be connected to two short edge w/ length <= 0.07
  CONVEX EDGE (LENGTH GT < 0.070)  ANGLE1 >=0 ANGLE2 >0
}
#ENDIF
SE_2a {
@ Poly edge with length < 0.07 um must have at least one neighboring edge with length = 0.07 um
  CONVEX EDGE (LENGTH PC < 0.070)  ANGLE1 >0 ANGLE2 >0
}
SE_3 {
@ SN vertex must not be connected to two short edges with length < 0.14um
  CONVEX EDGE (LENGTH SN < 0.140)  ANGLE1 >=0 ANGLE2 >0
}
SE_4 {
@ M1 vertex must not be connected to two short edges with lengths < 0.07 um
  CONVEX EDGE (LENGTH M1 < 0.070)  ANGLE1 >=0 ANGLE2 >0
}
SE_5a {
@ M2 vertex must not be connected to two short edges with lengths < 0.07 um
  CONVEX EDGE (LENGTH M2 < 0.070)  ANGLE1 >=0 ANGLE2 >0
}
SE_5b {
@ M3 vertex must not be connected to two short edges with lengths < 0.07 um
  CONVEX EDGE (LENGTH M3 < 0.070)  ANGLE1 >=0 ANGLE2 >0
}
SE_5c {
@ M4 vertex must not be connected to two short edges with lengths < 0.07 um
  CONVEX EDGE (LENGTH M4 < 0.070)  ANGLE1 >=0 ANGLE2 >0
}
SE_5d {
@ M5 vertex must not be connected to two short edges with lengths < 0.07 um
  CONVEX EDGE (LENGTH M5 < 0.070)  ANGLE1 >=0 ANGLE2 >0
}
SE_5e {
@ M6 vertex must not be connected to two short edges with lengths < 0.07 um
  CONVEX EDGE (LENGTH M6 < 0.070)  ANGLE1 >=0 ANGLE2 >0
}
SE_5f {
@ M7 vertex must not be connected to two short edges with lengths < 0.07 um
  CONVEX EDGE (LENGTH M7 < 0.070)  ANGLE1 >=0 ANGLE2 >0
}
SE_5g {
@ M8 vertex must not be connected to two short edges with lengths < 0.07 um
  CONVEX EDGE (LENGTH M8 < 0.070)  ANGLE1 >=0 ANGLE2 >0
}
#IFDEF RECOMMENDED YES
SE_4R {
@ Any M1 vertex touching an M1 edge <= 0.07 um must connect to an M1 edge >= 0.135
  Length (CONVEX EDGE (LENGTH M1 <= 0.135) ANGLE1 >=0  ANGLE2 > 0) <= 0.070
}
SE_5Ra {
@ Any M2 vertex touching an M2 edge <= 0.07 um must connect to an M2 edge >= 0.135
  Length (CONVEX EDGE (LENGTH M2 <= 0.135) ANGLE1 >=0  ANGLE2 > 0) <= 0.070
}
SE_5Rb {
@ Any M3 vertex touching an M3 edge <= 0.07 um must connect to an M3 edge >= 0.135
  Length (CONVEX EDGE (LENGTH M3 <= 0.135) ANGLE1 >=0  ANGLE2 > 0) <= 0.070
}
SE_5Rc {
@ Any M4 vertex touching an M4 edge <= 0.07 um must connect to an M4 edge >= 0.135
  Length (CONVEX EDGE (LENGTH M4 <= 0.135) ANGLE1 >=0  ANGLE2 > 0) <= 0.070
}
SE_5Rd {
@ Any M5 vertex touching an M5 edge <= 0.07 um must connect to an M5 edge >= 0.135
  Length (CONVEX EDGE (LENGTH M5 <= 0.135) ANGLE1 >=0  ANGLE2 > 0) <= 0.070
}
SE_5Re {
@ Any M6 vertex touching an M6 edge <= 0.07 um must connect to an M6 edge >= 0.135
  Length (CONVEX EDGE (LENGTH M6 <= 0.135) ANGLE1 >=0  ANGLE2 > 0) <= 0.070
}
SE_5Rf {
@ Any M7 vertex touching an M7 edge <= 0.07 um must connect to an M7 edge >= 0.135
  Length (CONVEX EDGE (LENGTH M7 <= 0.135) ANGLE1 >=0  ANGLE2 > 0) <= 0.070
}
SE_5Rg {
@ Any M8 vertex touching an M8 edge <= 0.07 um must connect to an M8 edge >= 0.135
  Length (CONVEX EDGE (LENGTH M8 <= 0.135) ANGLE1 >=0  ANGLE2 > 0) <= 0.070
}
#ENDIF
*/



//===========================================
//  LVT - Low Vt devices DRC 
//===========================================

GROUP GLVT LVT_?

LVT_1 {
@ LVT minimum width(parallel side to side width) is 0.18
  INT LVT < 0.18 ABUT>0<90 OPPOSITE REGION
}
LVT_2 {
@ Minimum Space between two LVT. (with run length > 0 ) is 0.18
  EXT LVT < 0.18 ABUT < 90 REGION OPPOSITE
}
/*
LVT_3 {
@ Minimum Space between LVT and AA (except Pickup AA) is 0.04
  EXT LVT (AA NOT TAP) < 0.04 ABUT<90 REGION
}
*/
LVT_4 {
@ LVT minimum extension outside of poly gate for MOS along source drain direction is 0.14
  Z = GATE INTERACT LVT
  X = Z INSIDE EDGE ACT
  ENC X LVT < 0.14 ABUT<90 REGION OPPOSITE
}
LVT_4a {
@ LVT minimum extension outside of poly gate for MOS along poly direction is 0.08
  Z = GATE INTERACT LVT
  X = ACT TOUCH EDGE Z
  ENC X LVT < 0.08 ABUT<90 REGION OPPOSITE
}
LVT_5 {
@ Minimum space between LVT and gate for MOS along source drain direction is 0.14
  X = GATE INSIDE EDGE ACT
  EXT LVT X < 0.14 ABUT<90 REGION OPPOSITE
}
LVT_5a {
@ Minimum Space between LVT and gate along poly direction is 0.08
  X = GATE TOUCH EDGE ACT
  EXT X LVT < 0.08 ABUT<90 REGION
}
LVT_6 {
@ Minimum space between LVT to (poly SAB resistor(GT AND RESP1) or AA SAB resistor(AA AND RESAA)) is 0.18
  EXT LVT GTSABR < 0.18 ABUT<90 SINGULAR REGION
  EXT LVT AASABR < 0.18 ABUT<90 SINGULAR REGION
}
LVT_9 {
@ LVT minimum area is 0.19
  AREA LVT < 0.19
}
LVT_10 {
@ LVT minimum enclosed area is 0.19
  AREA ((HOLES LVT INNER) NOT LVT) < 0.19
}
LVT_13 {
@ (LVT over AA) over ( NLL, PLL, HVT) is prohibited
  (LVT AND AA) AND ((NLL OR PLL) OR HVT) 
}
/*
LVT_14 {
@ Minimum Space between LVT and pickup AA is 0.02
  EXT LVT TAP < 0.02 ABUT<90 REGION
}
*/

//===========================================
//  HVT - High Vt devices DRC
//===========================================

GROUP GHVT HVT_?

HVT_1 {
@ HVT minimum width(parallel side to side width) is 0.18
  INT HVT < 0.18 ABUT>0<90 OPPOSITE REGION
}
HVT_2 {
@ Minimum Space between two HVT. (with run length > 0 ) is 0.18
  EXT HVT < 0.18 ABUT < 90 REGION   OPPOSITE
}
/*
HVT_3 {
@ Minimum Space between HVT and AA (except Pickup AA) is 0.04
  EXT HVT (AA NOT TAP) < 0.04 ABUT<90 REGION
}
*/
HVT_4 {
@ HVT minimum extension outside of poly gate for MOS along source drain direction is 0.14
  Z = GATE INTERACT HVT
  X = Z INSIDE EDGE ACT
  ENC X HVT < 0.14 ABUT<90 REGION OPPOSITE
}
HVT_4a {
@ HVT minimum extension outside of poly gate for MOS along poly direction is 0.08
  Z = GATE INTERACT HVT
  X = ACT TOUCH EDGE Z
  ENC X HVT < 0.08 ABUT<90 REGION OPPOSITE
}
HVT_5 {
@ Minimum space between HVT and gate for MOS along source drain direction is 0.14
  X = GATE INSIDE EDGE ACT
  EXT HVT X < 0.14 ABUT<90 REGION OPPOSITE
}
HVT_5a {
@ Minimum Space between HVT and gate along poly direction is 0.08
  X = GATE TOUCH EDGE ACT
  EXT X HVT < 0.08 ABUT<90 REGION
}
HVT_6 {
@ Minimum space between HVT to (poly SAB resistor(RESP1 AND GT) or AA SAB resistor(RESAA AND AA)) is 0.18
  EXT HVT GTSABR < 0.18 ABUT<90 SINGULAR REGION
  EXT HVT AASABR < 0.18 ABUT<90 SINGULAR REGION
}
HVT_9 {
@ HVT minimum area is 0.19
  AREA HVT < 0.19
}
HVT_10 {
@ HVT minimum enclosed area is 0.19
  AREA ((HOLES HVT INNER) NOT HVT) < 0.19
}
HVT_13 {
@ (HVT over AA) over ( TG, DG, NLL, PLL, LVT) is prohibited
  (HVT AND AA) AND (TG OR DG)
  (HVT AND AA) AND ((NLL OR PLL) OR LVT)
}
/*
HVT_14 {
@ Minimum Space between HVT and pickup AA is 0.02
  EXT HVT TAP < 0.02 ABUT<90 REGION
}
*/

/*
//===============================
//  NC - SRAM NMOS Implant DRC
//===============================

GROUP GNC NC_?

NC_1 {
@ NC minimum width is 0.18
  INT NC < 0.18 ABUT<90 SINGULAR REGION
}
NC_2 {
@ Minimum space between two NC is 0.18
@ Merge if the space is less than 0.18
  EXT NC < 0.18 ABUT<90 SINGULAR REGION
}
NC_3 {
@ Minimum space between NC and N+AA in PW or P+AA in NW is 0.08, except AA resistor
  X = (PACT NOT (PTAP OR AAR)) NOT TOUCH EDGE NC
  Y = (NACT NOT (NTAP OR AAR)) NOT TOUCH EDGE NC
  EXT NC X < 0.08 ABUT<90 REGION
  EXT NC Y < 0.08 ABUT<90 REGION
}
NC_4_8 {
@ NC minimum extension outside of poly gate for NMOS along source drain direction is 0.18
@ N+AA minimum enclosure by NC if the distance to the poly gate < 0.16um is 0.16
  Z = NGATE INTERACT NC
  X = Z INSIDE EDGE NACT
  A = EXPAND EDGE X INSIDE BY 0.16 OUTSIDE BY 0.16 CORNER FILL
  Y = Z COIN EDGE NACT
  B = EXPAND EDGE Y OUTSIDE BY 0.16 EXTEND BY 0.16
  C = A OR B
  C NOT NC
  ENC X NC < 0.18 ABUT<90 REGION OPPOSITE
}
NC_5 {
@ Space between NC and P-channel poly gate is 0.2
  EXT NC PGATE < 0.20 ABUT<90 SINGULAR REGION
}
NC_6 {
@ Space between NC SAB poly and AA resistor is 0.2
  EXT NC GTR < 0.20 ABUT<90 SINGULAR REGION
  EXT NC AAR < 0.20 ABUT<90 SINGULAR REGION
}
NC_7 {
@ N+AA enclosure by NC if the distance to the poly gate w>0.22um is 0.08
  X = (NACT TOUCH EDGE NGATE) NOT COIN EDGE PACT
  ENC X NC < 0.08 ABUT<90 REGION
}
NC_9 {
@ NC area is 0.10
  AREA NC < 0.10
}
NC_10 {
@ NC minimum enclosed area is 0.10
  AREA ((HOLES NC INNER) NOT NC) < 0.10
}
NC_11 {
@ NC can not overlap with P+ pickup AA or butted P+AA
  NC AND PACT
}
NC_12 {
@ NC shapes must be orthogonal
  ANGLE NC >0<90
}
NC_13 {
@ (NC over AA) over (TG, DG, LVN, VTNH) is prohibited
  (NC AND AA) AND (TG OR DG)
  (NC AND AA) AND (LVN OR VTNH)
}



//===============================
//  PC - SRAM PMOS Implant DRC
//===============================

GROUP GPC PC_?

PC_1 {
@ PC width is 0.18
  INT PC < 0.18 ABUT<90 SINGULAR REGION
}
PC_2 {
@ Space between two PC is 0.18
@ Merge if the space is less than 0.18
  EXT PC < 0.18 ABUT<90 SINGULAR REGION
}
PC_3 {
@ Space between PC and N+AA in PW or P+AA in NW is 0.09, except AA resistor
  X = (PACT NOT (PTAP OR AAR)) NOT TOUCH EDGE PC
  Y = (NACT NOT (NTAP OR AAR)) NOT TOUCH EDGE PC
  EXT PC X < 0.09 ABUT<90 REGION
  EXT PC Y < 0.09 ABUT<90 REGION
}
PC_4_8 {
@ PC extension outside of poly gate for PMOS along source drain direction is 0.18
@ N+AA enclosure by PC if the distance to the poly gate < 0.22um is 0.18
  Z = PGATE INTERACT PC
  X = Z INSIDE EDGE PACT
  A = EXPAND EDGE X INSIDE BY 0.22 OUTSIDE BY 0.22 CORNER FILL
  Y = Z COIN EDGE PACT
  B = EXPAND EDGE Y OUTSIDE BY 0.22 EXTEND BY 0.18
  C = A OR B
  C NOT PC
  ENC X PC < 0.18 ABUT<90 REGION OPPOSITE
}
PC_5 {
@ Space between PC and N-channel poly gate is 0.2
  EXT PC NGATE < 0.20 ABUT<90 SINGULAR REGION
}
PC_6 {
@ Space between PC SAB poly and AA resistor is 0.2
  EXT PC GTR < 0.20 ABUT<90 SINGULAR REGION
  EXT PC AAR < 0.20 ABUT<90 SINGULAR REGION
}
PC_7 {
@ P+AA enclosure by PC if the distance to the poly gate w>0.22um is 0.08
  X = (PACT TOUCH EDGE PGATE) NOT COIN EDGE NACT
  ENC X PC < 0.08 ABUT<90 REGION
}
PC_9 {
@ PC area is 0.10
  AREA PC < 0.10
}
PC_10 {
@ PC minimum enclosed area is 0.10
  AREA ((HOLES PC INNER) NOT PC) < 0.10
}
PC_11 {
@ PC can not overlap with N+ pickup AA or butted N+AA
  PC AND NACT
}
PC_12 {
@ PC shapes must be orthogonal
  ANGLE PC >0<90
}
PC_13 {
@ (PC over AA) over (TG, DG, LVP, VTPH) is prohibited
  (PC AND AA) AND (TG OR DG)
  (PC AND AA) AND (LVP OR VTPH)
}


//============================
//  NC - N-cell Implant DRC
//============================

GROUP GSRNC SRNC_?

SRNC_101 {
@ NC minimum width is 0.272
  INT NC < 0.272 ABUT<90 REGION
}
SRNC_102 {
@ Minimum space between two NC is 0.46
  EXT NC < 0.46 ABUT<90 REGION
}
SRNC_103 {
@ NC min area is 0.114
  AREA NC < 0.114
}
SRNC_104 {
@ NC minimum enclosed area is 0.114
  AREA ((HOLES NC INNER) NOT NC) < 0.114
}



//===============================
//  PC - P-cell Implant DRC
//===============================

GROUP GSRPC SRPC_?

SRPC_101 {
@ PC width is 0.46
  INT PC < 0.46 ABUT<90 REGION
}
SRPC_102 {
@ Space between two PC is 0.272
  EXT PC < 0.272 ABUT<90 REGION
}
SRPC_103 {
@ PC area is 0.114
  AREA PC < 0.114
}
SRPC_104 {
@ PC minimum enclosed area is 0.114
  AREA ((HOLES PC INNER) NOT PC) < 0.114
}
*/

//=======================================
//  SP - P+ S/D implantation DRC
//=======================================

GROUP GSP SP_?

SP_1 {
@ SP minimum width(with run length > 0) is 0.18
  INT SP < 0.18 ABUT<90 REGION OPPOSITE
}
/*SRSP_1 {
@ SP minimum width is 0.135
  X=INT SP < 0.135 ABUT<90 REGION
 X NOT OUTSIDE INST
}*/
SP_2 {
@ Minimum space between two SP(with run length > 0) is 0.18
@ Merge if the space is less than 0.18
  EXT SP < 0.18 OPPOSITE ABUT<90 REGION
}
/*SRSP_2 {
@ Minimum space between two SP is 0.135
 X= EXT SP < 0.135 ABUT<90 REGION
 X NOT OUTSIDE INST
}*/
SP_3a {
@ Minimum space between SP and N+AA in PW (run length > 0.1um) is 0.08, excpet AA resistor
  X = ((NACT OUTSIDE INST) NOT (NTAP OR AAR)) NOT COIN EDGE SP
  X1 = EXT SP X < 0.08 ABUT>0<90 REGION OPPOSITE
  X1 WITH EDGE (LENGTH X1 > 0.1)
}
SP_3b {
@ Minimum space between SP and N+AA in PW (run length <= 0.1um) is 0.05, excpet AA resistor
  X = ((NACT OUTSIDE INST) NOT (NTAP OR AAR)) NOT COIN EDGE SP
  EXT SP X < 0.05 ABUT>0<90 REGION
}
SRSP_3a{
@ Minimum space between SP and N+ AA inside PW is 0.041, except AA resistor. (run length > 0.1um)
  X = (NACT NOT OUTSIDE INST) AND PW
  Y = EXT SP X < 0.041 ABUT>0<90 REGION OPPOSITE
  (Y WITH EDGE (LENGTH Y > 0.1)) NOT OUTSIDE INST 
}
SRSP_3b{
@ Minimum space between SP and N+ AA inside PW is 0.037, except AA resistor. (run length <= 0.1um)
  X = (NACT NOT OUTSIDE INST) AND PW
  Y = EXT SP X < 0.037 ABUT>0<90 REGION OPPOSITE
  Z = Y COIN EDGE SP  
  (Y WITH EDGE (LENGTH Z <=0.1 )) NOT OUTSIDE INST 
}
SP_4{
@ Minimum space between SP and N+ pick-up AA is 0.02
  X = NTAP NOT COIN EDGE (SP INTERACT PACT)
  EXT SP X < 0.02 ABUT<90 REGION
}
// SKip SP.5 : Space between a SP and a butted N+ AA is 0
SP_6 {
@ SP minimum extension outside of poly gate for PMOS is 0.16
  ENC (GT COIN EDGE GATE) SP < 0.16 ABUT<90 REGION OPPOSITE
}
/*SRSP_6 {
@ SP minimum extension outside of poly gate for PMOS is 0.18, excluding floating poly
  ENC (((GT NOT OUTSIDE INST) NOT FTGT) IN EDGE PACT) SP < 0.18 ABUT<90 REGION OPPOSITE
}*/
SP_7a {
@ Minimum space between SP and S/D direction N-channel poly gate is 0.16
  EXT SP (GT COIN EDGE NGATE) < 0.16 ABUT<90 REGION OPPOSITE
}
/*SRSP_7a {
@ Minimum space between SP and S/D direction N-channel poly gate is 0.18, excluding floating poly
 SD = ((AA INTERACT GT) NOT GT) INTERACT CT 
 X = EXT SP (((GT NOT OUTSIDE INST) NOT FTGT) IN EDGE NACT) < 0.18 ABUT<90 REGION OPPOSITE
 X INTERACT SD
}*/

SP_7b {
@ Minimum space between SP and non-S/D direction N-channel poly gate is 0.08
X=  EXT SP  NGATE  < 0.08 ABUT<90 SINGULAR REGION
X  OUTSIDE SRAM
}
SP_7c {
@ A butted N+ pick-up AA space to PMOS gate in the same AA is >= 0.23
EXT (NACT TOUCH PSD) PGATE <0.23 ABUT<90 SINGULAR REGION 
}
/*SRSP_7b {
@ Minimum space between SP and non-S/D direction N-channel poly gate is 0.038
@ Minimum space between SP outter vertex and non-S/D direction N-channel poly gate outter vertex is 0.037
  X =EXT SP NGATE < 0.038 ABUT<90 REGION OPPOSITE
  X NOT OUTSIDE INST 
  Y = EXT SP NGATE < 0.037 ABUT<90 REGION CORNER TO CORNER
  Y NOT OUTSIDE INST 
}
SP_8a {
@ Minimum space between SP on a butted AA and poly gate edge in case the
@ extending of butted P+ AA is less than 0.16 (h<0.16) in PW is 0.16
  NGTL = NACT INSIDE EDGE GT
  NAAL = NACT TOUCH EDGE NGTL
  NAAL_EP = EXPAND EDGE NAAL OUTSIDE BY 0.16 EXTEND BY 0.01
  BUTPA_ED = PACT COIN EDGE (NACT NOT NTAP)
  BUTPA_ED_1 = BUTPA_ED INSIDE EDGE NAAL_EP
  BUTSP_1 = (SP INTERACT PW) WITH EDGE BUTPA_ED_1

  GTSP_1 = GT INSIDE EDGE ((NACT NOT NTAP) TOUCH PACT)
  GTSP   = GT TOUCH EDGE GTSP_1

  EXT BUTSP_1 GTSP < 0.16 ABUT<90 REGION
}
SP_8b {
@ Minimum space between a SP on a butted AA and poly gate edge in case the
@ extending of butted P+ AA is larger than 0.16 (h>0.16) in PW is 0.08
  NGTL = NACT INSIDE EDGE GT
  NAAL = NACT TOUCH EDGE NGTL
  NAAL_EP = EXPAND EDGE NAAL OUTSIDE BY 0.16 EXTEND BY 0.01
  BUTPA_ED = PACT COIN EDGE (NACT NOT NTAP)
  BUTPA_ED_1 = BUTPA_ED INSIDE EDGE NAAL_EP
  BUTSP_1 = (SP INTERACT PW) WITH EDGE BUTPA_ED_1

  BUTSP_2 = ((SP INTERACT PW) WITH EDGE BUTPA_ED ) NOT BUTSP_1

  GTSP_1 = GT INSIDE EDGE ((NACT NOT NTAP) TOUCH PACT)
  GTSP   = GT TOUCH EDGE GTSP_1

  EXT BUTSP_2 GTSP < 0.08 ABUT<90 REGION
}*/
SP_8c{
@ A butted N+ pick-up AA (in L shape AA) space to PMOS gate in the same AA is >=0.23, when this butted N+ pick-up AA extrusion:  0 < h < 0.1m 
  PAAL = PACT TOUCH INSIDE EDGE PGATE
  PAAL_EP = EXPAND EDGE PAAL OUTSIDE BY 0.1 EXTEND BY 0.01
  BUTNA_ED = NACT COIN EDGE (PACT NOT PTAP)
  BUTNA_ED_1 = BUTNA_ED INSIDE EDGE PAAL_EP
  BUTSN_1 = (NACT INTERACT NW) WITH EDGE BUTNA_ED_1
  GTSP_1 = GT INSIDE EDGE (PACT  TOUCH NACT)
  GTSP   = (GT WITH EDGE GTSP_1) TOUCH EDGE PGATE  
 // P = CONVEX EDGE (PACT OR (GT ENCLOSE PGATE)) ANGLE1==270 ANGLE2==270  
 // P_REGION = EXPAND EDGE P OUTSIDE BY 0.1
 EXT BUTSN_1 GTSP < 0.23 ABUT<90 REGION
  
}
SP_9 {
@ Space between a SP and a N+AA or N+POLY resistor (SN AND ((RESAA AND AA) OR (RESP1 AND GT))is 0.16
  EXT SP (AAR AND SN) < 0.16 ABUT<90 SINGULAR REGION
  EXT SP (GTR AND SN) < 0.16 ABUT<90 SINGULAR REGION
 // EXT SP (HRPR AND SN) < 0.16 ABUT<90 SINGULAR REGION
}
SP_10 {
@ P+AA minimum enclosure by SP((not include pick up AA) is 0.08
  X = (PTAP INTERACT GATE) AND VARMOS
  Y = PACT NOT (PTAP NOT X)
  Z = ENC Y SP < 0.08 ABUT >0< 90 SINGULAR REGION
  Z OUTSIDE INST
}
SRSP_10 {
@ P+AA minimum enclosure by SP is 0.038 (not include pick up AA)
  X =ENC (PACT NOT PTAP) (SP NOT COIN EDGE NTAP) < 0.038 ABUT<90 REGION OPPOSITE
  X NOT OUTSIDE INST  

}
SP_12 {
@ SP enclosure of P+ pickup AA is 0.02
  X0 = (PTAP INTERACT GATE) AND VARMOS
  X = ((PTAP OUTSIDE INST) NOT X0) NOT COIN EDGE NACT
  ENC X SP < 0.02 ABUT<90 REGION
}
//Skip SRSP.12 : P+ pickup AA minimum enclosure by SP is 0
/*
SP_11 {
@ N+AA minimum enclosure by SN if the distance to the related poly is <w= 0.16 is 0.16
  A = EXPAND EDGE PGTEIAA INSIDE BY 0.16 OUTSIDE BY 0.16 CORNER FILL
  Y = PGATE COIN EDGE PACT
  B = EXPAND EDGE Y OUTSIDE BY 0.16 EXTEND BY 0.16
  C = A OR B
  ENC PACT (SP IN EDGE C) < 0.16 ABUT<90 REGION OPPOSITE
}
*/
//Skip SP.13 : AA enclosure by SP along the edge of butted P+AA/N+AA is 0
SP_14 {
@ P+ AA resistor or P+Poly resistor minimum enclosure by SP is 0.14
@ The resistor here: (SP AND ((RESAA AND AA) OR (RESP1 AND GT))
  ENC (AAR AND  SP) SP < 0.14 ABUT<90 SINGULAR REGION
  ENC (GTR AND SP) SP < 0.14 ABUT<90 SINGULAR REGION
}
SP_15 {
@ SP and AA minimum overlap is 0.10
  INT SP  (AA  NOT COIN EDGE SP) < 0.10 ABUT<90 REGION OPPOSITE
  }
/*SRSP_15 {
@ SP and AA minimum overlap, SP inner vertex to AA inner vertex is 0.098
 INT (SP NOT OUTSIDE INST) ((AA NOT OUTSIDE INST) NOT TOUCH EDGE SP) < 0.098 ABUT<90 REGION OPPOSITE 
}*/
SP_16 {
@ SP minimum area include the connected area within INST is 0.11
  AREA (SP OUT INST) < 0.11
}
SRSP_16 {
@ SP minimum area is 0.072
 X = AREA SP < 0.072
 X NOT OUTSIDE INST 
}
SP_SN_17 {
@ SN and SP overlap is forbidden
  SN AND SP
}
SP_18 {
@ Minimum enclosed area of SP is 0.11
 AREA ((HOLES SP INNER) NOT SP) < 0.11
}
/*
SP_19 {
@ Minimum enclosure of a SP beyond a P+ AA in NW is 0.02
  ENC ((PACT AND NW) NOT COIN EDGE NTAP) SP < 0.02 ABUT<90 REGION
}

SRSP_19 {
@ Minimum enclosure of a SP beyond a P+ AA in NW is 0.0325
  ENC (((PACT NOT OUTSIDE INST) AND NW) NOT COIN EDGE NTAP) SP < 0.0325 ABUT<90 REGION
}

SP_20 { 
@ Minimum AA butted p-well contact enclosure by SP is 0.02
  //INT (PTAP COIN EDGE NACT) PTAP < 0.08 ABUT<90 REGION
   ENC ((PTAP NOT INSIDE INST) NOT COIN EDGE NACT) SP < 0.02 ABUT<90 REGION
}
*/
//Skip SRSP.20 : Minimum overlap of SP and AA butted p-well contact is 0
SP_20a {
@ P+ butted AA in P-well area(the area interact with CT)is 0.03
  AREA (((((SP CUT AA ) NOT (SP ENCLOSE AA)) AND AA) NOT NW) INTERACT CT) < 0.03
}
SP_21 {
@ N+ butted AA in NW contact extension of SP is 0.08
  INT (NTAP COIN EDGE PACT) NTAP  < 0.08 ABUT<90 REGION
}
SP_21a {
@ N+ butted AA in NW area(the area interact with CT)
 AREA (((((SN CUT AA ) NOT (SN ENCLOSE AA)) AND AA) AND NW) INTERACT CT)<0.03
}



//=================================
//  SN - N+ S/D Implantation DRC
//=================================

GROUP GSN SN_?

SN_1 {
@ SN minimum width(run length > 0) is 0.18
  INT SN  < 0.18 ABUT<90 OPPOSITE REGION
}
/*SRSN_1 {
@ SN width is 0.135
  X =INT SN < 0.135 ABUT<90 REGION
 X NOT OUTSIDE INST 
}*/
SN_2 {
@ Minimum space between two SN (with run length > 0) is 0.18
  EXT SN  < 0.18 OPPOSITE ABUT<90 REGION
}
/*SRSN_2 {
@ Space between two SN is 0.135
 X = EXT SN < 0.135 ABUT<90 REGION
 X NOT OUTSIDE INST 
}*/
SN_3a {
@ Minimum space between SN and P+AA in NW (run length > 0.1um) is 0.08,except AA resistor(RESAA AND AA)
  //X = (PACT NOT (PTAP OR AAR)) NOT TOUCH EDGE SN
  X = ((PACT AND NW) NOT AAR) NOT COIN EDGE SN
  X1 = EXT SN X < 0.08 ABUT>0<90 REGION OPPOSITE
  X2 =X1 WITH EDGE (LENGTH X1 > 0.1)
  X2 OUTSIDE INST 
}
SN_3b {
@ Minimum space between SN and P+AA in NW (run length <= 0.10um) is 0.05, except AA resistor(RESAA AND AA)
  X =((PACT  AND NW) NOT AAR) NOT COIN EDGE SN
  X1 = EXT SN X < 0.05 ABUT>0<90 REGION
   X1 OUTSIDE INST
}
SRSN_3a{
@ Minimum space between SN and P+ AA inside NW is 0.043, except AA resistor. (run length > 0.1um)
  X = ((PACT NOT OUTSIDE INST) AND NW) NOT COIN EDGE SN
  Y = EXT SN X < 0.043 ABUT>0<90 REGION OPPOSITE
  (Y WITH EDGE (LENGTH Y > 0.1)) NOT OUTSIDE INST 
}
SRSN_3b{
@ Minimum space between SN and P+ AA inside NW is 0.038, except AA resistor. (run length <= 0.1um)
  X = ((PACT NOT OUTSIDE INST) AND NW) NOT COIN EDGE SN
  Y = EXT SN X < 0.038 ABUT>0<90 REGION OPPOSITE
  Z = Y COIN EDGE SN  
  (Y WITH EDGE (LENGTH Z <=0.1 )) NOT OUTSIDE INST 
}
SN_4 {
@ Minimum space between SN and P+ pick-up AA is 0.02
  X = (PTAP OUTSIDE INST) NOT COIN EDGE (SN INTERACT NACT)
  EXT SN X < 0.02 ABUT<90 REGION
}
// Skip SRSN.4 : Minimum space between SN and P+ pick-up AA is 0 
// SKip SN.5 : Space between a SN and a butted P+ AA is 0
SN_6 {
@ SN minimum extension outside of poly gate for NMOS along source drain direction is 0.16
  ENC (GATE COIN EDGE GT) SN < 0.16 ABUT<90 REGION OPPOSITE
}
/*SRSN_6 {
@ SN minimum extension outside of Poly gate for NMOS along source drain direction is 0.18, excluding floatin poly
  SD = ((AA INTERACT GT) NOT GT) INTERACT CT
  X = ENC (((GT NOT OUTSIDE INST) NOT FTGT) IN EDGE NACT) SN < 0.18 ABUT<90 REGION OPPOSITE
  X INTERACT SD
}*/
SN_7a {
@ Minimum space between SN and S/D driection P-channel poly gate is 0.16
  EXT SN (GT COIN EDGE PGATE) < 0.16 ABUT<90 REGION OPPOSITE
}
/*SRSN_7a {
@ Minimum space between SN and S/D driection P-channel poly gate is 0.18, excluding floatin poly
  EXT SN (((GT NOT OUTSIDE INST) NOT FTGT) IN EDGE PACT) < 0.18 ABUT<90 REGION OPPOSITE
}*/
SN_7b {
@ Minimum space between SN and Non-S/D driection P-channel poly gate is 0.08 (outside of SRAM(INST area))
 X = EXT SN PGATE < 0.08 ABUT<90 SINGULAR REGION
X OUTSIDE INST

}
SN_7c{
@ A butted P+ pick-up AA space to NMOS gate in the same AA is >=0.23
EXT (PACT TOUCH NSD) NGATE <0.23 ABUT<90 SINGULAR REGION 
}
/*SRSN_7b {
@ Minimum space between SN and Non-S/D driection P-channel poly gate is 0.043, excluding floatin poly
  EXT SN ((PGATE AND INST) NOT FTGT) < 0.043 ABUT<90 REGION
}
SN_8a {
@ Minimum space between SN on a butted AA and poly gate edge in case the extending of butted N+ AA is less than 0.16 in NW is 0.16
  PGTL = PACT INSIDE EDGE GT
  PAAL = PACT TOUCH EDGE PGTL
  PAAL_EP = EXPAND EDGE PAAL OUTSIDE BY 0.16 EXTEND BY 0.01
  BUTNA_ED = NACT COIN EDGE (PACT NOT PTAP)
  BUTNA_ED_1 = BUTNA_ED INSIDE EDGE PAAL_EP
  BUTSN_1 = (SN INTERACT NW) WITH EDGE BUTNA_ED_1

  GTSN_1 = GT INSIDE EDGE ((PACT NOT PTAP) TOUCH NACT)
  GTSN   = GT TOUCH EDGE GTSN_1

  EXT BUTSN_1 GTSN < 0.16 ABUT<90 REGION
}
SN_8b {
@ Minimum space between SN on a butted AA and poly gate edge in case the extending of butted N+ AA is larger than 0.16 in NW is 0.08
  PGTL = PACT INSIDE EDGE GT
  PAAL = PACT TOUCH EDGE PGTL
  PAAL_EP = EXPAND EDGE PAAL OUTSIDE BY 0.16 EXTEND BY 0.01
  BUTNA_ED = NACT COIN EDGE (PACT NOT PTAP)
  BUTNA_ED_1 = BUTNA_ED INSIDE EDGE PAAL_EP
  BUTSN_1 = (SN INTERACT NW) WITH EDGE BUTNA_ED_1

  BUTSN_2 = ((SN INTERACT NW) WITH EDGE BUTNA_ED ) NOT BUTSN_1

  GTSN_1 = GT INSIDE EDGE ((PACT NOT PTAP) TOUCH NACT)
  GTSN   = GT TOUCH EDGE GTSN_1

  EXT BUTSN_2 GTSN < 0.08 ABUT<90 REGION
}*/
SN_8c{
@ A butted P+ pick-up AA (in L shape AA) space to NMOS gate in the same AA is >=0.23, when this butted P+ pick-up AA extrusion:  0 < h < 0.1m
  NAAL = NACT TOUCH INSIDE EDGE NGATE
  NAAL_EP = EXPAND EDGE NAAL OUTSIDE BY 0.1 EXTEND BY 0.01
  BUTNA_ED = PACT COIN EDGE (NACT NOT NTAP)
  BUTNA_ED_1 = BUTNA_ED INSIDE EDGE NAAL_EP
  BUTSN_1 = (PACT INTERACT PW) WITH EDGE BUTNA_ED_1

  GTSN_1 = GT INSIDE EDGE ((NACT NOT NTAP) TOUCH PACT)
  GTSN   = (GT WITH EDGE GTSN_1) TOUCH EDGE NGATE  
  N = CONVEX EDGE (NACT OR (GT ENCLOSE NGATE)) ANGLE1==270 ANGLE2==270  
  N_REGION = EXPAND EDGE N OUTSIDE BY 0.1
  EXT BUTSN_1 GTSN < 0.23 ABUT<90 REGION
  
}
SN_9 {
@ Minimum space between a SN and a P-type resistor is 0.16 (SP AND ((RESAA AND AA) OR (RESP1 AND GT))
  EXT SN (AAR AND SP) < 0.16 ABUT<90 SINGULAR REGION
  EXT SN (GTR AND SP) < 0.16 ABUT<90 SINGULAR REGION
  //EXT SN (HRPR INTERACT SP) < 0.16 ABUT<90 SINGULAR REGION
}
/*
SN_10 {
@ N+AA minimum enclosure by SN if the distance to the poly gate is > w=0.16 is 0.08
@ N+ pickup AA minimum enclosure by SN is 0.08
  //ENC SN (NACT NOT COIN EDGE PACT) < 0.08 ABUT<90 REGION
  X = ((NACT NOT NTAP) NOT NWR_SN) NOT COIN EDGE PACT
  A = X COIN EDGE SP
  B = X NOT COIN EDGE SP
  Achk = LENGTH A > 0.08
  ENC Achk SN < 0.08 ABUT<90 REGION
  ENC B SN < 0.08 ABUT<90 REGION OPPOSITE
}
SN_10 {
@ N+AA minimum enclosure by SN(Not apply to AA along S/D direction) is 0.08
  ENC ((NACT NOT INSIDE INST) TOUCH EDGE GATE) (SN NOT COIN EDGE PTAP) < 0.08 ABUT<90 REGION
}
*/
SN_10 {
@ N+AA minimum enclosure by SN(not include pick up AA) is 0.08 Waive for (AA interact RESNW)
  X = (NTAP INTERACT GATE) AND VARMOS
  Y = ((AA NOT INTERACT RESNW) AND SN) NOT (NTAP NOT X)
  Z = ENC Y SN < 0.08 ABUT >0< 90 SINGULAR REGION
  Z OUTSIDE INST
}
SRSN_10 {
@ N+AA minimum enclosure by SN is 0.041 (not include pick up AA)
@ N+AA outter vertex to SN inner vertex is 0.037(Not apply to AA along S/D direction)
  ENC ((NACT NOT OUTSIDE INST) NOT NTAP)  (SN NOT COIN EDGE PTAP) < 0.041 ABUT<90 REGION OPPOSITE
  ENC ((NACT NOT OUTSIDE INST) TOUCH EDGE GATE) (SN NOT COIN EDGE PTAP) < 0.037 ABUT<90 REGION
}
/*
SN_11 {
@ SN minimum extension outside of poly gate for NMOS is 0.22
  //ENC NGTEIAA SN < 0.18 ABUT<90 REGION OPPOSITE
  A = EXPAND EDGE NGTEIAA INSIDE BY 0.16 OUTSIDE BY 0.16 CORNER FILL
  Y = NGATE COIN EDGE NACT
  B = EXPAND EDGE Y OUTSIDE BY 0.16 EXTEND BY 0.16
  C = A OR B
  ENC NACT (SN IN EDGE C) < 0.16 ABUT<90 REGION OPPOSITE
}
*/
SN_12 {
@ N+ pickup AA minimum enclosure by SN is 0.02 Waive for (AA interact RESNW)
  //X = (NTAP NOT SNNR) NOT COIN EDGE PACT
  X0 = (NTAP INTERACT GATE) AND VARMOS
  X = ((NTAP NOT X0) NOT (AA INTERACT RESNW)) NOT COIN EDGE PACT
ENC X SN < 0.02 ABUT<90 REGION
}
//Skip SN.13 : AA enclosure by SN along the edge of butted P+AA/N+AA is 0
SN_14 {
@ N+AA resistor or N+POLY resistor minimum enclosure by SN is 0.14. The resistor here: (SN AND ((RESAA AND AA) OR (RESP1 AND GT))
  ENC (AAR AND SN) SN < 0.14 ABUT<90 SINGULAR REGION
  ENC (GTR AND SN) SN < 0.14 ABUT<90 SINGULAR REGION
}
SN_15 {
@ SN and AA minimum overlap is 0.10
  INT SN (AA NOT COIN EDGE SN) < 0.10 ABUT<90 OPPOSITE REGION
}
SN_16 {
@ SN minimum area include the connected area within INST is 0.11
  AREA (SN OUT INST) < 0.11
}
SRSN_16 {
@ SN minimum area is 0.0823
  X =AREA SN < 0.0823
 X NOT OUTSIDE INST 
}
SN_18 {
@ Minimum enclosed area of SN is 0.11
  AREA (((HOLES SN INNER) NOT SN) OUTSIDE INST) < 0.11
}
SRSN_18 {
@ Minimum enclosed area of SN is 0.0728
  X = AREA ((HOLES SN INNER) NOT SN) < 0.0728
 X NOT OUTSIDE INST 
}
/*
SN_19 {
@ Minimum enclosure of a SN beyond a N+ AA in PW is 0.02
  ENC ((NACT AND PW) NOT COIN EDGE PTAP) SN < 0.02 ABUT<90 REGION
}
SN_20 {
@ Minimum AA butted N-well contact enclosure by SN is 0.02
   ENC (NTAP NOT COIN EDGE PACT) SN < 0.02 ABUT<90 REGION
}
*/
SN_21 {
@ AA butted p-well contact minimum extension of SN is 0.08
  INT (PTAP COIN EDGE NACT) PTAP < 0.08 ABUT<90 REGION
}
//SN_20a covered by SP_21a
//SN_21a covered by SP_20a
SN_22 {
@ SN minimum width and length if the area touch with gate
  error = INT SN < 0.28 ABUT<90 OPPOSITE REGION
  error INTERACT GATE
}
//SRSN_2(0.12) covered by SRSN.1(0.135)




//=================================
//  SAB - Salicide Block DRC
//=================================

GROUP GSAB SAB_?

SAB_1 {
@ SAB minimum width is 0.20um
  INT SAB < 0.20 ABUT<90 SINGULAR REGION
}
SAB_2 {
@ Minimum space between two SABs is 0.20um
  EXT SAB < 0.20 ABUT<90 SINGULAR REGION
}
SAB_3 {
@ Minimum extension of related AA outside of SAB is 0.2um
  X =ENC SAB AA < 0.20 ABUT<90 SINGULAR REGION
X NOT OCOVL

}
SAB_4 {
@ Minimum space between SAB and AA is 0.15um
  EXT SAB AA < 0.15 ABUT<90 SINGULAR REGION
}
SAB_5 {
@ Minimum space between SAB and poly on AA is 0.24
  EXT SAB GATE < 0.24 ABUT<90 SINGULAR REGION
}
SAB_6 {
@ Minimum extension of SAB outside of poly on field oxide is 0.15
  ENC INTERGT SAB < 0.15 ABUT<90 REGION
}
SAB_7 {
@ Minimum space between SAB and CT is 0.18
 X= EXT SAB CT < 0.18 ABUT<90 SINGULAR REGION
 X NOT OCOVL
 (CT AND SAB) NOT OCOVL
}
SAB_8 {
@ Minimum extension of sAB outside of AA is 0.15
  X =ENC AA SAB < 0.15 ABUT<90 SINGULAR REGION
 X NOT OCOVL
}
/*
SAB_9 {
@ SAB overlap with SN/SP is 0.28
  INT SN SAB < 0.28 ABUT<90 SINGULAR REGION
  INT SP SAB < 0.28 ABUT<90 SINGULAR REGION
}
*/
SAB_10 {
@ SAB minimum area is 0.20
  AREA SAB < 0.20
}
SAB_10a {
@ SAB minimum enclosed area is 0.37
  AREA ((HOLES SAB INNER) NOT SAB) < 0.37
}
SAB_11 {
@ Minimum space between a SAB to ((GT not interact with SAB) on STI) is 0.2
  EXT SAB ((GT NOT INTERACT SAB) NOT (AA OR AADUM)) < 0.2 ABUT<90 SINGULAR REGION
}
/* This rule is covered by SAB_7 now.
SAB_12 {
@ CT in SAB region is not allowed
  AND CT SAB
}
*/
//Skip SAB.13 and SAB.14
SAB_15 {
@ Minimum resistor poly extension to SAB is 0.3. The resistor: GT interact RESP1
  ENC SAB (GT INTERACT RESP1) < 0.3 ABUT<90 SINGULAR REGION
}



//========================
//  CT - Contact DRC
//========================

GROUP GCT CT_?

//SQCT = RECTANGLE (CT NOT OUTSIDE INST) == 0.060 BY == 0.060
SQCT = RECTANGLE CT == 0.060 BY == 0.060
RECT = RECTANGLE (CT NOT OUTSIDE INST) == 0.060 BY == 0.160

CT_1 {
@CT.1	Fixed CT size (square shape)is 0.06.
   X = RECTANGLE CTi ASPECT ==1
    NOT RECTANGLE X == 0.060 BY == 0.060 
   
 }
CT.1a {
@ Non-square CT only allowed inside of [EFUSE, seal ring(MARKS), SRAM(INST)]
X = RECTANGLE CTi ASPECT ==1
Y = CT NOT X 
(Y NOT INSIDE (EFUSE OR INST)) NOT OCOVL
}

CT_2 {
@ Minimum space between two contacts is 0.080
@ SRCT_2, Minimum space between two contacts is 0.080
  EXT SQCT < 0.080 ABUT<90 SINGULAR REGION
}
CT_2a {
@ Minimum space between two contacts on different net is 0.11
 X = EXT SQCT < 0.11 ABUT<90 REGION NOT CONNECTED
  X OUTSIDE INST
}
SRCT_2a {
@ Minimum space between two contacts on different net is 0.088
  X = EXT SQCT < 0.088 ABUT<90 REGION NOT CONNECTED
  X NOT OUTSIDE INST
}
/*SRCT.101{
@ CT must be on AA or Poly 
 (SQCT NOT OUTSIDE INST) NOT (AA OR GT)
}*/
SRCT_102{
@ CT min space to V1 on different net is 0.075
X = EXT SQCT V1 <0.075 ABUT<90 REGION NOT CONNECTED
X NOT OUTSIDE INST
}

/*SRCT_105 {
@ CT touching INST distance to CT no touching INST is 0.10
  EXT (SQCT NOT OUTSIDE INST) (CT OUTSIDE INST) < 0.10 ABUT<90 SINGULAR REGION
}*/
CT_array = SIZE ( SIZE (SIZE SQCT BY 0.090) BY -0.30) BY 0.21
CT_3 {
@ CT array minimum space to CT array for run length > 0.34 um is 0.11
  X = EXT (CT_array OUTSIDE SRAM) < 0.11 ABUT<90 OPPOSITE REGION
  X WITH EDGE (LENGTH X > 0.34)
}
/*SRCT_3 {
@ CT array minimum space to CT array for run length > 0.000 um is 0.223
  EXT (CT_array NOT OUTSIDE INST) < 0.223 ABUT<90 OPPOSITE REGION
}*/
CT_3a {
@ Minimum space between two contacts in CT array is 0.08: contact array is larger or equal to 4x4 CT. 
@ Two contact regions whose space is within 0.12um at same M1 are considered to be in the same array.
  X = (SIZE (CT OUTSIDE SRAM) BY 0.060 OVERUNDER) AND M1
  Y = SIZE X BY 0.235 UNDEROVER
  Z = CT INTERACT Y
  (EXT Z < 0.08 ABUT<90 SINGULAR REGION) INSIDE M1
}
CT_4 {
@ Minimum space between AA region and contact overlap poly is 0.040
  EXT (INTERCT OUTSIDE INST) AA < 0.040 ABUT<90 SINGULAR REGION
}
SRCT_4 {
@ Minimum space between AA region and contact overlap poly is 0.032
  EXT ((SQCT NOT OUTSIDE INST) AND GT) AA < 0.032 ABUT<90 SINGULAR REGION
}
CT_5 {
@ 0.9/1.1/1.2V device minimum space between gate region and contact overlap AA is 0.040
  EXT (GATE OUTSIDE INST) (ACT_CT OUTSIDE INST) < 0.040 ABUT<90 SINGULAR REGION
}
SRCT_5 {
@ Minimum space between gate region and contact overlap AA is 0.028
 X = EXT GATE (SQCT AND AA) < 0.028 ABUT<90 SINGULAR REGION
 X NOT OUTSIDE INST
}
CT_5a {
@ 1.8/2.5V device minimum space between gate(enclosure by TG or DG) to contact overlap AA is 0.080
  EXT (GATE AND (DG OR TG)) ACT_CT < 0.080 ABUT<90 SINGULAR REGION
}
/*
CT_6 {
@ Minimum enclosure of an AA region beyond an AA CT region is 0.005
  ENC (CT INTERACT AA) AA < 0.005 ABUT<90 SINGULAR OUTSIDE ALSO
}
*/
CT_6abd {
@CT must be within AA (if CT touchs AA), and must meet rule (CT.6a or (CT.6b, CT.6c)) and CT.6d.
@ CT.6 CT.6a, CT.6b, CT.6c and CT.6d are not applicable for CT interacts with EFUSE(81;2) 
@The CT here is interacted with M1 and AA intersection.
@ CT enclosure by AA (four sides) >=0.01
@ CT enclosure by AA (exclude pick-up AA) for two opposite sides when either opposite sides<0.01m, >=0.005m >=0.03
@ CT enclosure by AA >=0.005
  (((CT OUTSIDE SRAM) INTERACT AA) NOT AA ) NOT EFUSE
  AAandM1 = ((AA NOT GT) AND M1) INTERACT (CT OUTSIDE SRAM)
  BadCT = RECTANGLE ENCLOSURE ((CT OUTSIDE SRAM) NOT TAP) AA   OUTSIDE ALSO
  GOOD 0.01 OPPOSITE  0.01 OPPOSITE 0.01 OPPOSITE 0.01 OPPOSITE
  GOOD 0.03 OPPOSITE 0.005 OPPOSITE  0.03 OPPOSITE 0.005 OPPOSITE 
 (BadCT INTERACT AAandM1)  NOT EFUSE
}
CT_6acd {
@ CT enclosure by AA (four sides) >=0.01
@ CT enclosure by pick-up AA for two opposite sides when either opposite sides<0.01m, >=0.005m.>=0.02
@ CT enclosure by AA  >=0.005
  AAandM1 = ((AA NOT GT) AND M1) INTERACT (CT OUTSIDE SRAM)
  BadCT = RECTANGLE ENCLOSURE ((CT OUTSIDE SRAM) AND TAP) AA   OUTSIDE ALSO
  GOOD 0.01 OPPOSITE 0.01 OPPOSITE 0.01 OPPOSITE 0.01 OPPOSITE
  GOOD 0.02 OPPOSITE 0.005 OPPOSITE  0.02  OPPOSITE 0.005 OPPOSITE
 (BadCT INTERACT AAandM1)  NOT EFUSE
}

/*SRCT_6a {
@ CT touching INST, Minimum CT enclosure by AA is -0.011
  CTintAA = (SQCT NOT OUTSIDE INST) INTERACT AA
  (SIZE CTintAA BY -0.011) NOT AA
}

CT_7 {
@ Minimum enclosure of a poly region beyond a poly CT region is 0.00
  (CT INTERACT GT) NOT GT
}
*/
CT_7ab {
@ CT must be within poly
@  per M1 and poly intersection containing a CT, must meet rule CT.7a or CT.7b
@ Minimum CT enclosure by poly is 0.01
@ Minimum CT enclosure by poly for two opposite sides is 0.02 when the either two opposite sides<=0.01um, >=0um, except EFUSE.
  (((CT OUTSIDE SRAM) INTERACT GT) NOT GT)  NOT EFUSE
  GTandM1 = (GT AND M1) INTERACT (CT OUTSIDE SRAM)
  BadCT = RECTANGLE ENCLOSURE (CT OUTSIDE SRAM) GT  OUTSIDE ALSO
  GOOD 0.01 OPPOSITE  0.01 OPPOSITE 0.01 OPPOSITE 0.01 OPPOSITE
  GOOD 0.02  0.00   0.02  0.00  
 (BadCT INTERACT GTandM1) NOT EFUSE
}
/*SRCT_7a {
@ Minimum CT enclosure by Poly is -0.003
  CTintGT = (SQCT NOT OUTSIDE INST) INTERACT GT
  (SIZE CTintGT BY -0.003) NOT GT
}*/
CT_8 {
@ Minimum CT(on AA) enclosure by SP is 0.03
  ENC ACT_CT SP < 0.030 ABUT<90 SINGULAR REGION
}
CT_9 {
@ Minimum CT(on AA) enclosure by SN is 0.03
  ENC ACT_CT SN < 0.030 ABUT<90 SINGULAR REGION
}
CT_10 {
@ CT overlap (gate or (STI not GT)) region is forbidden.  Waive the CT overlap gate in (LOGO, INDMY, MOMDMY). 
@ Waive the CT overlap STI for (CT straddles STI in INST). Waive rectangle CT in ( INST or EFUSE) violation of this rule.
  X1 = (CT AND GATE) OR (CT NOT ((AA OR AADUM) OR GT) )
  X2 =  (CT AND GATE) AND ((LOGO OR INDMY) OR MOMDMY)
  X3 =  (CT NOT (AA OR AADUM) ) AND INST
   ((X1 NOT  X2) NOT X3) NOT (RECT OR EFUSE)
}
/*
CT_11 {
@ AA contact located on SN/SP boundary is forbidden
  (ACT_CT INTERACT SN) INTERACT SP
}
*/
CT_11 {
@ It is not allowed that (CT not outside AA) touches or straddles on (SN or SP) edge
  X =CT NOT OUTSIDE AA
 (X INTERACT SN) NOT (CT INSIDE SN)  
 (X INTERACT SP) NOT (CT INSIDE SP)
}
CT_12 {
@ Non-salicided contacts are not allowed
  (CT AND SAB) NOT OCOVL
}
//CT_13 covered by CT_1, and offgrid,skew edge
#IFDEF RECOMMENDED YES
/*
CT_19_R {
@ Recommend to have redundant CT to prevent high contact resistance:
@ On the resistor connection.
@ Gate Source/Drain, and poly
@ For large transistor, spread the CT necessary for current all over the S/D area.
@ DRC highlight single CT connection
 X = ((HRP AND HRPDMY) AND SAB) AND GT
 X1 =((GT ENCLOSE X ) NOT X) ENCLOSE CT ==1   // HRP
  Z = (RESP1 AND SAB) AND GT 
X2 =((GT ENCLOSE Z ) NOT Z ) ENCLOSE CT ==1   //RESP1
Y = (SAB AND RESAA) AND AA 
X3 =((AA ENCLOSE Y) NOT Y)  ENCLOSE CT ==1 // RESAA
X4 =((AA ENCLOSE AAD) NOT AAD)  ENCLOSE CT ==1 //DIFRES
 X5 =(AA TOUCH NWRSTI) ENCLOSE CT ==1  // RESNWST
X6 =(HOLES (SAB ENCLOSE RESNWAA))  ENCLOSE CT ==1 // RESNWAA
X7= ((GT ENCLOSE GTP) NOT GTP)  ENCLOSE CT ==1 //PLRES
X8=(NSD OR PSD) ENCLOSE CT==1   
X9= ((GT ENCLOSE GATE) NOT GATE) ENCLOSE CT==1
((((((((X1 OR X2) OR X3) OR X4) OR X5) OR X6) OR X7) OR X8) OR X9 ) OUTSIDE SRAM

}*/
#ENDIF

//===========================================
//  SCT - Rectangle SCT in SRAM Layer DRC
//===========================================

GROUP GSRRCT SRRCT_?

SRRCT_101_102 {
@ Rectangle CT width is 0.06
@ Rectangle CT length is 0.16
  ((CT NOT OUTSIDE INST) NOT SQCT) NOT RECT
}
SRRCT_103 {
@ Rectangle CT min space to Rectangle CT is 0.074
  EXT RECT < 0.074 ABUT<90 SINGULAR REGION
}
/*SRRCT_104 {
@ Rectangle CT min space to CT no touching INST is 0.073
  EXT RECT (CT NOT INTERACT INST) < 0.073 ABUT<90 SINGULAR REGION
}*/
SRRCT_104c {
@ Rectangle CT min space to  CT INSIDE INST with touching prohibited is 0.07
  EXT RECT (CT INSIDE INST) < 0.07 ABUT>0<90 SINGULAR REGION
}
SCT_end = RECT COIN EDGE (LENGTH RECT == 0.06)
SCT_side = RECT NOT COIN EDGE SCT_end
SRRCT_106 {
@ Rectangle CT end min space to AA is 0.133(with run length>0)
  EXT SCT_end AA < 0.133 ABUT<90 REGION OPPOSITE 
}
SRRCT_106a {
@ Rectangle CT side min space to AA is 0.069
  EXT SCT_side AA < 0.069 ABUT<90 REGION
}
SRRCT_107 {
@ Rectangle CT end min space to Poly is 0.037
  EXT SCT_end GT < 0.037 ABUT<90 REGION
}
SRRCT_107a {
@ Rectangle CT side min space to Poly is 0.082
  EXT SCT_side GT < 0.082 ABUT<90 REGION
}
SRRCT_108 {
@ Rectangle CT min space to M1 is 0.057
  EXT RECT M1 < 0.057 ABUT<90 SINGULAR REGION
}


//==========================================================
// DMACRO / DMACRO for M1_6_6a_6b_6c Mn_6_6a_6b_6c TM_5_6_7
//==========================================================             
DMACRO Mn_6 MTLAY MTLEN MTWID MTSPA {
 MTW  = MTLAY WITH WIDTH > MTWID
 MTSi = EXT  MTW < MTSPA OPPOSITE REGION PARA ONLY
 MTS  = COPY MTSi 
 MTS WITH EDGE (LENGTH MTS > MTLEN)
}

DMACRO Mn_6a MTLAY MTLEN MTWID MTSPA {
 MTW  = MTLAY WITH WIDTH > MTWID
 MTSi = EXT MTLAY [MTW] < MTSPA OPPOSITE PARA ONLY
 MTS  = EXT MTLAY MTW < MTSPA OPPOSITE REGION PARA ONLY
 MTS WITH EDGE (LENGTH MTSi > MTLEN)
}

DMACRO Mn_6b MTLAY MTLEN MTW1 MTW2 MTSPA {
 MTWW1 = MTLAY WITH WIDTH > MTW1
 MTWW2 = MTLAY WITH WIDTH > MTW2
 MTSi  = EXT MTWW1 MTWW2 < MTSPA OPPOSITE REGION PARA ONLY
 MTS   = COPY MTSi
 MTS WITH EDGE (LENGTH MTS > MTLEN)
}

DMACRO Mn_6c MTLAY MTLEN MTW MTSPA {
 MTWW = MTLAY WITH WIDTH > MTW
 MTSi = EXT MTLAY [MTWW] < MTSPA OPPOSITE PARA ONLY
 MTS  = EXT MTLAY MTWW < MTSPA OPPOSITE REGION PARA ONLY  
 MTS WITH EDGE (LENGTH MTSi > MTLEN)
}

DMACRO TM56 MTLAY MTLEN MTWID MTSPA {
 X0_a = MTLAY WITH WIDTH >= MTLEN
 X0 = ENCLOSE RECTANGLE X0_a MTLEN MTWID
 X1 = EXT MTLAY < MTSPA OPPOSITE SPACE REGION PARA ONLY
 X2 = LENGTH X1 >= MTLEN
 X3 = X2 TOUCH EDGE X0
 X4_near = EXPAND EDGE X3 OUTSIDE BY MTWID
 X4_far  = (EXPAND EDGE X3 OUTSIDE BY (MTWID + 0.01)) NOT X4_near
 X5 = X4_near NOT MTLAY
 X6_near = EXT X1 X5 < MTWID OPPOSITE REGION
 X6_far  = EXT X4_far X5 < MTWID OPPOSITE REGION
 X7 = (X4_near NOT X5) NOT (X6_near OR X6_far)
 X7_edge = LENGTH (X7 COIN EDGE X1) >= MTLEN
 X7_expand = EXPAND EDGE X7_edge OUTSIDE BY MTSPA
 (X7_expand AND X1) NOT X5
}

DMACRO TM7 MTLAY MTLEN MTW1 MTW2 MTSPA {
 X0_a = MTLAY WITH WIDTH > MTLEN
 X0_1 = ENCLOSE RECTANGLE X0_a (MTLEN + 0.001) (MTW1 + 0.001)
 X0_2 = ENCLOSE RECTANGLE X0_a (MTW2 + 0.001) (MTLEN + 0.001)
 X1 = EXT X0_1 X0_2 < MTSPA OPPOSITE SPACE REGION PARA ONLY
 X2 = LENGTH X1 > MTLEN
 X3_1 = X2 TOUCH EDGE X0_1
 X3_2 = X2 TOUCH EDGE X0_2
 X4_1_near0 = EXPAND EDGE X3_1 OUTSIDE BY (MTW1 + 0.001)
 X4_1_near = SIZE (X4_1_near0 AND X0_1) BY ((MTLEN-0.1)/2.0) UNDEROVER
 X4_1_far  = (EXPAND EDGE X3_1 OUTSIDE BY (MTW1 + 0.01)) NOT X4_1_near0
 X4_1_real = X4_1_near WITH EDGE (LENGTH X4_1_far > MTLEN)
 X4_2_near0 = EXPAND EDGE X3_2 OUTSIDE BY (MTW2 + 0.001)
 X4_2_near = SIZE (X4_2_near0 AND X0_2) BY ((MTLEN-0.1)/2.0) UNDEROVER
 X4_2_far  = (EXPAND EDGE X3_2 OUTSIDE BY (MTW2 + 0.01)) NOT X4_2_near0
 X4_2_real = X4_2_near WITH EDGE (LENGTH X4_2_far > MTLEN)
 EXT X4_1_real X4_2_real < MTSPA OPPOSITE REGION PARA ONLY
}

MnPIN = ((((((M1PIN OR M2PIN) OR M3PIN) OR M4PIN) OR M5PIN) OR M6PIN) OR M7PIN) OR M8PIN
//=====================
//  M1 - Metal 1 DRC
//=====================

GROUP GM1 M1_?


M1_1 {
@ M1 minimum width is 0.07
  INT M1 < 0.07 ABUT<90 SINGULAR REGION
}
M1_2 {
@ M1 maximum width is 4.5
  Y1 = M1 NOT INDMY 
  Y2 = M1 AND INDMY
  Y1 WITH WIDTH >4.5
  X0= INT Y2 < 4.501 REGION
  X1= Y2 NOT X0
  X2= Y2 WITH WIDTH >4.5
  (X1 INTERACT X2) WITH WIDTH >4.5
}
M1_3 {
@ M1 minimum space is 0.07
  X = EXT M1 < 0.07 ABUT<89.99 SINGULAR REGION
  X OUTSIDE SRAM
}
SRM1_3sa {
@ M1 outter vertex to outter vertex distance is 0.064
 X = EXT (M1 NOT INDMY) < 0.064 ABUT<90 REGION CORNER TO CORNER
 X NOT OUTSIDE INST
}
M1_4 {
@ M1 minimum area (The INST connected area apply SRAM design rule) is 0.0196
  AREA (M1 OUT INST) < 0.0196
}
SRM1_4 {
@ M1 minimum area is 0.0168
 X = AREA M1 < 0.0168 
 X NOT OUTSIDE INST
}
M1_5 {
@ M1 minimum enclosed area is 0.2
  AREA ((HOLES M1 INNER) NOT M1) < 0.2
}  

M1_6 {
@ Minimum space between two length > 0.3 parallel metal lines 
@ with both metal line width is > 0.22 is 0.08
   CMACRO Mn_6 M1i 0.3 0.22 0.08
}

M1_6a {
@ Minimum space between two length > 0.6 parallel metal lines 
@ with one or both metal line width is > 0.7 is 0.12
  CMACRO Mn_6a M1i 0.6 0.7 0.12
}
M1_6b {
@ Minimum space between two length > 0.6 parallel metal lines with one metal
@ line width is > 0.22 and other metal line width is >0.7um is 0.14
  CMACRO Mn_6b M1i 0.6 0.22 0.7 0.14
}

M1_6c {
@ Minimum space between two length > 1.5 parallel metal lines with
@ one or both metal line width is >1.5um is 0.3
  CMACRO Mn_6c M1i 1.5 1.5 0.3
}

M1_7 {
@ CT must be within M1
 (SQCT NOT M1) OUTSIDE INST
}
M1_7bc_AA {
@  per (AA NOT GT) and M1 intersection containing a CT must meet rule M1.7b or M1.7c
@ M1 minimum overlap past CT for two opposite sides with the other two sides >=0um is 0.025
@ Or all 4 sides with enlcosure of 0.015 is also correct.
 AAandM1 = ((AA NOT GT) AND M1) INTERACT (CT OUTSIDE INST)
 BadCT = RECTANGLE ENCLOSURE (CT OUTSIDE INST)  M1 SINGULAR
 GOOD 0 0.025 0 0.025
 GOOD 0.015 OPPOSITE 0.015 OPPOSITE 0.015 OPPOSITE 0.015 OPPOSITE
 BadCT INTERACT AAandM1
}
M1_7bc_GT {
@  per Poly and M1 intersection containing a CT must meet rule M1.7b or M1.7c
@ M1 minimum overlap past CT for two opposite sides with the other two sides >=0um is 0.025
@ Or all 4 sides with enlcosure of 0.015 is also correct.
 GTandM1 = (GT AND M1) INTERACT (CT OUTSIDE INST)
 BadCT = RECTANGLE ENCLOSURE (CT OUTSIDE INST)  M1 SINGULAR
 GOOD 0 0.025 0 0.025
 GOOD 0.015 OPPOSITE 0.015 OPPOSITE 0.015 OPPOSITE 0.015 OPPOSITE
 BadCT INTERACT GTandM1
}
M1_7e {
@ CT minimum enclosure by M1 (M1 width > 0.7um) is 0.03um.
WM1 = M1 WITH WIDTH > 0.7
 X = ENC SQCT WM1 < 0.03 OPPOSITE REGION
 Y =  CT INTERACT X
 ENC Y M1 <0.03 OPPOSITE REGION
}




SRM1_7ab {
@ CT minimum within M1 is 0
@ M1 minimum overlap past CT for two opposite sides with either side >=0um and <0.015um is 0.012, not applicable to share contact
 ((CT NOT OUTSIDE INST) NOT RECT) NOT INSIDE M1  
  RECTANGLE ENCLOSURE ((CT NOT OUTSIDE INST) NOT RECT) M1 ABUT <90 SINGULAR
  GOOD  0.0  0.012   0.0  0.012
  }
M1_8 {
@ M1 density (%) in 110m * 110m window with step size 55m is 10%
  X = DENSITY (M1i OR M1DUM) < 0.10 WINDOW 110 STEP 55 BACKUP PRINT density_report_M1_8.log RDB density_report_M1_8.db
  X NOT MARKG
}
M1_8a {
@ M1maximum density (%) in 110m *110m window with step size 55m is 85%
  X = DENSITY (M1i OR M1DUM) > 0.85 WINDOW 110 STEP 55 BACKUP PRINT density_report_M1_8a.log RDB density_report_M1_8a.db 
  X NOT MARKG
}
M1_8b {
@ M1 maximum density difference(%) between any two 200um adjacent window (stepped without overlapping) is 50%
  X = DENSITY (M1i OR M1DUM) >= 0 WINDOW 200 GRADIENT > 0.5 ABSOLUTE BACKUP PRINT density_report_M1_8b.log  RDB density_report_M1_8b.db
  X NOT MARKG
}
M1_8c {
@ M1 maximum density(%) with 840um*840um window is 70%
  X = DENSITY (M1i OR M1DUM) > 0.7 WINDOW 840 BACKUP PRINT density_report_M1_8c.log RDB density_report_M1_8c.db 
  X NOT MARKG
}

M1_8d{
@ M1 density over the whole chip is >=20%
X = DENSITY (M1i OR M1DUM) <0.2  PRINT density_report_M1_8d.log  RDB density_report_M1_8d.db
X NOT MARKG
}
M1_9 {
@ (M1 at 45degree ) minimum width (run length>0um) is 0.17
   M145 = ANGLE M1 == 45
   INT M145 < 0.17 OPPOSITE REGION
}	
M1_10 {
@ (M1 at 45degree) minimum space to parallel M1 (run length>0um) is 0.17
  M145 = ANGLE M1 == 45
  EXT M145 M1 < 0.17 OPPOSITE REGION PARALLEL ONLY
} 
M1END = CONVEX EDGE M1 ANGLE1 ==90 LENGTH1 >=0.08 ANGLE2  ==90 LENGTH2  >=0.08 WITH LENGTH  <=0.11 
M1.11a {
@Minimum space between an M1 line end to an M1 line (the parallel run length >0um) is 0.07
 EXT M1END M1<0.07 OPPOSITE REGION 
}
M1.11b{
@Minimum space between an M1 line end (with (CT or V1)) to an M1 (the parallel run length >0um) is 0.07, when this M1 line end extend Q from (CT or V1),0.03 <= Q <0.05um 
X1 = EXT M1END  M1 <0.07 OPPOSITE REGION
X2 = M1END COIN EDGE X1 
X3 = ENC (CT OR V1) X2 <0.05 OPPOSITE REGION
X4 = ENC (CT OR V1) X2 <0.03 OPPOSITE REGION
X5 = (CT OR V1) INTERACT X3  
X6 = (CT OR V1) INTERACT X4
X7 = X5 NOT X6
X1 TOUCH (X3 INTERACT X7)
}
/*M1.11c {
@Minimum space between an M1 line end (with  (CT or V1)) to an M1 (the parallel run length >0um) is 0.1, when this M1 line end extend Q from  (CT or V1),  0 <= Q <0.03um 
X1 = EXT M1END  M1 <0.1 OPPOSITE REGION
X2 = M1END COIN EDGE X1 
X3 = ENC (CT OR V1) X2 <0.03 ABUT<90 OPPOSITE REGION
X4 = (CT OR V1) INTERACT X3
X1 TOUCH (X3 INTERACT X4)
}
M1.12 {
@ M1.12	Minimum space between V1 (the V1 distance E to M1[A] line end, E <= 0.08um) to neighbouring metal M1[B] line is 0.14, the parallel run length of the V1 and the metal M1[B] line >0um; 
@ Waive if there is redundant V1 in the M1[A] and M2 intersection. 	
 X1 =ENC V1 M1END <=0.08 ABUT<90 REGION
 X2 = V1 INTERACT X1 
 X3 = X2 INSIDE (M1 AND M2) 
 X4 = EXT  X3 (M1 NOT COIN EDGE M1END) <0.14 ABUT<90 OPPOSITE REGION
 X5 = V1 INTERACT X4
 X6 = V1 NOT X5
 X7 = ((M1 AND M2) ENCLOSE X5) ENCLOSE X6
 (X4 NOT INTERACT X7) INTERACT  (X1 AND X4 )
 X8 = X3 TOUCH INSIDE EDGE  M1END
 X9 = EXT X8 (M1 NOT COIN EDGE M1END) <0.14 ABUT<90 OPPOSITE REGION
 X10 = V1 INTERACT X9 
 X11 = V1 NOT X10
 X12 = ((M1 AND M2) ENCLOSE X10) ENCLOSE X11
 X9 NOT INTERACT X12
}
M1_13 {
@ Minimum space CT to M1 is 0.14, when the M1 and adjacent M1 meet the following conditions:
@ 1.	M1(enclosed CT) width >=0.11um
@ 2.	M1(enclosed CT) to adjacent M1 space <=0.08um
@ 3.	The projection parallel run length of M1(enclosed CT) and adjacent M1 >=0.27um.  For metal extrusion E < 0.12, the portion is treated as same flat metal.
@ Waive if there is redundant CT in the same [(M1 and AA intersection) or (M1 and GT) intersection]
 X0 = EXT M1  X1 <= 0.08 ABUT <90 opposite REGION
 X1 = (M1 ENCLOSE CT) WITH WIDTH >=0.11	
gaps  = ext X1 M1 < 0.2  opposite region exclude shielded
gaps_edge = gaps COIN EDGE X1
edges_check1 = ext X1 M1 < 0.2  opposite exclude shielded
gap1 = dfm property gaps edges_check1 overlap abut also multi
  [ wmax = max(ew(edges_check1)) ]
  [ wmin = min(ew(edges_check1)) ]
  [ l    = sum(ec(edges_check1)) ]>=0.27
  [ -= max(ew(edges_check1)) - min(ew(edges_check1)) ]  <= 0.12
gap = gap1  OR ( X0 with edge (length X0 >=0.27 ))
X2 = (gap INTERACT X1) INTERACT X0
X3 = CT INSIDE ((M1 AND AA) OR (M1 AND GT))
X4 = EXT (X3 INSIDE X1) (M1 INTERACT X2) < 0.14 ABUT <90 OPPOSITE REGION measure all 
X6 = X3  INTERACT X4 
X7 = X3 NOT X6    
X8 = ( ((M1 AND AA) OR (M1 AND GT)) ENCLOSE X6) ENCLOSE X7 
X5 =((((X4 INTERACT M1) INTERACT (X2 AND X4) ) INTERACT X1) INTERACT (X0 AND X4)) NOT INTERACT  X8
X5 OUTSIDE INST 
}*/

M1_13 {
@ Minimum space CT to M1 is 0.085, when the M1 and adjacent M1 meet the following conditions:
@ 1.	M1(enclosed CT) width >0.12um
@ 2.	M1(enclosed CT) to adjacent M1 space <=0.08um
@ 3.	The projected parallel run length R of M1[A] to M1[B]. R >= 0.27um
@ Waive if there is redundant CT in the same {(M1[A] and AA intersection) or (M1[A] and GT intersection) } 
X = EXT  M1 [X1] <= 0.08  ABUT <90 OPPOSITE  
X0 = EXT M1 X1 <= 0.08 ABUT <90 OPPOSITE REGION 
X01= M1 ENCLOSE CT ==1
X1 = X01 WITH WIDTH >0.12
gap =  X0 with edge (length X >0.27 )
X2 = (gap INTERACT X1) INTERACT X0
X3 = CT INSIDE ((M1 AND AA) OR (M1 AND GT))
X4 = EXT (X3 INSIDE X1) (M1 INTERACT X2) < 0.085 ABUT <90 OPPOSITE REGION measure all
Y = EXPAND EDGE (length X >0.27 ) OUTSIDE BY 0.001
X5 =((((X4 INTERACT M1) INTERACT (X2 AND X4) ) INTERACT X1) INTERACT (X0 AND X4) ) INTERACT (Y AND X4)
X5 OUTSIDE INST
}  
M1_14 {
@ Minimum M1 to M1 space S at M1 line-end. Width W < W0. The minimum space can be line end head to other M1 or line end side to other M1.  Rule check:
@ S >= (Dh or Ds ).  E1 =0.02, K1=0.065, W0=0.09um, Dh=Ds=0.08 in the illustration.
@Schematics Extension 1, Extension 2, and Extension 3:
@1 Three extensions overlaps with other M1=> NG
@2. When Extension 1 and one of the (extension 2 or extension 3) overlap with other M1.  
@The remaining side extension's Ds need to size up from 0.08 to 0.11um. If this remaining extension interact with other M1(include touch edge), NG.
@ Outside of SRAM(INST) area.
@ Waive extrusion F < 0.07.
@Only Highlight either one of the situations:
@1) There is only one CT in the same {(M1[A] and AA intersection) or (M1[A] and GT intersection) } and CT space to M1[B] Sh <0.10m.
@2) there is only one V1 in the M1[A] and M2 intersection, and V1 space to M1[B] Sh<0.10m
INTER_MA= ((M1 AND GT) OR (M1 AND AA )) ENCLOSE CT==1
CT_INTER = CT INSIDE INTER_MA
CT_EDGE = ENC  [CT_INTER] LINE_END <0.1 ABUT<90 OPPOSITE
CT_EDGE1 =EXT [CT_EDGE] M1 <0.1 ABUT<90  OPPOSITE  measure all  
CT_SING =CT_INTER  WITH EDGE CT_EDGE1

INTER_MT= (M1 AND M2)  ENCLOSE V1==1
V1_INTER = V1 INSIDE INTER_MT
V1_EDGE = ENC  [V1_INTER] LINE_END <0.1 ABUT<90 OPPOSITE
V1_EDGE1 =EXT [V1_EDGE] M1 <0.1 ABUT<90  OPPOSITE  measure all  
V1_SING =V1_INTER  WITH EDGE V1_EDGE1

LINE_END = CONVEX EDGE (M1 INTERACT (INTER_MA OR INTER_MT)) ANGLE1 ==90 LENGTH1 >=0.07 ANGLE2  ==90 LENGTH2  >=0.07 WITH LENGTH  < 0.09
LINE_END_SHAPE = EXPAND EDGE LINE_END INSIDE BY 0.044
LINE_SIDE = (M1 COIN EDGE LINE_END_SHAPE ) NOT COIN EDGE LINE_END
LINE_END_EXP = EXPAND EDGE LINE_END INSIDE BY 0.001 EXTEND BY 0.021
LINE_SIDE_EXP = EXPAND EDGE LINE_SIDE INSIDE BY 0.001 EXTEND BY 0.021
LINE_END_1 = LINE_END_EXP TOUCH EDGE LINE_END
LINE_SIDE_1 = LINE_SIDE_EXP TOUCH EDGE LINE_SIDE
E1 = EXT [LINE_END_1] M1 < 0.08 OPPOSITE PERP ALSO OBTUSE ALSO
E2 = EXT [LINE_SIDE_1] M1 < 0.08  OPPOSITE PERP ALSO OBTUSE ALSO
E3 = EXT [LINE_SIDE_1] M1 <= 0.11  OPPOSITE PERP ALSO OBTUSE ALSO
LINE_END_E1 = LINE_END_1 TOUCH EDGE E1
LINE_SIDE_E2 = LINE_SIDE_1 TOUCH EDGE E2
LINE_SIDE_E3 = LINE_SIDE_1 TOUCH EDGE E3
M1_CORNER = INT LINE_END_E1 LINE_SIDE_E2 <= 0.002 ABUT==90 REGION
M2_CORNER = INT LINE_END_E1 LINE_SIDE_E3 <= 0.002 ABUT==90 REGION
M_CORNER2 = (EXPAND EDGE LINE_END OUTSIDE BY 0.001) INTERACT  M1_CORNER ==2  // 0.08
M_CORNER3 = ((EXPAND EDGE LINE_END OUTSIDE BY 0.001) INTERACT (M2_CORNER NOT M1_CORNER)) INTERACT M1_CORNER   // 0.08 0.11
((LINE_END_SHAPE INTERACT (M_CORNER2 OR M_CORNER3)) INTERACT (CT_SING OR V1_SING) ) OUTSIDE INST
}

DMACRO V67D VLAY M_WIDE M_OTHER {
 X0_M_W = M_WIDE WITH WIDTH > 0.14
 X0_M_AND = ENCLOSE RECTANGLE (M_WIDE AND M_OTHER) 0.07 0.27
 X0_M_AND_W = X0_M_AND INTERACT X0_M_W
 X0_M_AND_W INTERACT VLAY  == 1
}

//========================
//  V1 - Via 1 DRC
//========================

GROUP GV1 V1_?

V1_1 {
@ Fixed V1 size is 0.07
  NOT RECTANGLE V1 == 0.07 BY == 0.07
}
V1_2 {
@ Space between two V1 is 0.07
  EXT V1 < 0.07 ABUT<90 SINGULAR REGION
}
V1_array = SIZE (SIZE V1 BY 0.05 OVERUNDER) BY 0.150 UNDEROVER
V1_GAP1 = V1_array NOT M1
V1_GAP2 = V1_array NOT M2
V1_3 {
@ Min Space between two V1 regions is 0.09 (with run length>=0) at least in two sides, in case V1 array is larger than or equal to 3x3.
@ Two via areas whose space is within 0.1 um are considered to be in the same array.
  X = EXT (V1 INTERACT V1_array) V1< 0.090 OPPOSITE EXTENDED  0.001  REGION 
   Y =SIZE V1 BY 0.001
  (Y INTERACT  V1_array)  INTERACT (X NOT Y) >2
}
/*
V1_4 {
@ V1_array not touching MOMDMY maximum width is 0.85
  (WITH WIDTH V1_array > 0.85) NOT INTERACT MOMDMY
}
*/
V1_5 {
@ V1 (different net)(outside of SRAM)  minimum space for run length > 0um is 0.1
 X =EXT V1 < 0.1 NOT CONNECTED OPPOSITE REGION
X OUTSIDE INST
}
V1_5a {
@ V1 (different net) minimum space is 0.09
  EXT V1 < 0.09  NOT CONNECTED REGION
  
}

/*V1.5b {
@ V1 minimum space in different net inside of SRAM is 0.09
   EXT (V1 NOT OUTSIDE INST)< 0.09 NOT CONNECTED REGION
}*/

V1_6abc {
@ V1 must be within M1
@ per M1 and M2 intersection containing a V1, must meet rule V1.6a, V1.6b or V1.6c
@ V1.6a, V1 minimum within M1 is 0.015
@ V1.6b, M1 minimum overlap past V1 for two opposite sides with the other two sides >= 0.01um is 0.02
@ V1.6c, M1 minimum overlap past V1 for two opposite sides with the other two sides >= 0um is 0.03
   V1  NOT INSIDE M1
  M1andM2 = (M1 AND M2) INTERACT (V1 OUTSIDE INST) 
  BadV1 = RECTANGLE ENCLOSURE (V1 OUTSIDE INST) M1  OUTSIDE ALSO
  GOOD 0.015 OPPOSITE 0.015  OPPOSITE 0.015 OPPOSITE 0.015 OPPOSITE
  GOOD 0.02 OPPOSITE 0.01 OPPOSITE  0.02 OPPOSITE 0.01 OPPOSITE
  GOOD 0.03  0  0.03  0 
  BadV1 INTERACT M1andM2
}

SRV1_6ac {
@ M1 minimum overlap past V1 for two opposite sides with the other two sides >= 0um is 0.015
  RECTANGLE ENCLOSURE (V1 NOT OUTSIDE INST) M1 ABUT <90 SINGULAR
  GOOD 0.015 OPPOSITE 0.0 0.015 OPPOSITE 0.0
}
/*V1_6d {
@ V1 touching M1 with width > 0.14um, with at least one redundant V1.
@ This rule only applies to that M1/M2 intersection area can enclose a rectangle of 0.07*0.27.
 CMACRO V67D V1 M1 M2
}*/
V1_7abc {
@ V1 must be within M2
@ M1 and M2 intersection containing a V1, must meet rule V1.7a, V1.7b or V1.7c
@ V1.7a, V1 minimum within M2 is 0.015
@ V1.7b, M2 minimum overlap past V1 for two opposite sides with the other two sides >= 0.01um is 0.02
@ V1.7c, M2 minimum overlap past V1 for two opposite sides with the other two sides >= 0um is 0.03
  V1 NOT M2
  M1andM2 = (M1 AND M2) INTERACT V1
  BadV1 = RECTANGLE ENCLOSURE V1  M2  OUTSIDE ALSO
  GOOD 0.015 OPPOSITE  0.015  OPPOSITE  0.015 OPPOSITE 0.015 OPPOSITE
  GOOD 0.02 OPPOSITE 0.01 OPPOSITE  0.02 OPPOSITE 0.01 OPPOSITE
  GOOD 0.03 0  0.03 0 
  BadV1 INTERACT M1andM2
}
/*SRV1_7 {
@ M2 minimum overlap past V1 for two opposite sides with the other two sides >=0 is 0.025
  RECTANGLE ENCLOSURE (V1 NOT OUTSIDE INST) M2 ABUT <90 SINGULAR
  GOOD 0.025 0.0 0.025 0.0
}
V1_7d {
@ V1 touching M2 with width > 0.14um, with at least one redundant V1.
@ This rule only applies to that M1/M2 intersection area can enclose a rectangle of 0.07*0.27.
 CMACRO V67D V1 M2 M1
}

V1_8 {
@ At least two V1 vias must connect M1 to M2 when the M1 or M2 width is > 0.26um  
  WM1 = WITH WIDTH M1 > 0.260
  WM2 = WITH WIDTH M2 > 0.260
  (M1 AND WM2) INTERACT V1 >0<2
  (WM1 AND M2) INTERACT V1 >0<2
}
*/
V1_8 {
@ At least two V1 vias must connect M1 to M2 when the M1 or M2 width is > 0.26um
  mx_wide =  WITH WIDTH M1 > 0.260
  my_wide =  WITH WIDTH M2 > 0.260
  mx_my_wide = mx_wide OR my_wide
  vx_612 = (V1 OUTSIDE SRAM) INTERACT mx_my_wide
  mx_my_612 = ((M1 AND M2) OUTSIDE SRAM) ENCLOSE vx_612
  mx_my_612 ENCLOSE V1 < 2
}
V1_9 {
@ At least three V1 vias must connect M1 to M2 when the M1 or M2 width is > 0.52um
  WM1 = WITH WIDTH M1 > 0.520
  WM2 = WITH WIDTH M2 > 0.520
  encVia = V1 INTERACT (WM1 OR WM2)
  ((M1 AND M2) ENCLOSE encVia) ENCLOSE V1 < 3
}
V1_10 {
@ At least four V1 vias must connect M1 to M2 when the M1 or M2 width is > 0.645um
  WM1 = WITH WIDTH M1 > 0.645
  WM2 = WITH WIDTH M2 > 0.645
  encVia = V1 INTERACT (WM1 OR WM2)
  ((M1 AND M2) ENCLOSE encVia) ENCLOSE V1 < 4
}
V1_square = RECTANGLE V1 ASPECT ==1
LAYER MAP 999 DATATYPE 1111 4321
LAYER EMPTY 4321
V1_EMPTY = EMPTY  OR (V1 INSIDE (M1 AND M2) ) 
INTER_EMPTY =EMPTY OR (M1 AND M2)  
CONNECT  V1_EMPTY INTER_EMPTY

V1_16 {
@ At least two V1s with space <=0.16m or three V1s with space <= 0.65um when one of  M1 or M2 with both length and width>0.24m. (exclude SRAM area to check)
X1a = WITH WIDTH M1  >0.24
X1b = WITH WIDTH M2  >0.24
WIDE = X1a OR X1b
X2 = (M1 AND M2) ENCLOSE V1
X3 =  V1 INSIDE X2 
X5c = EXT (V1_EMPTY INSIDE WIDE) V1_EMPTY <=0.16 ABUT<90 REGION CONNECTED   // space of via <= 0.16 
X6c = X2 ENCLOSE X5c   // good intersection with space of Via <= 0.16
X7= ((SIZE X3 BY 0.325) AND X2) ENCLOSE V1 >2
X7c= X2 ENCLOSE X7
X = ((X2 NOT X6c) NOT X7c) ENCLOSE (V1 INSIDE WIDE) // Via_16
X  OUTSIDE INST
}

CONNECT V1 M1
WM1 = M1 WITH WIDTH > 0.24
WM1_EDGE = LENGTH WM1 > 0
WM1_EXP = EXPAND EDGE WM1_EDGE OUTSIDE BY 1.1  
V1_A = V1_square INTERACT WM1_EXP 
CONNECT V1_A M1
CONNECT WM1 M1

WM2 = M2 WITH WIDTH > 0.24
WM2_EDGE = LENGTH WM2 > 0
WM2_EXP = EXPAND EDGE WM2_EDGE OUTSIDE BY 1.1
WM2_L1 = ( M2 not WM2 ) TOUCH WM2
V1_A2 = V1_square INTERACT WM2_EXP
CONNECT V1 M2
V1_A2_EMPTY = EMPTY  OR V1_A2 
M2_EMPTY  =EMPTY OR M2
WM2_EMPTY =EMPTY OR WM2 
CONNECT V1_A2_EMPTY  M2_EMPTY
CONNECT WM2_EMPTY M2_EMPTY

V1_17 {
@ At least two V1s  when either wide metal of M1 or M2 with both length L>0.24um and width W>0.24um, and the distance D<=1.1um away from this wide metal.Exclude non-square Vn and SRAM area.
WM1_L1 = ( M1 NOT WM1 ) TOUCH WM1
M1_ENCWM = (M1 INTERACT WM1) INTERACT V1_A
WM1_VEDGE = EXT [M1_ENCWM]  <1.1 ABUT<90 OPPOSITE NOTCH
WM1_EXT1 = EXT (WM1 COIN EDGE WM1_VEDGE) [V1_A] < 1.1 ABUT>=0 <90  OPPOSITE CONNECTED 
WM1_EXT2 = (EXT WM1 V1_A < 1.1 ABUT>=0 <90  OPPOSITE REGION CONNECTED ) INSIDE M1  
V1_B = V1_square WITH EDGE WM1_EXT1
X1 =(M1 AND M2) ENCLOSE V1_square >1
X2 = ((M1 AND M2)  AND ( WM1_L1 AND WM1_EXP )) NOT X1 
Y0=(M1 AND M2) ENCLOSE V1_square ==1 
Y1 = SIZE (V1_square INTERACT Y0) BY 1.1 INSIDE OF M1 STEP 0.005  
Y2= Y1 INTERACT (Y1 AND WM1)
VSING1= ((X2 INTERACT V1_B ==1) INTERACT Y2) OR ((X2 INTERACT WM1_EXT2) INTERACT V1_A)
VSING1 OUTSIDE INST 

M2_ENCWM = (M2 INTERACT WM2) INTERACT V1_A2
WM2_VEDGE = EXT [M2_ENCWM]  <1.1 ABUT<90 OPPOSITE NOTCH
WM2_EXT1 = EXT (WM2_EMPTY COIN EDGE WM2_VEDGE) [V1_A2_EMPTY] < 1.1 ABUT>=0 <90  OPPOSITE CONNECTED 
WM2_EXT2 = (EXT WM2_EMPTY V1_A2_EMPTY < 1.1 ABUT>=0 <90  OPPOSITE REGION CONNECTED ) INSIDE M2  
V1_B2 = V1_square WITH EDGE WM2_EXT1
X3 = ((M1 AND M2)  AND ( WM2_L1 AND WM2_EXP )) NOT X1 
Y3 = SIZE (V1_square INTERACT Y0) BY 1.1 INSIDE OF M2 STEP 0.005  
Y4= Y3 INTERACT (Y3 AND WM2)
VSING2= ((X3 INTERACT V1_B2 ==1) INTERACT Y4) OR (( X3 INTERACT WM2_EXT2) INTERACT V1_A2)
VSING2 OUTSIDE INST
}

//=====================
//  M2 - Metal 2 DRC
//=====================

GROUP GM2 M2_?

M2_1 {
@ M2 minimum width is 0.07
  INT M2 < 0.07 ABUT<90 SINGULAR REGION
}
M2_2 {
@ M2 maximum width is 4.5
  M2 WITH WIDTH > 4.50
}
M2_3 {
@ M2 minimum space is 0.07
  X = EXT M2  < 0.07 ABUT<90 SINGULAR REGION
  X OUTSIDE INST 
}
SRM2_3 {
@ M2 minimum space is 0.065
  X =EXT M2 < 0.065 ABUT<90 SINGULAR REGION
  X NOT OUTSIDE INST
}
M2_4 {
@ M2 minimum area(The INST connected area apply SRAM design rule) is 0.0196
  AREA (M2 OUT INST) < 0.0196
}
SRM2_4 {
@ M2 minimum area is 0.0192
  X =AREA M2 < 0.0192 
  X  NOT OUTSIDE INST
}
M2_5 {
@ M2 minimum enclosed area is 0.2
  AREA ((HOLES M2 INNER) NOT M2) < 0.2
}

M2_6 {
@ Minimum space between two length > 0.3 parallel metal lines
@ with  both metal line width is > 0.22 is 0.10
   CMACRO Mn_6 M2i 0.3 0.22 0.1
}

M2_6a {
@ Minimum space between two length > 0.6 parallel metal lines
@ with one or both metal line width is > 0.7 is 0.12
   CMACRO Mn_6a M2i 0.6 0.7 0.12
}
M2_6b {
@ Minimum space between two length > 0.6 parallel metal lines with one metal
@ line width is > 0.22 and other metal line width is >0.7um is 0.14
   CMACRO Mn_6b M2i 0.6 0.22 0.7 0.14
}

M2_6c {
@ Minimum space between two length > 1.5 parallel metal lines
@ with one or both metal line width is > 1.5 is 0.30
   CMACRO Mn_6c M2i 1.5 1.5 0.3
}
M2_7 {
@ Mn density (%) in 110m x 110m window with step size 55m is 10%
  X = DENSITY (M2i OR M2DUM) < 0.10 WINDOW 110 STEP 55 BACKUP PRINT density_report_M2_7.log RDB density_report_M2_7.db
  X NOT MARKG
}
M2_7a {
@ Mn density (%) in 110m x 110m window with step size 55m is	85%
  X = DENSITY (M2i OR M2DUM) > 0.85 WINDOW 110 STEP 55 BACKUP PRINT density_report_M2_7a.log RDB density_report_M2_7a.db
  X NOT MARKG
}
M2_7b {
@ M2 maximum density difference(%) between any two 200um adjacent window (stepped without overlapping) is 50%
  X = DENSITY (M2i OR M2DUM) >= 0 WINDOW 200 GRADIENT > 0.5 ABSOLUTE BACKUP PRINT density_report_M2_7b.log RDB density_report_M2_7b.db
  X NOT MARKG
}
M2_7c {
@ M2 maximum density(%) with 840um*840um window is 70%
  X = DENSITY (M2i OR M2DUM) > 0.7 WINDOW 840 BACKUP PRINT density_report_M2_7c.log RDB density_report_M2_7c.db 
  X NOT MARKG
}
M2_7d {
@ [(M2 with width > 2.8um) over M1] maximum density(%) with 200um*200um is 70%
X = DENSITY (((M2i WITH WIDTH > 2.800) OR (M2DUM WITH WIDTH > 2.800)) AND (M1i OR M1DUM)) > 0.7 WINDOW 200 STEP 100 BACKUP PRINT density_report_M2_7d.log RDB density_report_M2_7d.db
 X NOT MARKG
}
M2_7e {
@ [(M1 with width > 2.8um) over M2] maximum density(%) with 200um*200um is 70%
X = DENSITY ((M2i OR M2DUM) AND ((M1i WITH WIDTH > 2.80) OR (M1DUM WITH WIDTH > 2.80)) ) > 0.7 WINDOW 200 STEP 100 BACKUP PRINT density_report_M2_7e.log RDB density_report_M2_7e.db
  X NOT MARKG
}
M2_7f{
@ Mn density over the whole chip is >=20%
X =DENSITY (M2i OR M2DUM)< 0.2 PRINT density_report_M2_7f.log
X NOT MARKG
}
M2_8 {
@ (M2 at 45degree ) minimum width (run length>0um) is 0.17
   M245 = ANGLE M2 == 45
   INT M245 < 0.17 OPPOSITE REGION
}
M2_9 {
@ (M2 at 45degree) minimum space to parallel M2 (run length>0um) is 0.17
  M245 = ANGLE M2 == 45
  EXT M245  < 0.17 OPPOSITE REGION
}
M2END = CONVEX EDGE M2 ANGLE1 ==90 LENGTH1 >=0.08 ANGLE2  ==90 LENGTH2  >=0.08 WITH LENGTH  <=0.11 
M2.10a {
@ Space between a Mn line end to a Mn (the parallel run length >0m)
@ Excluding checking SRAM area
X =EXT M2END M2<0.07 OPPOSITE REGION
X  OUTSIDE INST 
}
M2.10b{
@ Minimum space between an Mn line end (with Vn) to an Mn (the parallel run length >0um) is 0.07. The Mn line end extend Q from Vn, 0.03 <= Q <0.05um 
X1 = EXT M2END  M2 <0.07 OPPOSITE REGION
X2 = M2END COIN EDGE X1 
X3 = ENC  V2 X2 <0.05 OPPOSITE REGION
X4 = ENC V2 X2 <0.03 OPPOSITE REGION
X5 = V2 INTERACT X3  
X6 = V2 INTERACT X4
X7 = X5 NOT X6
X =X1 TOUCH (X3 INTERACT X7)
X OUTSIDE INST
}
/*M2.10c{
@ Minimum space between an Mn line end (with Vn) to an Mn (the parallel run length >0um ) is 0.1. The Mn line end extend Q from Vn, 0 <= Q <0.03um 
X1 = EXT M2END  M2 <0.1 OPPOSITE REGION
X2 = M2END COIN EDGE X1 
X3 = ENC  V2 X2 <0.03 ABUT<90 OPPOSITE REGION
X4 = V2 INTERACT X3
X1 TOUCH (X3 INTERACT X4)
}*/

M2_11 {
@ Space between Vn-1 (Vn-1 is enclosed by Mn[A]) to neighbouring metal line Mn[B], when the layout structures meet the following conditions:
@ 1.	Mn[A] line end definition: line width W <0.1m. 
@ 2.	Vn-1 enclosure by Mn[A] line end: E < 0.05m
@ 3.	The parallel run length of Mn[A] and Mn[B]:E1 >=-0.03m
@ 4.	Space between Mn[A] to the neighbouring parallel metal line: Ds<0.08m;
@ 5.	Any one edge distance from the corner of the two edges of Mn[A]: K1 <0.095m
@ At least one Vn-1 in the Mn[A] and Mn-1 intersection meet this rule is ok.
@ This rule is not applicable for SRAM region DRC check.		0.12
LINE_END = CONVEX EDGE M2 ANGLE1 ==90 LENGTH1 >=0.08 ANGLE2  ==90 LENGTH2  >=0.08 WITH LENGTH  <0.1
 X1 =ENC V1  LINE_END<0.05 ABUT<90 REGION OPPOSITE
 X2 = V1 INTERACT X1 
 X3 = X2 INSIDE (M1 AND M2)
 X8 =X3 TOUCH EDGE X1
LINE_END_SHAPE = EXPAND EDGE LINE_END INSIDE BY 0.095
LINE_SIDE = (M2 COIN EDGE LINE_END_SHAPE ) NOT COIN EDGE LINE_END
LINE_SIDE1 = ENC X3 LINE_SIDE<0.03 REGION ABUT<90 OPPOSITE
V1_EDGE =(LINE_SIDE1 OR X3) TOUCH EDGE X8
LINE_END_EXP = EXPAND EDGE V1_EDGE INSIDE BY 0.001 EXTEND BY 0.031
LINE_SIDE_EXP = EXPAND EDGE LINE_SIDE INSIDE BY 0.001 
LINE_END_1 = LINE_END_EXP TOUCH EDGE V1_EDGE 
LINE_SIDE_1 = LINE_SIDE_EXP  TOUCH EDGE  LINE_SIDE
E1 = EXT [LINE_END_1] M2 < 0.12 OPPOSITE PERP ALSO OBTUSE ALSO 
E2 = EXT [LINE_SIDE_1] M2 < 0.08  OPPOSITE PERP ALSO OBTUSE ALSO
LINE_END_E1 = LINE_END_1 TOUCH EDGE E1
LINE_SIDE_E2 = LINE_SIDE_1 TOUCH EDGE E2
V42 =X3 WITH EDGE (X8 TOUCH EDGE LINE_END_E1)   
X5 = V1 INTERACT V42
X6 = V1 NOT X5
X7 = ((M1 AND M2) ENCLOSE X5) ENCLOSE X6
M2_CORNER1 = INT LINE_END_E1 LINE_SIDE_E2 <= 0.002 ABUT==90 REGION
(M2_CORNER1 NOT INTERACT X7) OUTSIDE INST

}


#IFDEF RECOMMENDED YES
M2_12_R{
@ Minimum Mn to Mn space S at Mn line-end 0.1. Width W < 0.1um . The minimum space can be line end head to other Mn or line end side to other M1.  Rule check:
@ S >= (Dh or Ds ).  E1 =0.03, K1=0.095 , Dh=Ds=0.1 in the illustration. 
@ Outside of SRAM(INST) area.
@ Waive extrusion F < 0.07.
@ Waive the violation for MOM (within MOMDMY).
LINE_END = CONVEX EDGE M2 ANGLE1 ==90 LENGTH1 >=0.07 ANGLE2  ==90 LENGTH2  >=0.07 WITH LENGTH  < 0.1
LINE_END_SHAPE = EXPAND EDGE LINE_END INSIDE BY 0.064
LINE_SIDE = (M2 COIN EDGE LINE_END_SHAPE ) NOT COIN EDGE LINE_END
LINE_END_EXP = EXPAND EDGE LINE_END INSIDE BY 0.001 EXTEND BY 0.031
LINE_SIDE_EXP = EXPAND EDGE LINE_SIDE INSIDE BY 0.001 EXTEND BY 0.031
LINE_END_1 = LINE_END_EXP TOUCH EDGE LINE_END
LINE_SIDE_1 = LINE_SIDE_EXP TOUCH EDGE LINE_SIDE
E1 = EXT [LINE_END_1] M2 < 0.1 OPPOSITE PERP ALSO OBTUSE ALSO
E2 = EXT [LINE_SIDE_1] M2 < 0.1  OPPOSITE PERP ALSO OBTUSE ALSO
LINE_END_E1 = LINE_END_1 TOUCH EDGE E1
LINE_SIDE_E2 = LINE_SIDE_1 TOUCH EDGE E2
M2_CORNER = INT LINE_END_E1 LINE_SIDE_E2 <= 0.002 ABUT==90 REGION
MOM =((M1 OR M2) OR M3) INTERACT ( MnPIN INTERACT (SIZE MOMDMY BY 0.114))
((LINE_END_SHAPE INTERACT M2_CORNER) OUTSIDE INST) NOT (MOM OR MOMDMY)

}
#ENDIF


//=====================
//  M3 - Metal 3 DRC
//=====================

GROUP GM3 M3_?

M3_1 {
@ M3 minimum width is 0.07
  INT M3 < 0.07 ABUT<90 SINGULAR REGION
}
M3_2 {
@ M3 maximum width is 4.5
  M3 WITH WIDTH > 4.50
}
M3_3 {
@ M3 minimum space is 0.07
  EXT M3 < 0.07 ABUT<90 SINGULAR REGION
}
M3_4 {
@ M3 minimum area is 0.0196
  AREA M3 < 0.0196
}
M3_5 {
@ M3 minimum enclosed area is 0.2
  AREA ((HOLES M3 INNER) NOT M3) < 0.2
}

M3_6 {
@ Minimum space between two length > 0.3 parallel metal lines
@ with  both metal line width is > 0.22 is 0.10
   CMACRO Mn_6 M3i 0.3 0.22 0.1
}

M3_6a {
@ Minimum space between two length > 0.6 parallel metal lines
@ with one or both metal line width is > 0.7 is 0.12
   CMACRO Mn_6a M3i 0.6 0.7 0.12
}
M3_6b {
@ Minimum space between two length > 0.6 parallel metal lines with one metal
@ line width is > 0.22 and other metal line width is >0.7um is 0.14
   CMACRO Mn_6b M3i 0.6 0.22 0.7 0.14
}

M3_6c {
@ Minimum space between two length > 1.5 parallel metal lines
@ with one or both metal line width is > 1.5 is 0.30
   CMACRO Mn_6c M3i 1.5 1.5 0.3
}
M3_7 {
@ M3 minimum density(%) in 110um*110um window with step size 55um is 12%
  X = DENSITY (M3i OR M3DUM) < 0.1 WINDOW 110 STEP 55 BACKUP PRINT density_report_M3_7.log RDB density_report_M3_7.db
  X NOT MARKG
}
M3_7a {
@ M3 maximum density(%) in 110um*110um window with step size 55um is 85%
  X = DENSITY (M3i OR M3DUM) > 0.85 WINDOW 110 STEP 55 BACKUP PRINT density_report_M3_7a.log RDB density_report_M3_7a.db
  X NOT MARKG
}
M3_7b {
@ M3 maximum density difference(%) between any two 200um adjacent window (stepped without overlapping) is 50%
  X = DENSITY (M3i OR M3DUM) >= 0 WINDOW 200 GRADIENT > 0.5 ABSOLUTE BACKUP PRINT density_report_M3_7b.log RDB density_report_M3_7b.db
  X NOT MARKG
}
M3_7c {
@ M3 maximum density(%) with 840um*840um window is 70%
  X = DENSITY (M3i OR M3DUM) > 0.7 WINDOW 840 BACKUP PRINT density_report_M3_7c.log RDB density_report_M3_7c.db
  X NOT MARKG
}
M3_7d {
@ [(M3 with width > 2.8um) over M2] maximum density(%) with 200um*200um is 70%
X = DENSITY (((M3i WITH WIDTH > 2.800) OR (M3DUM WITH WIDTH > 2.800)) AND (M2i OR M2DUM)) > 0.7 WINDOW 200 STEP 100 BACKUP PRINT density_report_M3_7d.log RDB density_report_M3_7d.db 
  X NOT MARKG
}
M3_7e {
@ [(M2 with width > 2.8um) over M3] maximum density(%) with 200um*200um is 70%
X = DENSITY ((M3i OR M3DUM) AND ((M2i WITH WIDTH > 2.80) OR (M2DUM WITH WIDTH > 2.80)) ) > 0.7 WINDOW 200 STEP 100 BACKUP PRINT density_report_M3_7e.log RDB density_report_M3_7e.db
  X NOT MARKG
}

M3_7f{
@ Mn density over the whole chip is >=20%
X =DENSITY (M3i OR M3DUM)< 0.2 PRINT density_report_M3_7f.log
X NOT MARKG
}

M3_8 {
@ (M3 at 45degree ) minimum width (run length>0um) is 0.17
   M345 = ANGLE M3 == 45
   INT M345 < 0.17 OPPOSITE REGION
}
M3_9 {
@ (M3 at 45degree) minimum space to parallel M3 (run length>0um) is 0.17
  M345 = ANGLE M3 == 45
  EXT M345 < 0.17 OPPOSITE REGION
}
M3END = CONVEX EDGE M3 ANGLE1 ==90 LENGTH1 >=0.08 ANGLE2  ==90 LENGTH2  >=0.08 WITH LENGTH  <=0.11 
M3.10a {
@Minimum space between an Mn line end to an Mn (the parallel run length >0um) is 0.07.Excluding checking SRAM area
X =EXT M3END M3<0.07 OPPOSITE REGION
 X OUTSIDE INST

}
M3.10b{
@ Minimum space between an Mn line end (with Vn) to an Mn (the parallel run length >0um) is 0.07. The Mn line end extend Q from Vn, 0.03 <= Q <0.05um Excluding checking SRAM area
X1 = EXT M3END  M3 <0.07 OPPOSITE REGION
X2 = M3END COIN EDGE X1 
X3 = ENC  V3 X2 <0.05 OPPOSITE REGION
X4 = ENC V3 X2 <0.03 OPPOSITE REGION
X5 = V3 INTERACT X3  
X6 = V3 INTERACT X4
X7 = X5 NOT X6
X= X1 TOUCH (X3 INTERACT X7)
X OUTSIDE INST
}
/*M3.10c{
@ Minimum space between an Mn line end (with Vn) to an Mn (the parallel run length >0um ) is 0.1. The Mn line end extend Q from Vn, 0 <= Q <0.03um 
X1 = EXT M3END  M3 <0.1 OPPOSITE REGION
X2 = M3END COIN EDGE X1 
X3 = ENC  V3 X2 <0.03 ABUT<90 OPPOSITE REGION
X4 = V3 INTERACT X3
X1 TOUCH (X3 INTERACT X4)
}*/
M3_11 {
@ Space between Vn-1 (Vn-1 is enclosed by Mn[A]) to neighbouring metal line Mn[B], when the layout structures meet the following conditions:
@ 1.	Mn[A] line end definition: line width W <0.1m. 
@ 2.	Vn-1 enclosure by Mn[A] line end: E < 0.05m
@ 3.	The parallel run length of Mn[A] and Mn[B]:E1 >=-0.03m
@ 4.	Space between Mn[A] to the neighbouring parallel metal line: Ds<0.08m;
@ 5.	Any one edge distance from the corner of the two edges of Mn[A]: K1 <0.095m
@ At least one Vn-1 in the Mn[A] and Mn-1 intersection meet this rule is ok.
@ This rule is not applicable for SRAM region DRC check.		0.12
LINE_END = CONVEX EDGE M3 ANGLE1 ==90 LENGTH1 >=0.08 ANGLE2  ==90 LENGTH2  >=0.08 WITH LENGTH  <0.1
 X1 =ENC V2  LINE_END<0.05 ABUT<90 REGION OPPOSITE
 X2 = V2 INTERACT X1 
 X3 = X2 INSIDE (M3 AND M2)
 X8 =X3 TOUCH EDGE X1
LINE_END_SHAPE = EXPAND EDGE LINE_END INSIDE BY 0.095
LINE_SIDE = (M3 COIN EDGE LINE_END_SHAPE ) NOT COIN EDGE LINE_END
LINE_SIDE1 = ENC X3 LINE_SIDE<0.03 REGION ABUT<90 OPPOSITE
V2_EDGE =(LINE_SIDE1 OR X3) TOUCH EDGE X8
LINE_END_EXP = EXPAND EDGE V2_EDGE INSIDE BY 0.001 EXTEND BY 0.031
LINE_SIDE_EXP = EXPAND EDGE LINE_SIDE INSIDE BY 0.001 
LINE_END_1 = LINE_END_EXP TOUCH EDGE V2_EDGE 
LINE_SIDE_1 = LINE_SIDE_EXP  TOUCH EDGE  LINE_SIDE
E1 = EXT [LINE_END_1] M3 < 0.12 OPPOSITE PERP ALSO OBTUSE ALSO 
E2 = EXT [LINE_SIDE_1] M3 < 0.08  OPPOSITE PERP ALSO OBTUSE ALSO
LINE_END_E1 = LINE_END_1 TOUCH EDGE E1
LINE_SIDE_E2 = LINE_SIDE_1 TOUCH EDGE E2
V42 =X3 WITH EDGE (X8 TOUCH EDGE LINE_END_E1)   
X5 = V2 INTERACT V42
X6 = V2 NOT X5
X7 = ((M3 AND M2) ENCLOSE X5) ENCLOSE X6
M2_CORNER1 = INT LINE_END_E1 LINE_SIDE_E2 <= 0.002 ABUT==90 REGION
(M2_CORNER1 NOT INTERACT X7) OUTSIDE INST

}
#IFDEF RECOMMENDED YES
M3_12_R{
@ Minimum Mn to Mn space S at Mn line-end 0.1. Width W < 0.1um . The minimum space can be line end head to other Mn or line end side to other M1.  Rule check:
@ S >= (Dh or Ds ).  E1 =0.03, K1=0.095 , Dh=Ds=0.1 in the illustration. 
@ Outside of SRAM(INST) area.
@ Waive extrusion F < 0.07.
@ Waive the violation for MOM (within MOMDMY).
LINE_END = CONVEX EDGE M3 ANGLE1 ==90 LENGTH1 >=0.07 ANGLE2  ==90 LENGTH2  >=0.07 WITH LENGTH  < 0.1
LINE_END_SHAPE = EXPAND EDGE LINE_END INSIDE BY 0.064
LINE_SIDE = (M3 COIN EDGE LINE_END_SHAPE ) NOT COIN EDGE LINE_END
LINE_END_EXP = EXPAND EDGE LINE_END INSIDE BY 0.001 EXTEND BY 0.031
LINE_SIDE_EXP = EXPAND EDGE LINE_SIDE INSIDE BY 0.001 EXTEND BY 0.031
LINE_END_1 = LINE_END_EXP TOUCH EDGE LINE_END
LINE_SIDE_1 = LINE_SIDE_EXP TOUCH EDGE LINE_SIDE
E1 = EXT [LINE_END_1] M3 < 0.1 OPPOSITE PERP ALSO OBTUSE ALSO
E2 = EXT [LINE_SIDE_1] M3 < 0.1  OPPOSITE PERP ALSO OBTUSE ALSO
LINE_END_E1 = LINE_END_1 TOUCH EDGE E1
LINE_SIDE_E2 = LINE_SIDE_1 TOUCH EDGE E2
M3_CORNER = INT LINE_END_E1 LINE_SIDE_E2 <= 0.002 ABUT==90 REGION
MOM =((M2 OR M3) OR M4) INTERACT ( MnPIN INTERACT (SIZE MOMDMY BY 0.114))
((LINE_END_SHAPE INTERACT M3_CORNER) OUTSIDE INST) NOT (MOM OR MOMDMY)
}
#ENDIF 


//=====================
//  M4 - Metal 4 DRC
//=====================

GROUP GM4 M4_?

M4_1 {
@ M4 minimum width is 0.07
  INT M4 < 0.07 ABUT<90 SINGULAR REGION
}
M4_2 {
@ M4 maximum width is 4.5
  M4 WITH WIDTH > 4.50
}
M4_3 {
@ M4 minimum space is 0.07
  EXT M4 < 0.07 ABUT<90 SINGULAR REGION
}
M4_4 {
@ M4 minimum area is 0.0196
  AREA M4 < 0.0196
}
M4_5 {
@ M4 minimum enclosed area is 0.2
  AREA ((HOLES M4 INNER) NOT M4) < 0.2
}

M4_6 {
@ Minimum space between two length > 0.3 parallel metal lines
@ with both metal line width is > 0.22 is 0.10
   CMACRO Mn_6 M4i 0.3 0.22 0.1
}

M4_6a {
@ Minimum space between two length > 0.6 parallel metal lines
@ with one or both metal line width is > 0.7 is 0.12
   CMACRO Mn_6a M4i 0.6 0.7 0.12
}
M4_6b {
@ Minimum space between two length > 0.6 parallel metal lines with one metal
@ line width is > 0.22 and other metal line width is >0.7um is 0.14
   CMACRO Mn_6b M4i 0.6 0.22 0.7 0.14
}
M4_6c {
@ Minimum space between two length > 1.5 parallel metal lines
@ with one or both metal line width is > 1.5 is 0.30
   CMACRO Mn_6c M4i 1.5 1.5 0.3
}

#IFDEF TOPMETAL 9
M4_7 {
@ M4 minimum density(%) in 110um*110um window with step size 55um is 10%
  X = DENSITY (M4i OR M4DUM) < 0.1 WINDOW 110 STEP 55 BACKUP PRINT density_report_M4_7.log RDB density_report_M4_7.db
  X NOT MARKG
}
M4_7f{
@ Mn density over the whole chip is >=20%
X =DENSITY (M4i OR M4DUM)< 0.2 PRINT density_report_M4_7f.log
X NOT MARKG
}
#ENDIF
#IFDEF TOPMETAL 8
M4_7 {
@ M4 minimum density(%) in 110um*110um window with step size 55um is 10%
  X = DENSITY (M4i OR M4DUM) < 0.1 WINDOW 110 STEP 55 BACKUP PRINT density_report_M4_7.log RDB density_report_M4_7.db
  X NOT MARKG
}
M4_7f{
@ Mn density over the whole chip is >=20%
X =DENSITY (M4i OR M4DUM)< 0.2 PRINT density_report_M4_7f.log
X NOT MARKG
}
#ENDIF
#IFDEF TOPMETAL 7
M4_7 {
@ M4 minimum density(%) in 110um*110um window with step size 55um is 10%
  X = DENSITY (M4i OR M4DUM) < 0.1 WINDOW 110 STEP 55 BACKUP PRINT density_report_M4_7.log RDB density_report_M4_7.db
  X NOT MARKG
}
M4_7f{
@ Mn density over the whole chip is >=20%
X =DENSITY (M4i OR M4DUM)< 0.2 PRINT density_report_M4_7f.log
X NOT MARKG
}
#ENDIF
#IFDEF TOPMETAL 6
M4_7 {
@ M4 minimum density(%) in 110um*110um window with step size 55um is 10%
  X = DENSITY (M4i OR M4DUM) < 0.1 WINDOW 110 STEP 55 BACKUP PRINT density_report_M4_7.log RDB density_report_M4_7.db
  X NOT MARKG
}
M4_7f{
@ Mn density over the whole chip is >=20%
X =DENSITY (M4i OR M4DUM)< 0.2 PRINT density_report_M4_7f.log
X NOT MARKG
}
#ENDIF
#IFDEF TOPMETAL 5
M4_7 {
@ M4 minimum density(%) in 110um*110um window with step size 55um is 10%
  X = DENSITY (M4i OR M4DUM) < 0.1 WINDOW 110 STEP 55 BACKUP PRINT density_report_M4_7.log RDB density_report_M4_7.db
  X NOT MARKG
}
M4_7f{
@ Mn density over the whole chip is >=20%
X =DENSITY (M4i OR M4DUM)< 0.2 PRINT density_report_M4_7f.log
X NOT MARKG
}
#ENDIF

M4_7a {
@ M4 maximum density(%) in 110um*110um window with step size 55um is 85%
  X = DENSITY (M4i OR M4DUM) > 0.85 WINDOW 110 STEP 55 BACKUP PRINT density_report_M4_7a.log RDB density_report_M4_7a.db
  X NOT MARKG
}
M4_7b {
@ M4 maximum density difference(%) between any two 200um adjacent window (stepped without overlapping) is 50%
  X = DENSITY (M4i OR M4DUM) >= 0 WINDOW 200 GRADIENT > 0.5 ABSOLUTE BACKUP PRINT density_report_M4_7b.log RDB density_report_M4_7b.db 
  X NOT MARKG
}
M4_7c {
@ M4 maximum density(%) with 840um*840um window is 70%
  X = DENSITY (M4i OR M4DUM) > 0.7 WINDOW 840 BACKUP PRINT density_report_M4_7c.log RDB density_report_M4_7c.db
  X NOT MARKG
}
M4_7d {
@ [(M4 with width > 2.8um) over M3] maximum density(%) with 200um*200um is 70%
X = DENSITY (((M4i WITH WIDTH > 2.800) OR (M4DUM WITH WIDTH > 2.800)) AND (M3i OR M3DUM)) > 0.7 WINDOW 200 STEP 100 BACKUP PRINT density_report_M4_7d.log RDB density_report_M4_7d.db 
  X NOT MARKG
}
M4_7e {
@ [(M3 with width > 2.8um) over M4] maximum density(%) with 200um*200um is 70%
X = DENSITY ((M4i OR M4DUM) AND ((M3i WITH WIDTH > 2.80) OR (M3DUM WITH WIDTH > 2.80)) ) > 0.7 WINDOW 200 STEP 100 BACKUP PRINT density_report_M4_7e.log RDB density_report_M4_7e.db
  X NOT MARKG
}



M4_8 {
@ (M4 at 45degree ) minimum width (run length>0um) is 0.17
   M445 = ANGLE M4 == 45
   INT M445 < 0.17 OPPOSITE REGION
}
M4_9 {
@ (M4 at 45degree) minimum space to parallel M4 (run length>0um) is 0.17
  M445 = ANGLE M4 == 45
  EXT M445 < 0.17 OPPOSITE REGION
}
M4END = CONVEX EDGE M4 ANGLE1 ==90 LENGTH1 >=0.08 ANGLE2  ==90 LENGTH2  >=0.08 WITH LENGTH  <=0.11 
M4.10a {
@Minimum space between an Mn line end to an Mn (the parallel run length >0um) is 0.07.Excluding checking SRAM area
X =EXT M4END M4<0.07 OPPOSITE REGION
X OUTSIDE INST
}
M4.10b{
@ Minimum space between an Mn line end (with Vn) to an Mn (the parallel run length >0um) is 0.07. The Mn line end extend Q from Vn, 0.03 <= Q <0.05um Excluding checking SRAM area
X1 = EXT M4END  M4 <0.07 OPPOSITE REGION
X2 = M4END COIN EDGE X1 
X3 = ENC  V4 X2 <0.05 OPPOSITE REGION
X4 = ENC V4 X2 <0.03 OPPOSITE REGION
X5 = V4 INTERACT X3  
X6 = V4 INTERACT X4
X7 = X5 NOT X6
X=X1 TOUCH (X3 INTERACT X7)
X OUTSIDE INST
}
/*M4.10c{
@ Minimum space between an Mn line end (with Vn) to an Mn (the parallel run length >0um ) is 0.1. The Mn line end extend Q from Vn, 0 <= Q <0.03um 
X1 = EXT M4END  M4 <0.1 OPPOSITE REGION
X2 = M4END COIN EDGE X1 
X3 = ENC  V4 X2 <0.03 ABUT<90 OPPOSITE REGION
X4 = V4 INTERACT X3
X1 TOUCH (X3 INTERACT X4)
}*/
M4.11 {
@ Space between Vn-1 (Vn-1 is enclosed by Mn[A]) to neighbouring metal line Mn[B], when the layout structures meet the following conditions:
@ 1.	Mn[A] line end definition: line width W <0.1m. 
@ 2.	Vn-1 enclosure by Mn[A] line end: E < 0.05m
@ 3.	The parallel run length of Mn[A] and Mn[B]:E1 >=-0.03m
@ 4.	Space between Mn[A] to the neighbouring parallel metal line: Ds<0.08m;
@ 5.	Any one edge distance from the corner of the two edges of Mn[A]: K1 <0.095m
@ At least one Vn-1 in the Mn[A] and Mn-1 intersection meet this rule is ok.
@ This rule is not applicable for SRAM region DRC check.		0.12
LINE_END = CONVEX EDGE M4 ANGLE1 ==90 LENGTH1 >=0.08 ANGLE2  ==90 LENGTH2  >=0.08 WITH LENGTH  <0.1
 X1 =ENC V3  LINE_END<0.05 ABUT<90 REGION OPPOSITE
 X2 = V3 INTERACT X1 
 X3 = X2 INSIDE (M3 AND M4)
 X8 =X3 TOUCH EDGE X1
LINE_END_SHAPE = EXPAND EDGE LINE_END INSIDE BY 0.095
LINE_SIDE = (M4 COIN EDGE LINE_END_SHAPE ) NOT COIN EDGE LINE_END
LINE_SIDE1 = ENC X3 LINE_SIDE<0.03 REGION ABUT<90 OPPOSITE
V3_EDGE =(LINE_SIDE1 OR X3) TOUCH EDGE X8
LINE_END_EXP = EXPAND EDGE V3_EDGE INSIDE BY 0.001 EXTEND BY 0.031
LINE_SIDE_EXP = EXPAND EDGE LINE_SIDE INSIDE BY 0.001 
LINE_END_1 = LINE_END_EXP TOUCH EDGE V3_EDGE 
LINE_SIDE_1 = LINE_SIDE_EXP  TOUCH EDGE  LINE_SIDE
E1 = EXT [LINE_END_1] M4 < 0.12 OPPOSITE PERP ALSO OBTUSE ALSO 
E2 = EXT [LINE_SIDE_1] M4< 0.08  OPPOSITE PERP ALSO OBTUSE ALSO
LINE_END_E1 = LINE_END_1 TOUCH EDGE E1
LINE_SIDE_E2 = LINE_SIDE_1 TOUCH EDGE E2
V42 =X3 WITH EDGE (X8 TOUCH EDGE LINE_END_E1)   
X5 = V3 INTERACT V42
X6 = V3 NOT X5
X7 = ((M3 AND M4) ENCLOSE X5) ENCLOSE X6
M2_CORNER1 = INT LINE_END_E1 LINE_SIDE_E2 <= 0.002 ABUT==90 REGION
(M2_CORNER1 NOT INTERACT X7) OUTSIDE INST

}
#IFDEF RECOMMENDED YES
M4_12_R{
@ Minimum Mn to Mn space S at Mn line-end 0.1. Width W < 0.1um . The minimum space can be line end head to other Mn or line end side to other M1.  Rule check:
@ S >= (Dh or Ds ).  E1 =0.03, K1=0.095 , Dh=Ds=0.1 in the illustration. 
@ Outside of SRAM(INST) area.
@ Waive extrusion F < 0.07.
@ Waive the violation for MOM (within MOMDMY).
LINE_END = CONVEX EDGE M4 ANGLE1 ==90 LENGTH1 >=0.07 ANGLE2  ==90 LENGTH2  >=0.07 WITH LENGTH  < 0.1
LINE_END_SHAPE = EXPAND EDGE LINE_END INSIDE BY 0.064
LINE_SIDE = (M4 COIN EDGE LINE_END_SHAPE ) NOT COIN EDGE LINE_END
LINE_END_EXP = EXPAND EDGE LINE_END INSIDE BY 0.001 EXTEND BY 0.031
LINE_SIDE_EXP = EXPAND EDGE LINE_SIDE INSIDE BY 0.001 EXTEND BY 0.031
LINE_END_1 = LINE_END_EXP TOUCH EDGE LINE_END
LINE_SIDE_1 = LINE_SIDE_EXP TOUCH EDGE LINE_SIDE
E1 = EXT [LINE_END_1] M4 < 0.1 OPPOSITE PERP ALSO OBTUSE ALSO
E2 = EXT [LINE_SIDE_1] M4 < 0.1  OPPOSITE PERP ALSO OBTUSE ALSO
LINE_END_E1 = LINE_END_1 TOUCH EDGE E1
LINE_SIDE_E2 = LINE_SIDE_1 TOUCH EDGE E2
M4_CORNER = INT LINE_END_E1 LINE_SIDE_E2 <= 0.002 ABUT==90 REGION
MOM =((M3 OR M4) OR M5) INTERACT ( MnPIN INTERACT (SIZE MOMDMY BY 0.114))
((LINE_END_SHAPE INTERACT M4_CORNER) OUTSIDE INST) NOT (MOM OR MOMDMY)
}
#ENDIF 


//=====================
//  M5 - Metal 5 DRC
//=====================

GROUP GM5 M5_?

M5_1 {
@ M5 minimum width is 0.07
  INT M5 < 0.07 ABUT<90 SINGULAR REGION
}
M5_2 {
@ M5 maximum width is 4.5
  M5 WITH WIDTH > 4.50
}
M5_3 {
@ M5 minimum space is 0.07
  EXT M5 < 0.07 ABUT<90 SINGULAR REGION
}
M5_4 {
@ M5 minimum area is 0.0196
  AREA M5 < 0.0196
}
M5_5 {
@ M5 minimum enclosed area is 0.2
  AREA ((HOLES M5 INNER) NOT M5) < 0.2
}

M5_6 {
@ Minimum space between two length > 0.3 parallel metal lines
@ with  both metal line width is > 0.22 is 0.10
  CMACRO Mn_6 M5i 0.3 0.22 0.1
}

M5_6a {
@ Minimum space between two length > 0.6 parallel metal lines
@ with one or both metal line width is > 0.7 is 0.12
  CMACRO Mn_6a M5i 0.6 0.7 0.12
}
M5_6b {
@ Minimum space between two length > 0.6 parallel metal lines with one metal
@ line width is > 0.22 and other metal line width is >0.7um is 0.14
   CMACRO Mn_6b M5i 0.6 0.22 0.7 0.14
}
M5_6c {
@ Minimum space between two length > 1.5 parallel metal lines
@ with one or both metal line width is > 1.5 is 0.30
  CMACRO Mn_6c M5i 1.5 1.5 0.3
}

#IFDEF TOPMETAL 9
M5_7 {
@ M5 minimum density(%) in 110um*110um window with step size 55um is 10%
  X = DENSITY (M5i OR M5DUM) < 0.1 WINDOW 110 STEP 55 BACKUP PRINT density_report_M5_7.log RDB density_report_M5_7.db
  X NOT MARKG
}
M5_7f{
@ Mn density over the whole chip is >=20%
X =DENSITY (M5i OR M5DUM)< 0.2 PRINT density_report_M5_7f.log
X NOT MARKG
}

#ENDIF
#IFDEF TOPMETAL 8
M5_7 {
@ M5 minimum density(%) in 110um*110um window with step size 55um is 10%
  X = DENSITY (M5i OR M5DUM) < 0.1 WINDOW 110 STEP 55 BACKUP PRINT density_report_M5_7.log RDB density_report_M5_7.db
  X NOT MARKG
}
M5_7f{
@ Mn density over the whole chip is >=20%
X =DENSITY (M5i OR M5DUM)< 0.2 PRINT density_report_M5_7f.log
X NOT MARKG
}

#ENDIF
#IFDEF TOPMETAL 7
M5_7 {
@ M5 minimum density(%) in 110um*110um window with step size 55um is 10%
  X = DENSITY (M5i OR M5DUM) < 0.1 WINDOW 110 STEP 55 BACKUP PRINT density_report_M5_7.log RDB density_report_M5_7.db
  X NOT MARKG
}
M5_7f{
@ Mn density over the whole chip is >=20%
X =DENSITY (M5i OR M5DUM)< 0.2 PRINT density_report_M5_7f.log
X NOT MARKG
}

#ENDIF
#IFDEF TOPMETAL 6
M5_7 {
@ M5 minimum density(%) in 110um*110um window with step size 55um is 10%
  X = DENSITY (M5i OR M5DUM) < 0.1 WINDOW 110 STEP 55 BACKUP PRINT density_report_M5_7.log RDB density_report_M5_7.db
  X NOT MARKG
}
M5_7f{
@ Mn density over the whole chip is >=20%
X =DENSITY (M5i OR M5DUM)< 0.2 PRINT density_report_M5_7f.log
X NOT MARKG
}

#ENDIF

M5_7a {
@ M5 maximum density(%) in 110um*110um window with step size 55um is 85%
  X = DENSITY (M5i OR M5DUM) > 0.85 WINDOW 110 STEP 55 BACKUP PRINT density_report_M5_7a.log RDB density_report_M5_7a.db
  X NOT MARKG
}
M5_7b {
@ M5 maximum density difference(%) between any two 200um adjacent window (stepped without overlapping) is 50%
  X = DENSITY (M5i OR M5DUM) >= 0 WINDOW 200 GRADIENT > 0.5 ABSOLUTE BACKUP PRINT density_report_M5_7b.log RDB density_report_M5_7b.db
  X NOT MARKG
}
M5_7c {
@ M5 maximum density(%) with 840um*840um window is 70%
  X = DENSITY (M5i OR M5DUM) > 0.7 WINDOW 840 BACKUP PRINT density_report_M5_7c.log RDB density_report_M5_7c.db
  X NOT MARKG
}
M5_7d {
@ [(M5 with width > 2.8um) over M4] maximum density(%) with 200um*200um is 70%
X = DENSITY (((M5i WITH WIDTH > 2.800) OR (M5DUM WITH WIDTH > 2.800)) AND (M4i OR M4DUM)) > 0.7 WINDOW 200 STEP 100 BACKUP PRINT density_report_M5_7d.log RDB density_report_M5_7d.db
 X NOT MARKG
}
M5_7e {
@ [(M4 with width > 2.8um) over M5] maximum density(%) with 200um*200um is 70%
X = DENSITY ((M5i OR M5DUM) AND ((M4i WITH WIDTH > 2.80) OR (M4DUM WITH WIDTH > 2.80))) > 0.7 WINDOW 200 STEP 100 BACKUP PRINT density_report_M5_7e.log RDB density_report_M5_7e.db
  X NOT MARKG
}

M5_8 {
@ (M5 at 45degree ) minimum width (run length>0um) is 0.17
   M545 = ANGLE M5 == 45
   INT M545 < 0.17 OPPOSITE REGION
}
M5_9 {
@ (M5 at 45degree) minimum space to parallel M5 (run length>0um) is 0.17
  M545 = ANGLE M5 == 45
  EXT M545 < 0.17 OPPOSITE REGION
}
M5END = CONVEX EDGE M5 ANGLE1 ==90 LENGTH1 >=0.08 ANGLE2  ==90 LENGTH2  >=0.08 WITH LENGTH  <=0.11 
M5.10a {
@Minimum space between an Mn line end to an Mn (the parallel run length >0um) is 0.07 Excluding checking SRAM area
X=EXT M5END M5<0.07 OPPOSITE REGION
X OUTSIDE INST
}
M5.10b{
@ Minimum space between an Mn line end (with Vn) to an Mn (the parallel run length >0um) is 0.07. The Mn line end extend Q from Vn, 0.03 <= Q <0.05um Excluding checking SRAM area
X1 = EXT M5END  M5 <0.07 OPPOSITE REGION
X2 = M5END COIN EDGE X1 
X3 = ENC  V5 X2 <0.05 OPPOSITE REGION
X4 = ENC V5 X2 <0.03 OPPOSITE REGION
X5 = V5 INTERACT X3  
X6 = V5 INTERACT X4
X7 = X5 NOT X6
X =X1 TOUCH (X3 INTERACT X7)
X OUTSIDE INST
}
/*M5.10c{
@ Minimum space between an Mn line end (with Vn) to an Mn (the parallel run length >0um ) is 0.1. The Mn line end extend Q from Vn, 0 <= Q <0.03um 
X1 = EXT M5END  M5 <0.1 OPPOSITE REGION
X2 = M5END COIN EDGE X1 
X3 = ENC  V5 X2 <0.03 ABUT<90 OPPOSITE REGION
X4 = V5 INTERACT X3
X1 TOUCH (X3 INTERACT X4)
}*/
M5.11 {
@ Space between Vn-1 (Vn-1 is enclosed by Mn[A]) to neighbouring metal line Mn[B], when the layout structures meet the following conditions:
@ 1.	Mn[A] line end definition: line width W <0.1m. 
@ 2.	Vn-1 enclosure by Mn[A] line end: E < 0.05m
@ 3.	The parallel run length of Mn[A] and Mn[B]:E1 >=-0.03m
@ 4.	Space between Mn[A] to the neighbouring parallel metal line: Ds<0.08m;
@ 5.	Any one edge distance from the corner of the two edges of Mn[A]: K1 <0.095m
@ At least one Vn-1 in the Mn[A] and Mn-1 intersection meet this rule is ok.
@ This rule is not applicable for SRAM region DRC check.		0.12
LINE_END = CONVEX EDGE M5 ANGLE1 ==90 LENGTH1 >=0.08 ANGLE2  ==90 LENGTH2  >=0.08 WITH LENGTH  <0.1
 X1 =ENC V4  LINE_END<0.05 ABUT<90 REGION OPPOSITE
 X2 = V4 INTERACT X1 
 X3 = X2 INSIDE (M5 AND M4)
 X8 =X3 TOUCH EDGE X1
LINE_END_SHAPE = EXPAND EDGE LINE_END INSIDE BY 0.095
LINE_SIDE = (M5 COIN EDGE LINE_END_SHAPE ) NOT COIN EDGE LINE_END
LINE_SIDE1 = ENC X3 LINE_SIDE<0.03 REGION ABUT<90 OPPOSITE
V4_EDGE =(LINE_SIDE1 OR X3) TOUCH EDGE X8
LINE_END_EXP = EXPAND EDGE V4_EDGE INSIDE BY 0.001 EXTEND BY 0.031
LINE_SIDE_EXP = EXPAND EDGE LINE_SIDE INSIDE BY 0.001 
LINE_END_1 = LINE_END_EXP TOUCH EDGE V4_EDGE 
LINE_SIDE_1 = LINE_SIDE_EXP  TOUCH EDGE  LINE_SIDE
E1 = EXT [LINE_END_1] M5 < 0.12 OPPOSITE PERP ALSO OBTUSE ALSO 
E2 = EXT [LINE_SIDE_1] M5< 0.08  OPPOSITE PERP ALSO OBTUSE ALSO
LINE_END_E1 = LINE_END_1 TOUCH EDGE E1
LINE_SIDE_E2 = LINE_SIDE_1 TOUCH EDGE E2
V42 =X3 WITH EDGE (X8 TOUCH EDGE LINE_END_E1)   
X5 = V4 INTERACT V42
X6 = V4 NOT X5
X7 = ((M5 AND M4) ENCLOSE X5) ENCLOSE X6
M2_CORNER1 = INT LINE_END_E1 LINE_SIDE_E2 <= 0.002 ABUT==90 REGION
(M2_CORNER1 NOT INTERACT X7) OUTSIDE INST


}
#IFDEF RECOMMENDED YES
M5_12_R{
@ Minimum Mn to Mn space S at Mn line-end 0.1. Width W < 0.1um . The minimum space can be line end head to other Mn or line end side to other M1.  Rule check:
@ S >= (Dh or Ds ).  E1 =0.03, K1=0.095 , Dh=Ds=0.1 in the illustration. 
@ Outside of SRAM(INST) area.
@ Waive extrusion F < 0.07.
@ Waive the violation for MOM (within MOMDMY).
LINE_END = CONVEX EDGE M5 ANGLE1 ==90 LENGTH1 >=0.07 ANGLE2  ==90 LENGTH2  >=0.07 WITH LENGTH  < 0.1
LINE_END_SHAPE = EXPAND EDGE LINE_END INSIDE BY 0.064
LINE_SIDE = (M5 COIN EDGE LINE_END_SHAPE ) NOT COIN EDGE LINE_END
LINE_END_EXP = EXPAND EDGE LINE_END INSIDE BY 0.001 EXTEND BY 0.031
LINE_SIDE_EXP = EXPAND EDGE LINE_SIDE INSIDE BY 0.001 EXTEND BY 0.031
LINE_END_1 = LINE_END_EXP TOUCH EDGE LINE_END
LINE_SIDE_1 = LINE_SIDE_EXP TOUCH EDGE LINE_SIDE
E1 = EXT [LINE_END_1] M5 < 0.1 OPPOSITE PERP ALSO OBTUSE ALSO
E2 = EXT [LINE_SIDE_1] M5 < 0.1  OPPOSITE PERP ALSO OBTUSE ALSO
LINE_END_E1 = LINE_END_1 TOUCH EDGE E1
LINE_SIDE_E2 = LINE_SIDE_1 TOUCH EDGE E2
M5_CORNER = INT LINE_END_E1 LINE_SIDE_E2 <= 0.002 ABUT==90 REGION
MOM =((M4 OR M5) OR M6) INTERACT ( MnPIN INTERACT (SIZE MOMDMY BY 0.114))
((LINE_END_SHAPE INTERACT M5_CORNER) OUTSIDE INST) NOT (MOM OR MOMDMY)
}
#ENDIF 

//=====================
//  M6 - Metal 6 DRC
//=====================

GROUP GM6 M6_?

M6_1 {
@ M6 minimum width is 0.07
  INT M6 < 0.07 ABUT<90 SINGULAR REGION
}
M6_2 {
@ M6 maximum width is 4.5
  M6 WITH WIDTH > 4.50
}
M6_3 {
@ M6 minimum space is 0.07
  EXT M6 < 0.07 ABUT<90 SINGULAR REGION
}
M6_4 {
@ M6 minimum area is 0.0196
  AREA M6 < 0.0196
}
M6_5 {
@ M6 minimum enclosed area is 0.2
  AREA ((HOLES M6 INNER) NOT M6) < 0.2
}

M6_6 {
@ Minimum space between two length > 0.3 parallel metal lines
@ with both metal line width is > 0.22 is 0.10
  CMACRO Mn_6 M6i 0.3 0.22 0.1
}

M6_6a {
@ Minimum space between two length > 0.6 parallel metal lines
@ with one or both metal line width is > 0.7 is 0.12
  CMACRO Mn_6a M6i 0.6 0.7 0.12
}
M6_6b {
@ Minimum space between two length > 0.6 parallel metal lines with one metal
@ line width is > 0.22 and other metal line width is >0.7um is 0.14
  CMACRO Mn_6b M6i 0.6 0.22 0.7 0.14
}
M6_6c {
@ Minimum space between two length > 1.5 parallel metal lines
@ with both metal line width is > 1.5 is 0.30
  CMACRO Mn_6c M6i 1.5 1.5 0.3
}

#IFDEF TOPMETAL 9
M6_7 {
@ M6 minimum density(%) in 110um*110um window with step size 55um is 10%
  X = DENSITY (M6i OR M6DUM) < 0.1 WINDOW 110 STEP 55 BACKUP PRINT density_report_M6_7.log RDB density_report_M6_7.db
  X NOT MARKG
}
M6_7f{
@ Mn density over the whole chip is >=20%
X =DENSITY (M6i OR M6DUM)< 0.2 PRINT density_report_M6_7f.log
X NOT MARKG
}

#ENDIF
#IFDEF TOPMETAL 8
M6_7 {
@ M6 minimum density(%) in 110um*110um window with step size 55um is 10%
  X = DENSITY (M6i OR M6DUM) < 0.1 WINDOW 110 STEP 55 BACKUP PRINT density_report_M6_7.log RDB density_report_M6_7.db
  X NOT MARKG
}
M6_7f{
@ Mn density over the whole chip is >=20%
X =DENSITY (M6i OR M6DUM)< 0.2 PRINT density_report_M6_7f.log
X NOT MARKG
}

#ENDIF
#IFDEF TOPMETAL 7
M6_7 {
@ M6 minimum density(%) in 110um*110um window with step size 55um is 10%
  X = DENSITY (M6i OR M6DUM) < 0.1 WINDOW 110 STEP 55 BACKUP PRINT density_report_M6_7.log RDB density_report_M6_7.db
  X NOT MARKG
}
M6_7f{
@ Mn density over the whole chip is >=20%
X =DENSITY (M6i OR M6DUM)< 0.2 PRINT density_report_M6_7f.log
X NOT MARKG
}

#ENDIF

M6_7a {
@ M6 maximum density(%) in 110um*110um window with step size 55um is 85%
  X = DENSITY (M6i OR M6DUM) > 0.85 WINDOW 110 STEP 55 BACKUP PRINT density_report_M6_7a.log RDB density_report_M6_7a.db 
  X NOT MARKG
}
M6_7b {
@ M6 maximum density difference(%) between any two 200um adjacent window (stepped without overlapping) is 50%
  X = DENSITY (M6i OR M6DUM) >= 0 WINDOW 200 GRADIENT > 0.5 ABSOLUTE BACKUP PRINT density_report_M6_7b.log RDB density_report_M6_7b.db
  X NOT MARKG
}
M6_7c {
@ M6 maximum density(%) with 840um*840um window is 70%
  X = DENSITY (M6i OR M6DUM) > 0.7 WINDOW 840 BACKUP PRINT density_report_M6_7c.log RDB density_report_M6_7c.db 
  X NOT MARKG
}
M6_7d {
@ [(M6 with width > 2.8um) over M5] maximum density(%) with 200um*200um is 70%
X = DENSITY (((M6i WITH WIDTH > 2.800) OR (M6DUM WITH WIDTH > 2.800)) AND (M5i OR M5DUM)) > 0.7 WINDOW 200 STEP 100 BACKUP PRINT density_report_M6_7d.log RDB density_report_M6_7d.db
  X NOT MARKG
}
M6_7e {
@ [(M5 with width > 2.8um) over M6] maximum density(%) with 200um*200um is 70%
X = DENSITY ((M6i OR M6DUM) AND ((M5i WITH WIDTH > 2.80) OR (M5DUM WITH WIDTH > 2.80)) ) > 0.7 WINDOW 200 STEP 100 BACKUP PRINT density_report_M6_7e.log RDB density_report_M6_7e.db 
  X NOT MARKG
}


M6_8 {
@ (M6 at 45degree ) minimum width (run length>0um) is 0.17
   M645 = ANGLE M6 == 45
   INT M645 < 0.17 OPPOSITE REGION
}
M6_9 {
@ (M6 at 45degree) minimum space to parallel M6 (run length>0um) is 0.17
  M645 = ANGLE M6 == 45
  EXT M645 < 0.17 OPPOSITE REGION
}
M6END = CONVEX EDGE M6 ANGLE1 ==90 LENGTH1 >=0.08 ANGLE2  ==90 LENGTH2  >=0.08 WITH LENGTH  <=0.11 
M6.10a {
@Minimum space between an Mn line end to an Mn (the parallel run length >0um) is 0.07.Excluding checking SRAM area
X =EXT M6END M6<0.07 OPPOSITE REGION
X OUTSIDE INST
}
M6.10b{
@ Minimum space between an Mn line end (with Vn) to an Mn (the parallel run length >0um) is 0.07. The Mn line end extend Q from Vn, 0.03 <= Q <0.05um.Excluding checking SRAM area
X1 = EXT M6END  M6 <0.07 OPPOSITE REGION
X2 = M6END COIN EDGE X1 
X3 = ENC  V6 X2 <0.05 OPPOSITE REGION
X4 = ENC V6 X2 <0.03 OPPOSITE REGION
X5 = V6 INTERACT X3  
X6 = V6 INTERACT X4
X7 = X5 NOT X6
X =X1 TOUCH (X3 INTERACT X7)
X OUT INST
}
/*M6.10c{
@ Minimum space between an Mn line end (with Vn) to an Mn (the parallel run length >0um ) is 0.1. The Mn line end extend Q from Vn, 0 <= Q <0.03um 
X1 = EXT M6END  M6 <0.1 OPPOSITE REGION
X2 = M6END COIN EDGE X1 
X3 = ENC  V6 X2 <0.03 ABUT<90 OPPOSITE REGION
X4 = V6 INTERACT X3
X1 TOUCH (X3 INTERACT X4)
}*/
M6.11 {
@ Space between Vn-1 (Vn-1 is enclosed by Mn[A]) to neighbouring metal line Mn[B], when the layout structures meet the following conditions:
@ 1.	Mn[A] line end definition: line width W <0.1m. 
@ 2.	Vn-1 enclosure by Mn[A] line end: E < 0.05m
@ 3.	The parallel run length of Mn[A] and Mn[B]:E1 >=-0.03m
@ 4.	Space between Mn[A] to the neighbouring parallel metal line: Ds<0.08m;
@ 5.	Any one edge distance from the corner of the two edges of Mn[A]: K1 <0.095m
@ At least one Vn-1 in the Mn[A] and Mn-1 intersection meet this rule is ok.
@ This rule is not applicable for SRAM region DRC check.		0.12
LINE_END = CONVEX EDGE M6 ANGLE1 ==90 LENGTH1 >=0.08 ANGLE2  ==90 LENGTH2  >=0.08 WITH LENGTH  <0.1
  X1 =ENC V5  LINE_END<0.05 ABUT<90 REGION OPPOSITE
 X2 = V5 INTERACT X1 
 X3 = X2 INSIDE (M5 AND M6)
 X8 =X3 TOUCH EDGE X1
LINE_END_SHAPE = EXPAND EDGE LINE_END INSIDE BY 0.095
LINE_SIDE = (M6 COIN EDGE LINE_END_SHAPE ) NOT COIN EDGE LINE_END
LINE_SIDE1 = ENC X3 LINE_SIDE<0.03 REGION ABUT<90 OPPOSITE
V5_EDGE =(LINE_SIDE1 OR X3) TOUCH EDGE X8
LINE_END_EXP = EXPAND EDGE V5_EDGE INSIDE BY 0.001 EXTEND BY 0.031
LINE_SIDE_EXP = EXPAND EDGE LINE_SIDE INSIDE BY 0.001 
LINE_END_1 = LINE_END_EXP TOUCH EDGE V5_EDGE 
LINE_SIDE_1 = LINE_SIDE_EXP  TOUCH EDGE  LINE_SIDE
E1 = EXT [LINE_END_1] M6 < 0.12 OPPOSITE PERP ALSO OBTUSE ALSO 
E2 = EXT [LINE_SIDE_1] M6< 0.08  OPPOSITE PERP ALSO OBTUSE ALSO
LINE_END_E1 = LINE_END_1 TOUCH EDGE E1
LINE_SIDE_E2 = LINE_SIDE_1 TOUCH EDGE E2
V42 =X3 WITH EDGE (X8 TOUCH EDGE LINE_END_E1)   
X5 = V5 INTERACT V42
X6 = V5 NOT X5
X7 = ((M5 AND M6) ENCLOSE X5) ENCLOSE X6
M2_CORNER1 = INT LINE_END_E1 LINE_SIDE_E2 <= 0.002 ABUT==90 REGION
(M2_CORNER1 NOT INTERACT X7) OUTSIDE INST


}
#IFDEF RECOMMENDED YES
M6_12_R{
@ Minimum Mn to Mn space S at Mn line-end 0.1. Width W < 0.1um . The minimum space can be line end head to other Mn or line end side to other M1.  Rule check:
@ S >= (Dh or Ds ).  E1 =0.03, K1=0.095 , Dh=Ds=0.1 in the illustration. 
@ Outside of SRAM(INST) area.
@ Waive extrusion F < 0.07.
@ Waive the violation for MOM (within MOMDMY).
LINE_END = CONVEX EDGE M6 ANGLE1 ==90 LENGTH1 >=0.07 ANGLE2  ==90 LENGTH2  >=0.07 WITH LENGTH  < 0.1
LINE_END_SHAPE = EXPAND EDGE LINE_END INSIDE BY 0.064
LINE_SIDE = (M6 COIN EDGE LINE_END_SHAPE ) NOT COIN EDGE LINE_END
LINE_END_EXP = EXPAND EDGE LINE_END INSIDE BY 0.001 EXTEND BY 0.031
LINE_SIDE_EXP = EXPAND EDGE LINE_SIDE INSIDE BY 0.001 EXTEND BY 0.031
LINE_END_1 = LINE_END_EXP TOUCH EDGE LINE_END
LINE_SIDE_1 = LINE_SIDE_EXP TOUCH EDGE LINE_SIDE
E1 = EXT [LINE_END_1] M6 < 0.1 OPPOSITE PERP ALSO OBTUSE ALSO
E2 = EXT [LINE_SIDE_1] M6 < 0.1  OPPOSITE PERP ALSO OBTUSE ALSO
LINE_END_E1 = LINE_END_1 TOUCH EDGE E1
LINE_SIDE_E2 = LINE_SIDE_1 TOUCH EDGE E2
M6_CORNER = INT LINE_END_E1 LINE_SIDE_E2 <= 0.002 ABUT==90 REGION
MOM =((M5 OR M6) OR M7) INTERACT ( MnPIN INTERACT (SIZE MOMDMY BY 0.114))
((LINE_END_SHAPE INTERACT M6_CORNER) OUTSIDE INST) NOT (MOM OR MOMDMY)
}
#ENDIF 



//=====================
//  M7 - Metal 7 DRC
//=====================

GROUP GM7 M7_?

M7_1 {
@ M7 minimum width is 0.07
  INT M7 < 0.07 ABUT<90 SINGULAR REGION
}
M7_2 {
@ M7 maximum width is 4.5
  M7 WITH WIDTH > 4.50
}
M7_3 {
@ M7 minimum space is 0.07
  EXT M7 < 0.07 ABUT<90 SINGULAR REGION
}
M7_4 {
@ M7 minimum area is 0.0196
  AREA M7 < 0.0196
}
M7_5 {
@ M7 minimum enclosed area is 0.2
  AREA ((HOLES M7 INNER) NOT M7) < 0.2
}

M7_6 {
@ Minimum space between two length > 0.3 parallel metal lines
@ with  both metal line width is > 0.22 is 0.10
  CMACRO Mn_6 M7i 0.3 0.22 0.1
}

M7_6a {
@ Minimum space between two length > 0.6 parallel metal lines
@ with one or both metal line width is > 0.7 is 0.12
  CMACRO Mn_6a M7i 0.6 0.7 0.12
}
M7_6b {
@ Minimum space between two length > 0.6 parallel metal lines with one metal
@ line width is > 0.22 and other metal line width is >0.7um is 0.14
  CMACRO Mn_6b M7i 0.6 0.22 0.7 0.14
}

M7_6c {
@ Minimum space between two length > 1.5 parallel metal lines
@ with one or both metal line width is > 1.5 is 0.30
  CMACRO Mn_6c M7i 1.5 1.5 0.3
}

#IFDEF TOPMETAL 9
M7_7 {
@ M7 minimum density(%) in 110um*110um window with step size 55um is 10%
  X = DENSITY (M7i OR M7DUM) < 0.1 WINDOW 110 STEP 55 BACKUP PRINT density_report_M7_7.log RDB density_report_M7_7.db
  X NOT MARKG
}
M7_7f{
@ Mn density over the whole chip is >=20%
X =DENSITY (M7i OR M7DUM)< 0.2 PRINT density_report_M7_7f.log
X NOT MARKG
}

#ENDIF
#IFDEF TOPMETAL 8
M7_7 {
@ M7 minimum density(%) in 110um*110um window with step size 55um is 10%
  X = DENSITY (M7i OR M7DUM) < 0.1 WINDOW 110 STEP 55 BACKUP PRINT density_report_M7_7.log RDB density_report_M7_7.db
  X NOT MARKG
}
M7_7f{
@ Mn density over the whole chip is >=20%
X =DENSITY (M7i OR M7DUM)< 0.2 PRINT density_report_M7_7f.log
X NOT MARKG
}

#ENDIF

M7_7a {
@ M7 maximum density(%) in 110um*110um window with step size 55um is 85%
  X = DENSITY (M7i OR M7DUM) > 0.85 WINDOW 110 STEP 55 BACKUP PRINT density_report_M7_7a.log RDB density_report_M7_7a.db
  X NOT MARKG
}
M7_7b {
@ M7 maximum density difference(%) between any two 200um adjacent window (stepped without overlapping) is 50%
  X = DENSITY (M7i OR M7DUM) >= 0 WINDOW 200 GRADIENT > 0.5 ABSOLUTE BACKUP PRINT density_report_M7_7b.log RDB density_report_M7_7b.db
  X NOT MARKG
}
M7_7c {
@ M7 maximum density(%) with 840um*840um window is 70%
  X = DENSITY (M7i OR M7DUM) > 0.7 WINDOW 840 BACKUP PRINT density_report_M7_7c.log RDB density_report_M7_7c.db
  X NOT MARKG
}
M7_7d {
@ [(M7 with width > 2.8um) over M6] maximum density(%) with 200um*200um is 70%
X = DENSITY (((M7i WITH WIDTH > 2.800) OR (M7DUM WITH WIDTH > 2.800)) AND (M6i OR M6DUM)) > 0.7 WINDOW 200 STEP 100 BACKUP PRINT density_report_M7_7d.log RDB density_report_M7_7d.db
  X NOT MARKG
}
M7_7e {
@ [(M6 with width > 2.8um) over M7] maximum density(%) with 200um*200um is 70%
X = DENSITY ((M7i OR M7DUM) AND ((M6i WITH WIDTH > 2.80) OR (M6DUM WITH WIDTH > 2.80))) > 0.7 WINDOW 200 STEP 100 BACKUP PRINT density_report_M7_7e.log RDB density_report_M7_7e.db
  X NOT MARKG
}



M7_8 {
@ (M7 at 45degree ) minimum width (run length>0um) is 0.17
   M745 = ANGLE M7 == 45
   INT M745 < 0.17 OPPOSITE REGION
}
M7_9 {
@ (M7 at 45degree) minimum space to parallel M7 (run length>0um) is 0.17
  M745 = ANGLE M7 == 45
  EXT M745 < 0.17 OPPOSITE REGION
}
M7END = CONVEX EDGE M7 ANGLE1 ==90 LENGTH1 >=0.08 ANGLE2  ==90 LENGTH2  >=0.08 WITH LENGTH  <=0.11 
M7.10a {
@Minimum space between an Mn line end to an Mn (the parallel run length >0um) is 0.07.Excluding checking SRAM area
X= EXT M7END M7<0.07 OPPOSITE REGION
X OUT INST
}
M7.10b{
@ Minimum space between an Mn line end (with Vn) to an Mn (the parallel run length >0um) is 0.07 The Mn line end extend Q from Vn, 0.03 <= Q <0.05um.Excluding checking SRAM area 
X1 = EXT M7END  M7 <0.07 OPPOSITE REGION
X2 = M7END COIN EDGE X1 
X3 = ENC  V7 X2 <0.05 OPPOSITE REGION
X4 = ENC V7 X2 <0.03 OPPOSITE REGION
X5 = V7 INTERACT X3  
X6 = V7 INTERACT X4
X7 = X5 NOT X6
X =X1 TOUCH (X3 INTERACT X7)
X OUTSIDE INST
}
/*M7.10c{
@ Minimum space between an Mn line end (with Vn) to an Mn (the parallel run length >0um ) is 0.1. The Mn line end extend Q from Vn, 0 <= Q <0.03um 
X1 = EXT M7END  M7 <0.1 OPPOSITE REGION
X2 = M7END COIN EDGE X1 
X3 = ENC  V7 X2 <0.03 ABUT<90 OPPOSITE REGION
X4 = V7 INTERACT X3
X1 TOUCH (X3 INTERACT X4)
}*/
M7.11 {
@ Space between Vn-1 (Vn-1 is enclosed by Mn[A]) to neighbouring metal line Mn[B], when the layout structures meet the following conditions:
@ 1.	Mn[A] line end definition: line width W <0.1m. 
@ 2.	Vn-1 enclosure by Mn[A] line end: E < 0.05m
@ 3.	The parallel run length of Mn[A] and Mn[B]:E1 >=-0.03m
@ 4.	Space between Mn[A] to the neighbouring parallel metal line: Ds<0.08m;
@ 5.	Any one edge distance from the corner of the two edges of Mn[A]: K1 <0.095m
@ At least one Vn-1 in the Mn[A] and Mn-1 intersection meet this rule is ok.
@ This rule is not applicable for SRAM region DRC check.		0.12
LINE_END = CONVEX EDGE M7 ANGLE1 ==90 LENGTH1 >=0.08 ANGLE2  ==90 LENGTH2  >=0.08 WITH LENGTH  <0.1
 X1 =ENC V6  LINE_END<0.05 ABUT<90 REGION OPPOSITE
 X2 = V6 INTERACT X1 
 X3 = X2 INSIDE (M7 AND M6)
 X8 =X3 TOUCH EDGE X1
LINE_END_SHAPE = EXPAND EDGE LINE_END INSIDE BY 0.095
LINE_SIDE = (M7 COIN EDGE LINE_END_SHAPE ) NOT COIN EDGE LINE_END
LINE_SIDE1 = ENC X3 LINE_SIDE<0.03 REGION ABUT<90 OPPOSITE
V6_EDGE =(LINE_SIDE1 OR X3) TOUCH EDGE X8
LINE_END_EXP = EXPAND EDGE V6_EDGE INSIDE BY 0.001 EXTEND BY 0.031
LINE_SIDE_EXP = EXPAND EDGE LINE_SIDE INSIDE BY 0.001 
LINE_END_1 = LINE_END_EXP TOUCH EDGE V6_EDGE 
LINE_SIDE_1 = LINE_SIDE_EXP  TOUCH EDGE  LINE_SIDE
E1 = EXT [LINE_END_1] M7 < 0.12 OPPOSITE PERP ALSO OBTUSE ALSO 
E2 = EXT [LINE_SIDE_1] M7< 0.08  OPPOSITE PERP ALSO OBTUSE ALSO
LINE_END_E1 = LINE_END_1 TOUCH EDGE E1
LINE_SIDE_E2 = LINE_SIDE_1 TOUCH EDGE E2
V42 =X3 WITH EDGE (X8 TOUCH EDGE LINE_END_E1)   
X5 = V6 INTERACT V42
X6 = V6 NOT X5
X7 = ((M7 AND M6) ENCLOSE X5) ENCLOSE X6
M2_CORNER1 = INT LINE_END_E1 LINE_SIDE_E2 <= 0.002 ABUT==90 REGION
(M2_CORNER1 NOT INTERACT X7) OUTSIDE INST

}
#IFDEF RECOMMENDED YES
M7_12_R{
@ Minimum Mn to Mn space S at Mn line-end 0.1. Width W < 0.1um . The minimum space can be line end head to other Mn or line end side to other M1.  Rule check:
@ S >= (Dh or Ds ).  E1 =0.03, K1=0.095 , Dh=Ds=0.1 in the illustration. 
@ Outside of SRAM(INST) area.
@ Waive extrusion F < 0.07.
@ Waive the violation for MOM (within MOMDMY).
LINE_END = CONVEX EDGE M7 ANGLE1 ==90 LENGTH1 >=0.07 ANGLE2  ==90 LENGTH2  >=0.07 WITH LENGTH  < 0.1
LINE_END_SHAPE = EXPAND EDGE LINE_END INSIDE BY 0.064
LINE_SIDE = (M7 COIN EDGE LINE_END_SHAPE ) NOT COIN EDGE LINE_END
LINE_END_EXP = EXPAND EDGE LINE_END INSIDE BY 0.001 EXTEND BY 0.031
LINE_SIDE_EXP = EXPAND EDGE LINE_SIDE INSIDE BY 0.001 EXTEND BY 0.031
LINE_END_1 = LINE_END_EXP TOUCH EDGE LINE_END
LINE_SIDE_1 = LINE_SIDE_EXP TOUCH EDGE LINE_SIDE
E1 = EXT [LINE_END_1] M7 < 0.1 OPPOSITE PERP ALSO OBTUSE ALSO
E2 = EXT [LINE_SIDE_1] M7 < 0.1  OPPOSITE PERP ALSO OBTUSE ALSO
LINE_END_E1 = LINE_END_1 TOUCH EDGE E1
LINE_SIDE_E2 = LINE_SIDE_1 TOUCH EDGE E2
M7_CORNER = INT LINE_END_E1 LINE_SIDE_E2 <= 0.002 ABUT==90 REGION
MOM =((M6 OR M7) OR M8) INTERACT ( MnPIN INTERACT (SIZE MOMDMY BY 0.114))
((LINE_END_SHAPE INTERACT M7_CORNER) OUTSIDE INST) NOT (MOM OR MOMDMY)
}
#ENDIF

//=====================
//  M8 - Metal 8 DRC
//=====================

GROUP GM8 M8_?

M8_1 {
@ M8 minimum width is 0.07
  INT M8 < 0.07 ABUT<90 SINGULAR REGION
}
M8_2 {
@ M8 maximum width is 4.5
  M8 WITH WIDTH > 4.50
}
M8_3 {
@ M8 minimum space is 0.07
  EXT M8 < 0.07 ABUT<90 SINGULAR REGION
}
M8_4 {
@ M8 minimum area is 0.0196
  AREA M8 < 0.0196
}
M8_5 {
@ M8 minimum enclosed area is 0.2
  AREA ((HOLES M8 INNER) NOT M8) < 0.2
}

M8_6 {
@ Minimum space between two length > 0.3 parallel metal lines
@ with both metal line width is > 0.22 is 0.10
  CMACRO Mn_6 M8i 0.3 0.22 0.1
}

M8_6a {
@ Minimum space between two length > 0.6 parallel metal lines
@ with one or both metal line width is > 0.7 is 0.12
  CMACRO Mn_6a M8i 0.6 0.7 0.12
}
M8_6b {
@ Minimum space between two length > 0.6 parallel metal lines with one metal
@ line width is > 0.22 and other metal line width is >0.7um is 0.14
  CMACRO Mn_6b M8i 0.6 0.22 0.7 0.14
}
M8_6c {
@ Minimum space between two length > 1.5 parallel metal lines
@ with one or both metal line width is > 1.5 is 0.30
  CMACRO Mn_6c M8i 1.5 1.5 0.3
}

#IFDEF TOPMETAL 9
M8_7 {
@ M8 minimum density(%) in 110um*110um window with step size 55um is 10%
  X = DENSITY (M8i OR M8DUM) < 0.1 WINDOW 110 STEP 55 BACKUP PRINT density_report_M8_7.log RDB density_report_M8_7.db
  X NOT MARKG
}
M8_7f{
@ Mn density over the whole chip is >=20%
X =DENSITY (M8i OR M8DUM)< 0.2 PRINT density_report_M8_7f.log
X NOT MARKG
}

#ENDIF

M8_7a {
@ M8 maximum density(%) in 110um*110um window with step size 55um is 85%
  X = DENSITY (M8i OR M8DUM) > 0.85 WINDOW 110 STEP 55 BACKUP PRINT density_report_M8_7a.log RDB density_report_M8_7a.db
  X NOT MARKG
}
M8_7b {
@ M8 maximum density difference(%) between any two 200um adjacent window (stepped without overlapping) is 50%
  X = DENSITY (M8i OR M8DUM) >= 0 WINDOW 200 GRADIENT > 0.5 ABSOLUTE BACKUP PRINT density_report_M8_7b.log RDB density_report_M8_7b.db
  X NOT MARKG
}
M8_7c {
@ M8 maximum density(%) with 840um*840um window is 70%
  X = DENSITY (M8i OR M8DUM) > 0.7 WINDOW 840 BACKUP PRINT density_report_M8_7c.log RDB density_report_M8_7c.db
  X NOT MARKG
}
M8_7d {
@ [(M8 with width > 2.8um) over M7] maximum density(%) with 200um*200um is 70%
X = DENSITY (((M8i WITH WIDTH > 2.800) OR (M8DUM WITH WIDTH > 2.800))AND (M7i OR M7DUM)) > 0.7 WINDOW 200 STEP 100 BACKUP PRINT density_report_M8_7d.log RDB density_report_M8_7d.db
  X NOT MARKG
}
M8_7e {
@ [(M7 with width > 2.8um) over M8] maximum density(%) with 200um*200um is 70%
X = DENSITY ((M8i OR M8DUM) AND ((M7i WITH WIDTH > 2.80) OR (M7DUM WITH WIDTH > 2.80))) > 0.7 WINDOW 200 STEP 100 BACKUP PRINT density_report_M8_7e.log RDB density_report_M8_7e.db
  X NOT MARKG
}

M8_8 {
@ (M8 at 45degree ) minimum width (run length>0um) is 0.17
   M845 = ANGLE M8 == 45
   INT M845 < 0.17 OPPOSITE REGION
}
M8_9 {
@ (M8 at 45degree) minimum space to parallel M8 (run length>0um) is 0.17
  M845 = ANGLE M8 == 45
  EXT M845 < 0.17 OPPOSITE REGION
}
M8END = CONVEX EDGE M8 ANGLE1 ==90 LENGTH1 >=0.08 ANGLE2  ==90 LENGTH2  >=0.08 WITH LENGTH  <=0.11
M8.10a {
@Minimum space between an Mn line end to an Mn (the parallel run length >0um) is 0.07.Excluding checking SRAM area
X= EXT M8END M8<0.07 OPPOSITE REGION
X OUT INST
}
M8.11 {
@ Space between Vn-1 (Vn-1 is enclosed by Mn[A]) to neighbouring metal line Mn[B], when the layout structures meet the following conditions:
@ 1.	Mn[A] line end definition: line width W <0.1m. 
@ 2.	Vn-1 enclosure by Mn[A] line end: E < 0.05m
@ 3.	The parallel run length of Mn[A] and Mn[B]:E1 >=-0.03m
@ 4.	Space between Mn[A] to the neighbouring parallel metal line: Ds<0.08m;
@ 5.	Any one edge distance from the corner of the two edges of Mn[A]: K1 <0.095m
@ At least one Vn-1 in the Mn[A] and Mn-1 intersection meet this rule is ok.
@ This rule is not applicable for SRAM region DRC check.		0.12
LINE_END = CONVEX EDGE M8 ANGLE1 ==90 LENGTH1 >=0.08 ANGLE2  ==90 LENGTH2  >=0.08 WITH LENGTH  <0.1
 X1 =ENC V7  LINE_END<0.05 ABUT<90 REGION OPPOSITE
 X2 = V7 INTERACT X1 
 X3 = X2 INSIDE (M7 AND M8)
 X8 =X3 TOUCH EDGE X1
LINE_END_SHAPE = EXPAND EDGE LINE_END INSIDE BY 0.095
LINE_SIDE = (M8 COIN EDGE LINE_END_SHAPE ) NOT COIN EDGE LINE_END
LINE_SIDE1 = ENC X3 LINE_SIDE<0.03 REGION ABUT<90 OPPOSITE
V7_EDGE =(LINE_SIDE1 OR X3) TOUCH EDGE X8
LINE_END_EXP = EXPAND EDGE V7_EDGE INSIDE BY 0.001 EXTEND BY 0.031
LINE_SIDE_EXP = EXPAND EDGE LINE_SIDE INSIDE BY 0.001 
LINE_END_1 = LINE_END_EXP TOUCH EDGE V7_EDGE 
LINE_SIDE_1 = LINE_SIDE_EXP  TOUCH EDGE  LINE_SIDE
E1 = EXT [LINE_END_1] M8 < 0.12 OPPOSITE PERP ALSO OBTUSE ALSO 
E2 = EXT [LINE_SIDE_1] M8< 0.08  OPPOSITE PERP ALSO OBTUSE ALSO
LINE_END_E1 = LINE_END_1 TOUCH EDGE E1
LINE_SIDE_E2 = LINE_SIDE_1 TOUCH EDGE E2
V42 =X3 WITH EDGE (X8 TOUCH EDGE LINE_END_E1)   
X5 = V7 INTERACT V42
X6 = V7 NOT X5
X7 = ((M7 AND M8) ENCLOSE X5) ENCLOSE X6
M2_CORNER1 = INT LINE_END_E1 LINE_SIDE_E2 <= 0.002 ABUT==90 REGION
(M2_CORNER1 NOT INTERACT X7) OUTSIDE INST

}

#IFDEF RECOMMENDED YES
M8_12_R{
@ Minimum Mn to Mn space S at Mn line-end 0.1. Width W < 0.1um . The minimum space can be line end head to other Mn or line end side to other M1.  Rule check:
@ S >= (Dh or Ds ).  E1 =0.03, K1=0.095 , Dh=Ds=0.1 in the illustration. 
@ Outside of SRAM(INST) area.
@ Waive extrusion F < 0.07.
@ Waive the violation for MOM (within MOMDMY).
LINE_END = CONVEX EDGE M8 ANGLE1 ==90 LENGTH1 >=0.07 ANGLE2  ==90 LENGTH2  >=0.07 WITH LENGTH  < 0.1
LINE_END_SHAPE = EXPAND EDGE LINE_END INSIDE BY 0.064
LINE_SIDE = (M8 COIN EDGE LINE_END_SHAPE ) NOT COIN EDGE LINE_END
LINE_END_EXP = EXPAND EDGE LINE_END INSIDE BY 0.001 EXTEND BY 0.031
LINE_SIDE_EXP = EXPAND EDGE LINE_SIDE INSIDE BY 0.001 EXTEND BY 0.031
LINE_END_1 = LINE_END_EXP TOUCH EDGE LINE_END
LINE_SIDE_1 = LINE_SIDE_EXP TOUCH EDGE LINE_SIDE
E1 = EXT [LINE_END_1] M8 < 0.1 OPPOSITE PERP ALSO OBTUSE ALSO
E2 = EXT [LINE_SIDE_1] M8 < 0.1  OPPOSITE PERP ALSO OBTUSE ALSO
LINE_END_E1 = LINE_END_1 TOUCH EDGE E1
LINE_SIDE_E2 = LINE_SIDE_1 TOUCH EDGE E2
M8_CORNER = INT LINE_END_E1 LINE_SIDE_E2 <= 0.002 ABUT==90 REGION
MOM =(M7 OR M8) INTERACT ( MnPIN INTERACT (SIZE MOMDMY BY 0.114))
((LINE_END_SHAPE INTERACT M8_CORNER) OUTSIDE INST ) NOT (MOM OR MOMDMY)
}
#ENDIF


//========================
//  V2 - Via 2 DRC
//========================

GROUP GV2 V2_?

V2_1 {
@ Fixed V2 size is 0.07
  NOT RECTANGLE V2 == 0.07 BY == 0.07
}
V2_2 {
@ Space between two V2 is 0.07
  EXT V2 < 0.07 ABUT<90 SINGULAR REGION
}
V2_array = SIZE (SIZE V2 BY 0.05 OVERUNDER) BY 0.150 UNDEROVER
V2_GAP2 = V2_array NOT M2
V2_GAP3 = V2_array NOT M3
V2_3 {
@Space between Vns (with run length0) at least two least two sides is 0.09, when array equal to or greater than 3x3. 
@Two Via areas whose space is within 0.10m are considered to be in the same array. An array does
@ not have both row and column greater than or equal to 3 can apply smaller spacing Vn.2 instead of Vn.3
    X = EXT (V2 INTERACT V2_array) V2< 0.090 OPPOSITE EXTENDED  0.001  REGION 
   Y =SIZE V2 BY 0.001
  (Y INTERACT  V2_array)  INTERACT (X NOT Y) >2 
}
/*
V2_4 {
@ V2_array not touching MOMDMY maximum width is 0.85
  (WITH WIDTH V2_array > 0.85) NOT INTERACT MOMDMY
}
*/
V2_5 {
@ V2 (different net) minimum space for run length > 0um is 0.1 (outside of SRAM)
 X = EXT V2 < 0.1 NOT CONNECTED OPPOSITE REGION
 X OUTSIDE INST
}
V2_5a {
@ V2 (different net) minimum space is 0.09
 EXT V2 < 0.09 NOT CONNECTED REGION

}
/*V2.5b {
@ Vn minimum space in different net inside of SRAM is 0.09
  EXT (V2 NOT OUTSIDE INST) < 0.09 NOT CONNECTED REGION
}*/

V2_6abc {
@ V2 must within M2
@  per Mn and Mn+1 intersection containing a Vn, must meet rule Vn.6a, Vn.6b or Vn.6c
@ V2.6a, V2 minimum within M2 is 0.015
@ Vn.6b	Mn overlap past Vn for two opposite sides with either side  >=0.01m, and < 0.015m  0.02
@ Vn.6c	Mn overlap past Vn for two opposite sides with either side >= 0m, and < 0.01m 0.03
  V2 NOT M2
  M2andM3 = (M2 AND M3) INTERACT (V2 OUTSIDE INST)
  BadV2 = RECTANGLE ENCLOSURE (V2 OUTSIDE INST) M2  OUTSIDE ALSO
  GOOD 0.015 OPPOSITE  0.015  OPPOSITE 0.015  OPPOSITE 0.015 OPPOSITE
  GOOD 0.02 OPPOSITE 0.01 OPPOSITE 0.02 OPPOSITE 0.01 OPPOSITE
  GOOD 0.03 0.0  0.03 0.0 
  BadV2 INTERACT M2andM3
}
SRV2_6 {
@ Vn minimum within Mn is 0.0
 (V2 NOT OUTSIDE INST) NOT INSIDE M2 
}
/*V2_6d {
@ V2 inside M2 with width > 0.14um, with at least one redundant V2.
@ This rule only applies to that M2/M3 intersection area can enclose a rectangle of 0.07*0.27.
 CMACRO V67D V2 M2 M3
}*/
V2_7abc {
@ V2 must within M3
@  per Mn and Mn+1 intersection containing a Vn, must meet rule Vn.7a, Vn.7b or Vn.7c
@ V2.7a, V2 minimum within M3 is 0.015
@ V2.7b, M3 minimum overlap past V2 for two opposite sides with either side >=0.01m, and < 0.015m  is 0.02
@ V2.7c, M3 minimum overlap past V2 for two opposite sides with the either side >=0m, and < 0.01m is 0.03
  V2 NOT M3
  M2andM3 = (M2 AND M3) INTERACT V2
  BadV2 = RECTANGLE ENCLOSURE V2 M3  OUTSIDE ALSO
  GOOD 0.015 OPPOSITE 0.015  OPPOSITE 0.015 OPPOSITE 0.015 OPPOSITE
  GOOD 0.02 OPPOSITE 0.01  OPPOSITE 0.02 OPPOSITE  0.01  OPPOSITE
  GOOD 0.03 0.0  0.03 0.0 
  BadV2 INTERACT M2andM3
}
/*V2_7d {
@ V2 inside M3 with width > 0.14um, with at least one redundant V2.
@ This rule only applies to that M2/M3 intersection area can enclose a rectangle of 0.07*0.27.
 CMACRO V67D V2 M3 M2
}*/

V2_8 {
@ At least two Vn vias must connect Mn to Mn+1 when the Mn or Mn+1 width is > 0.26um
  WM2 = WITH WIDTH M2 > 0.260
  WM3 = WITH WIDTH M3 > 0.260
  encVia = V2 INTERACT (WM2 OR WM3)
  ((M2 AND M3) ENCLOSE encVia) ENCLOSE V2 < 2
}
V2_9 {
@ At least three Vn vias must connect Mn to Mn+1 when the Mn or Mn+1 width is > 0.52um
  WM2 = WITH WIDTH M2 > 0.520
  WM3 = WITH WIDTH M3 > 0.520
  encVia = V2 INTERACT (WM2 OR WM3)
  ((M2 AND M3) ENCLOSE encVia) ENCLOSE V2 < 3
}
V2_10 {
@ At least four Vn vias must connect Mn to Mn+1 when the Mn or Mn+1 width is > 0.645um
  WM2 = WITH WIDTH M2 > 0.645
  WM3 = WITH WIDTH M3 > 0.645
  encVia = V2 INTERACT (WM2 OR WM3)
  ((M2 AND M3) ENCLOSE encVia) ENCLOSE V2 < 4
}
V2_square = RECTANGLE V2 ASPECT ==1
V2_EMPTY = EMPTY OR (V2_square INSIDE (M2 AND M3) )  
INTER_EMPTY2 =EMPTY OR (M2 AND M3) 
CONNECT  V2_EMPTY INTER_EMPTY2

V2_16 {
@At least two Vns with space <=0.16m when one of Mn or Mn+1 with both length and width >0.24m.
@Exclude non-square Vn and SRAM area.
X1a = WITH WIDTH M2  >0.24
X1b = WITH WIDTH M3  >0.24
WIDE = X1a OR X1b
X2 = (M3 AND M2) ENCLOSE V2_square
X3 =  V2_square INSIDE X2
X5c = EXT (V2_EMPTY INSIDE WIDE ) V2_EMPTY <=0.16 ABUT<90 REGION CONNECTED // space of via <= 0.16 
X6c = X2 ENCLOSE X5c  // good intersection with space of Via <= 0.16
X7= ((SIZE X3 BY 0.325) AND X2) ENCLOSE V2 >2
X7c=X2 ENCLOSE X7
X =((X2 NOT X6c) NOT X7c) ENCLOSE ( V2_square INSIDE WIDE ) // Via_16
X OUTSIDE INST
//COPY X5c
}

//WM2 = M2 WITH WIDTH > 0.24
V2_A = V2_square INTERACT WM2_EXP 

CONNECT V2 M2
CONNECT V2 M3
CONNECT V2_A M2
CONNECT WM2 M2
//M3_fake = area M3 >0
WM3 = M3 WITH WIDTH > 0.24
WM3_EDGE = LENGTH WM3 > 0
WM3_EXP = EXPAND EDGE WM3_EDGE OUTSIDE BY 1.1
WM3_L1 = ( M3 NOT WM3 ) TOUCH WM3
V2_A2 = V2_square INTERACT WM3_EXP
V2_A2_EMPTY = EMPTY OR V2_A2
M3_EMPTY = EMPTY OR M3
 WM3_EMPTY = EMPTY OR WM3 
CONNECT V2_A2_EMPTY M3_EMPTY
CONNECT WM3_EMPTY M3_EMPTY
V2_17 {
@ At least two Vns  when either wide metal of Mn or Mn+1 with both length L>0.24m and width W>0.24m, and the distance D<=1.1m away from this wide metal.
@ Exclude non-square Vn
WM2_L1 = ( M2 NOT WM2 ) TOUCH WM2
M2_ENCWM = (M2 INTERACT WM2) INTERACT V2_A
WM2_VEDGE = EXT [M2_ENCWM]  <1.1 ABUT<90 OPPOSITE NOTCH
WM2_EXT1 = EXT (WM2 COIN EDGE WM2_VEDGE) [V2_A] < 1.1 ABUT>=0 <90  OPPOSITE CONNECTED 
WM2_EXT2 = (EXT WM2 V2_A < 1.1 ABUT>=0 <90  OPPOSITE REGION CONNECTED ) INSIDE M2  
V2_B = V2_square WITH EDGE WM2_EXT1
X1 =(M2 AND M3) ENCLOSE V2_square >1
X2 = ((M2 AND M3)  AND ( WM2_L1 AND WM2_EXP )) NOT X1

Y0=(M2 AND M3) ENCLOSE V2_square ==1 
Y1 = SIZE (V2_square INTERACT Y0) BY 1.1 INSIDE OF M2 STEP 0.005  
Y2= Y1 INTERACT (Y1 AND WM2)

VSING1= ((X2 INTERACT V2_B ==1) INTERACT Y2) OR ((X2 INTERACT WM2_EXT2) INTERACT V2_A)
VSING1 OUTSIDE INST 

M3_ENCWM = (M3 INTERACT WM3) INTERACT V2_A2
WM3_VEDGE = EXT [M3_ENCWM]  <1.1 ABUT<90 OPPOSITE NOTCH
WM3_EXT1 = EXT (WM3_EMPTY COIN EDGE WM3_VEDGE) [V2_A2_EMPTY] < 1.1 ABUT>=0 <90  OPPOSITE CONNECTED 
WM3_EXT2 = (EXT WM3_EMPTY V2_A2_EMPTY < 1.1 ABUT>=0 <90  OPPOSITE REGION CONNECTED ) INSIDE M3  
V2_B2 = V2_square WITH EDGE WM3_EXT1
X3 = ((M2 AND M3)  AND ( WM3_L1 AND WM3_EXP )) NOT X1  
Y3 = SIZE (V2_square INTERACT Y0) BY 1.1 INSIDE OF M3 STEP 0.005  
Y4 = Y3 INTERACT (Y3 AND WM3)

VSING2= ((X3 INTERACT V2_B2 ==1) INTERACT Y4) OR (( X3 INTERACT WM3_EXT2) INTERACT V2_A2)
VSING2 OUTSIDE INST

}


//========================
//  V3 - Via 3 DRC
//========================

GROUP GV3 V3_?

V3_1 {
@ Fixed V3 size is 0.07
  NOT RECTANGLE V3 == 0.07 BY == 0.07
}
V3_2 {
@ Space between two V3 is 0.07
  EXT V3 < 0.07 ABUT<90 SINGULAR REGION
}
V3_array = SIZE (SIZE V3 BY 0.05 OVERUNDER) BY 0.150 UNDEROVER
V3_GAP3 = V3_array NOT M3
V3_GAP4 = V3_array NOT M4
V3_3 {
@Space between Vns (with run length0) at least two least two sides is 0.09, when array equal to or greater than 3x3. 
@Two Via areas whose space is within 0.10m are considered to be in the same array. An array does
@ not have both row and column greater than or equal to 3 can apply smaller spacing Vn.2 instead of Vn.3
  X = EXT (V3 INTERACT V3_array) V3< 0.090 OPPOSITE EXTENDED  0.001  REGION 
   Y =SIZE V3 BY 0.001
  (Y INTERACT  V3_array)  INTERACT (X NOT Y) >2
}
/*
V3_4 {
@ V3_array not touching MOMDMY maximum width is 0.85
  (WITH WIDTH V3_array > 0.85) NOT INTERACT MOMDMY
}
*/
#IFDEF TOPMETAL 9
V3_5 {
@ V3 (different net) minimum space for run length > 0um is 0.1(outside of SRAM)
  X = EXT V3 < 0.1 NOT CONNECTED OPPOSITE REGION
  X OUTSIDE INST 
}
V3_5a {
@ V3 (different net) minimum space is 0.09
  EXT V3 < 0.09 NOT CONNECTED REGION
 
}
/*V3_5b {
@ Vn minimum space in different net inside of SRAM is 0.09
  EXT (V3 NOT OUTSIDE INST) < 0.09 NOT CONNECTED REGION
}*/
#ENDIF
#IFDEF TOPMETAL 8

V3_5 {
@ V3 (different net) minimum space for run length > 0um is 0.1(outside of SRAM)
 X = EXT V3 < 0.1 NOT CONNECTED OPPOSITE REGION
  X OUTSIDE INST
}
V3_5a {
@ V3 (different net) minimum space is 0.09
 EXT V3 < 0.09 NOT CONNECTED REGION
 
}
/*V3_5b {
@ Vn minimum space in different net inside of SRAM is 0.09
 X = EXT (V3 AND INST) < 0.09 NOT CONNECTED REGION
 X NOT OUTSIDE INST
}*/
#ENDIF
#IFDEF TOPMETAL 7
V3_5 {
@ V3 (different net) minimum space for run length > 0um is 0.1(outside of SRAM)
 X = EXT V3 < 0.1 NOT CONNECTED OPPOSITE REGION
 X OUTSIDE INST
}
V3_5a {
@ V3 (different net) minimum space is 0.09
EXT V3 < 0.09 NOT CONNECTED REGION
 
}
/*V3_5b {
@ Vn minimum space in different net inside of SRAM is 0.09
  EXT (V3 NOT OUTSIDE INST) < 0.09 NOT CONNECTED REGION
}*/
#ENDIF
#IFDEF TOPMETAL 6
V3_5 {
@ V3 (different net) minimum space for run length > 0um is 0.1(outside of SRAM)
 X = EXT V3 < 0.1 NOT CONNECTED OPPOSITE REGION
 X OUTSIDE INST
}
V3_5a {
@ V3 (different net) minimum space is 0.09
 EXT V3 < 0.09 NOT CONNECTED REGION
 
}
/*V3_5b {
@ Vn minimum space in different net inside of SRAM is 0.09
  EXT (V3 NOT OUTSIDE INST) < 0.09 NOT CONNECTED REGION
}*/
#ENDIF
#IFDEF TOPMETAL 5
V3_5 {
@ V3 (different net) minimum space for run length > 0um is 0.1(outside of SRAM)
 X = EXT V3 < 0.1 NOT CONNECTED OPPOSITE REGION
 X OUTSIDE INST
}
V3_5a {
@ V3 (different net) minimum space is 0.09
 EXT V3 < 0.09 NOT CONNECTED REGION
  
}
/*V3_5b {
@ Vn minimum space in different net inside of SRAM is 0.09
  EXT (V3 NOT OUTSIDE INST) < 0.09 NOT CONNECTED REGION
}*/
#ENDIF
V3_6abc {
@ V2 must within M2
@  per Mn and Mn+1 intersection containing a Vn, must meet rule Vn.6a, Vn.6b or Vn.6c
@ V2.6a, V2 minimum within M2 is 0.015
@ Vn.6b	Mn overlap past Vn for two opposite sides with either side  >=0.01m, and < 0.015m  0.02
@ Vn.6c	Mn overlap past Vn for two opposite sides with either side >= 0m, and < 0.01m 0.03
  V3 NOT M3
  M3andM4 = (M3 AND M4) INTERACT V3
  BadV3 = RECTANGLE ENCLOSURE V3 M3 OUTSIDE ALSO
  GOOD 0.015 OPPOSITE 0.015 OPPOSITE  0.015  OPPOSITE 0.015 OPPOSITE
  GOOD 0.02 OPPOSITE 0.01 OPPOSITE  0.02 OPPOSITE 0.01  OPPOSITE
  GOOD 0.03 0.0  0.03 0.0 
  BadV3 INTERACT M3andM4
}
/*V3_6d {
@ Vn inside Mn with width > 0.14um, with at least one redundant Vn.
@ This rule only applies to that M3/M4 intersection area can enclose a rectangle of 0.07*0.27.
 CMACRO V67D V3 M3 M4
}*/
V3_7abc {
@ V2 must within M3
@  per Mn and Mn+1 intersection containing a Vn, must meet rule Vn.7a, Vn.7b or Vn.7c
@ V2.7a, V2 minimum within M3 is 0.015
@ V2.7b, M3 minimum overlap past V2 for two opposite sides with either side >=0.01m, and < 0.015m  is 0.02
@ V2.7c, M3 minimum overlap past V2 for two opposite sides with the either side >=0m, and < 0.01m is 0.03
  V3 NOT M4
  M3andM4 = (M3 AND M4) INTERACT V3
  BadV3 = RECTANGLE ENCLOSURE V3 M4  OUTSIDE ALSO
  GOOD 0.015 OPPOSITE  0.015 OPPOSITE  0.015 OPPOSITE  0.015 OPPOSITE
  GOOD 0.02 OPPOSITE 0.01 OPPOSITE  0.02  OPPOSITE 0.01  OPPOSITE
  GOOD 0.03 0.0  0.03 0.0 
  BadV3 INTERACT M3andM4
}
/*V3_7d {
@ Vn inside Mn+1 with width > 0.14um, with at least one redundant Vn.
@ This rule only applies to that M3/M4 intersection area can enclose a rectangle of 0.07*0.27.
 CMACRO V67D V3 M4 M3
}*/
V3_8 {
@ At least two Vn vias must connect Mn to Mn+1 when the Mn or Mn+1 width is > 0.26um
  WM3 = WITH WIDTH M3 > 0.260
  WM4 = WITH WIDTH M4 > 0.260
  encVia = V3 INTERACT (WM3 OR WM4)
  ((M3 AND M4) ENCLOSE encVia) ENCLOSE V3 < 2
}
V3_9 {
@ At least three Vn vias must connect Mn to Mn+1 when the Mn or Mn+1 width is > 0.52um
  WM3 = WITH WIDTH M3 > 0.520
  WM4 = WITH WIDTH M4 > 0.520
  encVia = V3 INTERACT (WM3 OR WM4)
  ((M3 AND M4) ENCLOSE encVia) ENCLOSE V3 < 3
}
V3_10 {
@ At least four Vn vias must connect Mn to Mn+1 when the Mn or Mn+1 width is > 0.645um
  WM3 = WITH WIDTH M3 > 0.645
  WM4 = WITH WIDTH M4 > 0.645
  encVia = V3 INTERACT (WM3 OR WM4)
  ((M3 AND M4) ENCLOSE encVia) ENCLOSE V3 < 4
}
V3_square = RECTANGLE V3 ASPECT ==1
V3_EMPTY = EMPTY OR (V3_square INSIDE (M3 AND M4) )  
INTER_EMPTY3 = EMPTY OR (M3 AND M4)
CONNECT  V3_EMPTY INTER_EMPTY3

V3_16 {
@At least two Vns with space <=0.16m when one of Mn or Mn+1 with both length and width >0.24m.
@Exclude non-square Vn and SRAM area.
X1a = WITH WIDTH M3  >0.24
X1b = WITH WIDTH M4  >0.24
WIDE = X1a OR X1b
X2 = (M3 AND M4) ENCLOSE V3_square
X3 =  V3_square INSIDE X2
X5c = EXT (V3_EMPTY INSIDE WIDE ) V3_EMPTY<=0.16 ABUT<90 REGION CONNECTED  // space of via <= 0.16 
X6c = X2 ENCLOSE X5c  // good intersection with space of Via <= 0.16
X7= ((SIZE X3 BY 0.325) AND X2) ENCLOSE V3 >2
X7c=X2 ENCLOSE X7
X=((X2 NOT X6c) NOT X7c) ENCLOSE (V3_square INSIDE WIDE) // Via_16
X OUTSIDE INST
}
V3_A = V3_square INTERACT WM3_EXP 
CONNECT V3_A M3
CONNECT V3 M3
CONNECT WM3 M3

//M4_fake = COPY M4
WM4 = M4 WITH WIDTH > 0.24
WM4_EDGE = LENGTH WM4 > 0
WM4_EXP = EXPAND EDGE WM4_EDGE OUTSIDE BY 1.1
WM4_L1 = ( M4 NOT WM4 ) TOUCH WM4
V3_A2 = V3_square INTERACT WM4_EXP

CONNECT V3 M4
V3_A2_EMPTY = EMPTY OR V3_A2
M4_EMPTY = EMPTY OR M4
WM4_EMPTY = EMPTY OR WM4 
CONNECT V3_A2_EMPTY M4_EMPTY
CONNECT WM4_EMPTY M4_EMPTY


V3_17 {
@ At least two Vns  when either wide metal of Mn or Mn+1 with both length L>0.24m and width W>0.24m, and the distance D<=1.1m away from this wide metal.
@ Exclude non-square Vn
WM3_L1 = ( M3 NOT WM3 ) TOUCH WM3
M3_ENCWM = (M3 INTERACT WM3) INTERACT V3_A
WM3_VEDGE = EXT [M3_ENCWM]  <1.1 ABUT<90 OPPOSITE NOTCH
WM3_EXT1 = EXT (WM3 COIN EDGE WM3_VEDGE) [V3_A] < 1.1 ABUT>=0 <90  OPPOSITE CONNECTED 
WM3_EXT2 = (EXT WM3 V3_A < 1.1 ABUT>=0 <90  OPPOSITE REGION CONNECTED ) INSIDE M3  
V3_B = V3_square WITH EDGE WM3_EXT1
X1 =(M3 AND M4) ENCLOSE V3_square >1
X2 = ((M3 AND M4)  AND ( WM3_L1 AND WM3_EXP )) NOT X1 


Y0=(M3 AND M4) ENCLOSE V3_square ==1 
Y1 = SIZE (V3_square INTERACT Y0) BY 1.1 INSIDE OF M3 STEP 0.005  
Y2= Y1 INTERACT (Y1 AND WM3)
 
VSING1= ((X2 INTERACT V3_B ==1) INTERACT Y2) OR ((X2 INTERACT WM3_EXT2) INTERACT V3_A)
VSING1 OUTSIDE INST 

M4_ENCWM = (M4 INTERACT WM4) INTERACT V3_A2
WM4_VEDGE = EXT [M4_ENCWM]  <1.1 ABUT<90 OPPOSITE NOTCH
WM4_EXT1 = EXT (WM4_EMPTY COIN EDGE WM4_VEDGE) [V3_A2_EMPTY] < 1.1 ABUT>=0 <90  OPPOSITE CONNECTED 
WM4_EXT2 = (EXT WM4_EMPTY V3_A2_EMPTY < 1.1 ABUT>=0 <90  OPPOSITE REGION CONNECTED ) INSIDE M4  
V3_B2 = V3_square WITH EDGE WM4_EXT1
X3 = ((M3 AND M4)  AND ( WM4_L1 AND WM4_EXP )) NOT X1 
Y3 = SIZE (V3_square INTERACT Y0) BY 1.1 INSIDE OF M4 STEP 0.005  
Y4= Y3 INTERACT (Y3 AND WM4)
 
VSING2= ((X3 INTERACT V3_B2 ==1) INTERACT Y4) OR (( X3 INTERACT WM4_EXT2) INTERACT V3_A2)
VSING2 OUTSIDE INST


}


//========================
//  V4 - Via 4 DRC
//========================

GROUP GV4 V4_?

V4_1 {
@ Fixed V4 size is 0.07
  NOT RECTANGLE V4 == 0.07 BY == 0.07
}
V4_2 {
@ Space between two V4 is 0.07
  EXT V4 < 0.07 ABUT<90 SINGULAR REGION
}
V4_array = SIZE (SIZE V4 BY 0.05 OVERUNDER) BY 0.150 UNDEROVER
V4_GAP4 = V4_array NOT M4
V4_GAP5 = V4_array NOT M5
V4_3 {
@Space between Vns (with run length0) at least two least two sides is 0.09, when array equal to or greater than 3x3. 
@Two Via areas whose space is within 0.10m are considered to be in the same array. An array does
@ not have both row and column greater than or equal to 3 can apply smaller spacing Vn.2 instead of Vn.3
 X = EXT (V4 INTERACT V4_array) V4< 0.090 OPPOSITE EXTENDED  0.001  REGION 
   Y =SIZE V4 BY 0.001
  (Y INTERACT  V4_array)  INTERACT (X NOT Y) >2
}
/*
V4_4 {
@ V4_array not touching MOMDMY maximum width is 0.85
  (WITH WIDTH V4_array > 0.85) NOT INTERACT MOMDMY
}
*/
#IFDEF TOPMETAL 9
V4_5 {
@ V4 (different net) minimum space for run length > 0um is 0.1 (outside of SRAM)
 X = EXT V4 < 0.1 NOT CONNECTED OPPOSITE REGION
 X OUTSIDE INST
}
V4_5a {
@ V4 (different net) minimum space is 0.09
 EXT V4 < 0.09 NOT CONNECTED REGION
  
}
/*V4_5b {
@ Vn minimum space in different net inside of SRAM is 0.09
  EXT (V4 NOT OUTSIDE INST) < 0.09 NOT CONNECTED REGION
}*/
#ENDIF
#IFDEF TOPMETAL 8
V4_5 {
@ V4 (different net) minimum space for run length > 0um is 0.1 (outside of SRAM)
 X = EXT V4 < 0.1 NOT CONNECTED OPPOSITE REGION
 X OUTSIDE INST
}
V4_5a {
@ V4 (different net) minimum space is 0.09
   EXT V4 < 0.09 NOT CONNECTED REGION
 
}
/*V4_5b {
@ Vn minimum space in different net inside of SRAM is 0.09
  EXT (V4 NOT OUTSIDE INST) < 0.09 NOT CONNECTED REGION
}*/
#ENDIF
#IFDEF TOPMETAL 7
V4_5 {
@ V4 (different net) minimum space for run length > 0um is 0.1 (outside of SRAM)
 X = EXT V4 < 0.1 NOT CONNECTED OPPOSITE REGION
 X OUTSIDE INST
}
V4_5a {
@ V4 (different net) minimum space is 0.09
  EXT V4 < 0.09 NOT CONNECTED REGION
  
}
/*V4_5b {
@ Vn minimum space in different net inside of SRAM is 0.09
  EXT (V4 NOT OUTSIDE INST) < 0.09 NOT CONNECTED REGION
}*/
#ENDIF
#IFDEF TOPMETAL 6
V4_5 {
@ V4 (different net) minimum space for run length > 0um is 0.11 (outside of SRAM)
  X =EXT V4 < 0.1 NOT CONNECTED OPPOSITE REGION
  X OUTSIDE INST
}
V4_5a {
@ V4 (different net) minimum space is 0.09
 EXT V4 < 0.09 NOT CONNECTED REGION
}
/*V4_5b {
@ Vn minimum space in different net inside of SRAM is 0.09
  EXT (V4 NOT OUTSIDE INST) < 0.09 NOT CONNECTED REGION
}*/
#ENDIF
V4_6abc {
@ V2 must within M2
@  per Mn and Mn+1 intersection containing a Vn, must meet rule Vn.6a, Vn.6b or Vn.6c
@ V2.6a, V2 minimum within M2 is 0.015
@ Vn.6b	Mn overlap past Vn for two opposite sides with either side  >=0.01m, and < 0.015m  0.02
@ Vn.6c	Mn overlap past Vn for two opposite sides with either side >= 0m, and < 0.01m 0.03
  V4 NOT M4
  M4andM5 = (M4 AND M5) INTERACT V4
  BadV4 = RECTANGLE ENCLOSURE V4 M4 OUTSIDE ALSO
  GOOD 0.015 OPPOSITE  0.015 OPPOSITE   0.015  OPPOSITE  0.015 OPPOSITE
  GOOD 0.02 OPPOSITE  0.01  OPPOSITE  0.02  OPPOSITE 0.01 OPPOSITE 
  GOOD 0.03 0.0  0.03 0.0
  BadV4 INTERACT M4andM5
}
/*V4_6d {
@ Vn touching Mn with width > 0.14um, with at least one redundant Vn.
@ This rule only applies to that M4/M5 intersection area can enclose a rectangle of 0.07*0.27.
 CMACRO V67D V4 M4 M5
}*/

V4_7abc {
@ V2 must within M3
@  per Mn and Mn+1 intersection containing a Vn, must meet rule Vn.7a, Vn.7b or Vn.7c
@ V2.7a, V2 minimum within M3 is 0.015
@ V2.7b, M3 minimum overlap past V2 for two opposite sides with either side >=0.01m, and < 0.015m  is 0.02
@ V2.7c, M3 minimum overlap past V2 for two opposite sides with the either side >=0m, and < 0.01m is 0.03
  V4 NOT M5
  M4andM5 = (M4 AND M5) INTERACT V4
  BadV4 = RECTANGLE ENCLOSURE V4 M5 OUTSIDE ALSO
  GOOD 0.015  OPPOSITE 0.015 OPPOSITE  0.015 OPPOSITE 0.015 OPPOSITE
  GOOD 0.02 OPPOSITE 0.01 OPPOSITE  0.02 OPPOSITE 0.01  OPPOSITE
  GOOD 0.03 0.0  0.03 0.0 
  BadV4 INTERACT M4andM5
}
/*V4_7d {
@ Vn+1 touching Mn with width > 0.14um, with at least one redundant Vn.
@ This rule only applies to that M4/M5 intersection area can enclose a rectangle of 0.07*0.27.
 CMACRO V67D V4 M5 M4
}*/
V4_8 {
@ At least two Vn vias must connect Mn to Mn+1 when the Mn or Mn+1 width is > 0.26um
  WM4 = WITH WIDTH M4 > 0.260
  WM5 = WITH WIDTH M5 > 0.260
  encVia = V4 INTERACT (WM4 OR WM5)
  ((M4 AND M5) ENCLOSE encVia) ENCLOSE V4 < 2
}
V4_9 {
@ At least three Vn vias must connect Mn to Mn+1 when the Mn or Mn+1 width is > 0.52um
  WM4 = WITH WIDTH M4 > 0.520
  WM5 = WITH WIDTH M5 > 0.520
  encVia = V4 INTERACT (WM4 OR WM5)
  ((M4 AND M5) ENCLOSE encVia) ENCLOSE V4 < 3
}
V4_10 {
@ At least four Vn vias must connect Mn to Mn+1 when the Mn or Mn+1 width is > 0.645um
  WM4 = WITH WIDTH M4 > 0.645
  WM5 = WITH WIDTH M5 > 0.645
  encVia = V4 INTERACT (WM4 OR WM5)
  ((M4 AND M5) ENCLOSE encVia) ENCLOSE V4 < 4
}
V4_square = RECTANGLE V4 ASPECT ==1
V4_EMPTY = EMPTY OR (V4_square INSIDE (M4 AND M5) )
INTER_EMPTY4 = EMPTY OR (M4 AND M5) 
CONNECT  V4_EMPTY INTER_EMPTY4

V4_16 {
@At least two Vns with space <=0.16m when one of Mn or Mn+1 with both length and width >0.24m.
@Exclude non-square Vn and SRAM area.
X1a = WITH WIDTH M4  >0.24
X1b = WITH WIDTH M5  >0.24
WIDE = X1a OR X1b
X2 = (M5 AND M4) ENCLOSE V4_square
X3 =  V4_square INSIDE X2
X5c = EXT (V4_EMPTY INSIDE WIDE ) V4_EMPTY<=0.16 ABUT<90 REGION CONNECTED // space of via <= 0.14 
X6c = X2 ENCLOSE X5c  // good intersection with space of Via <= 0.14
X7= ((SIZE X3 BY 0.325) AND X2) ENCLOSE V4 >2
X7c=X2 ENCLOSE X7
X =((X2 NOT X6c) NOT X7c) ENCLOSE ( V4_square INSIDE WIDE) // Via_16
X OUTSIDE INST
}
//WM4 = M4 WITH WIDTH > 0.24
CONNECT V4 M4
CONNECT V4 M5
V4_A = V4_square INTERACT WM4_EXP
CONNECT V4_A M4
CONNECT WM4 M4
WM5 = M5 WITH WIDTH > 0.24
WM5_EDGE = LENGTH WM5 > 0
WM5_EXP = EXPAND EDGE WM5_EDGE OUTSIDE BY 1.1
WM5_L1 = ( M5 NOT WM5 ) TOUCH WM5
V4_A2 = V4_square INTERACT WM5_EXP

V4_A2_EMPTY = EMPTY OR V4_A2
M5_EMPTY = EMPTY OR M5
 WM5_EMPTY = EMPTY OR WM5 
CONNECT V4_A2_EMPTY M5_EMPTY
CONNECT WM5_EMPTY M5_EMPTY




V4_17 {
@ At least two Vns when either wide metal of Mn or Mn+1 with both length L>0.24m and width W>0.24m, and the distance D<=1.1m away from this wide metal.
@ Exclude non-square Vn
 
WM4_L1 = ( M4 NOT WM4 ) TOUCH WM4
M4_ENCWM = (M4 INTERACT WM4) INTERACT V4_A
WM4_VEDGE = EXT [M4_ENCWM]  <1.1 ABUT<90 OPPOSITE NOTCH
WM4_EXT1 = EXT (WM4 COIN EDGE WM4_VEDGE) [V4_A] < 1.1 ABUT>=0 <90  OPPOSITE CONNECTED 
WM4_EXT2 = (EXT WM4 V4_A < 1.1 ABUT>=0 <90  OPPOSITE REGION CONNECTED ) INSIDE M4  
V4_B = V4_square WITH EDGE WM4_EXT1
X1 =(M4 AND M5) ENCLOSE V4_square >1
X2 = ((M4 AND M5)  AND ( WM4_L1 AND WM4_EXP )) NOT X1  
Y0=(M4 AND M5) ENCLOSE V4_square ==1 
Y1 = SIZE (V4_square INTERACT Y0) BY 1.1 INSIDE OF M4 STEP 0.005  
Y2= Y1 INTERACT (Y1 AND WM4)
VSING1= ((X2 INTERACT V4_B ==1) INTERACT Y2) OR ((X2 INTERACT WM4_EXT2) INTERACT V4_A)
VSING1 OUTSIDE INST 

M5_ENCWM = (M5 INTERACT WM5) INTERACT V4_A2
WM5_VEDGE = EXT [M5_ENCWM]  <1.1 ABUT<90 OPPOSITE NOTCH
WM5_EXT1 = EXT (WM5_EMPTY COIN EDGE WM5_VEDGE) [V4_A2_EMPTY] < 1.1 ABUT>=0 <90  OPPOSITE CONNECTED 
WM5_EXT2 = (EXT WM5_EMPTY V4_A2_EMPTY < 1.1 ABUT>=0 <90  OPPOSITE REGION CONNECTED ) INSIDE M5  
V4_B2 = V4_square WITH EDGE WM5_EXT1
X3 = ((M4 AND M5)  AND ( WM5_L1 AND WM5_EXP )) NOT X1  
Y3 = SIZE (V4_square INTERACT Y0) BY 1.1 INSIDE OF M5 STEP 0.005  
Y4= Y3 INTERACT (Y3 AND WM5)
VSING2= ((X3 INTERACT V4_B2 ==1) INTERACT Y4) OR (( X3 INTERACT WM5_EXT2) INTERACT V4_A2)
VSING2 OUTSIDE INST

}

//========================
//  V5 - Via 5 DRC
//========================

GROUP GV5 V5_?

V5_1 {
@ Fixed V5 size is 0.07
  NOT RECTANGLE V5 == 0.07 BY == 0.07
}
V5_2 {
@ Space between two V5 is 0.07
  EXT V5 < 0.07 ABUT<90 SINGULAR REGION
}
V5_array = SIZE (SIZE V5 BY 0.05 OVERUNDER) BY 0.150 UNDEROVER
V5_GAP5 = V5_array NOT M5
V5_GAP6 = V5_array NOT M6
V5_3 {
@Space between Vns (with run length0) at least two least two sides is 0.09, when array equal to or greater than 3x3. 
@Two Via areas whose space is within 0.10m are considered to be in the same array. An array does
@ not have both row and column greater than or equal to 3 can apply smaller spacing Vn.2 instead of Vn.3
   X = EXT (V5 INTERACT V5_array) V5< 0.090 OPPOSITE EXTENDED  0.001  REGION 
   Y =SIZE V5 BY 0.001
  (Y INTERACT  V5_array)  INTERACT (X NOT Y) >2
}
/*
V5_4 {
@ V5_array not touching MOMDMY maximum width is 0.85
  (WITH WIDTH V5_array > 0.85) NOT INTERACT MOMDMY
}
*/
#IFDEF TOPMETAL 9
V5_5 {
@ V5 (different net) minimum space for run length > 0um is 0.1(outside of SRAM)
  X = EXT V5 < 0.1 NOT CONNECTED OPPOSITE REGION
  X OUTSIDE INST 
}
V5_5a {
@ V5 (different net) minimum space is 0.09
 EXT V5 < 0.09 NOT CONNECTED REGION

}
/*V5_5b {
@ Vn minimum space in different net inside of SRAM is 0.09
  EXT (V5 NOT OUTSIDE INST) < 0.09 NOT CONNECTED REGION
}*/
#ENDIF
#IFDEF TOPMETAL 8
V5_5 {
@ V5 (different net) minimum space for run length > 0um is 0.1(outside of SRAM)
  X =EXT V5 < 0.1 NOT CONNECTED OPPOSITE REGION
  X OUTSIDE INST
}
V5_5a {
@ V5 (different net) minimum space is 0.09
 EXT V5 < 0.09 NOT CONNECTED REGION
 
}
/*V5_5b {
@ Vn minimum space in different net inside of SRAM is 0.09
  EXT (V5 NOT OUTSIDE INST) < 0.09 NOT CONNECTED REGION
}*/
#ENDIF
#IFDEF TOPMETAL 7
V5_5 {
@ V5 (different net) minimum space for run length > 0um is 0.1(outside of SRAM)
  X =EXT V5 < 0.1 NOT CONNECTED OPPOSITE REGION
  X OUTSIDE INST
}
V5_5a {
@ V5 (different net) minimum space is 0.09
  EXT V5 < 0.09 NOT CONNECTED REGION
 
}
/*V5_5b {
@ Vn minimum space in different net inside of SRAM is 0.09
  EXT (V5 NOT OUTSIDE INST) < 0.09 NOT CONNECTED REGION
}*/
#ENDIF
V5_6abc {
@ V2 must within M2
@  per Mn and Mn+1 intersection containing a Vn, must meet rule Vn.6a, Vn.6b or Vn.6c
@ V2.6a, V2 minimum within M2 is 0.015
@ Vn.6b	Mn overlap past Vn for two opposite sides with either side  >=0.01m, and < 0.015m  0.02
@ Vn.6c	Mn overlap past Vn for two opposite sides with either side >= 0m, and < 0.01m 0.03
  V5 NOT M5
  M5andM6 = (M5 AND M6) INTERACT V5
  Badv5 = RECTANGLE ENCLOSURE V5 M5  OUTSIDE ALSO
  GOOD 0.015  OPPOSITE 0.015  OPPOSITE  0.015 OPPOSITE  0.015 OPPOSITE
  GOOD 0.02 OPPOSITE 0.01 OPPOSITE  0.02 OPPOSITE 0.01 OPPOSITE 
  GOOD 0.03 0.0  0.03 0.0 
  BadV5 INTERACT M5andM6
}
/*V5_6d {
@ Vn touching Mn with width > 0.14um, with at least one redundant Vn.
@ This rule only applies to that M5/M6 intersection area can enclose a rectangle of 0.07*0.27.
 CMACRO V67D V5 M5 M6
}*/
V5_7abc {
@ V2 must within M2
@  per Mn and Mn+1 intersection containing a Vn, must meet rule Vn.6a, Vn.6b or Vn.6c
@ V2.6a, V2 minimum within M2 is 0.015
@ Vn.6b	Mn overlap past Vn for two opposite sides with either side  >=0.01m, and < 0.015m  0.02
@ Vn.6c	Mn overlap past Vn for two opposite sides with either side >= 0m, and < 0.01m 0.03
  V5 NOT M6
  M5andM6 = (M5 AND M6) INTERACT V5
  BadV5 = RECTANGLE ENCLOSURE V5 M6 OUTSIDE ALSO
  GOOD 0.015  OPPOSITE 0.015  OPPOSITE  0.015 OPPOSITE  0.015 OPPOSITE
  GOOD 0.02 OPPOSITE 0.01 OPPOSITE  0.02  OPPOSITE 0.01  OPPOSITE
  GOOD 0.03 0.0  0.03 0.0 
  BadV5 INTERACT M5andM6
}
/*V5_7d {
@ Vn+1 touching Mn with width > 0.14um, with at least one redundant Vn.
@ This rule only applies to that M5/M6 intersection area can enclose a rectangle of 0.07*0.27.
 CMACRO V67D V5 M6 M5
}*/
V5_8 {
@ At least two Vn vias must connect Mn to Mn+1 when the Mn or Mn+1 width is > 0.26um
  WM5 = WITH WIDTH M5 > 0.260
  WM6 = WITH WIDTH M6 > 0.260
  encVia = V5 INTERACT (WM5 OR WM6)
  ((M5 AND M6) ENCLOSE encVia) ENCLOSE V5 < 2
}
V5_9 {
@ At least three Vn vias must connect Mn to Mn+1 when the Mn or Mn+1 width is > 0.52um
  WM5 = WITH WIDTH M5 > 0.520
  WM6 = WITH WIDTH M6 > 0.520
  encVia = V5 INTERACT (WM5 OR WM6)
  ((M5 AND M6) ENCLOSE encVia) ENCLOSE V5 < 3
}
V5_10 {
@ At least four Vn vias must connect Mn to Mn+1 when the Mn or Mn+1 width is > 0.645um
  WM5 = WITH WIDTH M5 > 0.645
  WM6 = WITH WIDTH M6 > 0.645
  encVia = V5 INTERACT (WM5 OR WM6)
  ((M5 AND M6) ENCLOSE encVia) ENCLOSE V5 < 4
}
V5_square = RECTANGLE V5 ASPECT ==1
V5_EMPTY = EMPTY  OR (V5_square INSIDE (M5 AND M6) )
INTER_EMPTY5 = EMPTY OR (M5 AND M6) 
CONNECT  V5_EMPTY INTER_EMPTY5

V5_16 {
@At least two Vns with space <=0.16m when one of Mn or Mn+1 with both length and width >0.24m.
@Exclude non-square Vn and SRAM area.
X1a = WITH WIDTH M5  >0.24
X1b = WITH WIDTH M6  >0.24
WIDE = X1a OR X1b
X2 = (M5 AND M6) ENCLOSE V5_square
X3 =  V5_square INSIDE X2
X5c = EXT (V5_EMPTY INSIDE WIDE ) V5_EMPTY<=0.16 ABUT<90 REGION OPPOSITE // space of via <= 0.16 
X6c = X2 ENCLOSE X5c  // good intersection with space of Via <= 0.16
X7= ((SIZE X3 BY 0.325) AND X2) ENCLOSE V5 >2
X7c=X2 ENCLOSE X7

X =((X2 NOT X6c)NOT X7c) ENCLOSE (V5_square INSIDE WIDE ) // Via_16
X OUTSIDE INST
}
//WM5 = M5 WITH WIDTH > 0.24
CONNECT V5 M5
V5_A = V5_square INTERACT WM5_EXP
CONNECT V5_A M5
CONNECT WM5 M5

WM6 = M6 WITH WIDTH > 0.24
WM6_EDGE = LENGTH WM6 > 0
WM6_EXP = EXPAND EDGE WM6_EDGE OUTSIDE BY 1.1
WM6_L1 = ( M6 NOT WM6 ) TOUCH WM6
V5_A2 = V5_square INTERACT WM6_EXP
CONNECT V5 M6
V5_A2_EMPTY = EMPTY OR V5_A2
M6_EMPTY = EMPTY OR M6
 WM6_EMPTY = EMPTY OR WM6 
CONNECT V5_A2_EMPTY M6_EMPTY
CONNECT WM6_EMPTY M6_EMPTY


V5_17 {
@ At least two Vns when either wide metal of Mn or Mn+1 with both length L>0.24m and width W>0.24m, and the distance D<=1.1m away from this wide metal.
@ Exclude non-square Vn
WM5_L1 = ( M5 NOT WM5 ) TOUCH WM5
M5_ENCWM = (M5 INTERACT WM5) INTERACT V5_A
WM5_VEDGE = EXT [M5_ENCWM]  <1.1 ABUT<90 OPPOSITE NOTCH
WM5_EXT1 = EXT (WM5 COIN EDGE WM5_VEDGE) [V5_A] < 1.1 ABUT>=0 <90  OPPOSITE CONNECTED 
WM5_EXT2 = (EXT WM5 V5_A < 1.1 ABUT>=0 <90  OPPOSITE REGION CONNECTED ) INSIDE M5  
V5_B = V5_square WITH EDGE WM5_EXT1
X1 =(M5 AND M6) ENCLOSE V5_square >1
X2 = ((M5 AND M6)  AND ( WM5_L1 AND WM5_EXP )) NOT X1 

Y0=(M5 AND M6) ENCLOSE V5_square ==1 
Y1 = SIZE (V5_square INTERACT Y0) BY 1.1 INSIDE OF M5 STEP 0.005  
Y2= Y1 INTERACT (Y1 AND WM5)
 
VSING1= ((X2 INTERACT V5_B ==1) INTERACT Y2)  OR ((X2 INTERACT WM5_EXT2) INTERACT V5_A)
VSING1 OUTSIDE INST 

M6_ENCWM = (M6 INTERACT WM6) INTERACT V5_A2
WM6_VEDGE = EXT [M6_ENCWM]  <1.1 ABUT<90 OPPOSITE NOTCH
WM6_EXT1 = EXT (WM6_EMPTY COIN EDGE WM6_VEDGE) [V5_A2_EMPTY] < 1.1 ABUT>=0 <90  OPPOSITE CONNECTED 
WM6_EXT2 = (EXT WM6_EMPTY V5_A2_EMPTY < 1.1 ABUT>=0 <90  OPPOSITE REGION CONNECTED ) INSIDE M6  
V5_B2 = V5_square WITH EDGE WM6_EXT1
X3 = ((M5 AND M6)  AND ( WM6_L1 AND WM6_EXP )) NOT X1 
Y3 = SIZE (V5_square INTERACT Y0) BY 1.1 INSIDE OF M6 STEP 0.005  
Y4= Y3 INTERACT (Y3 AND WM6) 
VSING2= ((X3 INTERACT V5_B2 ==1) INTERACT Y4) OR (( X3 INTERACT WM6_EXT2) INTERACT V5_A2)
VSING2 OUTSIDE INST
}

//========================
//  V6 - Via 6 DRC
//========================

GROUP GV6 V6_?

V6_1 {
@ Fixed V6 size is 0.07
  NOT RECTANGLE V6 == 0.07 BY == 0.07
}
V6_2 {
@ Space between two V6 is 0.07
  EXT V6 < 0.07 ABUT<90 SINGULAR REGION
}
V6_array = SIZE (SIZE V6 BY 0.05 OVERUNDER) BY 0.150 UNDEROVER
V6_GAP6 = V6_array NOT M6
V6_GAP7 = V6_array NOT M7
V6_3 {
@Space between Vns (with run length0) at least two least two sides is 0.09, when array equal to or greater than 3x3. 
@Two Via areas whose space is within 0.10m are considered to be in the same array. An array does
@ not have both row and column greater than or equal to 3 can apply smaller spacing Vn.2 instead of Vn.3
 X = EXT (V6 INTERACT V6_array) V6< 0.090 OPPOSITE EXTENDED  0.001  REGION 
   Y =SIZE V6 BY 0.001
  (Y INTERACT  V6_array)  INTERACT (X NOT Y) >2
}
/*
V6_4 {
@ V6_array not touching MOMDMY maximum width is 0.85
  (WITH WIDTH V6_array > 0.85) NOT INTERACT MOMDMY
}
*/
#IFDEF TOPMETAL 9
V6_5 {
@ V6 (different net) minimum space for run length > 0um is 0.1(outside of SRAM)
 X = EXT V6 < 0.1 NOT CONNECTED OPPOSITE REGION
 X OUTSIDE INST 
}
V6_5a {
@ V6 (different net) minimum space is 0.09
  EXT V6 < 0.09 NOT CONNECTED REGION
 
}
/*V6_5b {
@ Vn minimum space in different net inside of SRAM is 0.09
  EXT (V6 NOT OUTSIDE INST) < 0.09 NOT CONNECTED REGION
}*/
#ENDIF
#IFDEF TOPMETAL 8
V6_5 {
@ V6 (different net) minimum space for run length > 0um is 0.1(outside of SRAM)
 X = EXT V6 < 0.1 NOT CONNECTED OPPOSITE REGION
 X OUTSIDE INST
}
V6_5a {
@ V6 (different net) minimum space is 0.09
 EXT V6 < 0.09 NOT CONNECTED REGION
 
}
/*V6_5b {
@ Vn minimum space in different net inside of SRAM is 0.09
  EXT (V6 NOT OUTSIDE INST) < 0.09 NOT CONNECTED REGION
}*/
#ENDIF
V6_6abc {
@ V2 must within M2
@  per Mn and Mn+1 intersection containing a Vn, must meet rule Vn.6a, Vn.6b or Vn.6c
@ V2.6a, V2 minimum within M2 is 0.015
@ Vn.6b	Mn overlap past Vn for two opposite sides with either side  >=0.01m, and < 0.015m  0.02
@ Vn.6c	Mn overlap past Vn for two opposite sides with either side >= 0m, and < 0.01m 0.03
  V6 NOT M6
  M6andM7 = (M6 AND M7) INTERACT V6
  BadV6 = RECTANGLE ENCLOSURE V6 M6  OUTSIDE ALSO
  GOOD 0.015 OPPOSITE 0.015 OPPOSITE  0.015 OPPOSITE 0.015 OPPOSITE
  GOOD 0.02 OPPOSITE 0.01 OPPOSITE  0.02 OPPOSITE 0.01  OPPOSITE
  GOOD 0.03 0.0  0.03 0.0 
  BadV6 INTERACT M6andM7
}
/*V6_6d {
@ Vn touching Mn with width > 0.14um, with at least one redundant Vn.
@ This rule only applies to that M6/M7 intersection area can enclose a rectangle of 0.07*0.27.
 CMACRO V67D V6 M6 M7
}*/
V6_7abc {
@ V2 must within M3
@  per Mn and Mn+1 intersection containing a Vn, must meet rule Vn.7a, Vn.7b or Vn.7c
@ V6.7a, V2 minimum within M3 is 0.015
@ V6.7b, M3 minimum overlap past V2 for two opposite sides with either side >=0.01m, and < 0.015m  is 0.02
@ V6.7c, M3 minimum overlap past V2 for two opposite sides with the either side >=0m, and < 0.01m is 0.03
  V6 NOT M7
  M6andM7 = (M6 AND M7) INTERACT V6
  BadV6 = RECTANGLE ENCLOSURE V6 M7  OUTSIDE ALSO
  GOOD 0.015 OPPOSITE 0.015 OPPOSITE  0.015  OPPOSITE 0.015 OPPOSITE
  GOOD 0.02 OPPOSITE 0.01 OPPOSITE 0.02 OPPOSITE 0.01 OPPOSITE
  GOOD 0.03 0.0  0.03 0.0 
  BadV6 INTERACT M6andM7
}
/*V6_7d {
@ Vn+1 touching Mn with width > 0.14um, with at least one redundant Vn.
@ This rule only applies to that M6/M7 intersection area can enclose a rectangle of 0.07*0.27.
 CMACRO V67D V6 M7 M6
}*/
V6_8 {
@ At least two Vn vias must connect Mn to Mn+1 when the Mn or Mn+1 width is > 0.26um
  WM6 = WITH WIDTH M6 > 0.260
  WM7 = WITH WIDTH M7 > 0.260
  encVia = V6 INTERACT (WM6 OR WM7)
  ((M6 AND M7) ENCLOSE encVia) ENCLOSE V6 < 2
}
V6_9 {
@ At least three Vn vias must connect Mn to Mn+1 when the Mn or Mn+1 width is > 0.52um
  WM6 = WITH WIDTH M6 > 0.520
  WM7 = WITH WIDTH M7 > 0.520
  encVia = V6 INTERACT (WM6 OR WM7)
  ((M6 AND M7) ENCLOSE encVia) ENCLOSE V6 < 3
}
V6_10 {
@ At least four Vn vias must connect Mn to Mn+1 when the Mn or Mn+1 width is > 0.645um
  WM6 = WITH WIDTH M6 > 0.645
  WM7 = WITH WIDTH M7 > 0.645
  encVia = V6 INTERACT (WM6 OR WM7)
  ((M6 AND M7) ENCLOSE encVia) ENCLOSE V6 < 4
}
V6_square = RECTANGLE V6 ASPECT ==1
V6_EMPTY =EMPTY OR  (V6_square INSIDE (M6 AND M7) ) 
INTER_EMPTY6 =EMPTY OR (M6 AND M7)
CONNECT  V6_EMPTY INTER_EMPTY6

V6_16 {
@At least two Vns with space <=0.16m when one of Mn or Mn+1 with both length and width >0.24m.
@Exclude non-square Vn and SRAM area.
X1a = WITH WIDTH M6  >0.24
X1b = WITH WIDTH M7  >0.24
WIDE = X1a OR X1b
X2 = (M7 AND M6) ENCLOSE V6_square
X3 =  V6_square INSIDE X2
X5c = EXT (V6_EMPTY INSIDE WIDE ) V6_EMPTY<=0.16 ABUT<90 REGION CONNECTED // space of via <= 0.16 
X6c = X2 ENCLOSE X5c  // good intersection with space of Via <= 0.16
X7= ((SIZE X3 BY 0.325) AND X2) ENCLOSE V6 >2
X7c=X2 ENCLOSE X7
X =((X2 NOT X6c) NOT X7c) ENCLOSE (V6_square INSIDE  WIDE ) // Via_16
X OUTSIDE INST
}
//WM6 = M6 WITH WIDTH > 0.24
CONNECT V6 M6
V6_A = V6_square INTERACT WM6_EXP
CONNECT V6_A M6
CONNECT WM6 M6
WM7 = M7 WITH WIDTH > 0.24
WM7_EDGE = LENGTH WM7 > 0
WM7_EXP = EXPAND EDGE WM7_EDGE OUTSIDE BY 1.1
WM7_L1 = ( M7 NOT WM7 ) TOUCH WM7
V6_A2 = V6_square INTERACT WM7_EXP
CONNECT V6 M7
V6_A2_EMPTY = EMPTY OR V6_A2
M7_EMPTY = EMPTY OR M7
 WM7_EMPTY = EMPTY OR WM7 
CONNECT V6_A2_EMPTY M7_EMPTY
CONNECT WM7_EMPTY M7_EMPTY


V6_17 {
@ At least two Vns when either wide metal of Mn or Mn+1 with both length L>0.24m and width W>0.24m, and the distance D<=1.1m away from this wide metal.
@ Exclude non-square Vn
WM6_L1 = ( M6 NOT WM6 ) TOUCH WM6
M6_ENCWM = (M6 INTERACT WM6) INTERACT V6_A
WM6_VEDGE = EXT [M6_ENCWM]  <1.1 ABUT<90 OPPOSITE NOTCH
WM6_EXT1 = EXT (WM6 COIN EDGE WM6_VEDGE) [V6_A] < 1.1 ABUT>=0 <90  OPPOSITE CONNECTED 
WM6_EXT2 = (EXT WM6 V6_A < 1.1 ABUT>=0 <90  OPPOSITE REGION CONNECTED ) INSIDE M6  
V6_B = V6_square WITH EDGE WM6_EXT1
X1 =(M6 AND M7) ENCLOSE V6_square >1
X2 = ((M6 AND M7)  AND ( WM6_L1 AND WM6_EXP )) NOT X1  
Y0=(M6 AND M7) ENCLOSE V6_square ==1 
Y1 = SIZE (V6_square INTERACT Y0) BY 1.1 INSIDE OF M6 STEP 0.005  
Y2= Y1 INTERACT (Y1 AND WM6)

VSING1= ((X2 INTERACT V6_B ==1) INTERACT Y2) OR ((X2 INTERACT WM6_EXT2) INTERACT V6_A)
VSING1 OUTSIDE INST 

M7_ENCWM = (M7 INTERACT WM7) INTERACT V6_A2
WM7_VEDGE = EXT [M7_ENCWM]  <1.1 ABUT<90 OPPOSITE NOTCH
WM7_EXT1 = EXT (WM7_EMPTY COIN EDGE WM7_VEDGE) [V6_A2_EMPTY] < 1.1 ABUT>=0 <90  OPPOSITE CONNECTED 
WM7_EXT2 = (EXT WM7_EMPTY V6_A2_EMPTY < 1.1 ABUT>=0 <90  OPPOSITE REGION CONNECTED ) INSIDE M7  
V6_B2 = V6_square WITH EDGE WM7_EXT1
X3 = ((M6 AND M7)  AND ( WM7_L1 AND WM7_EXP )) NOT X1  
Y3 = SIZE (V6_square INTERACT Y0) BY 1.1 INSIDE OF M7 STEP 0.005  
Y4= Y3 INTERACT (Y3 AND WM7)

VSING2=((X3 INTERACT V6_B2 ==1) INTERACT Y4) OR (( X3 INTERACT WM7_EXT2) INTERACT V6_A2)
VSING2 OUTSIDE INST
 

}




//========================
//  V7 - Via 7 DRC
//========================

GROUP GV7 V7_?

V7_1 {
@ Fixed V7 size is 0.07
  NOT RECTANGLE V7 == 0.07 BY == 0.07
}
V7_2 {
@ Space between two V7 is 0.07
  EXT V7 < 0.07 ABUT<90 SINGULAR REGION
}
V7_array = SIZE (SIZE V7 BY 0.05 OVERUNDER) BY 0.150 UNDEROVER
V7_GAP7 = V7_array NOT M7
V7_GAP8 = V7_array NOT M8
V7_3 {
@Space between Vns (with run length0) at least two least two sides is 0.09, when array equal to or greater than 3x3. 
@Two Via areas whose space is within 0.10m are considered to be in the same array. An array does
@ not have both row and column greater than or equal to 3 can apply smaller spacing Vn.2 instead of Vn.3
 X = EXT (V7 INTERACT V7_array) V7< 0.090 OPPOSITE EXTENDED  0.001  REGION 
   Y =SIZE V7 BY 0.001
  (Y INTERACT  V7_array)  INTERACT (X NOT Y) >2
}
/*
V7_4 {
@ V7_array not touching MOMDMY maximum width is 0.85
  (WITH WIDTH V7_array > 0.85) NOT INTERACT MOMDMY
}
*/
#IFDEF TOPMETAL 9
V7_5 {
@ V7 (different net) minimum space for run length > 0um is 0.1 (outside of SRAM)
 X = EXT V7 < 0.1 NOT CONNECTED OPPOSITE REGION
  X OUTSIDE INST
}
V7_5a {
@ V7 (different net) minimum space is 0.09
  EXT V7 < 0.09 NOT CONNECTED REGION
 
}
/*V7_5b {
@ Vn minimum space in different net inside of SRAM is 0.09
  EXT (V7 NOT OUTSIDE INST) < 0.09 NOT CONNECTED REGION
}*/
#ENDIF
V7_6abc {
@ V2 must within M2
@  per Mn and Mn+1 intersection containing a Vn, must meet rule Vn.6a, Vn.6b or Vn.6c
@ V2.6a, V2 minimum within M2 is 0.015
@ Vn.6b	Mn overlap past Vn for two opposite sides with either side  >=0.01m, and < 0.015m  0.02
@ Vn.6c	Mn overlap past Vn for two opposite sides with either side >= 0m, and < 0.01m 0.03
  V7 NOT M7
  M7andM8 = (M7 AND M8) INTERACT V7
  BadV7 = RECTANGLE ENCLOSURE V7 M7  OUTSIDE ALSO
  GOOD 0.015  OPPOSITE 0.015 OPPOSITE   0.015 OPPOSITE  0.015 OPPOSITE
  GOOD 0.02 OPPOSITE 0.01 OPPOSITE 0.02  OPPOSITE 0.01  OPPOSITE
  GOOD 0.03 0.0  0.03 0.0 
  BadV7 INTERACT M7andM8
}
/*V7_6d {
@ Vn inside Mn with width > 0.14um, with at least one redundant Vn.
@ This rule only applies to that M7/M8 intersection area can enclose a rectangle of 0.07*0.27.
 CMACRO V67D V7 M7 M8
}*/
V7_7abc {
@ V2 must within M3
@  per Mn and Mn+1 intersection containing a Vn, must meet rule Vn.7a, Vn.7b or Vn.7c
@ V6.7a, V2 minimum within M3 is 0.015
@ V6.7b, M3 minimum overlap past V2 for two opposite sides with either side >=0.01m, and < 0.015m  is 0.02
@ V6.7c, M3 minimum overlap past V2 for two opposite sides with the either side >=0m, and < 0.01m is 0.03
  V7 NOT M8
  M7andM8 = (M7 AND M8) INTERACT V7
  BadV7 = RECTANGLE ENCLOSURE V7 M8  OUTSIDE ALSO
  GOOD 0.015 OPPOSITE 0.015 OPPOSITE  0.015 OPPOSITE  0.015 OPPOSITE
  GOOD 0.02 OPPOSITE 0.01 OPPOSITE 0.02  OPPOSITE 0.01 OPPOSITE 
  GOOD 0.03 0.0  0.03 0.0 
  BadV7 INTERACT M7andM8
}
/*V7_7d {
@ Vn inside Mn+1 with width > 0.14um, with at least one redundant Vn.
@ This rule only applies to that M7/M8 intersection area can enclose a rectangle of 0.07*0.27.
 CMACRO V67D V7 M8 M7
}*/
V7_8 {
@ At least two Vn vias must connect Mn to Mn+1 when the Mn or Mn+1 width is > 0.26um
  WM7 = WITH WIDTH M7 > 0.260
  WM8 = WITH WIDTH M8 > 0.260
  encVia = V7 INTERACT (WM7 OR WM8)
  ((M7 AND M8) ENCLOSE encVia) ENCLOSE V7 < 2
}
V7_9 {
@ At least three Vn vias must connect Mn to Mn+1 when the Mn or Mn+1 width is > 0.52um
  WM7 = WITH WIDTH M7 > 0.520
  WM8 = WITH WIDTH M8 > 0.520
  encVia = V7 INTERACT (WM7 OR WM8)
  ((M7 AND M8) ENCLOSE encVia) ENCLOSE V7 < 3
}
V7_10 {
@ At least four Vn vias must connect Mn to Mn+1 when the Mn or Mn+1 width is > 0.645um
  WM7 = WITH WIDTH M7 > 0.645
  WM8 = WITH WIDTH M8 > 0.645
  encVia = V7 INTERACT (WM7 OR WM8)
  ((M7 AND M8) ENCLOSE encVia) ENCLOSE V7 < 4
}
V7_square = RECTANGLE V7 ASPECT ==1
V7_EMPTY = EMPTY OR (V7_square INSIDE (M7 AND M8) ) 
INTER_EMPTY7 = EMPTY OR (M7 AND M8) 
CONNECT  V7_EMPTY INTER_EMPTY7
V7_16 {
@ At least two Vns with space <=0.16m when one of Mn or Mn+1 with both length and width >0.24m.
@ Exclude non-square Vn and SRAM area.
X1a = WITH WIDTH M7  >0.24
X1b = WITH WIDTH M8  >0.24
WIDE = X1a OR X1b
X2 = (M7 AND M8) ENCLOSE V7_square
X3 =  V7_square INSIDE X2
X5c = EXT (V7_EMPTY INSIDE WIDE ) V7_EMPTY <=0.16 ABUT<90 REGION CONNECTED // space of via <= 0.16 
X6c = X2 ENCLOSE X5c  // good intersection with space of Via <= 0.16
X7= ((SIZE X3 BY 0.325) AND X2) ENCLOSE V7 >2
X7c=X2 ENCLOSE X7
X =((X2 NOT X6c) NOT X7c) ENCLOSE (V7_square INSIDE WIDE ) // Via_16
X OUTSIDE INST
}
//WM7 = M7 WITH WIDTH > 0.24
CONNECT V7 M7
V7_A = V7_square INTERACT WM7_EXP
CONNECT V7_A M7
CONNECT WM7 M7
WM8 = M8 WITH WIDTH > 0.24
WM8_EDGE = LENGTH WM8 > 0
WM8_EXP = EXPAND EDGE WM8_EDGE OUTSIDE BY 1.1
WM8_L1 = ( M8 NOT WM8 ) TOUCH WM8
V7_A2 = V7_square INTERACT WM8_EXP
CONNECT V7 M8
V7_A2_EMPTY = EMPTY OR V7_A2
M8_EMPTY = EMPTY OR M8
WM8_EMPTY = EMPTY OR WM8 
CONNECT V7_A2_EMPTY M8_EMPTY
CONNECT WM8_EMPTY M8_EMPTY


V7_17 {
@ At least two Vns  when either wide metal of Mn or Mn+1 with both length L>0.24m and width W>0.24m, and the distance D<=1.1m away from this wide metal.
@ Exclude non-square Vn
WM7_L1 = ( M7 NOT WM7 ) TOUCH WM7
M7_ENCWM = (M7 INTERACT WM7) INTERACT V7_A
WM7_VEDGE = EXT [M7_ENCWM]  <1.1 ABUT<90 OPPOSITE NOTCH
WM7_EXT1 = EXT (WM7 COIN EDGE WM7_VEDGE) [V7_A] < 1.1 ABUT>=0 <90  OPPOSITE CONNECTED 
WM7_EXT2 = (EXT WM7 V7_A < 1.1 ABUT>=0 <90  OPPOSITE REGION CONNECTED ) INSIDE M7  
V7_B = V7_square WITH EDGE WM7_EXT1
X1 =(M7 AND M8) ENCLOSE V7_square >1
X2 = ((M7 AND M8)  AND ( WM7_L1 AND WM7_EXP )) NOT X1  

Y0=(M7 AND M8) ENCLOSE V7_square ==1 
Y1 = SIZE (V7_square INTERACT Y0) BY 1.1 INSIDE OF M7 STEP 0.005  
Y2= Y1 INTERACT (Y1 AND WM7)

VSING1= ((X2 INTERACT V7_B ==1) INTERACT Y2) OR ((X2 INTERACT WM7_EXT2) INTERACT V7_A)
VSING1 OUTSIDE INST 

M8_ENCWM = (M8 INTERACT WM8) INTERACT V7_A2
WM8_VEDGE = EXT [M8_ENCWM]  <1.1 ABUT<90 OPPOSITE NOTCH
WM8_EXT1 = EXT (WM8_EMPTY COIN EDGE WM8_VEDGE) [V7_A2_EMPTY] < 1.1 ABUT>=0 <90  OPPOSITE CONNECTED 
WM8_EXT2 = (EXT WM8_EMPTY V7_A2_EMPTY < 1.1 ABUT>=0 <90  OPPOSITE REGION CONNECTED ) INSIDE M8  
V7_B2 = V7_square WITH EDGE WM8_EXT1
X3 = ((M7 AND M8)  AND ( WM8_L1 AND WM8_EXP )) NOT X1  
Y3 = SIZE (V7_square INTERACT Y0) BY 1.1 INSIDE OF M8 STEP 0.005  
Y4= Y3 INTERACT (Y3 AND WM8)

VSING2= ((X3 INTERACT V7_B2 ==1) INTERACT Y4) OR (( X3 INTERACT WM8_EXT2) INTERACT V7_A2)
VSING2 OUTSIDE INST

}


//========================
//  TV2 - Top Via 2 DRC
//========================

GROUP GTV2 TV2_?

TV2_1 {
@ Fixed TV2 size is 0.36
  NOT RECTANGLE TV2 == 0.36 BY == 0.36
}
TV2_2 {
@ Space between two TV2 is 0.34
  EXT TV2 < 0.34 ABUT<90 SINGULAR REGION
}
TV2_3 {
@ Space between two TV2s is 0.50, in case TV2 array is larger than or equal to 3x3.
@ Two Via areas whose space is within 0.56um are considered to be in the same array.
  TV2array = SIZE (SIZE TV2 BY 0.28 OVERUNDER) BY 0.85 UNDEROVER
  EXT (TV2 IN TV2array) < 0.50 ABUT<90 SINGULAR REGION
}
#IFDEF TOPMETAL 9
TV2_4_5_6 {
@ TV2 enclosure by Mn is 0.01
@ Extension of Mn line end outside of TV is 0.05
@ For TV2 located at the 90 degree corner, one side of metal extension
@ must be treated as end-of-line and the other side follows 0.01
  RECTANGLE ENC TV2 M8 ABUT<90 OUTSIDE ALSO
  GOOD 0.01 OPPOSITE 0.05 OPPOSITE 0.01 OPPOSITE 0.05 OPPOSITE
}
TV2_14	{
@ At least 2 TV2 within M8 and TM2 intersection area.  One of the M8 and TM2 width > 1.8 um. 
X1 = M8 WITH WIDTH >1.8
X2 = TM2 WITH WIDTH >1.8
Y1 = (M8 AND TM2) INTERACT X1
Y2 = (M8 AND TM2) INTERACT X2
(Y1 OR Y2) INTERACT TV2 < 2
}
#ENDIF
#IFDEF TOPMETAL 8
TV2_4_5_6 {
@ TV2 enclosure by Mn is 0.02
@ Extension of Mn line end outside of TV is 0.05
@ For TV2 located at the 90 degree corner, one side of metal extension
@ must be treated as end-of-line and the other side follows 0.01
  RECTANGLE ENC TV2 M7 ABUT<90 OUTSIDE ALSO
  GOOD 0.01 OPPOSITE 0.05 OPPOSITE 0.01 OPPOSITE 0.05 OPPOSITE
}
TV2_14	{
@ At least 2 TV2 within M7 and TM2 intersection area.  One of the M7 and TM2 width > 1.8 um. 
X1 = M7 WITH WIDTH >1.8
X2 = TM2 WITH WIDTH >1.8
Y1 = (M7 AND TM2) INTERACT X1
Y2 = (M7 AND TM2) INTERACT X2
(Y1 OR Y2) INTERACT TV2 < 2
}
#ENDIF
#IFDEF TOPMETAL 7
TV2_4_5_6 {
@ TV2 enclosure by Mn is 0.02
@ Extension of Mn line end outside of TV is 0.05
@ For TV2 located at the 90 degree corner, one side of metal extension
@ must be treated as end-of-line and the other side follows 0.02
  RECTANGLE ENC TV2 M6 ABUT<90 OUTSIDE ALSO
  GOOD 0.01 OPPOSITE 0.05 OPPOSITE 0.01 OPPOSITE 0.05 OPPOSITE
}
TV2_14	{
@ At least 2 TV2 within M6 and TM2 intersection area.  One of the M6 and TM2 width > 1.8 um. 
X1 = M6 WITH WIDTH >1.8
X2 = TM2 WITH WIDTH >1.8
Y1 = (M6 AND TM2) INTERACT X1
Y2 = (M6 AND TM2) INTERACT X2
(Y1 OR Y2) INTERACT TV2 < 2
}
#ENDIF
#IFDEF TOPMETAL 6
TV2_4_5_6 {
@ TV2 enclosure by Mn is 0.01
@ Extension of Mn line end outside of TV is 0.05
@ For TV2 located at the 90 degree corner, one side of metal extension
@ must be treated as end-of-line and the other side follows 0.02
  RECTANGLE ENC TV2 M5 ABUT<90 OUTSIDE ALSO
  GOOD 0.01 OPPOSITE 0.05 OPPOSITE 0.01 OPPOSITE 0.05 OPPOSITE
}
TV2_14	{
@ At least 2 TV2 within M5 and TM2 intersection area.  One of the M5 and TM2 width > 1.8 um. 
X1 = M5 WITH WIDTH >1.8
X2 = TM2 WITH WIDTH >1.8
Y1 = (M5 AND TM2) INTERACT X1
Y2 = (M5 AND TM2) INTERACT X2
(Y1 OR Y2) INTERACT TV2 < 2
}

#ENDIF
#IFDEF TOPMETAL 5
TV2_4_5_6 {
@ TV2 enclosure by Mn is 0.02
@ Extension of Mn line end outside of TV is 0.05
@ For TV2 located at the 90 degree corner, one side of metal extension
@ must be treated as end-of-line and the other side follows 0.02
  RECTANGLE ENC TV2 M4 ABUT<90 OUTSIDE ALSO
  GOOD 0.01 OPPOSITE 0.05 OPPOSITE 0.01 OPPOSITE 0.05 OPPOSITE
}
TV2_14	{
@ At least 2 TV2 within M4 and TM2 intersection area.  One of the M4 and TM2 width > 1.8 um. 
X1 = M4 WITH WIDTH >1.8
X2 = TM2 WITH WIDTH >1.8
Y1 = (M4 AND TM2) INTERACT X1
Y2 = (TM2 AND M4) INTERACT X2
(Y1 OR Y2) INTERACT TV2 < 2
}
#ENDIF
#IFDEF TOPMETAL 4
TV2_4_5_6 {
@ TV2 enclosure by Mn is 0.02
@ Extension of Mn line end outside of TV is 0.05
@ For TV2 located at the 90 degree corner, one side of metal extension
@ must be treated as end-of-line and the other side follows 0.01
  RECTANGLE ENC TV2 M3 ABUT<90 OUTSIDE ALSO
  GOOD 0.01 OPPOSITE 0.05 OPPOSITE 0.01 OPPOSITE 0.05 OPPOSITE
}
TV2_14	{
@ At least 2 TV2 within M3 and TM2 intersection area.  One of the M3 and TM2 width > 1.8 um. 
X1 = M3 WITH WIDTH >1.8
X2 = TM2 WITH WIDTH >1.8
Y1 =( M3 AND TM2) INTERACT X1 
Y2 = ( M3 AND TM2) INTERACT X2
(Y1 OR Y2) INTERACT TV2 < 2
}
#ENDIF


//========================
//  TM2 - Top Metal 2 DRC
//========================

#IFDEF UTM NO

GROUP GTM2 TM2_?

TM2_1 {
@ TM2 width is 0.40
  INT TM2 < 0.40 ABUT<90 SINGULAR REGION
}
TM2_2 {
@ Space between two TM2s is 0.40
  EXT TM2 < 0.40 ABUT<90 SINGULAR REGION
}
TM2_3_4_TV2_7 {
@ TV2 enclosure by TM2 is 0.020
@ Extension of TM2 line end outside of TV2 is 0.03
@ For TV2 located at the 90 degree corner, one side of TM2
@ enclosure must be > 0.20 and the other side > 0.03
  RECTANGLE ENC TV2 TM2 ABUT<90 OUTSIDE ALSO
  GOOD 0.02 OPPOSITE 0.03 OPPOSITE 0.02 OPPOSITE 0.03 OPPOSITE
}

TM2_5 {
@ Minimum space between two length > 1.5um parallel metal
@ lines with one or both metal line width is > 2um is 0.50
  CMACRO TM56 TM2i 1.501 2.001 0.5
}

/*TM2_6 {
@ Minimum space between two length > 1.5um parallel metal
@ lines with one or both metal line width is > 4um is 1.0
  CMACRO TM56 TM2i 1.501 4.001 1
}*/
TM2_7 {
@ Space between two length > 4.5m parallel metal lines with one or both metal line width is > 4.5m is 1.2.
  CMACRO TM56 TM2i 4.501 4.501 1.2
}
TM2_8 {
@ TM2 area is 0.56
  AREA TM2 < 0.56
}
TM2_9 {
@ Dielectric area(um2) enclosed by TM2 is 0.780
  AREA ((HOLES TM2 INNER) NOT TM2) < 0.780
}
TM2_10_a {
@ Dummy pattern is required in case TM2 density is less than 20%.(INDMY or MARKG or MARKS) are excluded for this rule check
  X = DENSITY (TM2i OR TM2DUMi) < 0.20 WINDOW 200 STEP 100 BACKUP PRINT density_report_TM2_10_a.log RDB density_report_TM2_10_a.db
  X NOT (MARKG OR INDMY)
}
TM2_10_b {
@ Max. density is 85%
  X = DENSITY (TM2i OR TM2DUMi) > 0.85 WINDOW 200 STEP 100 BACKUP PRINT density_report_TM2_10_b.log RDB density_report_TM2_10_b.db
  X NOT (MARKG OR INDMY)
}
TM2_10a{
@ TM2 density  over the whole chip is >=20%
X=DENSITY (TM2i OR TM2DUMi)< 0.2 PRINT density_report_TM2_10a.log
X NOT MARKG
}
TM2_11 {
@ MAX difference(%) between 2 adjacent 200um*200um area is 50%
  X = DENSITY (TM2i OR TM2DUMi) >= 0 WINDOW 200 GRADIENT > 0.5 ABSOLUTE BACKUP PRINT density_report_TM2_11.log RDB density_report_TM2_11.db
  X NOT MARKG
}

TM2_12 {
@ Maximum line width is 12um
  X = TM2 WITH WIDTH > 12
  X NOT INTERACT MD
}

#ENDIF


//============================
//  ALPA DRC
//============================

GROUP GALPA  ALPA_?

ALPA_ALL = ALPAi NOT   MARKG
ALPad = ALPA_ALL WITH WIDTH > 35
ALRDL = ALPA_ALL NOT ALPad 

ALPA_1 {
@ Minimum ALPA width is 2
  INT ALPA_ALL < 2 ABUT<90 SINGULAR REGION
}
ALPA_2 {
@ Minimum ALPA space is 2
  EXT ALPA_ALL < 2 ABUT<89.9 SINGULAR REGION
}
ALPA_5 {
@ Alpa minimum density with 100um*100um window is 10%, with exemption of touching inductor  
  checkregion = BORDER NOT INDMY
  X = DENSITY (ALPAi OR ALDUM) < 0.10 WINDOW 100  BACKUP RDB density_report_ALPA_5.db
  (X AND checkregion) NOT MARKG
}
ALPA_7 {
@ Space between ALRDL and Lmark window is 10
  (EXT ALRDL LOGO < 10 ABUT<90 SINGULAR REGION) NOT MARKG
}
ALPA_9 {
@ ALPA min density is 10%
  (DENSITY ( ALPAi OR ALDUM )  < 0.1) NOT MARKG
}
ALPA_10 {
@ ALPA max density is 70%
  (DENSITY ( ALPAi OR ALDUM )  > 0.7) NOT MARKG
}
/* 
#IFDEF BUMPING YES
ALPA_11 {
@ Space between ALRDL and Alpa pad for bumping process is 10um
  (EXT ALRDL ALPad < 10 ABUT>0<90 SINGULAR REGION) NOT MARKG
}
#ENDIF
*/
ALPA_12 {
@ ALPA must be drawn layer.
 DRC:1 NOT INTERACT ALPA_ALL
}

//=============================
//  PA (passivation-1) DRC
//=============================

GROUP GPA PA_?

PA_1 {
@ PA minimum size is 2um
  (INT PA < 2.0 ABUT<90 SINGULAR REGION) NOT MARKG
}
PA_2 {
@ Minimum space between two PAs is 2um
  (EXT PA < 2.0 ABUT<90 SINGULAR REGION) NOT MARKG
}
PA_3 {
@ PA enclosed by ALPA is 0.5um,outside is not allowed
  X = ENC (PA INTERACT ALPAi ) ALPAi < 0.5 ABUT<90 SINGULAR REGION OUTSIDE ALSO
  X NOT MARKG
}
#IFDEF UTM NO
PA_4 {
@ PA enclosed by TM2 is 0.5um,outside is not allowed
  ENC PA TM2 < 0.5 ABUT<90 SINGULAR REGION
  (PA NOT MARKG) OUT EDGE TM2
}
#ENDIF
#IFDEF UTM YES
PA_4 {
@ PA enclosed by MTT2 is 0.5um,outside is not allowed
  ENC PA MTT2 < 0.5 ABUT<90 SINGULAR REGION
  (PA NOT MARKG) OUT EDGE MTT2
}
#ENDIF
PA_10 {
@ PA opening without ALPA above it is not allowed.
  X = PA NOT ALPAi
  X NOT MARKG
}



//===========================
//  MD (passivation-2) DRC
//===========================

GROUP GMD MD_?

MD_1 {
@ MD(PA2) enclosured by Alpa is 1um
  ENC MD  ALPAi < 1.0 ABUT<90 SINGULAR REGION OUTSIDE ALSO
}
MD_2 {
@ MD(PA2) minimum width is 14um
  INT MD < 14.0 ABUT<90 SINGULAR REGION
}
MD_3 {
@ MD (PA2) minimum space is 6um
  EXT MD < 6.0 ABUT<90 SINGULAR REGION
}
#IFDEF RECOMMENDED YES

MD_4_R {
@ MD (PA2) must be within BORDER(CHIPEDGE) is 8um
  ENC MD BORDER < 8 ABUT<90 SINGULAR REGION OUTSIDE ALSO
}
#ENDIF

MD_5 {
@ MD (PA2) minimum space to PA is 1.7
  EXT MD PA < 1.7 SINGULAR REGION
}
#IFDEF RECOMMENDED YES

MD_6_R {
@ MD (PA2) wire-bond pad opening maximum to CHIPEDGE is 200um
  X = SIZE BD_WITHHOLE BY -200
  X AND MD
}
#ENDIF

/*MD_7 {
@ TM2 is prohibited over MD (PA2) wire-bond pad opening
  MD AND TM2
}*/
MD_8 {
@ Inductor is prohibited under MD (PA2) wire-bond pad opening
  INDMY AND MD
}
/*MD_9 {
@ [MD (PA2) pad opening not over seal ring] must be an orthogonal rectangle
  ANGLE (MD OUTSIDE MARKG) >0 <90
}*/
MD_10 {
@ MD (passivation 2) must be a drawn layer.
 DRC:1 NOT INTERACT (MD NOT MARKG)
}
MD_11 {
@ MD(PA2) is prohibited to overlap or touch with PA(PA size <3um)
  X = PA INTERACT MD
  INT X < 3 ABUT<90 SINGULAR REGION
}

//=====================
//   ESD1 rule
//=====================

GROUP GESD1 ESD_?

ESD_1 {
@ ESD1 minimum width is 0.33um.
 INT ESD1 < 0.33 ABUT<90 SINGULAR REGION
}
ESD_2 {
@ ESD1 minimum space is 0.33um.
 EXT ESD1 < 0.33 ABUT<90 SINGULAR REGION
}
ESD_3 {
@ ESD1 minimum area is 0.7 square um.
 AREA ESD1 < 0.7
}
ESD_4 {
@ Minimum enclosed area of ESD1 is 0.7 square um.
 ESD1HOLE = HOLES ESD1 INNER
 AREA (ESD1HOLE NOT ESD1) < 0.7
}
ESD_5 {
@ Minimum space between an ESD1 implant to an N-channel gate is 0.2um. Touching is not allowed.
 X = EXT ESD1 NGATE < 0.2 ABUT<90 SINGULAR REGION
 Y = NGATE INTERACT ESD1
 X OR Y
}
ESD_6 {
@ ESD1 must be enclosed by AA at least 0.2um.
 ENC (ESD1 NOT MARKG) AA < 0.2 ABUT<90 SINGULAR REGION OUTSIDE ALSO
}
ESD_7 {
@ ESD1 is not allowed to overlap with SP.
 ESD1 AND SP
}
ESD_8 {
@ ESD1 should be drawn directly at the location to have ESD implant. It should not interact with GT.
 ESD1 INTERACT GT
}
ESD_9{
@ CT enclosure by ESD1 >=0.2
ENC CT  ESD1 <0.2  ABUT<90 REGION SINGULAR 

}
#IFDEF RECOMMENDED YES

ESD_9a_R{
@ Recommended CT enclosure by ESD1 >=0.4
ENC CT  ESD1 <0.4  ABUT<90 REGION SINGULAR
}
#ENDIF


//=====================
//   HRP rule
//=====================

GROUP GHRP HRP_?

/*HRP_1{
@ It is strongly suggested that the resistor square number > 1 for precision Rs.
  X = (GT INTERACT HRP) INTERACT CT
  Y =  HRPR AND HRPDMY
  L = GT INSIDE EDGE HRPDMY 
  W = INSIDE EDGE HRPDMY GT
 DFM PROPERTY Y L W OVERLAP ABUT ALSO MULTI [WIDTH = LENGTH(W)] >0 [SQUARES = LENGTH(L)/LENGTH(W)] < 1
}*/

HRP_2 {
@ Minimum extension from HRP region beyond a poly resistor region is 0.22
 ENC HRPR HRP < 0.22 ABUT<90 SINGULAR REGION
}
HRP_3_4 {
@ Minimum clearance from HRP region to Polygate of NMOS/PMOS is 0.20
 GT_MOS = GT INTERACT GATE
 EXT HRP GT_MOS < 0.20 ABUT SINGULAR REGION
}
HRP_5 {
@ Minimum and maximum P+ implant for pickup overlap with SAB is 0.30
 SP_HRP = SP INTERACT HRP
 SAB_HRP = SAB INTERACT HRP
 X = SP_HRP AND SAB_HRP
 INT X < 0.30 ABUT<90 SINGULAR REGION
 SIZE X BY 0.15 UNDEROVER
}
HRP_7 {
@ Minimum width of Poly region for high resistance poly resistor is 2.00
 X = HR_GT INSIDE EDGE SAB
 INT X < 2.0 OPPOSITE REGION
}
/*HRP_8 {
@ Dummy layer "HRPDMY" is needed for DRC for high resistance Poly region
 SAB_HRP = SAB INTERACT (HRP INTERACT CT)
 SAB_HRP NOT INTERACT HRPDMY
}*/
HRP_9 {
@ SN SP not allowed in HRPDMY. When check this rule, size down HRPDMY by 0.3um along current direction.
 HRP_END = SIZE ((GT INTERACT HRPDMY) NOT HRPDMY) BY 0.3
 HRP_MID = (GT INTERACT HRPDMY) NOT HRP_END
 (SN OR SP) AND HRP_MID
}
HRP_11 {
@ HRP minimum space is 0.18um
 EXT HRP < 0.18 SINGULAR REGION
}
HRP_12 {
@ Inside HRP resistor GT area, HRPDMY and SAB must be exactly coincident.
 SAB_AND_HRP = (SAB INTERACT (HRP AND HRPDMY)) AND GT
 DMY_AND_HRP = HRPDMY AND GT
 SAB_AND_HRP XOR DMY_AND_HRP
}
HRP_13 {
@ HRP minimum width is 0.18um
 INT HRP < 0.18 SINGULAR REGION
}

//======================
//  MTT2 Rules
//======================

#IFDEF UTM YES

GROUP GMTT MTT2_?

MTT2_1 {
@ Minimum width of MTT is 1.5.
 INT MTT2 < 1.5 SINGULAR REGION
}
MTT2_2 {
@ Minimum space of MTT is 1.0.
 EXT MTT2 < 1.0 ABUT<89.9  SINGULAR REGION
}
MTT2_2a {
@ Minimum space between two MTTs having parallel segments >2um with one or both MTT width >=16um is 2um.
 X = MTT2 WITH WIDTH >= 16
 Y = EXT MTT2 X < 2 OPPOSITE REGION PARA ONLY
 Z =COPY Y 
 Z WITH EDGE (LENGTH Z > 2)
}
MTT2_3_4 {
@ Minimum extension of MTT beyond top via is 0.30.
 ENC TV2 MTT2 < 0.30 REGION OUTSIDE ALSO
}

MTT_IN = MTT2 AND INDMY 

MTT2_5{
@ Minimum space from MTT used as inductor to other MTT region is 30um.
 EXT MTT_IN (MTT2 NOT INTERACT MTT_IN) < 30 ABUT<90 SINGULAR REGION 
}
MTT2_6 {
@ Minimum area of MTT region is 2.25 square um.
 AREA MTT2 < 2.25
}
MTT2_7 {
@ Minimum density of MTT is 30%, with check window 200um*200um, and step 100um.
 X = DENSITY (MTT2i OR MTT2DMi) < 0.30 WINDOW 200 STEP 100 BACKUP PRINT density_report_MTT2.log RDB density_report_MTT2_7.db
 X NOT MARKG
}
MTT2_7a{
@ MTT2 density  over the whole chip	is >=20%
X= DENSITY (MTT2i OR MTT2DMi)<0.2 PRINT density_report_MTT2_7a.log
X  NOT MARKG
}
MTT2_7b{
@ INDMY area density in window size 840m*840m with step 420um is <=20%
X= DENSITY INDMY>0.20 WINDOW 840 STEP 420 BACKUP PRINT density_report_MTT2_7b.log RDB density_report_MTT2_7b.db
X  NOT MARKG
}

MTT2_8 {
@ All devices listed in device table inside inductor region are prohibited.
 X = GATE INTERACT CT 
 (GATE NOT X) AND INDMY
 RESAA AND INDMY
 RESNW AND INDMY
 RESP1 AND INDMY
 PLRES AND INDMY
 DIFRES AND INDMY
 DSTR AND INDMY
 BIPOLA AND INDMY
 HRPDMY AND INDMY
 MOMDMY AND INDMY
 M1R AND INDMY
 M2R AND INDMY
 M3R AND INDMY
 M4R AND INDMY
 M5R AND INDMY
 M6R AND INDMY
 M7R AND INDMY
 M8R AND INDMY
}
MTT2_9 {
@ Minimum extension of dummy layer INDMY beyond MTT region used as inductor is 15um.
 X = MTT2 INTERACT INDMY
 ENC X INDMY < 15 ABUT<90 SINGULAR REGION
}
MTT2_11 {
@ Maximum MTT width is 50um.
 X = MTT2 WITH WIDTH > 50
 X NOT INTERACT MD
}
MTT2_12 {
@ Maximum MTT density on the whole chip including dummy is 55%.
 X =DENSITY (MTT2i OR MTT2DMi) > 0.55 PRINT density_report_MTT2_fullchip.log
 X NOT MARKG
}

#ENDIF
//===============================================================
// E fuse dimension rule
//===============================================================


EFU_1_2 {
@ (GT AND GTFUSE) width (vertical to current flow)=0.045
@ (GT AND GTFUSE) length (parallel to current flow) is	=0.222
  EXT ((GTFUSE NOT GT) TOUCH OUTSIDE EDGE GT)<0.222 ABUT<90 REGION
  NOT RECTANGLE (GT AND GTFUSE) ==0.045 BY ==0.222    
}
EFU_3{
@ Only SP implant is allowed in EFUSE area (NW is not allowed in EFUSE area)
@ Highlight part: (EFUSE AND GT) NOT (SP NOT NW)
(EFUSE AND GT) NOT (SP NOT NW)
}
EFU_4{
@ GTFUSE(81;1) should be within EFUSE area to identify EFUSE function area.
GTFUSE NOT INSIDE EFUSE
}

#IFDEF GUIDELINE YES

//===============================================================
// LDMOS design Guideline for IO 2.5V gate OX device
//===============================================================

GROUP GLD LD_?

LDMOS = LDBK AND TG
GATE_LD = GATE AND LDMOS
PGATE_LD = PGATE AND LDMOS
NGATE_LD = NGATE AND LDMOS

PGATE_LDE = PGATE_LD AND NW
NGATE_LDE = NGATE_LD NOT NW

STI_1 = (GATE_LD INSIDE EDGE AA) COIN EDGE GT
STI_2 = INT STI_1 GATE_LD < 0.005 ABUT INTERSECTING ONLY REGION
STI_3 = GATE_LD NOT TOUCH EDGE STI_2
STI = EXPAND EDGE STI_3 OUTSIDE BY 0.15  //refer to rule LD.3



LD_1a_G {
@ Min Effective Channel length for NLDMOS transistors is 0.28
  INT NGATE_LDE < 0.28 ABUT < 90 SINGULAR REGION
}

LD_1b_G {
@ Min Effective Channel length for PLDMOS transistors is 0.26
  INT PGATE_LDE < 0.26 ABUT < 90 SINGULAR REGION
}

LD_2_G {
@ Min Drain AA width along source/drain direction for LDMOS transistors is 0.2
  X = (AA NOT GATE_LD) COIN EDGE STI
  INT X  < 0.2 OPPOSITE REGION
}

LD_3_G {
@ Fixed STI width along source/drain direction is 0.15
  STI NOT TOUCH (AA NOT GATE_LD) == 1
}

LD_4_G {
@ Min Overlap of GT and STI along source/drain direction is 0.05
  ENC STI_3 GT < 0.05 ABUT < 90 REGION OPPOSITE
}

LD_5_G {
@ Fixed N LDMOS gate overlaps with NW in source/drain direction length is 0.22.
@ Fixed P LDMOS gate not in NW in source/drain direction length is 0.22
  X = NGATE_LD AND NW
  SIZE X BY 0.11 UNDEROVER
  INT X < 0.22 SINGULAR REGION

  Y = PGATE_LD NOT NW
  SIZE Y BY 0.11 UNDEROVER
  INT Y < 0.22 SINGULAR REGION
}

LD_6_G {
@ Min LDMOS channel width is 2
  X = GATE_LD COIN EDGE GT
  LENGTH X < 2
}

LD_7a_G {
@ Min Space between LDMOS source side AA and pickup AA along source/drain direction is 0.6
  X = AA ENCLOSE GATE_LD
  Y = X INSIDE EDGE GT
  Z = X NOT TOUCH EDGE Y
  EXT Z TAP < 0.6 ABUT < 90 REGION
}

LD_7b_G {
@ Min Space between LDMOS source side AA and pickup AA along gate poly direction is 0.9
  X = GATE_LD COIN EDGE GT
  Y = INT X GATE_LD < 0.005 ABUT INTERSECTING ONLY REGION
  Z = ((AA ENCLOSE GATE_LD) TOUCH EDGE Y) NOT TOUCH EDGE GT
  EXT Z (TAP NOT COIN EDGE GATE) < 0.9 ABUT < 90 REGION
}

LD_8_G {
@ Min NW extension outside of N LDMOS AA along gate poly direction is 0.25.
@ Min NW space to P LDMOS AA along gate poly direction is 0.25
  X = AA TOUCH EDGE STI
  Y = INT X AA < 0.005 ABUT INTERSECTING ONLY REGION
  Z = AA TOUCH EDGE Y
  M = Z NOT TOUCH EDGE X

  ENC M NW < 0.25 ABUT < 90 REGION
  EXT M NW < 0.25 ABUT < 90 REGION
}

LD_9_G { 
@ LDMOS block layer (LDBK) is used to identify LDMOS function area.
@ Min LDBK extension outside of (gate, source, drain)'s AA is 0.4
  X = HOLES (NW INTERACT PGATE_LD)
  Y = NW INTERACT NGATE_LD
  Z = AA INTERACT (X OR Y)
  ENC Z LDBK < 0.4 ABUT < 90 REGION
}
#ENDIF

//=================
//  DFM rules
//=================

M1W = M1i WITH WIDTH > 0.22
M2W = M2i WITH WIDTH > 0.22
M3W = M3i WITH WIDTH > 0.22
M4W = M4i WITH WIDTH > 0.22
M5W = M5i WITH WIDTH > 0.22
M6W = M6i WITH WIDTH > 0.22
M7W = M7i WITH WIDTH > 0.22
M8W = M8i WITH WIDTH > 0.22

#IFDEF DFM YES

DMACRO DFM4 LOWMT HIGHMT VIA {
A_1 = LOWMT AND HIGHMT
W_LOWMT = LOWMT WITH WIDTH >= 0.35
W_HIGHMT = HIGHMT WITH WIDTH >= 0.35
A = ( A_1 INTERACT W_LOWMT ) OR (A_1 INTERACT W_HIGHMT )
B = A INTERACT VIA == 1
B1 = B TOUCH ( W_LOWMT NOT B ) == 2
B2 = B TOUCH ( W_HIGHMT NOT B ) == 2
B3 = B NOT (B1 OR B2 )
B4 = SIZE B3 BY 2
BALL = ((( B4 AND W_LOWMT ) OR (B4  AND W_HIGHMT ) ) ENCLOSE B3) OR ( B1 OR B2 )
LOWMT_1 = LOWMT INTERACT B
HIGHMT_1 = HIGHMT INTERACT B
LOWMT_INT = INT LOWMT_1 < 15 OPPOSITE EXCLUDE SHIELDED
HIGHMT_INT = INT HIGHMT_1 < 15 OPPOSITE EXCLUDE SHIELDED
LOWMT_2 = DFM PROPERTY BALL LOWMT_INT OVERLAP ABUT ALSO MULTI [WIDTH = MIN(EW(LOWMT_INT))]
HIGHMT_2 = DFM PROPERTY BALL HIGHMT_INT OVERLAP ABUT ALSO MULTI [WIDTH = MIN(EW(HIGHMT_INT))]
ERR1 = DFM PROPERTY BALL LOWMT_2 HIGHMT_2 OVERLAP ABUT ALSO MULTI [ratio = property(LOWMT_2,WIDTH)/property(HIGHMT_2,WIDTH)]>=5
ERR2 = DFM PROPERTY BALL LOWMT_2 HIGHMT_2 OVERLAP ABUT ALSO MULTI [ratio = property(HIGHMT_2,WIDTH)/property(LOWMT_2,WIDTH)]>=5
B INTERACT (ERR1 OR ERR2)
}

//===========================
//   DFM rule
//===========================

GROUP GDFM DFM_?

GTmergeAAdfm = GT OR AA
UG_edgedfm = CONVEX EDGE GT ANGLE1 == 270 ANGLE2 ==90
UG_edge_dfm = EXPAND EDGE UG_edgedfm  INSIDE BY 0.001
U_edgedfm = CONVEX EDGE GTmergeAAdfm ANGLE1 == 270 ANGLE2 ==270
U_edge_dfm = EXPAND EDGE U_edgedfm  INSIDE BY 0.001
AAconerdfm = EXT AA < 0.01 ABUT == 90 INTERSECTING ONLY REGION
GTconerdfm = EXT GT < 0.01 ABUT == 90 INTERSECTING ONLY REGION


DFM_4_V1 {
@ Insert one V1 if single V1 and (W1 >= 5W2, or W2 >= 5W1).
 CMACRO DFM4 M1 M2 V1
}
DFM_4_V2 {
@ Insert one V2 if single V2 and (W2 >= 5W3, or W3 >= 5W2).
 CMACRO DFM4 M2 M3 V2
}
DFM_4_V3 {
@ Insert one V3 if single V3 and (W3 >= 5W4, or W4 >= 5W3).
 CMACRO DFM4 M3 M4 V3
}
DFM_4_V4 {
@ Insert one V4 if single V4 and (W4 >= 5W5, or W5 >= 5W4).
 CMACRO DFM4 M4 M5 V4
}
DFM_4_V5 {
@ Insert one V5 if single V5 and (W5 >= 5W6, or W6 >= 5W5).
 CMACRO DFM4 M5 M6 V5
}
DFM_4_V6 {
@ Insert one V6 if single V6 and (W6 >= 5W7, or W7 >= 5W6).
 CMACRO DFM4 M6 M7 V6
}
DFM_4_V7 {
@ Insert one V7 if single V7 and (W7 >= 5W8, or W8 >= 5W7).
 CMACRO DFM4 M7 M8 V7
}
/*
//MnPIN = ((((((M1PIN OR M2PIN) OR M3PIN) OR M4PIN) OR M5PIN) OR M6PIN) OR M7PIN) OR M8PIN
DFM_5_M1 {
@ Maximum length of parallel metal(M1) lines with minimum spacing is 20 (Exclude MOM and Inductor device)
   MOM =(M1 OR M2) INTERACT ( MnPIN INTERACT (SIZE MOMDMY BY 0.114)) 
   MINM1_para = EXT (M1 NOT ((MOM OR INDMY) OR MOMDMY)) == 0.07 OPPOSITE REGION PARA ONLY
   X = LENGTH MINM1_para > 20
   MINM1_para WITH EDGE X
}
DFM_5_M2 {
@ Maximum length of parallel metal(M2) lines with minimum spacing is 20 (Exclude MOM and Inductor device)
   MOM = ((M2 OR M1) OR M3) INTERACT (MnPIN INTERACT (SIZE MOMDMY BY 0.114)) 
   MINM2_para = EXT (M2 NOT ((MOM OR INDMY) OR MOMDMY)) == 0.07 OPPOSITE REGION PARA ONLY
   X = LENGTH MINM2_para > 20
   MINM2_para WITH EDGE X
}
DFM_5_M3 {
@ Maximum length of parallel metal(M3) lines with minimum spacing is 20 (Exclude MOM and Inductor device)
   MOM = ((M3 OR M2) OR M4) INTERACT (MnPIN INTERACT (SIZE MOMDMY BY 0.114))
   MINM3_para = EXT (M3 NOT ((MOM OR INDMY) OR MOMDMY)) == 0.07 OPPOSITE REGION PARA ONLY
   X = LENGTH MINM3_para > 20
   MINM3_para WITH EDGE X
}
DFM_5_M4 {
@ Maximum length of parallel metal(M4) lines with minimum spacing is 20 (Exclude MOM and Inductor device)
   MOM = ((M4 OR M3)  OR M5) INTERACT (MnPIN INTERACT (SIZE MOMDMY BY 0.114))
   MINM4_para = EXT (M4 NOT ((MOM OR INDMY) OR MOMDMY)) == 0.07 OPPOSITE REGION PARA ONLY
   X = LENGTH MINM4_para > 20
   MINM4_para WITH EDGE X
}
DFM_5_M5 {
@ Maximum length of parallel metal(M5) lines with minimum spacing is 20(Exclude MOM and Inductor device)
   MOM = ((M5 OR M4) OR M6) INTERACT (MnPIN INTERACT (SIZE MOMDMY BY 0.114))
   MINM5_para = EXT (M5 NOT ((MOM OR INDMY) OR MOMDMY)) == 0.07 OPPOSITE REGION PARA ONLY
   X = LENGTH MINM5_para > 20
   MINM5_para WITH EDGE X
}
DFM_5_M6 {
@ Maximum length of parallel metal(M6) lines with minimum spacing is 20 (Exclude MOM and Inductor device)
   MOM = ((M6 OR M5) OR M7) INTERACT (MnPIN INTERACT (SIZE MOMDMY BY 0.114))
   MINM6_para = EXT (M6 NOT ((MOM OR INDMY) OR MOMDMY)) == 0.07 OPPOSITE REGION PARA ONLY
   X = LENGTH MINM6_para > 20
   MINM6_para WITH EDGE X
}
DFM_5_M7 {
@ Maximum length of parallel metal(M7) lines with minimum spacing is 20 (Exclude MOM and Inductor device)
   MOM = ((M7 OR M6) OR M8) INTERACT (MnPIN INTERACT (SIZE MOMDMY BY 0.114)) 
   MINM7_para = EXT (M7 NOT ((MOM OR INDMY) OR MOMDMY))== 0.07 OPPOSITE REGION PARA ONLY
   X = LENGTH MINM7_para > 20
   MINM7_para WITH EDGE X
}
DFM_5_M8 {
@ Maximum length of parallel metal(M8) lines with minimum spacing is 20 (Exclude MOM and Inductor device)
   MOM = (M8 OR M7) INTERACT (MnPIN INTERACT (SIZE MOMDMY BY 0.114))
   MINM8_para = EXT (M8 NOT ((MOM OR INDMY) OR MOMDMY)) == 0.07 OPPOSITE REGION PARA ONLY
   X = LENGTH MINM8_para > 20
   MINM8_para WITH EDGE X
}
*/

#IFDEF Priority2 YES
DFM_1 {
@ If channel length < 0.2um, channel width<=0.45, space between L-shaped AA to GT in the same MOS is 0.05 (Waive the violations in SRAM area)
   L1 = AA INSIDE EDGE GT
   L2 = LENGTH L1 < 0.2
   L3 = GATE WITH EDGE L2 >= 2
   L4 = GT  COIN EDGE L3
   L5 = LENGTH L4 <= 0.45
   L6 = L3 WITH EDGE L5

   LAA_ = (U_edge_dfm  INTERACT L6) TOUCH AAconerdfm == 1
   LAA = U_edgedfm COIN EDGE LAA_
   (LENGTH LAA < 0.05) NOT INSIDE EDGE INST
  }

DFM_2 {
@ If channel length < 0.2um, channel width<=0.45um, and L-shape GT length ( L >=0.055um), space between L-shaped GT to AA in the same MOS is 0.05. (Waive the violations in SRAM area)

   L1 = AA INSIDE EDGE GT
   L2 = LENGTH L1  < 0.2
   L3 = GATE WITH EDGE L2 >= 2
   L4 = GT COIN EDGE L3
   L5 = LENGTH L4 <= 0.45
   L6 = L3 WITH EDGE L5

   LGT_ = (U_edge_dfm INTERACT L6) TOUCH GTconerdfm == 1
   LGT = U_edgedfm COIN EDGE LGT_
   X = LENGTH LGT <0.05
   Y =EXPAND EDGE X OUTSIDE BY 0.001
   Z =  LENGTH (UG_edge_dfm NOT INTERACT GATE) >=0.055
   M =EXPAND EDGE Z INSIDE BY 0.001 
   (Y INTERACT M) NOT INST 
}
DFM_1a {
@ If MOS poly channel length <0.02um and channel width > 0.45um, min space between L-shaped AA to GT in the same MOS is 0.05.

   L1 = AA INSIDE EDGE GT
   L2 = LENGTH L1< 0.2
   L3 = GATE WITH EDGE L2 >= 2
   L4 = GT COIN EDGE L3
   L5 = LENGTH L4 > 0.45
   L6 = L3 WITH EDGE L5

   LAA_ = (U_edge_dfm INTERACT L6) TOUCH AAconerdfm == 1
   LAA = U_edgedfm COIN EDGE LAA_
   LENGTH LAA < 0.05
}
DFM_2a {
@ If channel length < 0.2um, channel width >0.45um, and L-shape GT length ( L >=0.055um), space between L-shaped GT to AA in the same MOS is 0.05

   L1 = AA INSIDE EDGE GT
   L2 = LENGTH L1 < 0.2
   L3 = GATE WITH EDGE L2 >= 2
   L4 = GT COIN EDGE L3
   L5 = LENGTH L4 > 0.45
   L6 = L3 WITH EDGE L5

   LGT_ = (U_edge_dfm INTERACT L6) TOUCH GTconerdfm == 1
   LGT = U_edgedfm COIN EDGE LGT_
   X =LENGTH LGT < 0.05
   Y =EXPAND EDGE X OUTSIDE BY 0.001
   Z =  LENGTH (UG_edge_dfm NOT INTERACT GATE) >=0.055
   M =EXPAND EDGE Z INSIDE BY 0.001 
   Y INTERACT M
}
DFM_3 {
@ Minimum Extension of poly outside of AA to form poly end-cap is 0.10  Exclude inside inductor (layer: INDMY) and exclude inside LDMOS(layer: LDBK). . 
  ENC ((AA NOT (INDMY OR LDBK)) COIN EDGE GATE) (GT NOT (INDMY OR LDBK)) < 0.10 ABUT<90  REGION
}
DFM_6 {
@ CT minimum within M1 is 0.025
  RECTANGLE ENCLOSURE CTM1 M1 SINGULAR OUTSIDE ALSO
  GOOD 0.025  0.025   0.025  0.025
}
DFM_7_AA {
@ For any geometry on AA,an edge of length < 1.0xWmin can not have any adjacent edge with length < 1.0xWmin
  CONVEX EDGE AA ANGLE1 > 0 LENGTH1 < 0.06 ANGLE2 > 0 WITH LENGTH < 0.06
}
DFM_7_GT {
@ For any geometry on GT,an edge of length < 1.0xWmin can not have any adjacent edge with length < 1.0xWmin
  CONVEX EDGE GT ANGLE1 > 0 LENGTH1 < 0.04 ANGLE2 > 0 WITH LENGTH < 0.04
}
DFM_7_NW {
@ For any geometry on NW,an edge of length < 1.0xWmin can not have any adjacent edge with length < 1.0xWmin
  CONVEX EDGE NW ANGLE1 > 0 LENGTH1 < 0.33 ANGLE2 > 0 WITH LENGTH < 0.33
}
DFM_7_M1 {
@ For any geometry on M1,an edge of length < 1.0xWmin can not have any adjacent edge with length < 1.0xWmin
  CONVEX EDGE M1 ANGLE1 > 0 LENGTH1 < 0.07 ANGLE2 > 0 WITH LENGTH < 0.07
}
DFM_7_M2 {
@ For any geometry on M2,an edge of length < 1.0xWmin can not have any adjacent edge with length < 1.0xWmin
  CONVEX EDGE M2 ANGLE1 > 0 LENGTH1 < 0.07 ANGLE2 > 0 WITH LENGTH < 0.07
}
DFM_7_M3 {
@ For any geometry on M3,an edge of length < 1.0xWmin can not have any adjacent edge with length < 1.0xWmin
  CONVEX EDGE M3 ANGLE1 > 0 LENGTH1 < 0.07 ANGLE2 > 0 WITH LENGTH < 0.07
}
DFM_7_M4 {
@ For any geometry on M4,an edge of length < 1.0xWmin can not have any adjacent edge with length < 1.0xWmin
  CONVEX EDGE M4 ANGLE1 > 0 LENGTH1 < 0.07 ANGLE2 > 0 WITH LENGTH < 0.07
}
DFM_7_M5 {
@ For any geometry on M5,an edge of length < 1.0xWmin can not have any adjacent edge with length < 1.0xWmin
  CONVEX EDGE M5 ANGLE1 > 0 LENGTH1 < 0.07 ANGLE2 > 0 WITH LENGTH < 0.07
}
DFM_7_M6 {
@ For any geometry on M6,an edge of length < 1.0xWmin can not have any adjacent edge with length < 1.0xWmin
  CONVEX EDGE M6 ANGLE1 > 0 LENGTH1 < 0.07 ANGLE2 > 0 WITH LENGTH < 0.07
}
DFM_7_M7 {
@ For any geometry on M7,an edge of length < 1.0xWmin can not have any adjacent edge with length < 1.0xWmin
  CONVEX EDGE M7 ANGLE1 > 0 LENGTH1 < 0.07 ANGLE2 > 0 WITH LENGTH < 0.07
}
DFM_7_M8 {
@ For any geometry on M8,an edge of length < 1.0xWmin can not have any adjacent edge with length < 1.0xWmin
  CONVEX EDGE M8 ANGLE1 > 0 LENGTH1 < 0.07 ANGLE2 > 0 WITH LENGTH < 0.07
}
DFM_8 {
@ GT Min length for 0.9/1.1/1.2V N/P MOS transistors (std, high, or low VT) is 0.044
  X = GT IN EDGE (AA NOT (DG OR TG))
  INT X < 0.044 ABUT<90 REGION
}
DFM_9 {
@ Minimum Extension of AA outside of GT is 0.07 Exclude gate within LDMOS region (layer: LDBK) and within inductor area (layer: INDMY).
  ENC ((GT OUT INST) NOT (LDBK OR INDMY)) (AA NOT (LDBK OR INDMY)) < 0.07 ABUT<90 SINGULAR REGION
}
DFM_10 {
@ Distance from poly to a perpendicular AA "U" inside vertex is 0.09,
@ where the AA vertex distance is <= 0.210um.
  AA_NOTCH = EXT AA <= 0.210 NOTCH OPPOSITE REGION
  AA_EDGE  = CONVEX EDGE AA ANGLE1>269.9 <270.1  ANGLE2>269.9 <270.1 WITH LENGTH<= 0.210  
  AA_REGION = EXPAND EDGE AA_EDGE OUTSIDE BY 0.001
  X = EXT (GT INTERACT AA ) AA_EDGE< 0.09 ABUT<90 OPPOSITE REGION
  (X ENCLOSE AA_REGION) INSIDE AA_NOTCH
}
/*DFM_11 {
@ poly minimum overlap past AA when poly to AA inner vertex distance < 0.060um is 0.11
  gtextaa = ENC AA GT < 0.110 OPPOSITE REGION
  gatespcaa = EXT GATE AA < 0.06 ABUT==90 PERP ONLY REGION
  gtextaa  WITH EDGE (gtextaa TOUCH EDGE gatespcaa)
}*/
DFM_12 {
@ poly minimum overlap past AA when poly to AA inner vertex distance < 0.040um is 0.13
  gtextaa = ENC AA GT < 0.13 OPPOSITE REGION
  gatespcaa = EXT GATE AA < 0.04 ABUT==90 PERP ONLY REGION
 gtextaa  WITH EDGE (gtextaa TOUCH EDGE gatespcaa)
}
DFM_13 {
@ CT array minimum space to CT array for run length > 0.34um is 0.18. CT array is formed by logic operation (((all CTs su0.09) sd0.3) su0.21).
  CT_array = SIZE ( SIZE (SIZE CT  BY 0.09) BY -0.3) BY 0.21
  X = EXT CT_array < 0.18 ABUT<90 OPPOSITE REGION
  Y = LENGTH X > 0.34
  X COIN EDGE Y
}
DFM_14 {
@ Minimum space between AA region and contact overlap poly is 0.05
  EXT (INTERCT OUT INST) AA < 0.050 ABUT<90 SINGULAR REGION
}
DFM_15 {
@ 0.9/1.1/1.2V device minimum space between gate region and contact overlap AA is 0.050
  EXT GATE (ACT_CT OUT INST) < 0.050 ABUT<90 SINGULAR REGION
}/*
DFM_16 {
@ Minimum enclosure of an AA region beyond an AA CT region is 0.010
  ENC ((CT INTERACT AA) OUT INST) AA < 0.010 ABUT<90 SINGULAR REGION OUTSIDE ALSO
}
DFM_17 {
@ Minimum enclosure of a poly region beyond a poly CT region is 0.005
  ENC ((CT INTERACT GT) OUT INST) GT < 0.005 ABUT<90 SINGULAR REGION OUTSIDE ALSO
}*/
DFM_28 {
@ M1 minimum overlap past CT for the sides with M1 size >= 0.12 is 0.015
 Over12_edge = INT (M1)  < 0.12  OPPOSITE
 ENC CT over12_edge < 0.015 REGION
}
DFM_29_V1{
@ At least two vias (Vn, TV1, TV2, n=1~7) in Mn and Mn+1 (M1, Mn, n=2~8, TM1, TM2) intersection area.
@ (This rule is not applicable for SRAM region, but SRAM region should follow main rule: V1.16, V1.17, Vn.16, Vn.17, TV1.13, TV2.13, TV2.14)
V1_INTER= V1 INSIDE (M1 AND M2) 
X = (M1 AND M2) INTERACT V1_INTER  <2
X OUTSIDE INST
}
DFM_29_V2{
@ At least two vias (Vn, TV1, TV2, n=1~7) in Mn and Mn+1 (M1, Mn, n=2~8, TM1, TM2) intersection area.
@ (This rule is not applicable for SRAM region, but SRAM region should follow main rule: V1.16, V1.17, Vn.16, Vn.17, TV1.13, TV2.13, TV2.14)
V2_INTER= V2 INSIDE (M2 AND M3) 
X = (M3 AND M2) INTERACT V2_INTER <2
X OUTSIDE INST
}
#IFDEF TOPMETAL 5

DFM_29_V3 {
@ At least two vias (Vn, TV1, TV2, n=1~7) in Mn and Mn+1 (M1, Mn, n=2~8, TM1, TM2) intersection area.
@ (This rule is not applicable for SRAM region, but SRAM region should follow main rule: V1.16, V1.17, Vn.16, Vn.17, TV1.13, TV2.13, TV2.14)
V3_INTER= V3 INSIDE (M3 AND M4) 
X =(M3 AND M4) INTERACT V3_INTER <2
X OUTSIDE INST
}
DFM_29_TV2 {
@ At least two vias (Vn, TV1, TV2, n=1~7) in Mn and Mn+1 (M1, Mn, n=2~8, TM1, TM2) intersection area.
@ (This rule is not applicable for SRAM region, but SRAM region should follow main rule: V1.16, V1.17, Vn.16, Vn.17, TV1.13, TV2.13, TV2.14)
TV2_INTER= TV2 INSIDE (TM2 AND M4) 
X = (TM2 AND M4) INTERACT TV2_INTER <2
X OUTSIDE INST
}

#ENDIF
#IFDEF TOPMETAL 6
DFM_29_V3 {
@ At least two vias (Vn, TV1, TV2, n=1~7) in Mn and Mn+1 (M1, Mn, n=2~8, TM1, TM2) intersection area.
@ (This rule is not applicable for SRAM region, but SRAM region should follow main rule: V1.16, V1.17, Vn.16, Vn.17, TV1.13, TV2.13, TV2.14)
V3_INTER= V3 INSIDE (M3 AND M4) 
X = (M3 AND M4) INTERACT V3_INTER <2
X OUTSIDE INST
}

DFM_29_V4{
@ At least two vias (Vn, TV1, TV2, n=1~7) in Mn and Mn+1 (M1, Mn, n=2~8, TM1, TM2) intersection area.
@ (This rule is not applicable for SRAM region, but SRAM region should follow main rule: V1.16, V1.17, Vn.16, Vn.17, TV1.13, TV2.13, TV2.14)
V4_INTER= V4 INSIDE (M5 AND M4) 
X =(M5 AND M4)  INTERACT V4_INTER  <2
X OUTSIDE INST
}
DFM_29_TV2 {
@ At least two vias (Vn, TV1, TV2, n=1~7) in Mn and Mn+1 (M1, Mn, n=2~8, TM1, TM2) intersection area.
@ (This rule is not applicable for SRAM region, but SRAM region should follow main rule: V1.16, V1.17, Vn.16, Vn.17, TV1.13, TV2.13, TV2.14)
TV2_INTER= TV2 INSIDE (TM2 AND M5) 
X = (TM2 AND M5) INTERACT TV2_INTER <2
X OUTSIDE INST
}

#ENDIF

#IFDEF TOPMETAL 7

DFM_29_V3 {
@ At least two vias (Vn, TV1, TV2, n=1~7) in Mn and Mn+1 (M1, Mn, n=2~8, TM1, TM2) intersection area.
@ (This rule is not applicable for SRAM region, but SRAM region should follow main rule: V1.16, V1.17, Vn.16, Vn.17, TV1.13, TV2.13, TV2.14)
V3_INTER= V3 INSIDE (M3 AND M4) 
X = (M3 AND M4) INTERACT V3_INTER <2
X OUTSIDE INST
}

DFM_29_V4{
@ At least two vias (Vn, TV1, TV2, n=1~7) in Mn and Mn+1 (M1, Mn, n=2~8, TM1, TM2) intersection area.
@ (This rule is not applicable for SRAM region, but SRAM region should follow main rule: V1.16, V1.17, Vn.16, Vn.17, TV1.13, TV2.13, TV2.14)
V4_INTER= V4 INSIDE (M5 AND M4) 
X = (M5 AND M4) INTERACT V4_INTER <2
X OUTSIDE INST
}

DFM_29_V5{
@ At least two vias (Vn, TV1, TV2, n=1~7) in Mn and Mn+1 (M1, Mn, n=2~8, TM1, TM2) intersection area.
@ (This rule is not applicable for SRAM region, but SRAM region should follow main rule: V1.16, V1.17, Vn.16, Vn.17, TV1.13, TV2.13, TV2.14)
V5_INTER= V5 INSIDE (M5 AND M6) 
X =(M5 AND M6)  INTERACT V5_INTER <2
X OUTSIDE INST
}
DFM_29_TV2 {
@ At least two vias (Vn, TV1, TV2, n=1~7) in Mn and Mn+1 (M1, Mn, n=2~8, TM1, TM2) intersection area.
@ (This rule is not applicable for SRAM region, but SRAM region should follow main rule: V1.16, V1.17, Vn.16, Vn.17, TV1.13, TV2.13, TV2.14)
TV2_INTER= TV2 INSIDE (TM2 AND M6) 
X = (TM2 AND M6) INTERACT TV2_INTER <2
X OUTSIDE INST
}

#ENDIF

#IFDEF TOPMETAL 8
DFM_29_V3 {
@ At least two vias (Vn, TV1, TV2, n=1~7) in Mn and Mn+1 (M1, Mn, n=2~8, TM1, TM2) intersection area.
@ (This rule is not applicable for SRAM region, but SRAM region should follow main rule: V1.16, V1.17, Vn.16, Vn.17, TV1.13, TV2.13, TV2.14)
V3_INTER= V3 INSIDE (M3 AND M4) 
X =  (M3 AND M4) INTERACT V3_INTER <2
X OUTSIDE INST
}

DFM_29_V4{
@ At least two vias (Vn, TV1, TV2, n=1~7) in Mn and Mn+1 (M1, Mn, n=2~8, TM1, TM2) intersection area.
@ (This rule is not applicable for SRAM region, but SRAM region should follow main rule: V1.16, V1.17, Vn.16, Vn.17, TV1.13, TV2.13, TV2.14)
V4_INTER= V4 INSIDE (M5 AND M4) 
X =(M5 AND M4)  INTERACT V4_INTER <2
X OUTSIDE INST
}

DFM_29_V5{
@ At least two vias (Vn, TV1, TV2, n=1~7) in Mn and Mn+1 (M1, Mn, n=2~8, TM1, TM2) intersection area.
@ (This rule is not applicable for SRAM region, but SRAM region should follow main rule: V1.16, V1.17, Vn.16, Vn.17, TV1.13, TV2.13, TV2.14)
V5_INTER= V5 INSIDE (M5 AND M6) 
X = (M5 AND M6) INTERACT V5_INTER <2
X OUTSIDE INST
}

DFM_29_V6{
@ At least two vias (Vn, TV1, TV2, n=1~7) in Mn and Mn+1 (M1, Mn, n=2~8, TM1, TM2) intersection area.
@ (This rule is not applicable for SRAM region, but SRAM region should follow main rule: V1.16, V1.17, Vn.16, Vn.17, TV1.13, TV2.13, TV2.14)
V6_INTER= V6 INSIDE (M6 AND M7) 
X = (M6 AND M7) INTERACT V6_INTER <2
X OUTSIDE INST
}
DFM_29_TV2 {
@ At least two vias (Vn, TV1, TV2, n=1~7) in Mn and Mn+1 (M1, Mn, n=2~8, TM1, TM2) intersection area.
@ (This rule is not applicable for SRAM region, but SRAM region should follow main rule: V1.16, V1.17, Vn.16, Vn.17, TV1.13, TV2.13, TV2.14)
TV2_INTER= TV2 INSIDE (TM2 AND M7) 
X = (TM2 AND M7) INTERACT TV2_INTER <2
X OUTSIDE INST
}

#ENDIF

#IFDEF TOPMETAL 9
DFM_29_V3 {
@ At least two vias (Vn, TV1, TV2, n=1~7) in Mn and Mn+1 (M1, Mn, n=2~8, TM1, TM2) intersection area.
@ (This rule is not applicable for SRAM region, but SRAM region should follow main rule: V1.16, V1.17, Vn.16, Vn.17, TV1.13, TV2.13, TV2.14)
V3_INTER= V3 INSIDE (M3 AND M4) 
X =(M3 AND M4)  INTERACT V3_INTER <2
X OUTSIDE INST
}

DFM_29_V4{
@ At least two vias (Vn, TV1, TV2, n=1~7) in Mn and Mn+1 (M1, Mn, n=2~8, TM1, TM2) intersection area.
@ (This rule is not applicable for SRAM region, but SRAM region should follow main rule: V1.16, V1.17, Vn.16, Vn.17, TV1.13, TV2.13, TV2.14)
V4_INTER= V4 INSIDE (M5 AND M4) 
X = (M5 AND M4) INTERACT V4_INTER <2
X OUTSIDE INST
}

DFM_29_V5{
@ At least two vias (Vn, TV1, TV2, n=1~7) in Mn and Mn+1 (M1, Mn, n=2~8, TM1, TM2) intersection area.
@ (This rule is not applicable for SRAM region, but SRAM region should follow main rule: V1.16, V1.17, Vn.16, Vn.17, TV1.13, TV2.13, TV2.14)
V5_INTER= V5 INSIDE (M5 AND M6) 
X = (M5 AND M6) INTERACT V5_INTER <2
X OUTSIDE INST
}

DFM_29_V6{
@ At least two vias (Vn, TV1, TV2, n=1~7) in Mn and Mn+1 (M1, Mn, n=2~8, TM1, TM2) intersection area.
@ (This rule is not applicable for SRAM region, but SRAM region should follow main rule: V1.16, V1.17, Vn.16, Vn.17, TV1.13, TV2.13, TV2.14)
V6_INTER= V6 INSIDE (M6 AND M7) 
X =(M6 AND M7) INTERACT V6_INTER   <2
X OUTSIDE INST
}

DFM_29_V7{
@ At least two vias (Vn, TV1, TV2, n=1~7) in Mn and Mn+1 (M1, Mn, n=2~8, TM1, TM2) intersection area.
@ (This rule is not applicable for SRAM region, but SRAM region should follow main rule: V1.16, V1.17, Vn.16, Vn.17, TV1.13, TV2.13, TV2.14)
V7_INTER= V7 INSIDE (M7 AND M8) 
X = (M7 AND M8) INTERACT V7_INTER <2
X OUTSIDE INST
}
DFM_29_TV2 {
@ At least two vias (Vn, TV1, TV2, n=1~7) in Mn and Mn+1 (M1, Mn, n=2~8, TM1, TM2) intersection area.
@ (This rule is not applicable for SRAM region, but SRAM region should follow main rule: V1.16, V1.17, Vn.16, Vn.17, TV1.13, TV2.13, TV2.14)
TV2_INTER= TV2 INSIDE (TM2 AND M8) 
X = (TM2 AND M8) INTERACT TV2_INTER  <2
X OUTSIDE INST
}

#ENDIF


#ENDIF

#IFDEF Priority3 YES

DFM_18 {
@ M1 minimum width is 0.08
  INT M1  < 0.08 ABUT<90 SINGULAR REGION
}
DFM_19 {
@ M1 minimum space is 0.08
  EXT (M1 OUTSIDE SRAM) < 0.08 ABUT<90 SINGULAR REGION
}
DFM_20 {
@ Space between two (run length > 0.3m) parallel M1 lines with both metal lines width > 0.22m is 0.12.
   M1Si = EXT M1W < 0.12 OPPOSITE REGION PARA ONLY
   M1S = M1Si NOT IN  INST
   M1S WITH EDGE (LENGTH M1S > 0.3)
}
DFM_21 {
@ V1 (different net) minimum space for run length > 0 is 0.11 (outside of SRAM)
  X =EXT V1  < 0.11 NOT CONNECTED OPPOSITE REGION
  X  OUTSIDE INST
}
/*
DFM_V1_8R {
@ At least two V1 vias must connect M1 to M2 when the M1 or M2 width is > 0.1um
  WM1 = WITH WIDTH M1 > 0.10
  WM2 = WITH WIDTH M2 > 0.10
  (M1 AND WM2) INTERACT V1 >0<2
  (WM1 AND M2) INTERACT V1 >0<2
}
*/
DFM_22_M2 {
@ M2 minimum width is 0.08
  INT M2  < 0.08 ABUT<90 SINGULAR REGION
}
DFM_23_M2 {
@ M2 minimum space is 0.08
  EXT (M2 OUTSIDE INST) < 0.08 ABUT<90 SINGULAR REGION
}
DFM_24_M2 {
@ Minimum space between two length > 0.3um parallel metal
@ lines with both metal line width is > 0.22um is 0.12
   M2Si = EXT M2W < 0.12 OPPOSITE REGION PARA ONLY
   M2S =COPY M2Si  
   M2S WITH EDGE (LENGTH M2S > 0.3)
}
DFM_25_V2 {
@ V2 (different net) minimum space for run length > 0 is 0.11 (outside of SRAM)
  X =EXT V2 < 0.11 NOT CONNECTED OPPOSITE REGION
  X OUTSIDE INST 
}
/*
DFM_V2_8R {
@ At least two Vn vias must connect Mn to Mn+1 when the Mn or Mn+1 width is > 0.1um
  WM2 = WITH WIDTH M2 > 0.10
  WM3 = WITH WIDTH M3 > 0.10
  (M2 AND WM3) INTERACT V2 >0<2
  (WM2 AND M3) INTERACT V2 >0<2
}
*/
DFM_22_M3 {
@ M3 minimum width is 0.08
  INT M3 < 0.08 ABUT<90 SINGULAR REGION
}
DFM_23_M3 {
@ M3 minimum space is 0.08
  EXT M3 < 0.08 ABUT<90 SINGULAR REGION
}
DFM_24_M3 {
@ Minimum space between two length > 0.3um parallel metal
@ lines with  both metal line width is >0.22um is 0.12
   M3Si = EXT  M3W < 0.12 OPPOSITE REGION PARA ONLY
   M3S = COPY M3Si 
   M3S WITH EDGE (LENGTH M3S > 0.3)
}
#IFDEF TOPMETAL 9
DFM_25_V3 {
@ V3 (different net) minimum space for run length > 0 is 0.11
 X = EXT V3 < 0.11  NOT CONNECTED OPPOSITE REGION
 X OUTSIDE INST 
}
#ENDIF
#IFDEF TOPMETAL 8
DFM_25_V3 {
@ V3 (different net) minimum space for run length > 0 is 0.11
  X =EXT V3 < 0.11 NOT CONNECTED OPPOSITE REGION
X OUTSIDE INST
}
#ENDIF
#IFDEF TOPMETAL 7
DFM_25_V3 {
@ V3 (different net) minimum space for run length > 0 is 0.11
 X= EXT V3 < 0.11 NOT CONNECTED OPPOSITE REGION
 X OUTSIDE INST
}
#ENDIF
#IFDEF TOPMETAL 6
DFM_25_V3 {
@ V3 (different net) minimum space for run length > 0 is 0.11
  X= EXT V3 < 0.11 NOT CONNECTED OPPOSITE REGION
  X OUTSIDE INST

}
#ENDIF
#IFDEF TOPMETAL 5
DFM_25_V3 {
@ V3 (different net) minimum space for run length > 0 is 0.11
 X =EXT V3 < 0.11 NOT CONNECTED OPPOSITE REGION
 X OUTSIDE INST
}
#ENDIF

/*
DFM_V3_8R {
@ At least two Vn vias must connect Mn to Mn+1 when the Mn or Mn+1 width is > 0.1um
  WM3 = WITH WIDTH M3 > 0.10
  WM4 = WITH WIDTH M4 > 0.10
  (M3 AND WM4) INTERACT V3 >0<2
  (WM3 AND M4) INTERACT V3 >0<2
}
*/
DFM_22_M4 {
@ M4 minimum width is 0.08
  INT M4 < 0.08 ABUT<90 SINGULAR REGION
}
DFM_23_M4 {
@ M4 minimum space is 0.08
  EXT M4 < 0.08 ABUT<90 SINGULAR REGION
}
DFM_24_M4 {
@ Minimum space between two length > 0.3um parallel metal
@ lines with both metal line width is > 0.22um is 0.12
   M4Si = EXT  M4W < 0.12 OPPOSITE REGION PARA ONLY
   M4S = COPY  M4Si 
   M4S WITH EDGE (LENGTH M4S > 0.3)
}
#IFDEF TOPMETAL 9
DFM_25_V4 {
@ V4 (different net) minimum space for run length > 0 is 0.11
  X =EXT V4 < 0.11 NOT CONNECTED OPPOSITE REGION
  X OUTSIDE INST
}
#ENDIF
#IFDEF TOPMETAL 8
DFM_25_V4 {
@ V4 (different net) minimum space for run length > 0 is 0.11
 X =EXT V4 < 0.11 NOT CONNECTED OPPOSITE REGION
  X OUTSIDE INST
}
#ENDIF
#IFDEF TOPMETAL 7
DFM_25_V4 {
@ V4 (different net) minimum space for run length > 0 is 0.11
 X= EXT V4 < 0.11 NOT CONNECTED OPPOSITE REGION
  X OUTSIDE INST
}
#ENDIF
#IFDEF TOPMETAL 6
DFM_25_V4 {
@ V4 (different net) minimum space for run length > 0 is 0.11
  X=EXT V4 < 0.11 NOT CONNECTED OPPOSITE REGION
  X OUTSIDE INST
}
#ENDIF
/*
DFM_V4_8R {
@ At least two Vn vias must connect Mn to Mn+1 when the Mn or Mn+1 width is > 0.1um
  WM4 = WITH WIDTH M4 > 0.10
  WM5 = WITH WIDTH M5 > 0.10
  (M4 AND WM5) INTERACT V4 >0<2
  (WM4 AND M5) INTERACT V4 >0<2
}
*/
DFM_22_M5 {
@ M5 minimum width is 0.08
  INT M5 < 0.08 ABUT<90 SINGULAR REGION
}
DFM_23_M5 {
@ M5 minimum space is 0.08
  EXT M5 < 0.08 ABUT<90 SINGULAR REGION
}
DFM_24_M5 {
@ Minimum space between two length > 0.3um parallel metal
@ lines with  both metal line width is > 0.22um is 0.12
   M5Si = EXT M5W < 0.12 OPPOSITE REGION PARA ONLY
   M5S = COPY M5Si 
   M5S WITH EDGE (LENGTH M5S > 0.3)
}
#IFDEF TOPMETAL 9
DFM_25_V5 {
@ V5 (different net) minimum space for run length > 0 is 0.11
 X =EXT V5 < 0.11 NOT CONNECTED OPPOSITE REGION
  X OUTSIDE INST

}
#ENDIF
#IFDEF TOPMETAL 8
DFM_25_V5 {
@ V5 (different net) minimum space for run length > 0 is 0.11
  X= EXT V5 < 0.11 NOT CONNECTED OPPOSITE REGION
 X OUTSIDE INST
}
#ENDIF
#IFDEF TOPMETAL 7
DFM_25_V5 {
@ V5 (different net) minimum space for run length > 0 is 0.11
  X= EXT V5 < 0.11 NOT CONNECTED OPPOSITE REGION
 X OUTSIDE INST
}
#ENDIF
/*
DFM_V5_8R {
@ At least two Vn vias must connect Mn to Mn+1 when the Mn or Mn+1 width is > 0.1um
  WM5 = WITH WIDTH M5 > 0.10
  WM6 = WITH WIDTH M6 > 0.10
  (M5 AND WM6) INTERACT V5 >0<2
  (WM5 AND M6) INTERACT V5 >0<2
}
*/
DFM_22_M6 {
@ M6 minimum width is 0.08
  INT M6 < 0.08 ABUT<90 SINGULAR REGION
}
DFM_23_M6 {
@ M6 minimum space is 0.08
  EXT M6 < 0.08 ABUT<90 SINGULAR REGION
}
DFM_24_M6 {
@ Minimum space between two length >= 0.3um parallel metal
@ lines with both metal line width is >= 0.22um is 0.12
   M6Si = EXT M6W < 0.12 OPPOSITE REGION PARA ONLY
   M6S = COPY M6Si 
   M6S WITH EDGE (LENGTH M6S > 0.3)
}
#IFDEF TOPMETAL 9
DFM_25_V6 {
@ V6 (different net) minimum space for run length > 0 is 0.11
  X =EXT V6 < 0.11 NOT CONNECTED OPPOSITE REGION
  X OUTSIDE INST

}
#ENDIF
#IFDEF TOPMETAL 8
DFM_25_V6 {
@ V6 (different net) minimum space for run length > 0 is 0.11
   X =EXT V6 < 0.11 NOT CONNECTED OPPOSITE REGION
  X OUTSIDE INST
}
#ENDIF
/*
DFM_V6_8R {
@ At least two Vn vias must connect Mn to Mn+1 when the Mn or Mn+1 width is > 0.1um
  WM6 = WITH WIDTH M6 > 0.10
  WM7 = WITH WIDTH M7 > 0.10
  (M6 AND WM7) INTERACT V6 >0<2
  (WM6 AND M7) INTERACT V6 >0<2
}
*/
DFM_22_M7 {
@ M7 minimum width is 0.08
  INT M7 < 0.08 ABUT<90 SINGULAR REGION
}
DFM_23_M7 {
@ M7 minimum space is 0.08
  EXT M7 < 0.08 ABUT<90 SINGULAR REGION
}
DFM_24_M7 {
@ Minimum space between two length > 0.3um parallel metal
@ lines with one or both metal line width is > 0.22um is 0.12
   M7Si = EXT M7W < 0.12 OPPOSITE REGION PARA ONLY
   M7S = COPY M7Si 
   M7S WITH EDGE (LENGTH M7S > 0.3)
}
#IFDEF TOPMETAL 9
DFM_25_V7 {
@ V7 (different net) minimum space for run length > 0 is 0.11
   X =EXT V7 < 0.11 NOT CONNECTED OPPOSITE REGION
  X OUTSIDE INST
}
#ENDIF
/*
DFM_V7_8R {
@ At least two Vn vias must connect Mn to Mn+1 when the Mn or Mn+1 width is > 0.1um
  WM7 = WITH WIDTH M7 > 0.10
  WM8 = WITH WIDTH M8 > 0.10
  (M7 AND WM8) INTERACT V7 >0<2
  (WM7 AND M8) INTERACT V7 >0<2
}
*/
DFM_22_M8 {
@ M8 minimum width is 0.08
  INT M8 < 0.08 ABUT<90 SINGULAR REGION
}
DFM_23_M8 {
@ M8 minimum space is 0.08
  EXT M8 < 0.08 ABUT<90 SINGULAR REGION
}
DFM_24_M8 {
@ Minimum space between two length > 0.3um parallel metal
@ lines with both metal line width is > 0.22um is 0.12
   M8Si = EXT M8W < 0.12 OPPOSITE REGION PARA ONLY
   M8S = COPY M8Si 
   M8S WITH EDGE (LENGTH M8S > 0.3)
}
#ENDIF
DFM_26 {
@ For parallel long NW (length >50um), must make NW width larger than 0.89um or NW to NW space larger than 0.89um
   X1 = EXT NW < 0.89 OPPOSITE REGION PARA ONLY
   X2 = LENGTH X1 > 50
   X3 = EXPAND EDGE X2 OUTSIDE BY 0.89
   X4 = X3 NOT INTERACT (X3 NOT NW)
   X5 = INT X2 < 0.89 REGION
   X5 NOT INTERACT X4
}
#ENDIF

//============================
//  Dummy insert check Rules
//============================

#IFDEF DUMC SMIC

GROUP GDUMC DUMC_?

LP = LOGO OR PTCT
LPM = LP OR MARKG
LP_BM = LP OR DUMBM
LPM_BM = LPM OR DUMBM

DUMC_1 {
@ Dummy AA should comply with AA.1, AA.4a rules
@ Min Dummy AA width is 0.06 (AA.1)
@ Min Dummy AA space is 0.08 (AA.4a)
  INT AADUM < 0.06 ABUT < 90 SINGULAR REGION
  EXT AADUM < 0.08 ABUT < 90 SINGULAR REGION
}

DUMC_2 {
@ Dummy AA must not touch (AA GT LOGO PTCT MARKG RESP1 RESNW PLRES HRPDMY).
  X = (AA OR GT) OR ((LPM OR HRPDMY) OR ((RESP1 OR PLRES) OR RESNW))
  AADUM INTERACT X
}

DUMC_3 {
@ Dummy AA cannot straddle N-Well boundaries.
  AADUM CUT NW
}

DUMC_5 {
@ Dummy AA space to AA >=0.710
  EXT AADUM AA < 0.71 ABUT < 90 SINGULAR REGION
}

DUMC_6 {
@ Dummy AA space to (GT, PTCT, RESP1, RESNW,  PLRES, HRPDMY) >=0.220
  EXT AADUM GT < 0.22 ABUT < 90 SINGULAR REGION
  EXT AADUM PTCT < 0.22 ABUT < 90 SINGULAR REGION
  EXT AADUM RESP1 < 0.22 ABUT < 90 SINGULAR REGION
  EXT AADUM RESNW < 0.22 ABUT < 90 SINGULAR REGION
  EXT AADUM PLRES < 0.22 ABUT < 90 SINGULAR REGION
  EXT AADUM HRPDMY < 0.22 ABUT < 90 SINGULAR REGION
}

DUMC_7 {
@ Dummy AA space to GTFUSE >=3.330
  EXT AADUM GTFUSE < 3.33 ABUT < 90 SINGULAR REGION
}

DUMC_8 {
@ Dummy AA space to NW >=0.260
  EXT AADUM NW < 0.26 ABUT < 90 SINGULAR REGION
}

/*DUMC_9 {
@ Dummy AA space to DNW >=0.260
  EXT AADUM DNW < 0.26 ABUT < 90 SINGULAR REGION
}*/

DUMC_10 {
@ Dummy AA cannot insert at RESNW area
  AADUM AND RESNW
}

DUMC_11 {
@ Dummy AA should not be larger than 20x20um
  ENCLOSE RECTANGLE AADUM 20.001 20.001
}

DUMC_12 {
@ Dummy GT must not touch (GT, AA, LOGO, PTCT, MARKG, RESAA, RESNW, DIFRES)
  GTDUM INTERACT GT
  GTDUM INTERACT AA
  GTDUM INTERACT LPM
  GTDUM INTERACT RESAA
  GTDUM INTERACT RESNW
  GTDUM INTERACT DIFRES
}

DUMC_13 {
@ Dummy GT minimum width >=0.044
  INT GTDUM < 0.044 ABUT <90 SINGULAR REGION
}

DUMC_14 {
@ Dummy GT minimum space >=0.110
  EXT GTDUM < 0.11 ABUT <90 SINGULAR REGION
}

DUMC_15 {
@ Dummy GT space to GT on AA >= 0.150
  EXT GTDUM (GT INTERACT AA) < 0.15 ABUT <90 SINGULAR REGION
}

DUMC_15a {
@ Dummy GT space to GT on field OX >= 0.110
  EXT GTDUM (GT NOT INTERACT AA) < 0.11 ABUT <90 SINGULAR REGION
}

DUMC_16 {
@ Dummy GT space to (AA,PTCT, RESAA, RESNW, DIFRES, HRPDMY). >=0.220
  EXT GTDUM AA < 0.22 ABUT <90 SINGULAR REGION
  EXT GTDUM PTCT< 0.22 ABUT <90 SINGULAR REGION
  EXT GTDUM RESAA < 0.22 ABUT <90 SINGULAR REGION
  EXT GTDUM RESNW < 0.22 ABUT <90 SINGULAR REGION
  EXT GTDUM DIFRES < 0.22 ABUT <90 SINGULAR REGION
  EXT GTDUM HRPDMY < 0.22 ABUT <90 SINGULAR REGION
}

DUMC_17 {
@ Dummy GT space to GTFUSE >=3.330
  EXT GTDUM GTFUSE < 3.33 ABUT <90 SINGULAR REGION
}

DUMC_18 {
@ Mx Dummy must not touch (Mx, Vx, Vx-1, LOGO, PTCT, MARKS), where Mx=M1-M8, TM1, TM2,MTT2. x=1~8. V8 and V-1 are not applicable
  INTERACT M1DUM ((M1 OR LPM) OR V1 ) 
  INTERACT M2DUM ((M2 OR LPM)  OR (V1 OR V2))
  INTERACT M3DUM ((M3 OR LPM)  OR (V2 OR V3))
  INTERACT M4DUM ((M4 OR LPM)  OR (V3 OR V4))
  INTERACT M5DUM ((M5 OR LPM)  OR (V4 OR V5))
  INTERACT M6DUM ((M6 OR LPM)  OR (V5 OR V6))
  INTERACT M7DUM ((M7 OR LPM)  OR (V6 OR V7) )
  INTERACT M8DUM ((M8 OR LPM)  OR V7)
  //INTERACT TM1DUM (TM1 OR LPM) 
  INTERACT TM2DUM (TM2 OR LPM)  
  INTERACT MTT2DM (MTT2 OR LPM) 
}

DUMC_19 {
@ Mx Dummy space to GTFUSE with touching prohibited, where Mx=M1, M2   >=3.33
  EXT M1DUM GTFUSE < 3.33 ABUT <90 SINGULAR REGION
  EXT M2DUM GTFUSE < 3.33 ABUT <90 SINGULAR REGION
  INTERACT M1DUM GTFUSE
  INTERACT M2DUM GTFUSE
}
PT_BM = DUMBM OR PTCT
DUMC_20_M1 {
@ Mx Dummy space to (MxDUB, DUMBM, PTCT), where Mx=M1-M8.   >=0.6
  EXT M1DUM (M1DUB OR PT_BM) < 0.6 ABUT < 90 SINGULAR REGION
}

DUMC_20_M2 {
  EXT M2DUM (M2DUB OR PT_BM) < 0.6 ABUT < 90 SINGULAR REGION
}

DUMC_20_M3 {
  EXT M3DUM (M3DUB OR PT_BM) < 0.6 ABUT < 90 SINGULAR REGION
}

DUMC_20_M4 {
  EXT M4DUM (M4DUB OR PT_BM) < 0.6 ABUT < 90 SINGULAR REGION
}

DUMC_20_M5 {
  EXT M5DUM (M5DUB OR PT_BM) < 0.6 ABUT < 90 SINGULAR REGION
}

DUMC_20_M6 {
  EXT M6DUM (M6DUB OR PT_BM) < 0.6 ABUT < 90 SINGULAR REGION
}

DUMC_20_M7 {
  EXT M7DUM (M7DUB OR PT_BM) < 0.6 ABUT < 90 SINGULAR REGION
}

DUMC_20_M8 {
  EXT M8DUM (M8DUB OR PT_BM) < 0.6 ABUT < 90 SINGULAR REGION
}

DUMC_21_M1 {
@ Mx Dummy space to Mx(when Mx Dummy not touching INDMY), where Mx=M1-M8. >=0.6
  EXT (M1DUM  NOT INTERACT INDMY) M1 < 0.6 ABUT < 90 SINGULAR REGION
}

DUMC_21_M2 {
@ Mx Dummy space to Mx(when Mx Dummy not touching INDMY), where Mx=M1-M8. >=0.6
  EXT (M2DUM NOT INTERACT INDMY) M2 < 0.6 ABUT < 90 SINGULAR REGION
}

DUMC_21_M3 {
@ Mx Dummy space to Mx(when Mx Dummy not touching INDMY), where Mx=M1-M8. >=0.6
  EXT (M3DUM  NOT INTERACT INDMY) M3  < 0.6 ABUT < 90 SINGULAR REGION
}

DUMC_21_M4 {
@ Mx Dummy space to Mx(when Mx Dummy not touching INDMY), where Mx=M1-M8. >=0.6
  EXT (M4DUM NOT INTERACT INDMY) M4  < 0.6 ABUT < 90 SINGULAR REGION
}

DUMC_21_M5 {
@ Mx Dummy space to Mx(when Mx Dummy not touching INDMY), where Mx=M1-M8. >=0.6
  EXT (M5DUM  NOT INTERACT INDMY) M5  < 0.6 ABUT < 90 SINGULAR REGION
}

DUMC_21_M6 {
@ Mx Dummy space to Mx(when Mx Dummy not touching INDMY), where Mx=M1-M8. >=0.6
  EXT (M6DUM NOT INTERACT INDMY) M6  < 0.6 ABUT < 90 SINGULAR REGION
}

DUMC_21_M7 {
@ Mx Dummy space to Mx(when Mx Dummy not touching INDMY), where Mx=M1-M8. >=0.6
  EXT (M7DUM NOT INTERACT INDMY) M7  < 0.6 ABUT < 90 SINGULAR REGION
}

DUMC_21_M8 {
@ Mx Dummy space to Mx(when Mx Dummy not touching INDMY), where Mx=M1-M8. >=0.6
  EXT (M8DUM NOT INTERACT INDMY) M8 < 0.6 ABUT < 90 SINGULAR REGION
}

DUMC_21a_M1{
@ Mx Dummy space to Mx (when Mx Dummy touching INDMY), where Mx=M1-M8.0.53
EXT (M1DUM INTERACT INDMY) M1  <0.53 ABUT < 90 SINGULAR REGION
}
DUMC_21a_M2 {
  EXT (M2DUM INTERACT INDMY) M2  < 0.53 ABUT < 90 SINGULAR REGION
}

DUMC_21a_M3 {
  EXT (M3DUM INTERACT INDMY) M3  < 0.53 ABUT < 90 SINGULAR REGION
}

DUMC_21a_M4 {
  EXT (M4DUM INTERACT INDMY) M4  < 0.53 ABUT < 90 SINGULAR REGION
}

DUMC_21a_M5 {
  EXT (M5DUM INTERACT INDMY) M5 < 0.53 ABUT < 90 SINGULAR REGION
}

DUMC_21a_M6 {
  EXT (M6DUM INTERACT INDMY) M6  < 0.53 ABUT < 90 SINGULAR REGION
}

DUMC_21a_M7 {
  EXT ( M7DUM INTERACT INDMY) M7  < 0.53 ABUT < 90 SINGULAR REGION
}

DUMC_21a_M8 {
  EXT (M8DUM INTERACT INDMY) M8 < 0.53 ABUT < 90 SINGULAR REGION
}

DUMC_22 {
@ Vx Dummy must not touch (Vx, Mx, Mx+1, LOGO, PTCT, INDMY ,MARKS), where Vx=V1-V7, x=1-7
  LPI = (LP OR INDMY) OR MARKG
  V1DUM INTERACT ((V1 OR LPI)  OR (M1 OR M2))
  V2DUM INTERACT ((V2 OR LPI) OR (M2 OR M3))
  V3DUM INTERACT ((V3 OR LPI)  OR (M3 OR M4))
  V4DUM INTERACT ((V4 OR LPI)  OR (M4 OR M5))
  V5DUM INTERACT ((V5 OR LPI)  OR (M5 OR M6))
  V6DUM INTERACT ((V6 OR LPI)  OR (M6 OR M7))
  V7DUM INTERACT ((V7 OR LPI) OR (M7 OR M8))
}

DMACRO DUMC_23_24 DMLAY {
X1 = RECTANGLE DMLAY == 0.07 BY == 0.07
X2 = RECTANGLE DMLAY == 0.077 BY == 0.077
Y = X1 OR X2
DMLAY NOT Y
}

DUMC_23_24_V1 {
@ Vx Dummy exact width is 0.07 or 0.077, where Vx=V1-V7.
@ xx Dummy must be square, where xx=V1-V7
CMACRO DUMC_23_24 V1DUM
}
DUMC_23_24_V2 {
@ Vx Dummy exact width is 0.07 or 0.077, where Vx=V1-V7.
@ xx Dummy must be square, where xx=V1-V7
CMACRO DUMC_23_24 V2DUM
}
DUMC_23_24_V3 {
@ Vx Dummy exact width is 0.07 or 0.077, where Vx=V1-V7.
@ xx Dummy must be square, where xx=V1-V7
CMACRO DUMC_23_24 V3DUM
}
DUMC_23_24_V4 {
@ Vx Dummy exact width is 0.07 or 0.077, where Vx=V1-V7.
@ xx Dummy must be square, where xx=V1-V7
CMACRO DUMC_23_24 V4DUM
}
DUMC_23_24_V5 {
@ Vx Dummy exact width is 0.07 or 0.077, where Vx=V1-V7.
@ xx Dummy must be square, where xx=V1-V7
CMACRO DUMC_23_24 V5DUM
}
DUMC_23_24_V6 {
@ Vx Dummy exact width is 0.07 or 0.077, where Vx=V1-V7.
@ xx Dummy must be square, where xx=V1-V7
CMACRO DUMC_23_24 V6DUM
}
DUMC_23_24_V7 {
@ Vx Dummy exact width is 0.07 or 0.077, where Vx=V1-V7.
@ xx Dummy must be square, where xx=V1-V7
CMACRO DUMC_23_24 V7DUM
}

DUMC_25_a_b_V1 {
@ Vx Dummy must be within Mx Dummy, where Vx=V1-V7 and Mx= metal level below Vx. >=0.06
@ Vx Dummy must be within My Dummy, where Vx=V1-V7 and My= metal level above Vx. >=0.06
  M1D_AND_M2D = M1DUM AND M2DUM
  ENC V1DUM M1D_AND_M2D < 0.06 ABUT < 90 SINGULAR REGION
  V1DUM NOT M1D_AND_M2D
}

DUMC_25_a_b_V2 {
  M2D_AND_M3D = M2DUM AND M3DUM
  ENC V2DUM M2D_AND_M3D < 0.06 ABUT < 90  SINGULAR REGION
  V2DUM NOT M2D_AND_M3D
}

DUMC_25_a_b_V3 {
  M3D_AND_M4D = M3DUM AND M4DUM
  ENC V3DUM M3D_AND_M4D < 0.06 ABUT < 90  SINGULAR REGION
  V3DUM NOT M3D_AND_M4D
}

DUMC_25_a_b_V4 {
  M4D_AND_M5D = M4DUM AND M5DUM
  ENC V4DUM M4D_AND_M5D < 0.06 ABUT < 90  SINGULAR REGION
  V4DUM NOT M4D_AND_M5D
}

DUMC_25_a_b_V5 {
  M5D_AND_M6D = M5DUM AND M6DUM
  ENC V5DUM M5D_AND_M6D < 0.06 ABUT < 90  SINGULAR REGION
  V5DUM NOT M5D_AND_M6D
}

DUMC_25_a_b_V6 {
  M6D_AND_M7D = M6DUM AND M7DUM
  ENC V6DUM M6D_AND_M7D < 0.06 ABUT < 90  SINGULAR REGION
  V6DUM NOT M6D_AND_M7D
}

DUMC_25_a_b_V7 {
  M7D_AND_M8D = M7DUM AND M8DUM
  ENC V7DUM M7D_AND_M8D < 0.06 ABUT < 90  SINGULAR REGION
  V7DUM NOT M7D_AND_M8D
}

DUMC_26 {
@ TMx Dummy space to (TMx, TMxDUB,PTCT), where TMx=TM1, TM2, >=0.6
  EXT TM2DUM ((TM2 OR TM2DUB) OR PTCT) < 0.6 ABUT < 90 SINGULAR REGION
  //EXT MTT2DM ((MTT2 OR MTT2DB) OR PTCT) < 1.77 ABUT < 90 SINGULAR REGION
}
DUMC_26a {
@ MTT2 Dummy(MTT2DM) space to (MTT2, MTT2DB,PTCT)	>=1.77
 EXT MTT2DM ((MTT2 OR MTT2DB) OR PTCT) < 1.77 ABUT < 90 SINGULAR REGION
}


DUMC_27 {
@ ALPA Dummy must not touch (ALPA, LOGO, PTCT,MARKS)
@ ALPA Dummy must not touch (ALPA, LOGO, PTCT, ALDUB, MARKG)
  ALDUM INTERACT (ALPAi OR LPM) 
}

DUMC_28 {
@ ALPA Dummy space to (ALPA, ALDUB,PTCT).>=2.84
  EXT ALDUM ((ALPAi OR PTCT) OR ALDUB) < 2.84 ABUT < 90 SINGULAR REGION
}

DUMC_29 {
@ ALPA Dummy space to INDMY with touching prohibited. >=2.84
  EXT ALDUM INDMY < 2.84 ABUT < 90 SINGULAR REGION
  ALDUM AND INDMY
}

DUMC_30_M1 {
@ Maximum xx Dummy density within INDMY. (Where xx=M1~M8, TM1, TM2,MTT2. Only check dummy metal density) <12%
 M1DUM_INDMY = M1DUM AND INDMY
 X = COPY INDMY
 DENSITY M1DUM_INDMY INDMY [AREA(M1DUM_INDMY)/AREA(INDMY)]> 0.12 INSIDE OF LAYER X PRINT density_report_M1DUM_INDMY.log RDB density_report_DUMC_30_M1.db
}

DUMC_30_M2 {
 M2DUM_INDMY = M2DUM AND INDMY
  X = COPY INDMY
 DENSITY M2DUM_INDMY INDMY [AREA(M2DUM_INDMY)/AREA(INDMY)]> 0.12 INSIDE OF LAYER X PRINT density_report_M2DUM_INDMY.log RDB density_report_DUMC_30_M2.db
}

DUMC_30_M3 {
 M3DUM_INDMY = M3DUM AND INDMY
  X = COPY INDMY
 DENSITY M3DUM_INDMY INDMY [AREA(M3DUM_INDMY)/AREA(INDMY)]> 0.12 INSIDE OF LAYER X PRINT density_report_M3DUM_INDMY.log RDB density_report_DUMC_30_M3.db
}

DUMC_30_M4 {
 M4DUM_INDMY = M4DUM AND INDMY
  X = COPY INDMY
 DENSITY M4DUM_INDMY INDMY [AREA(M4DUM_INDMY)/AREA(INDMY)]> 0.12 INSIDE OF LAYER X PRINT density_report_M4DUM_INDMY.log RDB density_report_DUMC_30_M4.db
}

DUMC_30_M5 {
 M5DUM_INDMY = M5DUM AND INDMY
  X = COPY INDMY
 DENSITY M5DUM_INDMY INDMY [AREA(M5DUM_INDMY)/AREA(INDMY)]> 0.12 INSIDE OF LAYER X PRINT density_report_M5DUM_INDMY.log RDB density_report_DUMC_30_M5.db
}

DUMC_30_M6 {
 M6DUM_INDMY = M6DUM AND INDMY
  X = COPY INDMY
 DENSITY M6DUM_INDMY INDMY [AREA(M6DUM_INDMY)/AREA(INDMY)]> 0.12 INSIDE OF LAYER X PRINT density_report_M6DUM_INDMY.log RDB density_report_DUMC_30_M6.db
}

DUMC_30_M7 {
 M7DUM_INDMY = M7DUM AND INDMY
  X = COPY INDMY
 DENSITY M7DUM_INDMY INDMY [AREA(M7DUM_INDMY)/AREA(INDMY)]> 0.12 INSIDE OF LAYER X PRINT density_report_M7DUM_INDMY.log RDB density_report_DUMC_30_M7.db
}

DUMC_30_M8 {
 M8DUM_INDMY = M8DUM AND INDMY
  X = COPY INDMY
 DENSITY M8DUM_INDMY INDMY [AREA(M8DUM_INDMY)/AREA(INDMY)]> 0.12 INSIDE OF LAYER X PRINT density_report_M8DUM_INDMY.log RDB density_report_DUMC_30_M8.db
}


#IFDEF UTM NO

DUMC_30_TM2 {
 TM2DUM_INDMY = TM2DUMi AND INDMY
  X = COPY INDMY
DENSITY TM2DUM_INDMY INDMY [AREA(TM2DUM_INDMY)/AREA(INDMY)]> 0.12 INSIDE OF LAYER X PRINT density_report_TM2DUM_INDMY.log RDB density_report_DUMC_30_TM2.db

}

#ENDIF

#IFDEF UTM YES

DUMC_30_MTT2 {
 MTT2DM_INDMY = MTT2DMi AND INDMY
  X = COPY INDMY
DENSITY MTT2DM_INDMY INDMY [AREA(MTT2DM_INDMY)/AREA(INDMY)]> 0.12 INSIDE OF LAYER X PRINT density_report_MTT2DM_INDMY.log RDB density_report_DUMC_30_MTT2.db
}

#ENDIF

DUMC_31 {
@ xx Dummy must be within BORDER, where xx=all metal and via levels, AA, GT.
  M1DUM NOT BD_WITHHOLE
  M2DUM NOT BD_WITHHOLE
  M3DUM NOT BD_WITHHOLE
  M4DUM NOT BD_WITHHOLE
  M5DUM NOT BD_WITHHOLE
  M6DUM NOT BD_WITHHOLE
  M7DUM NOT BD_WITHHOLE
  M8DUM NOT BD_WITHHOLE
  TM2DUM NOT BD_WITHHOLE
  MTT2DM NOT BD_WITHHOLE
  ALDUM NOT BD_WITHHOLE
  V1DUM NOT BD_WITHHOLE
  V2DUM NOT BD_WITHHOLE
  V3DUM NOT BD_WITHHOLE
  V4DUM NOT BD_WITHHOLE
  V5DUM NOT BD_WITHHOLE
  V6DUM NOT BD_WITHHOLE
  V7DUM NOT BD_WITHHOLE
  AADUM NOT BD_WITHHOLE
  GTDUM NOT BD_WITHHOLE
}

DUMC_32 {
@ Min. width of Mx Dummy, where Mx=M1-M8. >=0.22
  INT M1DUM < 0.22 ABUT < 90 SINGULAR REGION
  INT M2DUM < 0.22 ABUT < 90 SINGULAR REGION
  INT M3DUM < 0.22 ABUT < 90 SINGULAR REGION
  INT M4DUM < 0.22 ABUT < 90 SINGULAR REGION
  INT M5DUM < 0.22 ABUT < 90 SINGULAR REGION
  INT M6DUM < 0.22 ABUT < 90 SINGULAR REGION
  INT M7DUM < 0.22 ABUT < 90 SINGULAR REGION
  INT M8DUM < 0.22 ABUT < 90 SINGULAR REGION
}

DUMC_33_M1 {
@ Min. space of Mx Dummy, where Mx=M1-M8. >=0.22
  EXT M1DUM < 0.22 ABUT < 90 SINGULAR REGION
}

DUMC_33_M2 {
  EXT M2DUM < 0.22 ABUT < 90 SINGULAR REGION
}

DUMC_33_M3 {
  EXT M3DUM < 0.22 ABUT < 90 SINGULAR REGION
}

DUMC_33_M4 {
  EXT M4DUM < 0.22 ABUT < 90 SINGULAR REGION
}

DUMC_33_M5 {
  EXT M5DUM < 0.22 ABUT < 90 SINGULAR REGION
}

DUMC_33_M6 {
  EXT M6DUM < 0.22 ABUT < 90 SINGULAR REGION
}

DUMC_33_M7 {
  EXT M7DUM < 0.22 ABUT < 90 SINGULAR REGION
}

DUMC_33_M8 {
  EXT M8DUM < 0.22 ABUT < 90 SINGULAR REGION
}

DUMC_34 {
@ Min. width of TMx Dummy, where TMx=TM1-TM2,MTT2. >=0.44
  INT TM2DUM < 0.44 ABUT < 90 SINGULAR REGION
  INT MTT2DM < 0.44 ABUT < 90 SINGULAR REGION
}

DUMC_35 {
@ Min. space of TMx Dummy, where TMx=TM1-TM2,MTT2. >=0.6
  //EXT TM1DUM < 0.6 ABUT < 90 SINGULAR REGION
  EXT TM2DUM < 0.6 ABUT < 90 SINGULAR REGION
  EXT MTT2DM < 0.6 ABUT < 90 SINGULAR REGION
}

DUMC_36 {
@ Min. width of ALPA Dummy. >=4.44
  INT ALDUM < 4.44 ABUT < 90 SINGULAR REGION
}

DUMC_37 {
@ Min. space of ALPA Dummy. >=2.84
  EXT ALDUM < 2.84 ABUT < 90 SINGULAR REGION
}

#ENDIF

#IFDEF DUMC CUSTOMER

GROUP GDUMCN DUMCN_?

DUMCN_1 {
@ Dummy AA minimum width        AA.1
  INT AADUM < 0.06 ABUT < 90 SINGULAR REGION
}

DUMCN_2 {
@ Dummy AA minimum space to (AA, dummy AA)      AA.4a
  EXT AADUM < 0.08 ABUT < 90 SINGULAR REGION
  EXT AADUM AA < 0.08 ABUT < 90 SINGULAR REGION
}

DUMCN_3 {
@ Dummy AA minimum space to GT is 0.03  GT.4
  EXT AADUM GT < 0.03 ABUT < 90 SINGULAR REGION
}

DUMCN_4 {
@ Dummy AA must not touch (AA, GT, RESNW).
  AADUM INTERACT ((AA OR GT) OR RESNW)
}
/*
DUMCN_5 {
@ Dummy AA cannot straddle on N-Well boundaries.
  AADUM CUT NW
}
*/
DUMCN_6 {
@ Dummy GT minimum width is 0.04  GT.1a
  INT GTDUM < 0.04 ABUT < 90 SINGULAR REGION
}

DUMCN_7 {
@ Dummy GT minimum space to (GT, dummy GT)  GT.3
  EXT GTDUM < 0.1 ABUT < 90 SINGULAR REGION
  EXT GTDUM GT < 0.1 ABUT < 90 SINGULAR REGION
}

DUMCN_8 {
@ Dummy GT space to AA  GT.4
  EXT GTDUM AA < 0.03 ABUT < 90 SINGULAR REGION
}

DUMCN_9 {
@ Dummy GT must not touch (GT, AA).
  GTDUM INTERACT (GT OR AA)
}

DUMCN_10 {
@ Mx Dummy minimum width, where Mx=M1-M8.  Mn.1
  INT M1DUM < 0.07 ABUT < 90 SINGULAR REGION
  INT M2DUM < 0.07 ABUT < 90 SINGULAR REGION
  INT M3DUM < 0.07 ABUT < 90 SINGULAR REGION
  INT M4DUM < 0.07 ABUT < 90 SINGULAR REGION
  INT M5DUM < 0.07 ABUT < 90 SINGULAR REGION
  INT M6DUM < 0.07 ABUT < 90 SINGULAR REGION
  INT M7DUM < 0.07 ABUT < 90 SINGULAR REGION
  INT M8DUM < 0.07 ABUT < 90 SINGULAR REGION
}

DUMCN_11_M1 {
@ Mx Dummy minimum space to (Mx, Mx dummy), where Mx=M1-M8.  Mn.2
  EXT M1DUM (M1 OR M1DUM) < 0.07 ABUT < 90 SINGULAR REGION
}

DUMCN_11_M2 {
  EXT M2DUM (M2 OR M2DUM) < 0.07 ABUT < 90 SINGULAR REGION
}

DUMCN_11_M3 {
  EXT M3DUM (M3 OR M3DUM)< 0.07 ABUT < 90 SINGULAR REGION
}

DUMCN_11_M4 {
  EXT M4DUM (M4 OR M4DUM)< 0.07 ABUT < 90 SINGULAR REGION
}

DUMCN_11_M5 {
  EXT M5DUM (M5 OR M5DUM)< 0.07 ABUT < 90 SINGULAR REGION
}

DUMCN_11_M6 {
  EXT M6DUM (M6 OR M6DUM)< 0.07 ABUT < 90 SINGULAR REGION
}

DUMCN_11_M7 {
  EXT M7DUM (M7 OR M7DUM)< 0.07 ABUT < 90 SINGULAR REGION
}

DUMCN_11_M8 {
  EXT M8DUM (M8 OR M8DUM)< 0.07 ABUT < 90 SINGULAR REGION
}

DUMCN_12 {
@ Mx Dummy must not touch Mx, where Mx=M1-M8, TM1, TM2.
  M1DUM INTERACT M1
  M2DUM INTERACT M2
  M3DUM INTERACT M3
  M4DUM INTERACT M4
  M5DUM INTERACT M5
  M6DUM INTERACT M6
  M7DUM INTERACT M7
  M8DUM INTERACT M8
  TM2DUM INTERACT TM2
  MTT2DM INTERACT MTT2
}

DMACRO DUMCN_13_16 DMLAY {
X1 = RECTANGLE DMLAY == 0.07 BY == 0.07
X2 = RECTANGLE DMLAY == 0.077 BY == 0.077
X3 = RECTANGLE DMLAY == 0.12 BY == 0.12
Y = (X1 OR X2) OR X3
DMLAY NOT Y
}
DUMCN_13_16_V1 {
@ Vx Dummy exact width is 0.07 or 0.077 or 0.12, where Vx=V1-V7.
@ xx Dummy must be square, where xx=V1-V7
CMACRO DUMCN_13_16 V1DUM
}
DUMCN_13_16_V2 {
@ Vx Dummy exact width is 0.07 or 0.077 or 0.12, where Vx=V1-V7.
@ xx Dummy must be square, where xx=V1-V7
CMACRO DUMCN_13_16 V2DUM
}
DUMCN_13_16_V3 {
@ Vx Dummy exact width is 0.07 or 0.077 or 0.12, where Vx=V1-V7.
@ xx Dummy must be square, where xx=V1-V7
CMACRO DUMCN_13_16 V3DUM
}
DUMCN_13_16_V4 {
@ Vx Dummy exact width is 0.07 or 0.077 or 0.12, where Vx=V1-V7.
@ xx Dummy must be square, where xx=V1-V7
CMACRO DUMCN_13_16 V4DUM
}
DUMCN_13_16_V5 {
@ Vx Dummy exact width is 0.07 or 0.077 or 0.12, where Vx=V1-V7.
@ xx Dummy must be square, where xx=V1-V7
CMACRO DUMCN_13_16 V5DUM
}
DUMCN_13_16_V6 {
@ Vx Dummy exact width is 0.07 or 0.077 or 0.12, where Vx=V1-V7.
@ xx Dummy must be square, where xx=V1-V7
CMACRO DUMCN_13_16 V6DUM
}
DUMCN_13_16_V7 {
@ Vx Dummy exact width is 0.07 or 0.077 or 0.12, where Vx=V1-V7.
@ xx Dummy must be square, where xx=V1-V7
CMACRO DUMCN_13_16 V7DUM
}

DUMCN_14_V1 {
@ Vx Dummy minimum space to (Vx, Vx dummy)  Vn.2
  EXT V1DUM (V1 OR V1DUM) < 0.07 ABUT < 90 SINGULAR REGION
}

DUMCN_14_V2 {
  EXT V2DUM (V2 OR V2DUM) < 0.07 ABUT < 90 SINGULAR REGION
}

DUMCN_14_V3 {
  EXT V3DUM (V3 OR V3DUM) < 0.07 ABUT < 90 SINGULAR REGION
}

DUMCN_14_V4 {
  EXT V4DUM (V4 OR V4DUM) < 0.07 ABUT < 90 SINGULAR REGION
}

DUMCN_14_V5 {
  EXT V5DUM (V5 OR V5DUM) < 0.07 ABUT < 90 SINGULAR REGION
}

DUMCN_14_V6 {
  EXT V6DUM (V6 OR V6DUM) < 0.07 ABUT < 90 SINGULAR REGION
}

DUMCN_14_V7 {
  EXT V7DUM (V7 OR V7DUM) < 0.07 ABUT < 90 SINGULAR REGION
}

DUMCN_15 {
@ Vn Dummy must not touch (Vn, Mn, Mn+1), where n=1-7
  V1DUM INTERACT (V1 OR (M1 OR M2))
  V2DUM INTERACT (V2 OR (M2 OR M3))
  V3DUM INTERACT (V3 OR (M3 OR M4))
  V4DUM INTERACT (V4 OR (M4 OR M5))
  V5DUM INTERACT (V5 OR (M5 OR M6))
  V6DUM INTERACT (V6 OR (M6 OR M7))
  V7DUM INTERACT (V7 OR (M7 OR M8))
}

DUMCN_17_V1 {
@ Vn Dummy must be within (Mn dummy and Mn+1 Dummy), where n=1-7.  Vn.6a
  M1D_AND_M2D = M1DUM AND M2DUM
  V1DUM NOT M1D_AND_M2D
  ENC V1DUM M1D_AND_M2D < 0.015 ABUT < 90 SINGULAR REGION
}

DUMCN_17_V2 {
  M2D_AND_M3D = M2DUM AND M3DUM
  V2DUM NOT M2D_AND_M3D
  ENC V2DUM M2D_AND_M3D < 0.015 ABUT < 90 SINGULAR REGION
}

DUMCN_17_V3 {
  M3D_AND_M4D = M3DUM AND M4DUM
  V3DUM NOT M3D_AND_M4D
  ENC V3DUM M3D_AND_M4D < 0.015 ABUT < 90 SINGULAR REGION
}

DUMCN_17_V4 {
  M4D_AND_M5D = M4DUM AND M5DUM
  V4DUM NOT M4D_AND_M5D
  ENC V4DUM M4D_AND_M5D < 0.015 ABUT < 90 SINGULAR REGION
}

DUMCN_17_V5 {
  M5D_AND_M6D = M5DUM AND M6DUM
  V5DUM NOT M5D_AND_M6D
  ENC V5DUM M5D_AND_M6D < 0.015 ABUT < 90 SINGULAR REGION
}

DUMCN_17_V6 {
  M6D_AND_M7D = M6DUM AND M7DUM
  V6DUM NOT M6D_AND_M7D
  ENC V6DUM M6D_AND_M7D < 0.015 ABUT < 90 SINGULAR REGION
}

DUMCN_17_V7 {
  M7D_AND_M8D = M7DUM AND M8DUM
  V7DUM NOT M7D_AND_M8D
  ENC V7DUM M7D_AND_M8D < 0.015 ABUT < 90 SINGULAR REGION
}

DUMCN_18 {
@ TMx Dummy minimum width, where TMx=TM1, TM2. TM1.1
  INT TM2DUM < 0.4 ABUT < 90 SINGULAR REGION
  INT MTT2DM < 0.4 ABUT < 90 SINGULAR REGION
}

DUMCN_19 {
@ TMx Dummy minimum space to (TMx and TMx dummy) , where TMx=TM1, TM2. TM1.2
  EXT TM2DUM (TM2 OR TM2DUM) < 0.4 ABUT < 90 SINGULAR REGION
  EXT MTT2DM (MTT2 OR MTT2DM) < 0.4 ABUT < 90 SINGULAR REGION
}

DUMCN_20 {
@ ALPA Dummy minimum width  ALPA.1
  INT ALDUM < 4 ABUT < 90 SINGULAR REGION
}

DUMCN_21 {
@ ALPA Dummy minimum space to (ALPA, ALPA dummy).  ALPA.2
  EXT ALDUM (ALPAi OR ALDUM) < 2 ABUT < 90 SINGULAR REGION
}

DUMCN_22 {
@ ALPA Dummy must not touch ALPA
  ALDUM INTERACT ALPAi
}

DUMCN_23 {
@ xx Dummy must be within BORDER, where xx=all metal and via levels
  M1DUM NOT BORDER
  M2DUM NOT BORDER
  M3DUM NOT BORDER
  M4DUM NOT BORDER
  M5DUM NOT BORDER
  M6DUM NOT BORDER
  M7DUM NOT BORDER
  M8DUM NOT BORDER
  TM2DUM NOT BORDER
  MTT2DM NOT BORDER
  ALDUM NOT BORDER
  V1DUM NOT BORDER
  V2DUM NOT BORDER
  V3DUM NOT BORDER
  V4DUM NOT BORDER
  V5DUM NOT BORDER
  V6DUM NOT BORDER
  V7DUM NOT BORDER
}

#ENDIF
//==================================
//  ULVT: Ultra Low Vt devices Rules
//==================================


ULVT_1{
@ ULVT width (Parallel side to side width) is >=0.33
INT ULVT <0.33 PARA ONLY  REGION  
}
ULVT_2{
@ Space between two ULVTs (with run length>0) is >=0.33
EXT ULVT< 0.33   ABUT<90 REGION OPPOSITE  

}
/*ULVT_3{
@ AA with transistor enclosure by ULVT(include AA area not under poly) is >=0.2
ENC  MOS ULVT <0.2  ABUT<90 REGION
}*/
ULVT_4{	
@ Gate enclosure by ULVT is > =0.14
ENC GATE ULVT< 0.14 ABUT<90 REGION
}
/*ULVT_5{	
@ Space between ULVT and AA with device (include all the devices described in the design truth table 7.1.9) is >=0.2. Prohibit overlap of ULVT and other voltage AA with transistor.
  X_MOS = AA INTERACT GT
  X_RES = AA INTERACT (DIFRES OR RESAA)
  X_DIO1 = AA INTERACT (SIZE (DSTR NOT INTERACT PSUB) BY 0.3)
  X_DIO2 = AA INTERACT (SIZE (DSTR INTERACT PSUB) BY 0.4)
  X_NPN_PNP = AA INTERACT DMPNP
  X_ALL = (((X_MOS OR X_RES) OR (X_DIO1 OR X_DIO2)) OR X_NPN_PNP) NOT INST 
  EXT ULVT X_ALL < 0.2 ABUT<90 SINGULAR REGION
  (X_MOS CUT ULVT) AND ULVT
}*/
ULVT_6{
@ Space between ULVT and gate  is >=0.14
EXT ULVT GATE <0.14 ABUT<90 REGION
}
ULVT_7{
@ ULVT area is >=0.463
AREA ULVT <0.463 
}
ULVT_8{
@ULVT enclosed area  > =0.463
 AREA ((HOLES ULVT INNER) NOT ULVT) < 0.463
}
ULVT_9{
@ Space between ULVT and (DG or TG) >=0.33
EXT ULVT (DG OR TG)<0.33  ABUT<90 REGION
}

//=======================
//  Seal Ring Check
//=======================

GROUP GGRC  GRC_?

CT_SEAL = CTi AND MARKG
V1_SEAL = V1i AND MARKG
V2_SEAL = V2i AND MARKG
V3_SEAL = V3i AND MARKG
V4_SEAL = V4i AND MARKG
V5_SEAL = V5i AND MARKG
V6_SEAL = V6i AND MARKG
V7_SEAL = V7i AND MARKG
TV2_SEAL = TV2i AND MARKG

GRC_1 {
@ Contact slot width is fixed value 0.06um.
@ 45 degree part can have tolerance up to sqrt(2) times this value.
 CT_SEAL_SQ = RECTANGLE CT_SEAL
 CT_SEAL_LN = CT_SEAL NOT CT_SEAL_SQ
 CT_V_edge = ANGLE CT_SEAL_LN == 90
 CT_H_edge = ANGLE CT_SEAL_LN == 0
 CT_D_edge = ANGLE CT_SEAL_LN >44.9 <45.1
 X_V = INT CT_V_edge < 10 ABUT<90 OPPOSITE REGION
 X_H = INT CT_H_edge < 10 ABUT<90 OPPOSITE REGION
 X_D = INT CT_D_edge < 10 ABUT<90 OPPOSITE REGION
 INT CT_SEAL_LN < 0.059 ABUT<90 SINGULAR REGION
 X_V WITH WIDTH > 0.061
 X_H WITH WIDTH > 0.061
 X_D WITH WIDTH > 0.085
}
DMACRO SEAL2 VLAY {
 V_SEAL_SQ = RECTANGLE VLAY
 V_SEAL_LN = VLAY NOT V_SEAL_SQ
 V_V_edge = ANGLE V_SEAL_LN == 90
 V_H_edge = ANGLE V_SEAL_LN == 0
 V_D_edge = ANGLE V_SEAL_LN >44.9 <45.1
 X_V = INT V_V_edge < 10 ABUT<90 OPPOSITE REGION
 X_H = INT V_H_edge < 10 ABUT<90 OPPOSITE REGION
 X_D = INT V_D_edge < 10 ABUT<90 OPPOSITE REGION
 INT V_SEAL_LN < 0.069 ABUT<90 SINGULAR REGION
 X_V WITH WIDTH > 0.071
 X_H WITH WIDTH > 0.071
 X_D WITH WIDTH > 0.099
}
GRC_2_V1 {
@ V1 slot width is fixed value 0.07um.
@ 45 degree part can have tolerance up to sqrt(2) times this value.
 CMACRO SEAL2 V1_SEAL
}
GRC_2_V2 {
@ V2 slot width is fixed value 0.07um.
@ 45 degree part can have tolerance up to sqrt(2) times this value.
 CMACRO SEAL2 V2_SEAL
}
GRC_2_V3 {
@ V3 slot width is fixed value 0.07um.
@ 45 degree part can have tolerance up to sqrt(2) times this value.
 CMACRO SEAL2 V3_SEAL
}
GRC_2_V4 {
@ V4 slot width is fixed value 0.07um.
@ 45 degree part can have tolerance up to sqrt(2) times this value.
 CMACRO SEAL2 V4_SEAL
}
GRC_2_V5 {
@ V5 slot width is fixed value 0.07um.
@ 45 degree part can have tolerance up to sqrt(2) times this value.
 CMACRO SEAL2 V5_SEAL
}
GRC_2_V6 {
@ V6 slot width is fixed value 0.07um.
@ 45 degree part can have tolerance up to sqrt(2) times this value.
 CMACRO SEAL2 V6_SEAL
}
GRC_2_V7 {
@ V7 slot width is fixed value 0.07um.
@ 45 degree part can have tolerance up to sqrt(2) times this value.
 CMACRO SEAL2 V7_SEAL
}
GRC_3_TV2 {
@ TV2 slot width is fixed value 0.36um.
@ 45 degree part can have tolerance up to sqrt(2) times this value.
 TV2_SEAL_SQ = RECTANGLE TV2_SEAL
 TV2_SEAL_LN = TV2_SEAL NOT TV2_SEAL_SQ
 TV2_V_edge = ANGLE TV2_SEAL_LN == 90
 TV2_H_edge = ANGLE TV2_SEAL_LN == 0
 TV2_D_edge = ANGLE TV2_SEAL_LN >44.9 <45.1
 X_V = INT TV2_V_edge < 10 ABUT<90 OPPOSITE REGION
 X_H = INT TV2_H_edge < 10 ABUT<90 OPPOSITE REGION
 X_D = INT TV2_D_edge < 10 ABUT<90 OPPOSITE REGION
 INT TV2_SEAL_LN < 0.359 ABUT<90 SINGULAR REGION
 X_V WITH WIDTH > 0.361
 X_H WITH WIDTH > 0.361
 X_D WITH WIDTH > 0.510
}
GRC_4 {
@ Square contact size in seal ring must be 0.06um * 0.06um.
 X = RECTANGLE CT_SEAL
 NOT RECTANGLE X == 0.06 BY == 0.06
}
GRC_5 {
@ Square V1-V7 size in seal ring must be 0.07um * 0.07um.
 X1 = RECTANGLE V1_SEAL
 X2 = RECTANGLE V2_SEAL
 X3 = RECTANGLE V3_SEAL
 X4 = RECTANGLE V4_SEAL
 X5 = RECTANGLE V5_SEAL
 X6 = RECTANGLE V6_SEAL
 X7 = RECTANGLE V7_SEAL
 NOT RECTANGLE X1 == 0.07 BY == 0.07
 NOT RECTANGLE X2 == 0.07 BY == 0.07
 NOT RECTANGLE X3 == 0.07 BY == 0.07
 NOT RECTANGLE X4 == 0.07 BY == 0.07
 NOT RECTANGLE X5 == 0.07 BY == 0.07
 NOT RECTANGLE X6 == 0.07 BY == 0.07
 NOT RECTANGLE X7 == 0.07 BY == 0.07
}
GRC_6 {
@ Square TV size in seal ring must be 0.36um * 0.36um.
 X2 = RECTANGLE TV2_SEAL
 NOT RECTANGLE X2 == 0.36 BY == 0.36
}



//============================
// SRAM Device Dimension Check 
//============================
GATE_INST = GATE INSIDE (SIZE INST by -1.5)
GATE_INST_PD = (GATE_INST OUTSIDE NW) OUTSIDE SDOP
GATE_INST_PG = (GATE_INST OUTSIDE NW) INSIDE SDOP
GATE_INST_PU =  GATE_INST INSIDE NW

SRDevice.1{
@ All Gates inside INST must be inside DNSRAM (SP299), LRSRAM (SP374), D2SRAM (DP589) or RFSRAM (DP741).
GATE_INST NOT INSIDE (((DNSRAM OR LRSRAM) OR D2SRAM) OR RFSRAM)
}
SRDEV.SP299.PD.W {
@ SP299 PD gate channel width FIX is 0.142 
LENGTH (GT COIN EDGE (GATE_INST_PD INSIDE DNSRAM)) != 0.142   
}
SRDEV.SP299.PD.L{
@ SP299 PD gate channel length is 0.055
LENGTH (AA COIN EDGE (GATE_INST_PD INSIDE DNSRAM)) != 0.055
}
SRDEV.SP299.PG.W {
@ SP299 PG gate channel width is 0.11
LENGTH (GT COIN EDGE (GATE_INST_PG INSIDE DNSRAM)) != 0.11
}
SRDEV.SP299.PG.L {
@ SP299 PG gate channel length is 0.059
LENGTH (AA COIN EDGE (GATE_INST_PG INSIDE DNSRAM)) != 0.059
}
SRDEV.SP299.PU.W {
@ SP299 PU gate channel width is 0.06
LENGTH (GT COIN EDGE (GATE_INST_PU INSIDE DNSRAM)) != 0.06
}
SRDEV.SP299.PU.L {
@  SP299 PU gate channel length	0.055
LENGTH (AA COIN EDGE (GATE_INST_PU INSIDE DNSRAM)) !=0.055
}
SRDEV.SP374.PD.W {
@ SP374 PD gate channel width is 0.233
 LENGTH (GT COIN EDGE (GATE_INST_PD INSIDE LRSRAM)) != 0.233
}
SRDEV.SP374.PD.L {
@ SP374 PD gate channel length fix is 0.055
LENGTH (AA COIN EDGE (GATE_INST_PD INSIDE LRSRAM)) != 0.055
}

SRDEV.SP374.PG.W {
@ SP374 PG gate channel width fix is 0.183
LENGTH (GT COIN EDGE (GATE_INST_PG INSIDE LRSRAM)) != 0.183
}
SRDEV.SP374.PG.L{
@ SP374 PG gate channel length fix is 0.063
LENGTH (AA COIN EDGE (GATE_INST_PG INSIDE LRSRAM)) != 0.063
}

SRDEV.SP374.PU.W {
@ SP374 PU gate channel width fix is 0.07
LENGTH (GT COIN EDGE (GATE_INST_PU INSIDE LRSRAM)) !=0.07
}
SRDEV.SP374.PU.L{
@ SP374 PU gate channel length fix is 0.055
LENGTH (AA COIN EDGE (GATE_INST_PU INSIDE LRSRAM)) != 0.055
}

SRDEV.DP589.PD.W {
@ DP589 PD gate channel width fix is 0.305
LENGTH (GT COIN EDGE (GATE_INST_PD INSIDE D2SRAM)) !=0.305
}
SRDEV.DP589.PD.L { 
@ DP589 PD gate channel length fix is 0.055
LENGTH (AA COIN EDGE (GATE_INST_PD INSIDE D2SRAM)) !=0.055
}
SRDEV.DP589.PG.W {
@ DP589 PG gate channel width fix is 0.154
LENGTH (GT COIN EDGE (GATE_INST_PG INSIDE D2SRAM)) !=0.154
}
SRDEV.DP589.PG.L {
@ DP589 PG gate channel length fix is 0.067
LENGTH (AA COIN EDGE (GATE_INST_PG INSIDE D2SRAM)) !=0.067
}
SRDEV.DP589.PU.W {
@ DP589 PU gate channel width fix is 0.06
LENGTH (GT COIN EDGE (GATE_INST_PU INSIDE D2SRAM)) !=0.06
}
SRDEV.DP589.PU.L{
@ DP589 PU gate channel length fix is 0.055
LENGTH (AA COIN EDGE (GATE_INST_PU INSIDE D2SRAM)) !=0.055
}

SRDEV.DP741.PD.W{
@ DP741 PD gate channel width fix is 0.438
LENGTH (GT COIN EDGE (GATE_INST_PD INSIDE RFSRAM)) !=0.438
}
SRDEV.DP741.PD.L{
@ DP741 PD gate channel length fix is 0.055
LENGTH (AA COIN EDGE (GATE_INST_PD INSIDE RFSRAM)) !=0.055
}
SRDEV.DP741.PG.W{
@ DP741 PG gate channel width fix is 0.168
LENGTH (GT COIN EDGE (GATE_INST_PG INSIDE RFSRAM)) !=0.168
}
SRDEV.DP741.PG.L {
@ DP741 PG gate channel length fix is 0.063
LENGTH (AA COIN EDGE (GATE_INST_PG INSIDE RFSRAM)) !=0.063
}
SRDEV.DP741.PU.W {
@ DP741 PU gate channel width fix is 0.08
LENGTH (GT COIN EDGE (GATE_INST_PU INSIDE RFSRAM)) !=0.08
}
SRDEV.DP741.PU.L {
@ DP741 PU gate channel length fix is 0.055
LENGTH (AA COIN EDGE (GATE_INST_PU INSIDE RFSRAM)) !=0.055
}

//============================
//  SRAM Marker Layer Check
//============================
GROUP GSRMarker SRMarker_?


SRMarker_4{
@ Marker layer DNSRAM, LRSRAM, D2SRAM, RFSRAM must be within SRAM marker INST.
(((DNSRAM OR LRSRAM) OR D2SRAM) OR RFSRAM) NOT INST 
}
SRMarker_5 {
@ For high performance SRAM bit cell(LRSRAM (SP374),  RFSRAM (DP741)), there must be high performance marker layer HPBL overlapped.
(LRSRAM OR RFSRAM) OUTSIDE  HPBL
}
SRMarker_6 {
@ No hole or slot is permitted in one SRAM marker layer(DNSRAM, LRSRAM, D2SRAM, RFSRAM, INST).
 HOLES INST
 HOLES DNSRAM
 HOLES LRSRAM
 HOLES D2SRAM
 HOLES RFSRAM
}
SRMarker_8 {
@ DNSRAM, LRSRAM, D2SRAM, RFSRAM should not overlap with each other(touch is permitted)
(((( (DNSRAM INTERACT LRSRAM) OR (DNSRAM INTERACT D2SRAM)) OR (DNSRAM INTERACT RFSRAM))OR (LRSRAM  INTERACT D2SRAM)) OR (LRSRAM  INTERACT RFSRAM))OR ( D2SRAM INTERACT RFSRAM)
}
SRMarker_9 {
@ No Overlap of (DNSRAM(SP299) or D2SRAM(DP589)) with HPBL is permitted.
(DNSRAM OR D2SRAM) AND  HPBL
}
#IFDEF GUIDELINE YES

//==============================
// BUMP UBM pad design guideline 
//==============================

GROUP GBUMP BUMP_?

BUMP_1_G{
@ BUMP Pitch (center to center space) >=166.67	
X = EXTENTS BUMP CENTERS 0.01
EXT X<166.66  REGION
}
	
BUMP_2_G{
@ MD width(parallel edge to edge) inside BUMP  >=61.11
INT (MD INSIDE BUMP) <61.11  PARA ONLY  REGION 
}
BUMP_3_G {
@ BUMP width (parallel edge to edge) is >=88.89
INT BUMP < 88.89 ABUT<90 SINGULAR REGION OPPOSITE  SYMMETRIC
X = CONVEX EDGE BUMP < 2
INT X < 88.89 REGION
}
BUMP_4_G {
@ MD enclosed by BUMP >=15.56
ENC MD BUMP< 15.56 ABUT<90 REGION
}
BUMP_5_G{
@ BUMP enclosure by ALPA >=6.67
ENC BUMP ALPA_ALL < 6.67 ABUT<90 REGION OUTSIDE ALSO
}
BUMP_7_G{
@ BUMP space is >=77.78
 EXT BUMP <77.78 ABUT<90 REGION 
}

//=====================================
//DUP (Device Under Pad) Pad Guidelines
//=====================================?

GROUP GDUP DUP_?
DUP_area = DUPMK1 AND MD
DUP_1_G {
@ DUPMK1 must enclose PA for DUP pad area.
@ notice: coding not match 3R DR.
 (MD INTERACT DUPMK1) NOT DUPMK1
}
#IFDEF TOPMETAL 4

DUP_2_G{
@ Two metal layers (TM and TM-1) are needed in DUP pad area, these two metal layers design must be solid.
DUP_area ENCLOSE (DUP_area NOT M3)
}
DUP_3a_G{
@ ALPAR, MOMDMY, INDMY, TM2R, TM-1R(TM-1 resistor mark layer) must be outside of DUP pad area.
((((ALPAR OR MOMDMY) OR INDMY) OR TM2R) OR M3R ) AND DUP_area

}
DUP_4_G{
@ TV-1 pattern must be outside of DUP pad area
V2 AND DUP_area
}

#ENDIF

#IFDEF TOPMETAL 5

DUP_2_G{
@ Two metal layers (TM and TM-1) are needed in DUP pad area, these two metal layers design must be solid.
DUP_area ENCLOSE (DUP_area NOT M4)
}
DUP_3a_G{
@ ALPAR, MOMDMY, INDMY, TM2R, TM-1R(TM-1 resistor mark layer) must be outside of DUP pad area.
((((ALPAR OR MOMDMY) OR INDMY) OR TM2R) OR M4R ) AND DUP_area

}
DUP_4_G{
@ TV-1 pattern must be outside of DUP pad area
V3 AND DUP_area
}

#ENDIF
#IFDEF TOPMETAL 6
DUP_2_G{
@ Two metal layers (TM and TM-1) are needed in DUP pad area, these two metal layers design must be solid.
DUP_area ENCLOSE (DUP_area NOT M5)
}
DUP_3a_G{
@ ALPAR, MOMDMY, INDMY, TM2R, TM-1R(TM-1 resistor mark layer) must be outside of DUP pad area.
((((ALPAR OR MOMDMY) OR INDMY) OR TM2R) OR M5R ) AND DUP_area

}
DUP_4_G{
@ TV-1 pattern must be outside of DUP pad area
V4 AND DUP_area
}

#ENDIF
#IFDEF TOPMETAL 7
DUP_2_G{
@ Two metal layers (TM and TM-1) are needed in DUP pad area, these two metal layers design must be solid.
DUP_area ENCLOSE (DUP_area NOT M6)
}
DUP_3a_G{
@ ALPAR, MOMDMY, INDMY, TM2R, TM-1R(TM-1 resistor mark layer) must be outside of DUP pad area.
((((ALPAR OR MOMDMY) OR INDMY) OR TM2R) OR M6R ) AND DUP_area

}
DUP_4_G{
@ TV-1 pattern must be outside of DUP pad area
V5 AND DUP_area
}


#ENDIF
#IFDEF TOPMETAL 8
DUP_2_G{
@ Two metal layers (TM and TM-1) are needed in DUP pad area, these two metal layers design must be solid.
DUP_area ENCLOSE (DUP_area NOT M7)
}
DUP_3a_G{
@ ALPAR, MOMDMY, INDMY, TM2R, TM-1R(TM-1 resistor mark layer) must be outside of DUP pad area.
((((ALPAR OR MOMDMY) OR INDMY) OR TM2R) OR M7R ) AND DUP_area

}
DUP_4_G{
@ TV-1 pattern must be outside of DUP pad area
V6 AND DUP_area
}


#ENDIF
#IFDEF TOPMETAL 9
DUP_2_G{
@ Two metal layers (TM and TM-1) are needed in DUP pad area, these two metal layers design must be solid.
DUP_area ENCLOSE (DUP_area NOT M8)
}
DUP_3a_G{
@ ALPAR, MOMDMY, INDMY, TM2R, TM-1R(TM-1 resistor mark layer) must be outside of DUP pad area.
((((ALPAR OR MOMDMY) OR INDMY) OR TM2R) OR M8R ) AND DUP_area

}
DUP_4_G{
@ TV-1 pattern must be outside of DUP pad area
V7 AND DUP_area
}

#ENDIF
#IFDEF UTM NO

DUP_2_1_G{
@ Two metal layers (TM and TM-1) are needed in DUP pad area, these two metal layers design must be solid.
DUP_area ENCLOSE (DUP_area NOT TM2 )
  
}
#ENDIF
#IFDEF UTM YES
DUP_2_1_G{
@ Two metal layers (TM and TM-1) are needed in DUP pad area, these two metal layers design must be solid.
DUP_area ENCLOSE (DUP_area NOT  MTT2) 
}
#ENDIF

DUP_5_G{
@ DUP pad area must have TV array between TM and TM-1.
@ Two Via areas whose space is within 0.56m are considered to be in the same array.
@ TV space within array in DUP pad opening area should follow TV2.3.
TV2array = SIZE (SIZE (TV2 INSIDE DUP_area)  BY 0.28 OVERUNDER) BY 0.85 UNDEROVER 
DUP_area NOT ENCLOSE TV2array
}
#ENDIF


//============================
//  Conventional Check
//============================

GROUP GConvention Convention_?

Convention_FLT_NW {
@ NW without N+ pick up
  NW NOT INTERACT NTAPi
}
Convention_BPMO {
@ Pmos in PW
  PW AND (PGATE NOT VARMOS)
}
Convention_BAD_IMP {
@ AA area without any implant
  X = AAi NOT INTERACT RESNW
  ((X NOT SNi) NOT SPi) NOT MARKG
}

#ENDCRYPT
