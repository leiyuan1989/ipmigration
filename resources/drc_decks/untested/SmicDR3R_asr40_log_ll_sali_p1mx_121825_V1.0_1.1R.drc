;avParameters( ?resolution 0.001 )



; SMIC40nm PDK
; ASSURA(r) version 4.1.2 or above
; generated by GTE Version: 03.04.002  Build: @1470 (20100415103723) on Jul 27, 2011

; ********************************************************************************
;   Assura DRC Rules
;   SMIC 40nm Logic 1P10M Salicide 0.9/1.1/1.2/1.8/2.5V
;   Low Leakage and Generic Design Rule
;   
; ********************************************************************************
;   Reference Documents :
;   - TD-LO40-DR-2001 SMIC 40nm Logic 1P10M Salicide 0.9/1.1/1.2/1.8/2.5V
;      Low Leakage and Generic Design Rule ( Rev 3R Tech Dev Rev: 1.0)
;   - 40nm Logic Design Rule check special notes
;      Doc. No:  TD-LO40-DR-2014       Rev:0R   Tech Dev. Rev.:1.0
;   - TD-LO40-DR-2002 SMIC 40nm Logic 1P10M Salicide 0.9/1.1/1.2/1.8/2.5V
;      Low Leakage and Generic DFM (Design For Manufacturability) Rules
;     ( Rev 2T, 2010-09-17 )
;   - 40nm Logic ESD and Latch-up Guideline ( Rev 0T, 2010-07-16 )
;   - 40nm Logic Antenna Ratio Effect Generic Prevention Design Guide Rule
;     ( Rev 0T, 2010-07-16 )
; ********************************************************************************
;   DISCLAIMER
; ********************************************************************************
;   The information contained herein is provided by Cadence Design Systems on an
;   "AS IS" basis without any warranty, and Cadence Design Systems has no
;   obligation to support or otherwise maintain the information.  Cadence Design
;   Systems disclaims any representation that the information does not infringe
;   any intellectual property rights or proprietary rights of any third parties.
;   There are no other warranties given by Cadence Design Systems, whether
;   express, implied or statutory, including, without limitation, implied
;   warranties of merchantability and fitness for a particular purpose.
;   Cadence Design Systems shall not be liable for the accuracy of
;   this design rule file or its ability to capture errors.
;   The user is responsible for thoroughly testing and implementing
;   its features.
; ********************************************************************************
;#################################################
;#     Environmental Variables Setting           #
;#################################################

; 1> "Recommended_rules_check": The rules with the superscript of [R] in DR are recommended rules which require performing DRC runset;
;    but DRC checking is not gated for recommended rules. Pls consult with process integration engineer if customers have the doubt;
;    DRC default value is to check recommended rules;                            
;    If you open the switch "Recommended_rules_check", the recommended rules shouldn't be checked;
; 2> "Guideline_rules_check". It's stongly recommended to follow layout guidelines for design. And the guidelines require performing DRC runset;
;    but DRC checking is not gated for them.Pls consult with integration engineers if customer has the problem;
;    SMIC spice model and PDK is based on SMIC design rule guidelines;
;    Switch "Guidelines_rules_CHECK" Please set the value for the switch to check or not to check only based on the descriptions above;
;    Default value is to check Guidelines rules;
;    If you open the switch "Guideline_rules_check", the guideline rules shouldn't be checked;
; 3> "DFM rule selection;
;    DFM rule contain three priority level rules:
;    User should follow Priority 1 rules, please open the switch "DFM_priority_1";
;    User can select the switch "DFM_priority_2" and "DFM_priority_3" to decide whether will check these rules;
; 4> Dummy pattern check rule selection. Defaults to check SMIC rule DUMC ;
;    If you want to check non-SMIC rule DUMCN, please open the switch "CUSTOMER_DUMMY_CHECKS";
; 5> "BUMPING_NO", Dumping process ALPA.11 rule check selection. Defaults to check this rule;
;    If you open the switch "BUMPING_NO", the rules shouldn't be checked;
; 6> "CHK_CORN_RULES", CORN rule selection;
;    DRC default value is to check chip corn rule without SEAL RING; 
;    If customer need to check chip corn rule with SEAL RING, please open the switch "CHK_CORN_RULES";
; 7> "CHK_BORDER_RULES", BORDER rule selection;
;    DRC default value is to check chip level; 
;    If customer need to check IP level rule, please open the switch "CHK_BORDER_RULES";
; 8> If top metal is layer TM2 (layer 122, top metal with regular thickness),then please open the swith "UTM_NO" ;
;    If top metal is layer MTT2 (layer 231, top metal with ultra thickness), then please open the swith "UTM_YES";
; 9> If you want to check density rules, please open the switch "DENSITY_CHECKS";

;Read me first:
;1>The square number in rule DIFRES.3,PLRES.3 can't be implemented because of tool limitation;
;2>GT.9 not check the following: The (GT or GTDUM) parallel to gate for (GT.9) covers channel width >= 67% because of tool limitation; 

; Revision History :
; V1.0_1.1R   Oct-26-2012
; Add BORDER rule switch.
; Redefine Layers definition,Redefine DUP pad area.
; Update NW.12, TG.5, DG.5,GT.6a,SP.7b,CT.3/3a,CT.6abd/6acd/7ab/19,M1.3,V1.6abc/6acd,V1.8,
; Mn.12,Vn.6abc/6acd/7abc.DFM.5/19, DUP.1/5.
; Enhance M1.7e,V1.17,Vn.17,RESAA.14 RESP1.15, SP.20a/21a DFM.13.CT.6,GT.4,MTT2.5
; V1.0_1R     Sep-26-2012    
; Define AA/PLOY/HRP resistor area 
; Update RESNWST rule, AA.11/14/14a/18/19,RESAA.3/5/6/9a/10,AAC.5,
; RESNWAA_2_3/8,TG.11,BORDER4,GT.1b/2b/3c/6/20c/20d/22,RESP1.5/6/9/10,	. 
; SP.9/10/12/14/15/20a/21a,SN.3a/3b/9/10/14,SAB.15,M1.13,M1.14,V1.16/17
; Vn.16/Vn.17,Mn.9,ALPA.2/5,HRP.9,MTT2.2/5,DFM.3,DUMC.18/22/27/35,NW.13                                   
; Add DUP rule, RESAA.14,DNW.7,PSUB.3e,GT.1h,RESP1.15,ESD.9/9a,BUMP.1 
; Update NW.11,NW.12 

;Pre1.0_20120824
;Update V1.16,Vn.16,V1.17,Vn.17,TM1.7,TM2.7 coding,according to DR team request who will update design rule next DR version.   
;Update rule description in runset,according to design rule in TECN(TECN NO.:TD1208070001)
;Update Mn.11,GT.6a,M1.6,Mn.6,MTT2.7b
;define ULVT BUMP OCOVL GT end 
;add AA.4d/16/17/18/19, NW.9/11/12/13/14/15/16, BORDER.4, GT.3c/6a/8a/27/28,7a/7d/7e 
;SP.7c/8c,AA.C.5,MTT2.7b,DUMC.21a,DFM.29,EFU rule coding,ULVT rule coding,BUMP rule coding    
;add layer DNSRAM,LRSRAM,D2SRAM,RFSRAM,HPBL,BUMP,DMPNP,ULVT,OCOVL;SRAM Device rules,SRAM Marker layer rules,ulvt rules,AA.4d,SN.8c,SP.8c,add m1aa~m8all description,EFU rules
;add AA.15,AA.16,AA.17,AA.18,RESNWAA rules,SRDOP.105¿?GT_2b_test1,GT_2b_test2,GT.3c,GT.6a,GT.27,GT.28
;add NW.11,NW.12,NW.13,NW.14,NW.15,NW.16,SRSP.3a,SRSP.3b
;Update SRAA.4a,SRAA.4c¿?RESNWST.4,PW definition
;Delete AA.5/6/7/8,SRGT.103,SRGT.19,V1.5b/6d/7d,Vn.5b/6d/7d,TM1.6,TM2.6,DFM.11
;Update AA.9a/14a/14,NW.1,rename RESNWAA7/10/11/12/13/14 to RESNWAA.9/10/11/12/13
;PSUB.2/3a/3b/3cd,TG.11,GT.5/6/8/20c/20d/21/25a/26/22,RESP1.7,PLRES.5,SP.1/6/7a/10,
;SRSP.3a,SN.1/6/7a/10,SAB.3/7/8,CT.1a/2a,11/12,SRCT.2a,SRM1.7ab,M1.6a/6b/6c/8/8a/13,
;V1.3/5/5a/17,SRM2.3,M2.3,Mn.6a/6b/6c/7/7a/7d/7e/10a/10b,Vn.3/5/5a/16/17,TM2.7,
;HRP.12,DFM.1/2/20/21/24/25,DUMC.20/21/30,SRNW.1,DIFRES.7,RESNWST.4,GT.8,PLRES.7
;V1.16,Vn.16,DUMC.21,DFM.10
;According to design rule DOC:TD-LO40-DR-2001 3R draft 2012-07-11v1 
;Add RESNWAA rule coding, SRAM Device Dimension Check Rule coding,SRMarker rules coding ,DRDOP.105 coding      
;Update SRAA.4a,SRAA.4c,SRNW.1,SRGT.3/7/10,SRDOP.102/103,SRSN.3a/3b/10,SRSP.3a/3b/10,SRRCT.104c,/106/107/107a/108
;SRM1.7ab,SRV1.6ac,SRM2.4,M1.8b,Mn.7b,Mn.11,DFM.3/5/9,MD.11
;Delete SRAA.4,SRNW.3,SRGT.5/7/9,SRSN.1/2/6/7,SRSP.1/2/6/7,SRCT.105/3/6a,SRRCT.104,SRV1.7,SRM1.3,switchProc35() deleted
;Read me first:
;1>The square number in rule DIFRES.3,PLRES.3 can't be implemented because of tool limitation;
;2>GT.9 not check the following: The (GT or GTDUM) parallel to gate for (GT.9) covers channel width >= 67% because of tool limitation;  

;07/06/2012 PreV1.0_0R
;Add LDMOS rules,V1.16,V1.17,Vn.16,Vn.17
;Inhance DFM.5
;07/02/2012 PreV1.0_0R
;Add layer:EFUSE, BIPOLA, DSTR, MnR, MARKS,
;Modified:DFM.1,DFM.2, M6.5, M6.8, M6.9,V5.5,M7.5,M7.8,M7.9,V6.5,M8.5,M8.8,M8.9,V7.5,TM1.8,TM1.5,GT.20,GT.20b,
;M1.8,M2.7 Mn.7,ALPA.9,ALPA.10, RESAA.2, TG.3,TG.4,DG.3,DG.4,TG.5,DG.5,GT.1e,GT.7,GT.5,GT.6,Gt.9,GT.10,LVT.6,HVT.6,
;LVT.9,HVT.9,LVT.10,HVT.10,SN.7b,CT.1,CT.2a,Mn.5,Mn.8,M1.9,M1.10,Mn.8,Mn.9,ALPA.1,PA.3,PA.4,
;Added:DFM.1a, DFM.2a, M6.11, V5.5a,5b,M7.11,V6.5a,5b,V7.7a,V7.7b,GT.20c,GT.20d,MTT2 rules,DIFRES rules, RESNWST rules, PLRES rules,CT.1a,
;Mn.11,HRP rules, MTT2 rules, CORN.2,switch "UTM_YES","UTM_NO" for thick top metal
;Deleted:GT.16,DUMC.9,DNW.5,PSUB.note4,GT.13,DUMC.9
;add define BORDER and CORN switch,TV2.13,Mn.10a,Mn.10b,Mn.7b,EXCLU check rule,LDMOS rules,;optimize gate definition,aa_res definition,layer connection,
;optimize following rules:
;AA.1,SRAA.1a,SRAA.4a,SRAA.4b4c,AA.4b4c,AA.5,SRAA.5,AA.6,SRAA.6,AA.7,AA.8,AA.9,AA.13,NW.1,SRNW.1,NW.2,TG.8,DG.8,RESAA.9a,RESAA.9b,GT.1a,GT.4,SRGT.4,
;SRGT.5,SRGT.6,SRGT.9,GT.19,GT.21,PLRES.5,PLRES.6,PLRES.8,SAB.6,SAB.7,SAB.11,SAB.15,SN/SP.1,SN.2,SP.2,SRSN.2,SRSP.2,SRSN.1,SRSN.1,SN.3a,SN.3b
;SP.3a,SP.3b,SRSN.3,SRSP.3,SN.4,SP.4,SN.6,SP.6,CT.3a,CT.4,CT.5,,Mn.6,Mn.6a,Mn.6c,M1.10
;TM1.6,TM2.5,TM2.6,Vn.6,Vn.5a,Vn.5b,Mn.3,ESD1.4,ESD1.5,ESD1.6,PA.3,DUMC.29
;modify AA.10,RESAA.4,DNW.4,RESNWST.1.5,RESNWST.2,RESNWST.6,RESNWST.8,PSUB.2,PSUB.3a,PSUB.3b,PSUB.3c3d,PSUB.5,PSUB.13,DG.5(0.176->0.2)
;DIFRES.5,DIFRES.6,DIFRES.8,DIFRES.9,DIFRES.10,GT.2b,GT.3,SRGT.3,SRGT.7,GT.8,SRGT.8,SRGT.10,GT.22,M1.8b,MTT.5,V1.6d,TV1.13,TM2.8,TM1.9,TM2.9
;CT.6,DFM.2,DFM.5,HRP.2,HRP.3.4,HRP.5,HRP.7,HRP.8,HRP.12,MD.11
;The square number in rule DIFRES.3,PLRES.3 can't be implemented because of tool limitation;
;GT.9 not check the following: The (GT or GTDUM) parallel to gate for (GT.9) covers channel width >= 67% because of tool limitation;  
;M1.13 maybe has false errors because of tool limitation;.


;11/28/2011 Rev 1.09
;Modified MD.11 (12/01)
;Modified CT.6,CT.7,Vn.6,Vn.7,SP.6,SN.6,SP.7a,SN.7a,SN.22,seal ring rules of GR.1,GR.2,GR.3 
;Based on DR update:modified M1.7a,added DFM.28. 
;10/25/2011 Rev 1.08
;Added two procedure to check DFM.4,Vn.6d,Vn.7d
;Modified GT.26,TVn.4,TVn.5,TVn1.6,Mn.6,DUMC.20,DUMC.21,BORDER.1,GT.22,Vn.6,RESP1.3,RESP1.4,RESP1.7,
;LVT.4a,LVT.5a,HVT.4a,HVT.5a,SP.4,SN.4,SP.15,SN.15,SN.20,SP.20,CT.3,M1.7,TM2.5,TM2.6,ALPA.7,MD.5,MD.6,
;DUMC.16,DUMC.31,DUMCN.17,DUMCN.23,DUMCN.18,CORN.1,ESD.4,ESD.8,
;Added seperate rule Vn.6d,Vn.7d to check
;Added RESNW.note1,note2,RESP1.5
;Add layer EXCLU
;Modified RESAA.9, GT.8, ALPA.11(modified and add switch), DUMCN.17 
; 07/22/2011 Rev 1.07(mohamede)
; -Added PSUB.3d, SN.21, SN.20a, MD.11, DUMC.15s, DUMC.16a, DUMC.27, DUMC.28,
;   DUMC.29, DUMC.36, DUMC.37
; -Added 7.4.40 corner rules
; -Deleted TV1.8, TV1.9, TV1.10, TV1.11, TV1.12, TV2.8,TV2.9, TV2.10, TV2.11, TV2.12, PA.5, PA.6, PA.7, PA.8
; -Added BORDER sect- updated message and added missing layers
; 04/07/2011 Rev 1.06(mohamede)
; -Added DFM.27 rules
; 03/31/2011 Rev 1,05(mohamede)
; -Updated rules according to the DRM: TD-LO40-DR-2002v1T_R20100920.pdf pages 140-141
; 03/11/2011 Rev 1.04(mohamede)
;  -Updated DFM_CHECKS switches priorities according to the DRM: TD-LO40-DR-2002v1T_R20100920.pdf pages 6-9
; 01/20/2011 Rev 1.03(mohamede)
;  -Updated rules according to the DRM: TD-L040-DR-2001v12010-12-29v3.pdf
;     with latest update on 2010-12-11
; 12/09/2010 Rev 1.02(jrussell)
;  -Updated Vn.6, Vn.7, GT.5, GT.6, GT.13, DFM.3, DFM.11, DFM.12
;  -Removed duplicate layer warnings
; 12/01/2010 Rev 1.01(jrussell)
;  -Updated Vn.6d, Vn.7d, Vn.8, Vn.9, Vn.10
; 11/15/2010 Rev 1.00(jrussell) 
;   -Initial Release

drcExtractRules(

layerDefs("gds2"

   INST=layer( 60 type(0) )

    AAi=layer( 10 type(0) )

    AADUM=layer( 10 type(1) )

    ALDUB=layer( 83 type(6) )

    ALDUM=layer( 83 type(11) )

    ALPA=layer( 83 type(0) )

 
    BORDER=layer( 127 type(0) )

    CTi=layer( 50 type(0) )
    
    CTBAR=layer(50 type(1) )

    DGi=layer( 29 type(0) )

    DNWi=layer( 19 type(0) )

    DUMBA=layer( 91 type(0) )

    DUMBM=layer( 90 type(0) )

    DUMBP=layer( 92 type(0) )

    ESD1i=layer( 41 type(0) )

    ESD2=layer( 42 type(0) )

    ESD3=layer( 169 type(0) )

    FUSE=layer( 81 type(0) )
 
    EFUSE=layer(81 type(2) )

    GTi=layer( 30 type(0) )

    GTDUM=layer( 30 type(1) )

    GTFUSE=layer( 81 type(1) )

    HRPi=layer( 39 type(0) )

    HRPDMY=layer( 210 type(0) )

    HVT=layer( 159 type(11) )

    BIPOLA=layer( 159 type(1) )
   
    PTCT=layer( 159 type(7) )

    INDMY=layer( 212 type(0) )
  
    DSTR=layer(138 type(0) )

    LOGO=layer( 26 type(0) )

    LVNi=layer( 219 type(0) )

    LVPi=layer( 218 type(0) )

    LVT=layer( 159 type(12) )

    PLDMK=layer( 131 type(4) )

    M1i=layer( 61 type(0) )
    M1_text=textToPin( 61 type(254) )


    M1R=layer( 171 type(0) )
    M2R=layer( 172 type(0) )
    M3R=layer( 173 type(0) )
    M4R=layer( 174 type(0) )
    M5R=layer( 175 type(0) )
    M6R=layer( 176 type(0) )
    M7R=layer( 177 type(0) )
    M8R=layer( 178 type(0) )
    TM1R=layer( 201 type(0) )
    TM2R=layer( 202 type(0) )

    M2i=layer( 62 type(0) )
    M2_text=textToPin( 62 type(254) )

    M3i=layer( 63 type(0) )
    M3_text=textToPin( 63 type(254) )

    M4i=layer( 64 type(0) )
    M4_text=textToPin( 64 type(254) )

    M5i=layer( 65 type(0) )
    M5_text=textToPin( 65 type(254) )

    M6i=layer( 66 type(0) )
    M6_text=textToPin( 66 type(254) )

    M7i=layer( 67 type(0) )
    M7_text=textToPin( 67 type(254) )

    M8i=layer( 68 type(0) )
    M8_text=textToPin( 68 type(254) )

    ;MARKGi=layer( 189 type(0) )
 
    MARKS=layer( 189 type(151) )

    MD=layer( 130 type(0) )

    MIM=layer( 58 type(0) )

    MOMDMY=layer( 211 type(1) )

    MnDUB_metal1=layer( 151 type(1) )

    MnDUB_metal2=layer( 152 type(1) )

    MnDUB_metal3=layer( 153 type(1) )

    MnDUB_metal4=layer( 154 type(1) )

    MnDUB_metal5=layer( 155 type(1) )

    MnDUB_metal6=layer( 156 type(1) )

    MnDUB_metal7=layer( 157 type(1) )

    MnDUB_metal8=layer( 158 type(1) )

    MnDUB_topmetal1=layer( 193 type(1) )

    MnDUB_topmetal2=layer( 194 type(1) )

    MnDUM_metal1a=layer( 61 type(1) )

    MnDUM_metal2a=layer( 62 type(1) )

    MnDUM_metal3a=layer( 63 type(1) )

    MnDUM_metal4a=layer( 64 type(1) )

    MnDUM_metal5a=layer( 65 type(1) )

    MnDUM_metal6a=layer( 66 type(1) )

    MnDUM_metal7a=layer( 67 type(1) )

    MnDUM_metal8a=layer( 68 type(1) )

    MnDUM_topmetal1=layer( 120 type(1) )

    MnDUM_topmetal2=layer( 122 type(1) )

    NCAP=layer( 93 type(1) )
    CAPBP=layer( 137 type(0) )

    NLHi=layer( 36 type(0) )

    NLHTi=layer( 114 type(0) )

    NLLi=layer( 35 type(0) )

    NWi=layer( 14 type(0) )

    OVERDR=layer( 125 type(3) )

    PA=layer( 80 type(0) )

    PABAR=layer( 80 type(2) )

    PLHi=layer( 37 type(0) )

    PLHTi=layer( 115 type(0) )

    PLLi=layer( 38 type(0) )

    PSUBi=layer( 85 type(0) )

    RESAA=layer( 97 type(0) )
  
    DIFRES=layer( 97 type(3) )

    RESNW=layer( 95 type(0) )

    RESP1=layer( 96 type(0) )
 
    PLRES=layer( 96 type(3) )

    SABi=layer( 48 type(0) )

    SNi=layer( 40 type(0) )

    SPi=layer( 43 type(0) )

    TGi=layer( 125 type(0) )

    TGV=layer( 125 type(1) )

    TM1i=layer( 120 type(0) )
    TM1_text=textToPin( 120 type(254) )

    TM2i=layer( 122 type(0) )
    TM2_text=textToPin( 122 type(254) )

    TV1i=layer( 121 type(0) )

    TV2i=layer( 123 type(0) )

    V1i=layer( 70 type(0) )

    V2i=layer( 71 type(0) )

    V3i=layer( 72 type(0) )

    V4i=layer( 73 type(0) )

    V5i=layer( 74 type(0) )

    V6i=layer( 75 type(0) )

    V7i=layer( 76 type(0) )

    VTNHi=layer( 47 type(0) )

    VTPHi=layer( 46 type(0) )

    VnBAR_topvia1=layer( 121 type(2) )

    VnBAR_topvia2=layer( 123 type(2) )

    VnBAR_via1=layer( 70 type(2) )

    VnBAR_via2=layer( 71 type(2) )

    VnBAR_via3=layer( 72 type(2) )

    VnBAR_via4=layer( 73 type(2) )

    VnBAR_via5=layer( 74 type(2) )

    VnBAR_via6=layer( 75 type(2) )

    VnBAR_via7=layer( 76 type(2) )

    VnDUM_via1a=layer( 70 type(1) )

    VnDUM_via2a=layer( 71 type(1) )

    VnDUM_via3a=layer( 72 type(1) )

    VnDUM_via4a=layer( 73 type(1) )

    VnDUM_via5a=layer( 74 type(1) )

    VnDUM_via6a=layer( 75 type(1) )

    VnDUM_via7a=layer( 76 type(1) )

    LDBK=layer( 216 type(150) )

    M1DOP=layer( 61 type(7) )

    M2DOP=layer( 62 type(7) )

    M3DOP=layer( 63 type(7) )

    M4DOP=layer( 64 type(7) )

    M5DOP=layer( 65 type(7) )

    M6DOP=layer( 66 type(7) )
  
    M7DOP=layer( 67 type(7) )
 
    M8DOP=layer( 68 type(7) )

    V1DOP=layer( 70 type(7) )
 
    V2DOP=layer( 71 type(7) )

    V3DOP=layer( 72 type(7) )

    V4DOP=layer( 73 type(7) )

    V5DOP=layer( 74 type(7) )

    V6DOP=layer( 75 type(7) )

    V7DOP=layer( 76 type(7) )

    V1DUB=layer( 70 type(6) )
 
    V2DUB=layer( 71 type(6) )

    V3DUB=layer( 72 type(6) )

    V4DUB=layer( 73 type(6) )

    V5DUB=layer( 74 type(6) )

    V6DUB=layer( 75 type(6) )

    V7DUB=layer( 76 type(6) )
 
    MTT2DMi=layer(231 type(1) )

    MTT2DB=layer(194 type(2) )
 
    MTT2i=layer(231 type(0) )

    ESDIO2=layer(133 type(3) )

    EXCLU=layer(132 type(0) )

    bulk=cellBoundary(root)
    ;PW = layer( 20 type(0) )
    NCi = layer( 21 type(0) )
    PCi = layer( 16 type(0) )
    SDOPi = layer( 99 type(0) )
    WNi = layer( 203 type(0) )
    SM = layer( 84 type(0) )
    VARMOS = layer( 93 type(0) )
   
    M1PIN=layer( 61 type(251) )
    M2PIN=layer( 62 type(251) )
    M3PIN=layer( 63 type(251) )
    M4PIN=layer( 64 type(251) )
    M5PIN=layer( 65 type(251) )
    M6PIN=layer( 66 type(251) )
    M7PIN=layer( 67 type(251) )
    M8PIN=layer( 68 type(251) )
    DNSRAM=layer( 60 type(2) )
    DPSRAM=layer( 60 type(4) )
    LRSRAM=layer( 60 type(5) )
    D2SRAM=layer( 60 type(11) )
    RFSRAM=layer( 60 type(9) )
    HPBL=layer( 60 type(150) )
    ULVTi=layer( 159 type(152) )
    BUMPi=layer( 168 type(0) )
    OCOVLi=layer( 91 type(5) )
    DMPNP=layer( 134 type(0) )
    DGV=layer( 29 type(1) )
    DUPMK1i=layer( 89 type(156) )
    ALPAR=layer( 83 type(1) )
    ;ESDHV=layer( 133 type(1) )
    ;ESDIO2=layer( 133 type(3) )
    EMPTY= layer( 999 type(1111) )
    OTPMK1=layer( 89 type(160) )

)
 
layerDefs("df2"

    INST=layer("INST" type("drawing"))

    AAi=layer("AA" type("drawing"))

    AADUM=layer("AADUM" type("drawing"))

    ALDUB=layer("ALDUB" type("drawing"))

    ALDUM=layer("ALDUM" type("drawing"))

    ALPA=layer("ALPA" type("drawing"))

    BORDER=layer("BORDER" type("drawing"))

    CTi=layer("CT" type("drawing"))

    CTBAR=layer("CTBAR" type("drawing"))

    DGi=layer("DG" type("drawing"))

    DNWi=layer("DNW" type("drawing"))

    DUMBA=layer("DUMBA" type("drawing"))

    DUMBM=layer("DUMBM" type("drawing"))

    DUMBP=layer("DUMBP" type("drawing"))

    ESD1i=layer("ESD1" type("drawing"))

    ESD2=layer("ESD2" type("drawing"))

    ESD3=layer("ESD3" type("drawing"))

    FUSE=layer("FUSE" type("drawing"))
 
    EFUSE=layer("EFUSE" type("drawing"))

    GTi=layer("GT" type("drawing"))

    GTDUM=layer("GTDUM" type("drawing"))

    GTFUSE=layer("GTFUSE" type("drawing"))

    HRPi=layer("HRP" type("drawing"))

    HRPDMY=layer("HRPDMY" type("drawing"))

    HVT=layer("HVT" type("drawing"))

    BIPOLA=layer("BIPOLA" type("drawing"))

    INDMY=layer("INDMY" type("drawing"))

    DSTR=layer("DSTR" type("drawing"))

    LOGO=layer("LOGO" type("drawing"))

    LVNi=layer("LVN" type("drawing"))

    LVPi=layer("LVP" type("drawing"))

    LVT=layer("LVT" type("drawing"))
    
    PLDMK=layer("PLDMK" type("drawing"))

    PTCT=layer("PTCT" type("drawing"))

    M1i=layer("M1" type("drawing"))
    M1_text=textToPin("M1" type("label"))

    M1R=layer("MnR" type("metal1"))
    M2R=layer("MnR" type("metal2"))
    M3R=layer("MnR" type("metal3"))
    M4R=layer("MnR" type("metal4"))
    M5R=layer("MnR" type("metal5"))
    M6R=layer("MnR" type("metal6"))
    M7R=layer("MnR" type("metal7"))
    M8R=layer("MnR" type("metal8"))
    TM1R=layer("MnR" type("topmetal1"))
    TM2R=layer("MnR" type("topmetal2"))

    M2i=layer("M2" type("drawing"))
    M2_text=textToPin("M2" type("label"))

    M3i=layer("M3" type("drawing"))
    M3_text=textToPin("M3" type("label"))

    M4i=layer("M4" type("drawing"))
    M4_text=textToPin("M4" type("label"))

    M5i=layer("M5" type("drawing"))
    M5_text=textToPin("M5" type("label"))

    M6i=layer("M6" type("drawing"))
    M6_text=textToPin("M6" type("label"))

    M7i=layer("M7" type("drawing"))
    M7_text=textToPin("M7" type("label"))

    M8i=layer("M8" type("drawing"))
    M8_text=textToPin("M8" type("label"))

    ;MARKGi=layer("MARK" type("markg"))

    MARKS=layer("MARK" type("marks"))

    MD=layer("MD" type("drawing"))

    MIM=layer("MIM" type("drawing"))

    MOMDMY=layer("MOMDMY" type("drawing"))
    CAPBP=layer("CAPBP" type("drawing"))

    MnDUB_metal1=layer("MnDUB" type("metal1"))

    MnDUB_metal2=layer("MnDUB" type("metal2"))

    MnDUB_metal3=layer("MnDUB" type("metal3"))

    MnDUB_metal4=layer("MnDUB" type("metal4"))

    MnDUB_metal5=layer("MnDUB" type("metal5"))

    MnDUB_metal6=layer("MnDUB" type("metal6"))

    MnDUB_metal7=layer("MnDUB" type("metal7"))

    MnDUB_metal8=layer("MnDUB" type("metal8"))

    MnDUB_topmetal1=layer("MnDUB" type("topmetal1"))

    MnDUB_topmetal2=layer("MnDUB" type("topmetal2"))

    MnDUM_metal1a=layer("MnDUM" type("metal1"))

    MnDUM_metal2a=layer("MnDUM" type("metal2"))

    MnDUM_metal3a=layer("MnDUM" type("metal3"))

    MnDUM_metal4a=layer("MnDUM" type("metal4"))

    MnDUM_metal5a=layer("MnDUM" type("metal5"))

    MnDUM_metal6a=layer("MnDUM" type("metal6"))

    MnDUM_metal7a=layer("MnDUM" type("metal7"))

    MnDUM_metal8a=layer("MnDUM" type("metal8"))

    MnDUM_topmetal1=layer("MnDUM" type("topmetal1"))

    MnDUM_topmetal2=layer("MnDUM" type("topmetal2"))

    NCAP=layer("NCAP" type("drawing"))

    NLHi=layer("NLH" type("drawing"))

    NLHTi=layer("NLHT" type("drawing"))

    NLLi=layer("NLL" type("drawing"))

    NWi=layer("NW" type("drawing"))

    OVERDR=layer("OVERDR" type("drawing"))

    PA=layer("PA" type("drawing"))

    PABAR=layer("PABAR" type("drawing"))

    PLHi=layer("PLH" type("drawing"))

    PLHTi=layer("PLHT" type("drawing"))

    PLLi=layer("PLL" type("drawing"))

    PSUBi=layer("PSUB" type("drawing"))

    RESAA=layer("RESAA" type("drawing"))
   
    DIFRES=layer("DIFRES" type("res"))

    RESNW=layer("RESNW" type("drawing"))

    RESP1=layer("RESP1" type("drawing"))

    PLRES=layer("PLRES" type("res"))

    SABi=layer("SAB" type("drawing"))

    SNi=layer("SN" type("drawing"))

    SPi=layer("SP" type("drawing"))

    TGi=layer("TG" type("drawing"))

    TGV=layer("TGV" type("drawing"))

    TM1i=layer("TM1" type("drawing"))
    TM1_text=textToPin("TM1" type("label"))

    TM2i=layer("TM2" type("drawing"))
    TM2_text=textToPin("TM2" type("label"))

    TV1i=layer("TV1" type("drawing"))

    TV2i=layer("TV2" type("drawing"))

    V1i=layer("V1" type("drawing"))

    V2i=layer("V2" type("drawing"))

    V3i=layer("V3" type("drawing"))

    V4i=layer("V4" type("drawing"))

    V5i=layer("V5" type("drawing"))

    V6i=layer("V6" type("drawing"))

    V7i=layer("V7" type("drawing"))

    VTNHi=layer("VTNH" type("drawing"))

    VTPHi=layer("VTPH" type("drawing"))

    VnBAR_topvia1=layer("VnBAR" type("topvia1"))

    VnBAR_topvia2=layer("VnBAR" type("topvia2"))

    VnBAR_via1=layer("VnBAR" type("via1"))

    VnBAR_via2=layer("VnBAR" type("via2"))

    VnBAR_via3=layer("VnBAR" type("via3"))

    VnBAR_via4=layer("VnBAR" type("via4"))

    VnBAR_via5=layer("VnBAR" type("via5"))

    VnBAR_via6=layer("VnBAR" type("via6"))

    VnBAR_via7=layer("VnBAR" type("via7"))

    VnDUM_via1a=layer("VnDUM" type("via1"))

    VnDUM_via2a=layer("VnDUM" type("via2"))

    VnDUM_via3a=layer("VnDUM" type("via3"))

    VnDUM_via4a=layer("VnDUM" type("via4"))

    VnDUM_via5a=layer("VnDUM" type("via5"))

    VnDUM_via6a=layer("VnDUM" type("via6"))

    VnDUM_via7a=layer("VnDUM" type("via7"))

    M1DOP=layer("MnDOP" type("metal1"))

    M2DOP=layer("MnDOP" type("metal2"))

    M3DOP=layer("MnDOP" type("metal3"))

    M4DOP=layer("MnDOP" type("metal4"))

    M5DOP=layer("MnDOP" type("metal5"))

    M6DOP=layer("MnDOP" type("metal6"))

    M7DOP=layer("MnDOP" type("metal7"))

    M8DOP=layer("MnDOP" type("metal8"))

    V1DOP=layer("VnDOP" type("via1"))

    V2DOP=layer("VnDOP" type("via2"))

    V3DOP=layer("VnDOP" type("via3"))

    V4DOP=layer("VnDOP" type("via4"))

    V5DOP=layer("VnDOP" type("via5"))

    V6DOP=layer("VnDOP" type("via6"))

    V7DOP=layer("VnDOP" type("via7"))

    V1DUB=layer("VnDUB" type("via1"))

    V2DUB=layer("VnDUB" type("via2"))

    V3DUB=layer("VnDUB" type("via3"))

    V4DUB=layer("VnDUB" type("via4"))

    V5DUB=layer("VnDUB" type("via5"))

    V6DUB=layer("VnDUB" type("via6"))

    V7DUB=layer("VnDUB" type("via7"))

    LDBK=layer("LDBK" type("drawing"))

    MTT2DMi=layer("MTT2DM" type("drawing"))

    MTT2DB=layer("MTT2DB" type("drawing"))

    MTT2i=layer("MTT2" type("drawing"))

    ESDIO2=layer("ESDIO2" type("drawing"))
  
    EXCLU=layer("EXCLU" type("drawing"))

    bulk=cellBoundary(root)

    ;PW = layer( "PW" type("drawing") )
    NCi = layer( "NC" type("drawing") )
    PCi = layer( "PC" type("drawing") )
    SDOPi = layer( "SDOP" type("drawing") )
    WNi = layer( "WN" type("drawing") )
    SM = layer( "SM" type("drawing") )
    VARMOS = layer( "VARMOS" type("drawing") )
    EMPTY  = layer( "EMPTY"  type("drawing") )

    M1PIN=layer("MnPIN" type("metal1"))

    M2PIN=layer("MnPIN" type("metal2"))

    M3PIN=layer("MnPIN" type("metal3"))

    M4PIN=layer("MnPIN" type("metal4"))

    M5PIN=layer("MnPIN" type("metal5"))

    M6PIN=layer("MnPIN" type("metal6"))

    M7PIN=layer("MnPIN" type("metal7"))

    M8PIN=layer("MnPIN" type("metal8"))
    DNSRAM=layer("SRAM" type("dnsram"))
    DPSRAM=layer("SRAM" type("dpsram"))
    LRSRAM=layer("SRAM" type("lrsram"))
    D2SRAM=layer("SRAM" type("d2sram"))
    RFSRAM=layer("SRAM" type("rfsram"))
    HPBL=layer("SRAM" type("hpbl"))
    ULVTi=layer("ULVT" type("drawing"))
    BUMPi=layer("BUMP" type("drawing"))
    OCOVLi=layer("OCOVL" type("drawing"))
    DMPNP=layer("DMPNP" type("drawing"))
    DGV=layer("DGV" type("drawing"))
    DUPMK1i=layer("DUPMK1" type("drawing"))
    ALPAR=layer("ALPAR" type("drawing"))
    OTPMK1=layer("OTPMK1" type("drawing"))
)

MARKG = geomCat(MARKS)
AA = geomAndNot(AAi MARKG)
NW = geomAndNot(NWi MARKG)
PC = geomAndNot(PCi MARKG)
DNW = geomAndNot(DNWi MARKG)
NC = geomAndNot(NCi MARKG)
DG = geomAndNot(DGi MARKG)
GT = geomAndNot(GTi MARKG)
NLL = geomAndNot(NLLi MARKG)
NLH = geomAndNot(NLHi MARKG)
PLL = geomAndNot(PLLi MARKG)
PLH = geomAndNot(PLHi MARKG)
SN = geomAndNot(SNi MARKG)
SP = geomAndNot(SPi MARKG)
VTPH = geomAndNot(VTPHi MARKG)
VTNH = geomAndNot(VTNHi MARKG)
SAB = geomAndNot(SABi MARKG)
CT = geomAndNot(CTi MARKG)
M1 = geomAndNot(M1i MARKG)
M2 = geomAndNot(M2i MARKG)
M3 = geomAndNot(M3i MARKG)
M4 = geomAndNot(M4i MARKG)
M5 = geomAndNot(M5i MARKG)
M6 = geomAndNot(M6i MARKG)
M7 = geomAndNot(M7i MARKG)
M8 = geomAndNot(M8i MARKG)
TM1 = geomAndNot(TM1i MARKG)
TM2 = geomAndNot(TM2i MARKG)
MTT2 = geomAndNot(MTT2i MARKG)
V1 = geomAndNot(V1i MARKG)
V2 = geomAndNot(V2i MARKG)
V3 = geomAndNot(V3i MARKG)
V4 = geomAndNot(V4i MARKG)
V5 = geomAndNot(V5i MARKG)
V6 = geomAndNot(V6i MARKG)
V7 = geomAndNot(V7i MARKG)
TV1 = geomAndNot(TV1i MARKG)
TV2 = geomAndNot(TV2i MARKG)
WN = geomAndNot(WNi MARKG)
SDOP = geomAndNot(SDOPi MARKG)
NLHT = geomAndNot(NLHTi MARKG)
PLHT = geomAndNot(PLHTi MARKG)
TG = geomAndNot(TGi MARKG)
LVP = geomAndNot(LVPi MARKG)
LVN = geomAndNot(LVNi MARKG)
PSUB = geomAndNot(PSUBi MARKG)
HRP = geomAndNot(HRPi MARKG)
PW=geomAndNot(bulk PSUBi) 
ULVT = geomAndNot(ULVTi MARKG)
BUMP = geomAndNot(BUMPi MARKG)
OCOVL = geomAndNot(OCOVLi MARKG)
DUPMK1 = geomAndNot(DUPMK1i MARKG)
ESD1=geomAndNot(ESD1i MARKG)

SRAM=geomOr(geomOr(geomOr(DNSRAM LRSRAM) D2SRAM) DPSRAM) 
nacti=geomAnd(SNi AAi)
pacti=geomAnd(SPi AAi)
ntapi=geomAnd(nacti NWi)
ptapi=geomAndNot(pacti NWi)
ngatei=geomAnd(nacti GTi)
pgatei=geomAnd(pacti GTi)
nsdi=geomAndNot(nacti ngatei)
psdi=geomAndNot(pacti pgatei)
sqct=geomContactCheck(CT width==0.06 length==0.06)


; gate=( AA and GT )
;gate=geomAnd(AA GT)
gate0 = geomAnd( geomButtOrOver(GT CT) AA)
aa1 = geomAndNot( geomButtOrOver(AA gate0) gate0)
aa2 = geomButtOnly(aa1 gate0 keep > 1)
aa3 = geomButtOrOver(aa1 CT)
aa4 = geomOr(aa2 aa3)
gate1 = geomButtOnly(gate0 aa4 keep == 2)
gate2 = geomAnd(gate0 LDBK)
gate = geomOr(gate1 gate2) 
poly_gate=geomButtOrOver(GT gate)

; ALALPA=ALPA or ALRDL
;ALALPA1=geomOr(ALPA ALRDL)
ALALPA2=geomOr(ALPA ALDUM)
ALPA_ALL=geomAndNot(ALPA MARKG)
ALPad=geomWidth(ALPA_ALL keep>35)
ALRDL=geomAndNot(ALPA_ALL ALPad)

; aa_all=AA or AADUM
aa_all=geomOr(AA AADUM)
aa_all_ni=geomOutside(aa_all INST)
aa_ni=geomOutside(AA INST)
aa_in=geomAndNot(AA aa_ni)
; nact=AA and SN
nact=geomAnd(SN AA)

; nact_dnw=nact overlap DNW
nact_dnw=geomOverlap(nact DNW)

ngate=geomAnd(gate SN)
ntap=geomAnd(nact NW)
pact=geomAnd(SP AA)
pgate=geomAnd(gate SP)
psd=geomButtOnly(geomAndNot(pact pgate) pgate)
nsd=geomButtOnly(geomAndNot(nact ngate) ngate)

ptap=geomAndNot(pact NW)


tap=geomOr( ntap ptap)
nontap=geomAndNot( AA tap)

pmos = geomOr(pgate psd)
nmos = geomOr(ngate nsd)
mos = geomOr(pmos nmos)
mos12 = geomOutside(mos geomOr(DG TG))
mos18 = geomButtOrOver(mos DG)
mos25 = geomButtOrOver(mos TG)

pbaa = geomAnd(AA PSUB)
pbgt = geomButtOrOver(GT PSUB)

naaeigt = geomGetEdge(nact inside GT)
paaeigt = geomGetEdge(pact inside GT)
ngteiaa = geomGetEdge(GT inside nact)
pgteiaa = geomGetEdge(GT inside pact)
gteiaa  = geomGetEdge(GT inside AA)

intergt = geomAndNot(GT gate)
interct=geomAnd(CT intergt)
act_ct=geomAnd(CT AA)
ctaam1=geomButtOrOver(CT geomAnd(AA M1))
ctgtm1=geomButtOrOver(CT geomAnd(GT M1))
ctm1=geomOr(ctaam1 ctgtm1)

gtlength=geomGetLength(GT keep>0.001)
gt_end_head1=geomSelectEdge(gtlength length keep<=0.11 angle1(keep==90 length keep>=0.08) angle2(keep==90 length keep>=0.08))
gt_end_head=drc(gt_end_head1 geomEnclose(AA gate) enc<0.12 opposite edgea)
gt_nonend=geomAndNot(GT geomOr(geomGetEdge(GT coincident gt_end_head1) geomGetEdge(GT butting gt_end_head1))) 

; aa_mos=AA overlap GT
aa_mos=geomOverlap(AA GT)

; aa_mos_dg=aa_mos overlap DG
aa_mos_dg=geomOverlap(aa_mos DG)

; aa_mos_tg=aa_mos overlap TG
aa_mos_tg=geomOverlap(aa_mos TG)

; aa_mos_hv=aa_mos_dg or aa_mos_tg
aa_mos_hv=geomOr(aa_mos_dg aa_mos_tg)

; aa_mos_lv=aa_mos andnot aa_mos_hv
aa_mos_lv=geomAndNot(aa_mos aa_mos_hv)

; aa_non_mos=AA andnot aa_mos
aa_non_mos=geomAndNot(AA aa_mos)

; aa_nonfloat=AA overlap CT
aa_nonfloat=geomOverlap(AA CT)

; aa_float=AA andnot aa_nonfloat
aa_float=geomAndNot(AA aa_nonfloat)
ftaa=geomAvoiding(AA CTi)
ftgt=geomAvoiding(GT CTi)
; aa_res=aa_non_mos overlap RESAA
aa_res=geomButtOrOver(geomButtOrOver(AA RESAA) SAB)
aa_difres=geomAnd(AA DIFRES)

; aa_res_n=aa_res overlap SN
aa_res_n=geomOverlap(aa_res SN)

; aa_res_p=aa_res overlap SP
aa_res_p=geomOverlap(aa_res SP)

; aa_res_sab=aa_res overlap SAB
aa_res_sab=geomOverlap(aa_res SAB)

; aa_resbody=aa_res  and RESAA
aa_resbody=geomAnd(RESAA aa_res)
aa_difresbody=geomAnd(DIFRES aa_difres)

; aa_up_2p5=AA size 2.5
L43467=geomSize(AA 1.0)
aa_up_2p5=geomSize(L43467 1.5)

; alpa_or_alrdl=ALPA or ALRDL
alpa_or_alrdl=geomCat(ALPA)

; bulk_copy=bulk upDown 0.005
L83637=geomSize(bulk 0.005)
bulk_copy=geomSize(L83637 -0.005)
DGTG=geomOr(DG TG)
bulk_no_dt=geomAndNot(bulk DGTG)
bulk_no_MIN=geomAndNot( bulk geomOr(INDMY MARKG MARKS))

BORDER_1=geomHoles(BORDER)
BORDER_all=geomOr(BORDER_1 BORDER)

; chamfer=bulk andnot BORDER
chamfer=geomAndNot(bulk BORDER_all)

; ct_aa=CT overlap aa_nonfloat
ct_aa=geomOverlap(CT aa_nonfloat)

; ct_poly=CT overlap GT
ct_poly=geomOverlap(CT GT)

; gate_psub=gate and PSUB
gate_psub=geomAnd(PSUB gate)

; gate_psub_dg=gate_psub overlap DG
gate_psub_dg=geomOverlap(gate_psub DG)

; gate_psub_tg=gate_psub overlap TG
gate_psub_tg=geomOverlap(gate_psub TG)

MnPIN=geomOr(geomOr(geomOr(geomOr(geomOr(geomOr(geomOr(M1PIN M2PIN) M3PIN) M4PIN) M5PIN) M6PIN) M7PIN) M8PIN)

LP= geomOr(LOGO PTCT)
LPM=geomOr(LP MARKG)
LP_BM=geomOr(LP DUMBM)
LPM_BM=geomOr(LPM DUMBM)

rulev16a1=geomAndNot(V1 geomInside(V1 M1))
rulev1_6a=drc(M1 geomOutside(V1 INST) venc(enc1<0.015 enc2<0.015 enc3<0.015 enc4<0.015))
rulev1_6b=drc(M1 geomOutside(V1 INST) venc(enc1<0.01 enc2<0.02 enc3<0.01 enc4<0.02))
rulev1_6c=drc(M1 geomOutside(V1 INST) venc(enc1<0 enc2<0.03 enc3<0 enc4<0.03))
rulev1_6ar=geomWithEdge(V1 rulev1_6a)
rulev1_6br=geomWithEdge(V1 rulev1_6b)
rulev1_6cr=geomWithEdge(V1 rulev1_6c)
rulev1_6ab=geomAnd(rulev1_6ar rulev1_6br)
rule_V1_6AB=geomButtOrOver(geomAnd(rulev1_6ab rulev1_6cr) geomButtOrOver(geomAnd(M1 M2) geomOutside(V1 INST)))
rule_V1_6=geomCat(rulev16a1 rule_V1_6AB)


rulev1_7a=drc(M2 V1 venc(enc1<0.015 enc2<0.015 enc3<0.015 enc4<0.015))
rulev1_7b=drc(M2 V1 venc(enc1<0.01 enc2<0.02 enc3<0.01 enc4<0.02))
rulev1_7c=drc(M2 V1 venc(enc1<0 enc2<0.03 enc3<0 enc4<0.03))
rulev1_7ar=geomWithEdge(V1 rulev1_7a)
rulev1_7br=geomWithEdge(V1 rulev1_7b)
rulev1_7cr=geomWithEdge(V1 rulev1_7c)
rulev1_7ab=geomAnd(rulev1_7ar rulev1_7br)
rule_V1_7=geomButtOrOver(geomAnd(rulev1_7ab rulev1_7cr) geomButtOrOver(geomAnd(M1 M2) V1))

V2_ni=geomOutside(V2 INST)
rulev2_6a=drc(M2 V2_ni venc(enc1<0.015 enc2<0.015 enc3<0.015 enc4<0.015))
rulev2_6b=drc(M2 V2_ni venc(enc1<0.01 enc2<0.02 enc3<0.01 enc4<0.02))
rulev2_6c=drc(M2 V2_ni venc(enc1<0 enc2<0.03 enc3<0 enc4<0.03))
rulev2_6ar=geomWithEdge(V2_ni rulev2_6a)
rulev2_6br=geomWithEdge(V2_ni rulev2_6b)
rulev2_6cr=geomWithEdge(V2_ni rulev2_6c)
rulev2_6ab=geomAnd(rulev2_6ar rulev2_6br)
rule_V2_6=geomButtOrOver(geomAnd(rulev2_6ab rulev2_6cr) geomButtOrOver(geomAnd(M2 M3) V2_ni ))

rulev2_7a=drc(M3 V2 venc(enc1<0.015 enc2<0.015 enc3<0.015 enc4<0.015))
rulev2_7b=drc(M3 V2 venc(enc1<0.01 enc2<0.02 enc3<0.01 enc4<0.02))
rulev2_7c=drc(M3 V2 venc(enc1<0 enc2<0.03 enc3<0 enc4<0.03))
rulev2_7ar=geomWithEdge(V2 rulev2_7a)
rulev2_7br=geomWithEdge(V2 rulev2_7b)
rulev2_7cr=geomWithEdge(V2 rulev2_7c)
rulev2_7ab=geomAnd(rulev2_7ar rulev2_7br)
rule_V2_7=geomButtOrOver(geomAnd(rulev2_7ab rulev2_7cr) geomButtOrOver(geomAnd(M2 M3) V2))

rulev3_6a=drc(M3 V3 venc(enc1<0.015 enc2<0.015 enc3<0.015 enc4<0.015))
rulev3_6b=drc(M3 V3 venc(enc1<0.01 enc2<0.02 enc3<0.01 enc4<0.02))
rulev3_6c=drc(M3 V3 venc(enc1<0 enc2<0.03 enc3<0 enc4<0.03))
rulev3_6ar=geomWithEdge(V3 rulev3_6a)
rulev3_6br=geomWithEdge(V3 rulev3_6b)
rulev3_6cr=geomWithEdge(V3 rulev3_6c)
rulev3_6ab=geomAnd(rulev3_6ar rulev3_6br)
rule_V3_6=geomButtOrOver(geomAnd(rulev3_6ab rulev3_6cr) geomButtOrOver(geomAnd(M4 M3) V3))

rulev3_7a=drc(M4 V3 venc(enc1<0.015 enc2<0.015 enc3<0.015 enc4<0.015))
rulev3_7b=drc(M4 V3 venc(enc1<0.01 enc2<0.02 enc3<0.01 enc4<0.02))
rulev3_7c=drc(M4 V3 venc(enc1<0 enc2<0.03 enc3<0 enc4<0.03))
rulev3_7ar=geomWithEdge(V3 rulev3_7a)
rulev3_7br=geomWithEdge(V3 rulev3_7b)
rulev3_7cr=geomWithEdge(V3 rulev3_7c)
rulev3_7ab=geomAnd(rulev3_7ar rulev3_7br)
rule_V3_7=geomButtOrOver(geomAnd(rulev3_7ab rulev3_7cr) geomButtOrOver(geomAnd(M4 M3) V3))

rulev4_6a=drc(M4 V4 venc(enc1<0.015 enc2<0.015 enc3<0.015 enc4<0.015))
rulev4_6b=drc(M4 V4 venc(enc1<0.01 enc2<0.02 enc3<0.01 enc4<0.02))
rulev4_6c=drc(M4 V4 venc(enc1<0 enc2<0.03 enc3<0 enc4<0.03))
rulev4_6ar=geomWithEdge(V4 rulev4_6a)
rulev4_6br=geomWithEdge(V4 rulev4_6b)
rulev4_6cr=geomWithEdge(V4 rulev4_6c)
rulev4_6ab=geomAnd(rulev4_6ar rulev4_6br)
rule_V4_6=geomButtOrOver(geomAnd(rulev4_6ab rulev4_6cr) geomButtOrOver(geomAnd(M4 M5) V4))

rulev4_7a=drc(M5 V4 venc(enc1<0.015 enc2<0.015 enc3<0.015 enc4<0.015))
rulev4_7b=drc(M5 V4 venc(enc1<0.01 enc2<0.02 enc3<0.01 enc4<0.02))
rulev4_7c=drc(M5 V4 venc(enc1<0 enc2<0.03 enc3<0 enc4<0.03))
rulev4_7ar=geomWithEdge(V4 rulev4_7a)
rulev4_7br=geomWithEdge(V4 rulev4_7b)
rulev4_7cr=geomWithEdge(V4 rulev4_7c)
rulev4_7ab=geomAnd(rulev4_7ar rulev4_7br)
rule_V4_7=geomButtOrOver(geomAnd(rulev4_7ab rulev4_7cr) geomButtOrOver(geomAnd(M4 M5) V4))

rulev5_6a=drc(M5 V5 venc(enc1<0.015 enc2<0.015 enc3<0.015 enc4<0.015))
rulev5_6b=drc(M5 V5 venc(enc1<0.01 enc2<0.02 enc3<0.01 enc4<0.02))
rulev5_6c=drc(M5 V5 venc(enc1<0 enc2<0.03 enc3<0 enc4<0.03))
rulev5_6ar=geomWithEdge(V5 rulev5_6a)
rulev5_6br=geomWithEdge(V5 rulev5_6b)
rulev5_6cr=geomWithEdge(V5 rulev5_6c)
rulev5_6ab=geomAnd(rulev5_6ar rulev5_6br)
rule_V5_6=geomButtOrOver(geomAnd(rulev5_6ab rulev5_6cr) geomButtOrOver(geomAnd(M6 M5) V5))

rulev5_7a=drc(M6 V5 venc(enc1<0.015 enc2<0.015 enc3<0.015 enc4<0.015))
rulev5_7b=drc(M6 V5 venc(enc1<0.01 enc2<0.02 enc3<0.01 enc4<0.02))
rulev5_7c=drc(M6 V5 venc(enc1<0 enc2<0.03 enc3<0 enc4<0.03))
rulev5_7ar=geomWithEdge(V5 rulev5_7a)
rulev5_7br=geomWithEdge(V5 rulev5_7b)
rulev5_7cr=geomWithEdge(V5 rulev5_7c)
rulev5_7ab=geomAnd(rulev5_7ar rulev5_7br)
rule_V5_7=geomButtOrOver(geomAnd(rulev5_7ab rulev5_7cr) geomButtOrOver(geomAnd(M6 M5) V5))

rulev6_6a=drc(M6 V6 venc(enc1<0.015 enc2<0.015 enc3<0.015 enc4<0.015))
rulev6_6b=drc(M6 V6 venc(enc1<0.01 enc2<0.02 enc3<0.01 enc4<0.02))
rulev6_6c=drc(M6 V6 venc(enc1<0 enc2<0.03 enc3<0 enc4<0.03))
rulev6_6ar=geomWithEdge(V6 rulev6_6a)
rulev6_6br=geomWithEdge(V6 rulev6_6b)
rulev6_6cr=geomWithEdge(V6 rulev6_6c)
rulev6_6ab=geomAnd(rulev6_6ar rulev6_6br)
rule_V6_6=geomButtOrOver(geomAnd(rulev6_6ab rulev6_6cr) geomButtOrOver(geomAnd(M6 M7) V6))

rulev6_7a=drc(M7 V6 venc(enc1<0.015 enc2<0.015 enc3<0.015 enc4<0.015))
rulev6_7b=drc(M7 V6 venc(enc1<0.01 enc2<0.02 enc3<0.01 enc4<0.02))
rulev6_7c=drc(M7 V6 venc(enc1<0 enc2<0.03 enc3<0 enc4<0.03))
rulev6_7ar=geomWithEdge(V6 rulev6_7a)
rulev6_7br=geomWithEdge(V6 rulev6_7b)
rulev6_7cr=geomWithEdge(V6 rulev6_7c)
rulev6_7ab=geomAnd(rulev6_7ar rulev6_7br)
rule_V6_7=geomButtOrOver(geomAnd(rulev6_7ab rulev6_7cr) geomButtOrOver(geomAnd(M6 M7) V6))

rulev7_6a=drc(M7 V7 venc(enc1<0.015 enc2<0.015 enc3<0.015 enc4<0.015))
rulev7_6b=drc(M7 V7 venc(enc1<0.01 enc2<0.02 enc3<0.01 enc4<0.02))
rulev7_6c=drc(M7 V7 venc(enc1<0 enc2<0.03 enc3<0 enc4<0.03))
rulev7_6ar=geomWithEdge(V7 rulev7_6a)
rulev7_6br=geomWithEdge(V7 rulev7_6b)
rulev7_6cr=geomWithEdge(V7 rulev7_6c)
rulev7_6ab=geomAnd(rulev7_6ar rulev7_6br)
rule_V7_6=geomButtOrOver(geomAnd(rulev7_6ab rulev7_6cr) geomButtOrOver(geomAnd(M8 M7) V7))

rulev7_7a=drc(M8 V7 venc(enc1<0.015 enc2<0.015 enc3<0.015 enc4<0.015))
rulev7_7b=drc(M8 V7 venc(enc1<0.01 enc2<0.02 enc3<0.01 enc4<0.02))
rulev7_7c=drc(M8 V7 venc(enc1<0 enc2<0.03 enc3<0 enc4<0.03))
rulev7_7ar=geomWithEdge(V7 rulev7_7a)
rulev7_7br=geomWithEdge(V7 rulev7_7b)
rulev7_7cr=geomWithEdge(V7 rulev7_7c)
rulev7_7ab=geomAnd(rulev7_7ar rulev7_7br)
rule_V7_7=geomButtOrOver(geomAnd(rulev7_7ab rulev7_7cr) geomButtOrOver(geomAnd(M8 M7) V7))

; rule_ct6_good was defined using native code
rule_ct6_bad1=drc( aa_nonfloat ct_aa venc( encAll<0.01 ) figb )
rule_ct6_bad2_1=drc(aa_nonfloat ct_aa enc<0.01 figb)
rule_ct6_bad2=drc( aa_nonfloat rule_ct6_bad2_1 venc( enc1<0.03 enc2<0 enc3<0.03 enc4<0 ) figb )
rule_ct6_good1=geomAndNot(ct_aa rule_ct6_bad1)
rule_ct6_good2=geomAndNot(ct_aa rule_ct6_bad2)
rule_ct6_good=geomOr(rule_ct6_good1 rule_ct6_good2)

; rule_GT19=gate encRect 200 200
rule_GT19=geomEncloseRect(gate 200 200)

; rule_GT21=notRectangle gate

rule_GT21=geomAndNot(geomGetNonRectangle(geomAnd(GT AA)) OCOVL)

MnDUM_metal1b=geomOr(MnDUM_metal1a M1DOP) 
MnDUM_metal1=geomAndNot(MnDUM_metal1b  MARKG)
MnDUM_metal2b=geomOr(MnDUM_metal2a M2DOP)
MnDUM_metal2=geomAndNot(MnDUM_metal2b  MARKG)
MnDUM_metal3b=geomOr(MnDUM_metal3a M3DOP)
MnDUM_metal3=geomAndNot(MnDUM_metal3b MARKG)
MnDUM_metal4b=geomOr(MnDUM_metal4a M4DOP)
MnDUM_metal4=geomAndNot(MnDUM_metal4b MARKG)
MnDUM_metal5b=geomOr(MnDUM_metal5a M5DOP)
MnDUM_metal5=geomAndNot(MnDUM_metal5b MARKG)
MnDUM_metal6b=geomOr(MnDUM_metal6a M6DOP)
MnDUM_metal6=geomAndNot(MnDUM_metal6b MARKG)
MnDUM_metal7b=geomOr(MnDUM_metal7a M7DOP)
MnDUM_metal7=geomAndNot(MnDUM_metal7b MARKG)
MnDUM_metal8b=geomOr(MnDUM_metal8a M8DOP)
MnDUM_metal8=geomAndNot(MnDUM_metal8b MARKG)
MnDUM_topmetal1a=geomAndNot(MnDUM_topmetal1 MARKG)
MnDUM_topmetal2a=geomAndNot(MnDUM_topmetal2 MARKG)
MTT2DM=geomAndNot(MTT2DMi MARKG)

VnDUM_via1b=geomOr(VnDUM_via1a V1DOP)
VnDUM_via1=geomAndNot(VnDUM_via1b MARKG)
VnDUM_via2b=geomOr(VnDUM_via2a V2DOP)
VnDUM_via2=geomAndNot(VnDUM_via2b MARKG)
VnDUM_via3b=geomOr(VnDUM_via3a V3DOP)
VnDUM_via3=geomAndNot(VnDUM_via3b MARKG)
VnDUM_via4b=geomOr(VnDUM_via4a V4DOP)
VnDUM_via4=geomAndNot(VnDUM_via4b MARKG)
VnDUM_via5b=geomOr(VnDUM_via5a V5DOP)
VnDUM_via5=geomAndNot(VnDUM_via5b MARKG)
VnDUM_via6b=geomOr(VnDUM_via6a V6DOP)
VnDUM_via6=geomAndNot(VnDUM_via6b MARKG)
VnDUM_via7b=geomOr(VnDUM_via7a V7DOP)
VnDUM_via7=geomAndNot(VnDUM_via7b MARKG)

LOPT=geomOr(LOGO PTCT)
LPMR=geomOr(LOPT MARKG)
LPMD=geomOr(LPMR RESNW)
LPMN=geomOr(LPMD DIFRES)
LPMP=geomOr(LPMN PLRES)
LPHR=geomOr(LPMP HRPDMY)
; rule_GTDUMC16=LOGO or DUMBP
DUMC16_a=geomOr(AA DUMBP)
rule_GTDUMC16=geomOr(DUMC16_a RESAA)
;rule_GTDUMC16=geomOr(DUMBP LOGO)

; rule_PA_10=PA downUp 5
rule_PA_10=geomSize(PA -5 downUp)

; rule_RESNW2_notrect=notRectangle RESNW
rule_RESNW2_notrect=geomGetNonRectangle(RESNW)

; rule_TM1_13=TM1 downUp 15
rule_TM1_13=geomSize(TM1 -15 downUp)

; rule_TM2_12=TM2 downUp 6
rule_TM2_12=geomSize(TM2 -6 downUp)

; rule_alpa5_zone=BORDER andnot INDMY
rule_alpa5_zone=geomAndNot(BORDER_all INDMY)

; rule_dfm10_zone=aa_mos drcNotch<=0.21
rule_dfm10_zone=drc(aa_mos 0<notch<=0.21 opposite parallel)

; rule_psub_note1=PSUB and NW
rule_psub_note1=geomAnd(NW PSUB)

; rule_psub_note2=PSUB and DNW
rule_psub_note2=geomAnd(DNW PSUB)

; rule_psub_note4=PSUB and SP
rule_psub_note4=geomAnd(PSUB SP)

; rule_psub_note5=notRectangle gate_psub
rule_psub_note5=geomGetNonRectangle(gate_psub)

; sn_gate=SN overlap gate
sn_gate=geomOverlap(SN gate)

; tg_or_dg=TG or DG
tg_or_dg=geomOr(DG TG)

; nw_hv=NW interact tg_or_dg
nw_hv=geomButtOrOver(NW tg_or_dg)

; nw_lv=NW andnot nw_hv
nw_lv=geomAndNot(NW nw_hv)

; tm1_all=TM1 or MnDUM_topmetal1
tm1_all=geomOr(MnDUM_topmetal1a TM1)

; tm2_all=TM2 or MnDUM_topmetal2
tm2_all=geomOr(MnDUM_topmetal2a TM2)

; ESD_all=ESD1 or ESD2 or ESD3
L80452=geomOr(ESD1 ESD2)
ESD_all=geomOr(ESD3 L80452)

poly_all=geomOr(GT GTDUM)

poly_mos=geomOverlap(GT aa_mos)
mos_l1=geomGetEdge(AA coincident gate)
mos_l2=geomGetLength(mos_l1 keep<0.2)
mos_l_2=geomEnclose(poly_mos geomWithEdge(gate mos_l2))

mos_w1=geomGetEdge(GT coincident gate)
mos_w2=geomGetLength(mos_w1 keep<=0.45)
mos_w_45=geomEnclose(poly_mos geomWithEdge(gate mos_w2))
mos_w2a=geomGetLength(mos_w1 keep>0.45)
mos_w_l45=geomEnclose(poly_mos geomWithEdge(gate mos_w2a))

poly_mos_l2w45=geomAnd(mos_l_2 mos_w_45)
poly_mos_l2wl45=geomAnd(mos_l_2 mos_w_l45)

aa_mos_l2w45=geomEnclose(aa_mos geomWithEdge(gate mos_w2))
aa_mos_l2wl45=geomEnclose(aa_mos geomWithEdge(gate mos_w2a))

nw_res=geomOverlap(NW RESNW)
aa_nw_res=geomOverlap(AA nw_res)


poly_float=geomAndNot(GT poly_mos)

poly_hres=geomOverlap(poly_float HRP)

poly_hres_n=geomOverlap(poly_hres SN)

poly_hres_p=geomOverlap(poly_hres SP)

poly_mos_field=geomAndNot(poly_mos aa_mos)

poly_field=geomOr(poly_float poly_mos_field)

poly_res=geomOverlap(poly_float RESP1)
poly_plres=geomOverlap(poly_float PLRES)

poly_res_n=geomOverlap(poly_res SN)

poly_res_p=geomOverlap(poly_res SP)

poly_res_sab=geomOverlap(poly_res SAB)

poly_resbody=geomAnd(RESP1 poly_res)
poly_plresbody=geomAnd(PLRES poly_plres)

polyInt=geomAndNot(GT poly_resbody)

; aa_nmos=aa_mos and SN andnot NW
L84206=geomAnd(SN aa_mos)
aa_nmos=geomAndNot(L84206 NW)

L80884=geomOverlap(aa_mos_tg SN)
aa_nmos_tg_overd=geomOverlap(L80884 OVERDR)

aa_nmos_tg_underd=geomOverlap(L80884 TGV)

L37580=geomAnd(SP aa_mos)
aa_pmos=geomAnd(L37580 NW)

L80886=geomOverlap(aa_mos_tg SP)
aa_pmos_tg_overd=geomOverlap(L80886 OVERDR)

aa_pmos_tg_underd=geomOverlap(L80886 TGV)

L60191=geomAndNot(aa_nonfloat gate)
ant_dio=drc(L60191 area>0.054)

gate_lv=geomAndNot(gate tg_or_dg)

gate_hv=geomAndNot(gate gate_lv)

gate_hv_not_tgv=geomAndNot(gate_hv TGV)

L45662=geomAndNot(gate_psub gate_psub_dg)
gate_psub_lv=geomAndNot(L45662 gate_psub_tg)

gate_psub_tg_overd=geomOverlap(gate_psub_tg OVERDR)

L30811=geomAnd(M1 aa_nonfloat)
m1aa_conn=geomOverlap(L30811 ct_aa)

L21906=geomAnd(GT M1)
m1gt_conn=geomOverlap(L21906 ct_poly)

L23464=geomAnd(M1 M2)
m1m2_conn=geomOverlap(L23464 V1)

L93672=geomAnd(M2 M3)
m2m3_conn=geomOverlap(L93672 V2)

L63880=geomAnd(M3 M4)
m3m4_conn=geomOverlap(L63880 V3)

L34088=geomAnd(M4 M5)
m4m5_conn=geomOverlap(L34088 V4)

L4296=geomAnd(M5 M6)
m5m6_conn=geomOverlap(L4296 V5)

L74504=geomAnd(M6 M7)
m6m7_conn=geomOverlap(L74504 V6)

L44712=geomAnd(M7 M8)
m7m8_conn=geomOverlap(L44712 V7)

L14495=geomAndNot(nact NW)

psub_implant=geomOverlap(PSUB nsd)

L70864=geomAnd(NW pact)
ntap_butted=geomButtOnly(ntap L70864)


ptap_butted=geomButtOnly(ptap L14495)

L34427=geomOr(SN SP)
resaa_implant=geomOverlap(L34427 aa_resbody)

respoly_implant=geomOverlap(L34427 poly_resbody)

L93230=geomOr(ALPA LOGO)
L93231=geomOr(L93230 PTCT)
L93232=geomOr(geomOr(geomOr(L93231 MARKG) ALDUB) DUMBM)
rule_ALDUMC27=geomButtOrOver(ALDUM L93232)

L38887=geomButtOrOver(ct_aa SP)
rule_CT11=geomButtOrOver(L38887 SN)

DUBM=geomOr(DUMBM MARKG)
DUPT=geomOr(DUBM PTCT)
DUPL=geomOr(DUPT LOGO)

DUMC18_1=geomOr(M1 LPM)
L77340=geomOr(DUMC18_1 V1)
rule_M1DUMC18=geomButtOrOver(MnDUM_metal1 L77340)

DUMC18_2=geomOr(M2 LPM)
L77341=geomOr(DUMC18_2 geomOr(V1 V2))
rule_M2DUMC18=geomButtOrOver(MnDUM_metal2 L77341)

DUMC18_3=geomOr(M3 LPM)
L77342=geomOr(DUMC18_3 geomOr(V3 V2))
rule_M3DUMC18=geomButtOrOver(MnDUM_metal3 L77342)

DUMC18_4=geomOr(M4 LPM)
L77343=geomOr(DUMC18_4 geomOr(V3 V4))
rule_M4DUMC18=geomButtOrOver(MnDUM_metal4 L77343)

DUMC18_5=geomOr(M5 LPM)
L77344=geomOr(DUMC18_5 geomOr(V5 V4))
rule_M5DUMC18=geomButtOrOver(MnDUM_metal5 L77344)

DUMC18_6=geomOr(M6 LPM)
L77345=geomOr(DUMC18_6 geomOr(V5 V6))
rule_M6DUMC18=geomButtOrOver(MnDUM_metal6 L77345)

DUMC18_7=geomOr(M7 LPM)
L77346=geomOr(DUMC18_7 geomOr(V7 V6))
rule_M7DUMC18=geomButtOrOver(MnDUM_metal7 L77346)

DUMC18_8=geomOr(M8 LPM)
L77347=geomOr(DUMC18_8 V7)
rule_M8DUMC18=geomButtOrOver(MnDUM_metal8 L77347)

L58660=geomOr(MnDUM_metal1 MnDUM_metal2)
rule_MxDUMC19=geomButtOrOver(GTFUSE L58660)

L59614=geomAndNot(aa_res aa_resbody)
rule_RESAA8=geomGetNonRectangle(L59614)

rule_RESAA10=geomAndNot(aa_res_p NW)

L85903=geomSizeAnd(aa_nw_res nw_res 0.33 4.9999)
rule_RESNW6=geomOverlap(L85903 aa_nw_res keep>1)

L31746=geomAndNot(poly_res poly_resbody)
rule_RESP18=geomGetNonRectangle(L31746)

DUMC18_tm1=geomOr(TM1 LPM)
L98592=geomOr(DUMC18_tm1 MnDUB_topmetal1)
rule_TM1DUMC18=geomButtOrOver(MnDUM_topmetal1a L98592)

DUMC18_tm2=geomOr(TM2 LPM)
L98591=geomOr(DUMC18_tm2 MnDUB_topmetal2)
rule_TM2DUMC18=geomButtOrOver(MnDUM_topmetal2a L98591)

DUMC18_ttm2=geomOr(MTT2 LPM)
L98593=geomOr(DUMC18_ttm2 MTT2DB)
rule_TTM2DUMC18=geomButtOrOver(MTT2DM L98593)


L2870=geomSize(ESD_all 1)
rule_esd3_sn=geomOverlap(SN L2870)

rule_esd3_sp=geomOverlap(SP L2870)

L38573=geomAvoiding(AA NCAP)
L38574=geomAvoiding(PSUB INDMY)
rule_psub_note3=geomOverlap(L38574 L38573 keep>1)

L18295=geomSize(TV1 0.28)
L39864=geomSize(L18295 -0.28)
tv1_array=geomSize(L39864 -0.85 downUp)

tv1_in_array=geomButtOrOver(TV1 tv1_array)

L14614=geomSize(TV2 0.28)
L69015=geomSize(L14614 -0.28)
tv2_array=geomSize(L69015 -0.85 downUp)

tv2_in_array=geomButtOrOver(TV2 tv2_array)

L56434=geomSize(V1 0.05)
L18639=geomSize(L56434 -0.05)
v1_array=geomSize(L18639 -0.17 downUp)

v1_in_arraya=geomButtOrOver(V1 v1_array)


L527=geomSize(V2 0.05)
L44976=geomSize(L527 -0.05)
v2_array=geomSize(L44976 -0.17 downUp)

v2_in_array=geomOverlap(V2 v2_array)

L9808=geomSize(V3 0.05)
L41295=geomSize(L9808 -0.05)
v3_array=geomSize(L41295 -0.17 downUp)

v3_in_array=geomOverlap(V3 v3_array)

L20143=geomSize(V4 0.05)
L37614=geomSize(L20143 -0.05)
v4_array=geomSize(L37614 -0.17 downUp)

v4_in_array=geomOverlap(V4 v4_array)

L36818=geomSize(V5 0.05)
L66067=geomSize(L36818 -0.05)
v5_array=geomSize(L66067 -0.17 downUp)

v5_in_array=geomOverlap(V5 v5_array)

L73517=geomSize(V6 0.05)
L69748=geomSize(L73517 -0.05)
v6_array=geomSize(L69748 -0.17 downUp)

v6_in_array=geomOverlap(V6 v6_array)

L83444=geomSize(V7 0.05)
L93867=geomSize(L83444 -0.05)
v7_array=geomSize(L93867 -0.17 downUp)

v7_in_array=geomOverlap(V7 v7_array)

L72059=geomSizeAnd(CT M1 0.03 0.09)
L66732=geomSize(L72059 -0.30)
ct_array=geomSize(L66732 0.21)

ct_in_array=geomOverlap(CT ct_array)

; rule_AA11=( nact cut NW ) or ( pact cut NW )
L31001=geomAndNot( geomStraddle(nact NW) LDBK)
L76361=geomAndNot( geomStraddle(pact NW) LDBK) 
rule_AA11=geomCat(L31001 L76361)

; rule_GT23=( gate cut SN ) or ( gate cut SP )
L30962=geomStraddle(gate SN)
L30964=geomStraddle(gate SP)
rule_GT23=geomOr(L30962 L30964)

; rule_LATCHUP3_pmos=aa_pmos andnot pgate andnot ( ntap sizeWithin 30 0.05 NW )
L63849=geomAndNot(aa_pmos pgate)
L95290=geomSizeAnd(ntap NW 0.38 35)
rule_LATCHUP3_pmos=geomAndNot(L63849 L95290)

; rule_RESAA1=aa_resbody andnot ( aa_resbody butt==2 ( aa_res andnot aa_resbody ) )
L84149=geomButting(aa_resbody L59614 keep==2)
rule_RESAA1=geomAndNot(aa_resbody L84149)

; rule_RESP11=poly_resbody andnot ( poly_resbody butt==2 ( poly_res andnot poly_resbody
;  ) )
L8219=geomButting(poly_resbody L31746 keep==2)
rule_RESP11=geomAndNot(poly_resbody L8219)

; rule_RESP114=((RESP1 and SN) and SAB) and GT
L48381=geomAnd(RESP1 SN)
L47591=geomAnd(L48381 SAB)
rule_RESP114=geomAnd(GT L47591)

PTMA=geomOr(PTCT MARKG)
LOGO1=geomOr(LOGO PTMA)
; rule_VnDUM_via1=VnDUM_via1 interact (V1 or LOGO or INDMY)
L77619=geomOr(LOGO1 V1)
L36764=geomOr(INDMY L77619)
rule_VnDUM_via1=geomButtOrOver(VnDUM_via1 L36764)

; rule_VnDUM_via2=VnDUM_via2 interact (V2 or LOGO or INDMY)
L77620=geomOr(LOGO1 V2)
L36742=geomOr(INDMY L77620)
rule_VnDUM_via2=geomButtOrOver(VnDUM_via2 L36742)

; rule_VnDUM_via3=VnDUM_via3 interact (V3 or LOGO or INDMY)
L77621=geomOr(LOGO1 V3)
L36741=geomOr(INDMY L77621)
rule_VnDUM_via3=geomButtOrOver(VnDUM_via3 L36741)

; rule_VnDUM_via4=VnDUM_via4 interact (V4 or LOGO or INDMY)
L77622=geomOr(LOGO1 V4)
L36740=geomOr(INDMY L77622)
rule_VnDUM_via4=geomButtOrOver(VnDUM_via4 L36740)

; rule_VnDUM_via5=VnDUM_via5 interact (V5 or LOGO or INDMY)
L77623=geomOr(LOGO1 V5)
L36739=geomOr(INDMY L77623)
rule_VnDUM_via5=geomButtOrOver(VnDUM_via5 L36739)

; rule_VnDUM_via6=VnDUM_via6 interact (V6 or LOGO or INDMY)
L77624=geomOr(LOGO1 V6)
L36738=geomOr(INDMY L77624)
rule_VnDUM_via6=geomButtOrOver(VnDUM_via6 L36738)

; rule_VnDUM_via7=VnDUM_via7 interact (V7 or LOGO or INDMY)
L77625=geomOr(LOGO1 V7)
L36737=geomOr(INDMY L77625)
rule_VnDUM_via7=geomButtOrOver(VnDUM_via7 L36737)

L58262=geomGetRectangle(poly_mos_field)
L66928=drc(poly_mos_field aa_mos 0<enc<.12 opposite parallel)
rule_gt78_poly=geomAnd(L58262 L66928)

L7502=geomSize(rule_gt78_poly 0.005 edges)
rule_gt78_zone=geomAvoiding(L7502 aa_mos)

L45456=geomOr(AA GT)
L84387=geomOr(DUMBP L45456)
L69564=geomOr(L84387 LOGO)
L69565=geomOr(L69564 PTCT)
L69566=geomOr(L69565 MARKG)
L69567=geomOr(L69566 RESAA)
L69568=geomOr(L69567 RESNW)
L69569=geomOr(L69568 DIFRES)
rule_AADUMC12=geomButtOrOver(GTDUM L69569)

L11112=geomOr(GT LOGO)
L11113=geomOr(L11112 PTCT)
L11114=geomOr(L11113 MARKG)
L11115=geomOr(L11114 RESP1)
L11116=geomOr(L11115 RESNW)
L11118=geomOr(L11116 PLRES)
L11119=geomOr(L11118 HRPDMY)

L40602=geomAnd(ct_poly gate)
L40602a=geomAndNot( L40602 geomOr(LOGO INDMY MOMDMY) )
L33419=geomAndNot(CT AA)
L17767=geomAndNot(L33419 GT)
L17767a=geomAndNot(L17767 INST)
rule_CT10=geomAndNot( geomOr(L17767a L40602a) geomOr(INST EFUSE) )

L33798=geomAvoiding(GT HRP)
L33790=geomAvoiding(L33798 MOMDMY)
L6569=geomAvoiding(L33790 GTFUSE)
;L6569=geomOverlap(L33798 SAB)
L67791=geomAndNot(L6569 SN)
rule_GT22_1=geomAndNot(L67791 SP)
rule_GT22=geomAndNot(rule_GT22_1 INST)

L16119=geomAndNot(aa_nmos ngate)
L69811=geomAndNot(bulk NW)
L64892=geomSizeAnd(ptap L69811 0.38 35)
rule_LATCHUP3_nmos=geomAndNot(L16119 L64892)

L90861=geomOr(L2870 SN)
L21904=geomOr(L90861 SP)
rule_esd3_aa=geomOverlap(AA L21904)

L52975=geomGetAngledEdge(aa_mos keep==90 mode1)
L11959=geomSize(L52975 0.005 edges )
L65245=geomOverlap(L11959 GT)
L6946=geomGetAngledEdge(aa_mos keep==0 mode1)
L7964=geomSize(L6946 0.005 edges )
L90650=geomOverlap(L7964 GT)
aa_sddir_not=geomOr(L65245 L90650)

L23336=geomGetEdge(aa_mos butting aa_sddir_not)
L23337=geomGetEdge(aa_mos_l2w45 butting aa_sddir_not)
L23338=geomGetEdge(aa_mos_l2wl45 butting aa_sddir_not)
rule_spsn_8a8b_h=geomSize(L23336 0.16 autoSteps(nil))

L36906=geomOr(L69564 RESNW)
rule_AADUMC2=geomButtOrOver(AADUM geomOr(AA L11119))


M1G26=geomWidth( M1 keep>0.26)
M2G26=geomWidth( M2 keep>0.26)
V1G26=geomButtOrOver(geomOutside(V1 SRAM) geomOr(M1G26 M2G26))
M1AM2=geomOutside(geomAnd(M1 M2) SRAM)
rule_V1_8=geomEnclose( geomEnclose(M1AM2 V1G26) V1 keep<2) 

M2G26=geomWidth( M2 keep>0.26)
M3G26=geomWidth( M3 keep>0.26)
V2G26=geomButtOrOver(V2 geomOr(M2G26 M3G26))
M2AM3=geomAnd(M2 M3)
rule_V2_8=geomEnclose( geomEnclose(M2AM3 V2G26) V2 keep<2)

M3G26=geomWidth( M3 keep>0.26)
M4G26=geomWidth( M4 keep>0.26)
V3G26=geomButtOrOver(V3 geomOr(M3G26 M4G26))
M3AM4=geomAnd(M3 M4)
rule_V3_8=geomEnclose( geomEnclose(M3AM4 V3G26) V3 keep<2)

M4G26=geomWidth( M4 keep>0.26)
M5G26=geomWidth( M5 keep>0.26)
V4G26=geomButtOrOver(V4 geomOr(M4G26 M5G26))
M4AM5=geomAnd(M4 M5)
rule_V4_8=geomEnclose( geomEnclose(M4AM5 V4G26) V4 keep<2)

M5G26=geomWidth( M5 keep>0.26)
M6G26=geomWidth( M6 keep>0.26)
V5G26=geomButtOrOver(V5 geomOr(M5G26 M6G26))
M5AM6=geomAnd(M5 M6)
rule_V5_8=geomEnclose( geomEnclose(M5AM6 V5G26) V5 keep<2)

M6G26=geomWidth( M6 keep>0.26)
M7G26=geomWidth( M7 keep>0.26)
V6G26=geomButtOrOver(V6 geomOr(M6G26 M7G26))
M6AM7=geomAnd(M6 M7)
rule_V6_8=geomEnclose( geomEnclose(M6AM7 V6G26) V6 keep<2)

M7G26=geomWidth( M7 keep>0.26)
M8G26=geomWidth( M8 keep>0.26)
V7G26=geomButtOrOver(V7 geomOr(M7G26 M8G26))
M7AM8=geomAnd(M7 M8)
rule_V7_8=geomEnclose( geomEnclose(M7AM8 V7G26) V7 keep<2)

; rule_AA10=( aa_mos overlap gate_lv overlap gate_hv ) or ( aa_mos cut DG ) or ( aa_mos
;  cut TG )
L96233=geomOverlap(aa_mos gate_lv)
L88316=geomOverlap(L96233 gate_hv)
L4845=geomStraddle(aa_mos DG)
L77656=geomOr(L4845 L88316)
L4349=geomStraddle(aa_mos TG)
rule_AA10=geomOr(L4349 L77656)



M1G52=geomWidth( M1 keep>0.52)
M2G52=geomWidth( M2 keep>0.52)
V1G52=geomButtOrOver(V1 geomOr(M1G52 M2G52))
rule_V1_9=geomEnclose( geomEnclose(M1AM2 V1G52) V1 keep<3)

M2G52=geomWidth( M2 keep>0.52)
M3G52=geomWidth( M3 keep>0.52)
V2G52=geomButtOrOver(V2 geomOr(M2G52 M3G52))
rule_V2_9=geomEnclose( geomEnclose(M2AM3 V2G52) V2 keep<3)

M3G52=geomWidth( M3 keep>0.52)
M4G52=geomWidth( M4 keep>0.52)
V3G52=geomButtOrOver(V3 geomOr(M3G52 M4G52))
rule_V3_9=geomEnclose( geomEnclose(M3AM4 V3G52) V3 keep<3)

M4G52=geomWidth( M4 keep>0.52)
M5G52=geomWidth( M5 keep>0.52)
V4G52=geomButtOrOver(V4 geomOr(M4G52 M5G52))
rule_V4_9=geomEnclose( geomEnclose(M4AM5 V4G52) V4 keep<3)

M5G52=geomWidth( M5 keep>0.52)
M6G52=geomWidth( M6 keep>0.52)
V5G52=geomButtOrOver(V5 geomOr(M5G52 M6G52))
rule_V5_9=geomEnclose( geomEnclose(M5AM6 V5G52) V5 keep<3)

M6G52=geomWidth( M6 keep>0.52)
M7G52=geomWidth( M7 keep>0.52)
V6G52=geomButtOrOver(V6 geomOr(M6G52 M7G52))
rule_V6_9=geomEnclose( geomEnclose(M6AM7 V6G52) V6 keep<3)

M7G52=geomWidth( M7 keep>0.52)
M8G52=geomWidth( M8 keep>0.52)
V7G52=geomButtOrOver(V7 geomOr(M7G52 M8G52))
rule_V7_9=geomEnclose( geomEnclose(M7AM8 V7G52) V7 keep<3)

; rule_RESAA9=( aa_res notInteract SAB ) or ( aa_res andnot ( SN or SP ) ) or ( aa_res
;  and ( NLHT or NLH or PLHT or PLH or LVN or NLL or VTNH or LVP or PLL or VTPH ) )
L48652=geomAvoiding(aa_res SAB)
L28601=geomAndNot(aa_res L34427)
L9057=geomOr(L28601 L48652)
L2723=geomOr(NLH NLHT)
L40685=geomOr(L2723 PLHT)
L8340=geomOr(L40685 PLH)
L42998=geomOr(L8340 LVN)
L96743=geomOr(L42998 NLL)
L88238=geomOr(L96743 VTNH)
L87570=geomOr(L88238 LVP)
L45104=geomOr(L87570 PLL)
L2703=geomOr(L45104 VTPH)
L16202=geomAnd(L2703 aa_res)
rule_RESAA9a=geomOr(L16202 L9057)
rule_RESAA9=geomAndNot(rule_RESAA9a EXCLU)

; rule_RESP19=( poly_res notInteract SAB ) or ( poly_res andnot ( SN or SP ) ) or (
;  poly_res and ( NLHT or NLH or PLHT or PLH or LVN or NLL or VTNH or LVP or PLL or
;  VTPH ) )
L88440=geomAvoiding(poly_res SAB)
L8699=geomAndNot(poly_res L34427)
L3895=geomOr(L8699 L88440)
L50850=geomAnd(L2703 poly_res)
rule_RESP19=geomOr(L3895 L50850)

; aa_HDA was defined using native code
processCoverage( 
  measure( windowSize=250 stepSize=250 
    aa_HDA_1=calculate(area(aa_all)/area())
  )
)
aa_HDA=geomGetCoverage(aa_HDA_1 keep>0.85)

; rule_AAC1=aa_HDA encRect 250 250
rule_AAC1=geomEncloseRect(aa_HDA 250 250)

; aa_LDA was defined using native code
processCoverage( 
  measure( windowSize=25 stepSize=25 
    aa_LDA_1=calculate(area(aa_all)/area())
  )
)
aa_LDA=geomGetCoverage(aa_LDA_1 keep<0.10)

; rule_AAC3=aa_LDA encRect 50 50
rule_AAC3=geomEncloseRect(aa_LDA 50 50)

; aa_MDA was defined using native code
processCoverage( 
  measure( windowSize=25 stepSize=25 
    aa_MDA_1=calculate(area(aa_all)/area())
  )
)
aa_MDA=geomGetCoverage(aa_MDA_1 keep<0.20)

; rule_AAC4=aa_MDA encRect 125 125
rule_AAC4=geomEncloseRect(aa_MDA 125 125)

; aa_mos_corner_edge was defined using native code
corn1=geomGetCorner(aa_mos angleAll)
corn2=geomGrowCorner(corn1 0.005 angleAll outside inner)
aa_mos_corner_edge=geomGetEdge(aa_mos butting corn2 wholeEdge)

m1_ct=geomOverlap(M1 CT)

m1_gt0p14=geomSize(M1 -0.07 downUp)

ct_m1_gt0p14=geomOverlap(CT m1_gt0p14)

ct_not_m1_gt0p14=geomAndNot(CT ct_m1_gt0p14)

m1_gt0p26=geomSize(m1_gt0p14 -0.13 downUp)

m1_gt0p52=geomSize(m1_gt0p26 -0.26 downUp)

m2_all=geomOr(M2 MnDUM_metal2)

m2_gt0p26=geomSize(M2 -0.13 downUp)

m2_gt0p52=geomSize(m2_gt0p26 -0.26 downUp)

m3_all=geomOr(M3 MnDUM_metal3)

m3_gt0p26=geomSize(M3 -0.13 downUp)

m3_gt0p52=geomSize(m3_gt0p26 -0.26 downUp)

m4_all=geomOr(M4 MnDUM_metal4)

m4_gt0p26=geomSize(M4 -0.13 downUp)

m4_gt0p52=geomSize(m4_gt0p26 -0.26 downUp)

m5_all=geomOr(M5 MnDUM_metal5)

m5_gt0p26=geomSize(M5 -0.13 downUp)

m5_gt0p52=geomSize(m5_gt0p26 -0.26 downUp)

m6_all=geomOr(M6 MnDUM_metal6)

m6_gt0p26=geomSize(M6 -0.13 downUp)

m6_gt0p52=geomSize(m6_gt0p26 -0.26 downUp)

m7_all=geomOr(M7 MnDUM_metal7)

m7_gt0p26=geomSize(M7 -0.13 downUp)

m7_gt0p52=geomSize(m7_gt0p26 -0.26 downUp)

m8_all=geomOr(M8 MnDUM_metal8)

m8_gt0p26=geomSize(M8 -0.13 downUp)

m8_gt0p52=geomSize(m8_gt0p26 -0.26 downUp)

; m1_gt0p645 was defined using native code
m1_gt0p645=geomWidth( m1_gt0p52 keep>0.645 )

; m1_gt2p8=m1_gt0p645 downUp 1.4
m1_gt2p8=geomSize(m1_gt0p645 -1.4 downUp)

; m1_gt2p8_m2=m1_gt2p8 and M2
m1_gt2p8_m2=geomAnd(M2 m1_gt2p8)

; m2_gt0p645 was defined using native code
m2_gt0p645=geomWidth( m2_gt0p52 keep>0.645 )

; m2_gt2p8=m2_gt0p645 downUp 1.4
m2_gt2p8=geomSize(m2_gt0p645 -1.4 downUp)

; m2_gt2p8_m1=m2_gt2p8 and M1
m2_gt2p8_m1=geomAnd(M1 m2_gt2p8)

; m2_gt2p8_m3=m2_gt2p8 and M3
m2_gt2p8_m3=geomAnd(M3 m2_gt2p8)



M1G645=geomWidth( M1 keep>0.645)
M2G645=geomWidth( M2 keep>0.645)
V1G645=geomButtOrOver(V1 geomOr(M1G645 M2G645))
rule_V1_10=geomEnclose( geomEnclose(M1AM2 V1G645) V1 keep<4)

M2G645=geomWidth( M2 keep>0.645)
M3G645=geomWidth( M3 keep>0.645)
V2G645=geomButtOrOver(V2 geomOr(M2G645 M3G645))
rule_V2_10=geomEnclose( geomEnclose(M2AM3 V2G645) V2 keep<4)

M3G645=geomWidth( M3 keep>0.645)
M4G645=geomWidth( M4 keep>0.645)
V3G645=geomButtOrOver(V3 geomOr(M3G645 M4G645))
rule_V3_10=geomEnclose( geomEnclose(M3AM4 V3G645) V3 keep<4)

M4G645=geomWidth( M4 keep>0.645)
M5G645=geomWidth( M5 keep>0.645)
V4G645=geomButtOrOver(V4 geomOr(M4G645 M5G645))
rule_V4_10=geomEnclose( geomEnclose(M4AM5 V4G645) V4 keep<4)

M5G645=geomWidth( M5 keep>0.645)
M6G645=geomWidth( M6 keep>0.645)
V5G645=geomButtOrOver(V5 geomOr(M5G645 M6G645))
rule_V5_10=geomEnclose( geomEnclose(M5AM6 V5G645) V5 keep<4)

M6G645=geomWidth( M6 keep>0.645)
M7G645=geomWidth( M7 keep>0.645)
V6G645=geomButtOrOver(V6 geomOr(M6G645 M7G645))
rule_V6_10=geomEnclose( geomEnclose(M6AM7 V6G645) V6 keep<4)

M7G645=geomWidth( M7 keep>0.645)
M8G645=geomWidth( M8 keep>0.645)
V7G645=geomButtOrOver(V7 geomOr(M7G645 M8G645))
rule_V7_10=geomEnclose( geomEnclose(M7AM8 V7G645) V7 keep<4)

; m3_gt0p645 was defined using native code
m3_gt0p645=geomWidth( m3_gt0p52 keep>0.645 )

; m3_gt2p8=m3_gt0p645 downUp 1.4
m3_gt2p8=geomSize(m3_gt0p645 -1.4 downUp)

; m3_gt2p8_m2=m3_gt2p8 and M2
m3_gt2p8_m2=geomAnd(M2 m3_gt2p8)

; m3_gt2p8_m4=m3_gt2p8 and M4
m3_gt2p8_m4=geomAnd(M4 m3_gt2p8)



; m4_gt0p645 was defined using native code
m4_gt0p645=geomWidth( m4_gt0p52 keep>0.645 )

; m4_gt2p8=m4_gt0p645 downUp 1.4
m4_gt2p8=geomSize(m4_gt0p645 -1.4 downUp)

; m4_gt2p8_m3=m4_gt2p8 and M3
m4_gt2p8_m3=geomAnd(M3 m4_gt2p8)

; m4_gt2p8_m5=m4_gt2p8 and M5
m4_gt2p8_m5=geomAnd(M5 m4_gt2p8)



; m5_gt0p645 was defined using native code
m5_gt0p645=geomWidth( m5_gt0p52 keep>0.645 )

; m5_gt2p8=m5_gt0p645 downUp 1.4
m5_gt2p8=geomSize(m5_gt0p645 -1.4 downUp)

; m5_gt2p8_m4=m5_gt2p8 and M4
m5_gt2p8_m4=geomAnd(M4 m5_gt2p8)

; m5_gt2p8_m6=m5_gt2p8 and M6
m5_gt2p8_m6=geomAnd(M6 m5_gt2p8)



; m6_gt0p645 was defined using native code
m6_gt0p645=geomWidth( m6_gt0p52 keep>0.645 )

; m6_gt2p8=m6_gt0p645 downUp 1.4
m6_gt2p8=geomSize(m6_gt0p645 -1.4 downUp)

; m6_gt2p8_m5=m6_gt2p8 and M5
m6_gt2p8_m5=geomAnd(M5 m6_gt2p8)

; m6_gt2p8_m7=m6_gt2p8 and M7
m6_gt2p8_m7=geomAnd(M7 m6_gt2p8)



; m7_gt0p645 was defined using native code
m7_gt0p645=geomWidth( m7_gt0p52 keep>0.645 )

; m7_gt2p8=m7_gt0p645 downUp 1.4
m7_gt2p8=geomSize(m7_gt0p645 -1.4 downUp)

; m7_gt2p8_m6=m7_gt2p8 and M6
m7_gt2p8_m6=geomAnd(M6 m7_gt2p8)

; m7_gt2p8_m8=m7_gt2p8 and M8
m7_gt2p8_m8=geomAnd(M8 m7_gt2p8)



; m8_gt0p645 was defined using native code
m8_gt0p645=geomWidth( m8_gt0p52 keep>0.645 )

; m8_gt2p8=m8_gt0p645 downUp 1.4
m8_gt2p8=geomSize(m8_gt0p645 -1.4 downUp)

; m8_gt2p8_m7=m8_gt2p8 and M7
m8_gt2p8_m7=geomAnd(M7 m8_gt2p8)



; poly_mos_corner_edge was defined using native code
corn1=geomGetCorner(poly_mos angleAll)
corn2=geomGrowCorner(corn1 0.005 angleAll outside inner)
poly_mos_corner_edge=geomGetEdge(poly_mos butting corn2 wholeEdge)

; real_gate was defined using native code
active1 = geomAnd( aa_mos CT )
active2 = geomSize(geomSize(active1 0.072) -0.072)
real_gate1= geomOverlap( GT active2 )
real_gate= geomSize(geomSize( real_gate1 0.08) -0.08)

; poly_float2=(poly_all notInteract real_gate) upDown 0.08
L17807=geomAvoiding(poly_all real_gate)
L67461=geomSize(L17807 0.08)
poly_float2=geomSize(L67461 -0.08)

; rule_DFM11 was defined using native code
rule_DFM11_1=drc(poly_mos aa_mos 0<enc<0.11 shielded opposite)
rule_DFM11_2=drc(aa_mos poly_mos 0<sep<0.06 opposite)
rule_DFM11_3=geomOverlap(rule_DFM11_2 aa_sddir_not)
rule_DFM11=geomButtOrOver(rule_DFM11_1 rule_DFM11_3)

; rule_DFM12 was defined using native code
rule_DFM12_1=drc(poly_mos aa_mos 0<enc<0.13 opposite shielded)
rule_DFM12_2=drc(aa_mos poly_mos 0<sep<0.04 opposite)
rule_DFM12_3=geomOverlap(rule_DFM12_2 aa_sddir_not)
rule_DFM12=geomButtOrOver(rule_DFM12_1 rule_DFM12_3 )

; rule_DFM27 was defined using native code
rule_DFM27_1=drc(poly_float2 real_gate 0.13<=sep<=0.20)
rule_DFM27=geomAvoiding(real_gate rule_DFM27_1)

; rule_GT13 was defined using native code
rule_GT13_1=drc(poly_mos aa_mos 0<enc<0.09 shielded)
rule_GT13_2=drc(poly_mos aa_mos 0<sep<0.060)
rule_GT13=geomButtOrOver(rule_GT13_1 rule_GT13_2)

; rule_V1_6 was defined using native code


rule_m17_1=geomWidth(M1 keep>=0.12)
rule_m17_2=geomAnd(CT rule_m17_1)
rule_m17dfm28=drc(M1 rule_m17_2 enc<0.015)

sqct=geomContactCheck(CT width==0.06 length==0.06)
rule_M17_1=geomOutside(geomAndNot(sqct M1) INST)


; rule_sn8a8b_sn was defined using native code
rule_sn8a8b_sn_1=geomGetEdge(SN butting pact wholeEdge)
rule_sn8a8b_sn_2=geomGetAdjacentEdge(SN rule_sn8a8b_sn_1)
rule_sn8a8b_sn_3=geomSize(rule_sn8a8b_sn_2 -0.005)
rule_sn8a8b_sn=geomAnd(rule_sn8a8b_sn_3 NW)

; rule_sp8a8b_sp was defined using native code
rule_sp8a8b_sp_1=geomGetEdge(SP butting nact wholeEdge)
rule_sp8a8b_sp_2=geomGetAdjacentEdge(SP rule_sp8a8b_sp_1)
rule_sp8a8b_sp_3=geomSize(rule_sp8a8b_sp_2 -0.005)
rule_sp8a8b_sp=geomAndNot(rule_sp8a8b_sp_3 NW)


  m1all=geomOr(M1i MnDUM_metal1)
   m2all=geomOr(M2i MnDUM_metal2)
   m3all=geomOr(M3i MnDUM_metal3)
   m4all=geomOr(M4i MnDUM_metal4)
   m5all=geomOr(M5i MnDUM_metal5)
   m6all=geomOr(M6i MnDUM_metal6)
   m7all=geomOr(M7i MnDUM_metal7)
   m8all=geomOr(M8i MnDUM_metal8)
   tm1all=geomOr(TM1i MnDUM_topmetal1a)
   tm2all=geomOr(TM2i MnDUM_topmetal2a)

  M1W=geomWidth(M1i keep>0.22)
  M2W=geomWidth(M2i keep>0.22)
  M3W=geomWidth(M3i keep>0.22)
  M4W=geomWidth(M4i keep>0.22)
  M5W=geomWidth(M5i keep>0.22)
  M6W=geomWidth(M6i keep>0.22)
  M7W=geomWidth(M7i keep>0.22)
  M8W=geomWidth(M8i keep>0.22)


 


RECT=geomGetRectangle(geomAndNot(CT geomOutside(CT INST)) width==0.060 length==0.160)




aa90c=geomGetCorner(AA keep==270 concave edge)
aa90c_e=geomGetEdge(aa_mos coincident aa90c wholeEdge)

gt90c=geomGetCorner(GT keep==270 concave edge)
gt90c_e=geomGetEdge(poly_mos coincident gt90c wholeEdge)

; procedure for switches METAL_OPTION_4LM_1TM
procedure( switchProc04()
TV1_down_metal=geomCat(EMPTY)
TV2_down_metal=geomCat(M3)
    geomConnect(
        via(PABAR ALPA MTT2i)
        via(PABAR ALPA TM2i)
        via(PA ALPA MTT2i)
        via(PA ALPA TM2i)
        via(VnBAR_topvia2 MTT2i M3i)
        via(VnBAR_topvia2 TM2i M3i) 
        via(TV2i MTT2i M3i)
        via(TV2i TM2i M3i)
        buttOrOver(resaa_implant aa_res)
        buttOrOver(respoly_implant poly_res)
        via(VnBAR_via2 M3i M2i) 
        via(V2i M3i M2i)
        via(VnBAR_via1 M1i M2i)
        via(V1i M2i M1i)
        via(CTi M1i ntapi)
        via(CTi M1i nsdi)
        via(CTi M1i ptapi)
        via(CTi M1i psdi)
        via(CTi M1i polyInt)
        via(sqct M1i ntapi)
        via(sqct M1i nsdi)
        via(sqct M1i ptapi)
        via(sqct M1i psdi)
        via(sqct M1i polyInt)
        buttOrOver(rule_esd3_aa ESD_all)
        buttOrOver(rule_esd3_aa rule_esd3_sn)
        buttOrOver(rule_esd3_aa rule_esd3_sp)
        label(TM2_text TM2i)
        label(M3_text M3i)
        label(M2_text M2i)
        label(M1_text M1i)
    )
    geomStamp(nw_lv ntapi buttOrOver)
    geomStamp(nw_hv ntapi buttOrOver)
    geomStamp(psub_implant nsdi buttOrOver)

)

; procedure for switches METAL_OPTION_5LM_1TM
procedure( switchProc05()
TV1_down_metal=geomCat(EMPTY)
TV2_down_metal=geomCat(M4)
    geomConnect(
        via(PABAR ALPA MTT2i)
        via(PABAR ALPA TM2i)
        via(PA ALPA MTT2i)
        via(PA ALPA TM2i)
        via(VnBAR_topvia2 MTT2i M4i)
        via(VnBAR_topvia2 TM2i M4i)
        via(TV2i MTT2i M4i)
        via(TV2i TM2i M4i)
        buttOrOver(resaa_implant aa_res)
        buttOrOver(respoly_implant poly_res)
        via(VnBAR_via3 M4i M3i)
        via(V3i M4i M3i) 
        via(VnBAR_via2 M3i M2i) 
        via(V2i M3i M2i)
        via(VnBAR_via1 M1i M2i)
        via(V1i M2i M1i)
        via(CTi M1i ntapi)
        via(CTi M1i nsdi)
        via(CTi M1i ptapi)
        via(CTi M1i psdi)
        via(CTi M1i polyInt)
        via(sqct M1i ntapi)
        via(sqct M1i nsdi)
        via(sqct M1i ptapi)
        via(sqct M1i psdi)
        via(sqct M1i polyInt)
        buttOrOver(rule_esd3_aa ESD_all)
        buttOrOver(rule_esd3_aa rule_esd3_sn)
        buttOrOver(rule_esd3_aa rule_esd3_sp)
        label(TM2_text TM2i)
        label(M4_text M4i)
        label(M3_text M3i)
        label(M2_text M2i)
        label(M1_text M1i)
    )
    geomStamp(nw_lv ntapi buttOrOver)
    geomStamp(nw_hv ntapi buttOrOver)
    geomStamp(psub_implant nsdi buttOrOver)

)

; procedure for switches METAL_OPTION_5LM_2TM
procedure( switchProc06()
TV1_down_metal=geomCat(M3)
TV2_down_metal=geomCat(TM1)
    geomConnect(
        buttOrOver(ALPA PABAR)
        buttOrOver(ALPA PA)
        buttOrOver(PABAR MTT2i)
        buttOrOver(PABAR TM2i)
        buttOrOver(PA MTT2i)
        buttOrOver(PA TM2i)
        buttOrOver(MTT2i VnBAR_topvia2)
        buttOrOver(TM2i VnBAR_topvia2)
        buttOrOver(MTT2i TV2i)  
        buttOrOver(TM2i TV2i)
        buttOrOver(VnBAR_topvia2 TM1i)
        buttOrOver(TV2i TM1i)
        buttOrOver(TM1i VnBAR_topvia1)
        buttOrOver(TM1i TV1i)
        buttOrOver(VnBAR_topvia1 M3i)
        buttOrOver(TV1i M3i)
        buttOrOver(resaa_implant aa_res)
        buttOrOver(respoly_implant poly_res)
        buttOrOver(VnBAR_via3 M3i)
        via(VnBAR_via2 M3i M2i)
        via(V2i M3i M2i)
        via(VnBAR_via1 M2i M1i) 
        via(V1i M2i M1i)
        via(CTi M1i ntapi)
        via(CTi M1i nsdi)
        via(CTi M1i ptapi)
        via(CTi M1i psdi)
        via(CTi M1i polyInt)
        via(sqct M1i ntapi)
        via(sqct M1i nsdi)
        via(sqct M1i ptapi)
        via(sqct M1i psdi)
        via(sqct M1i polyInt)
        buttOrOver(rule_esd3_aa ESD_all)
        buttOrOver(rule_esd3_aa rule_esd3_sn)
        buttOrOver(rule_esd3_aa rule_esd3_sp)
        label(TM2_text TM2i)
        label(TM1_text TM1i)
        label(M3_text M3i)
        label(M2_text M2i)
        label(M1_text M1i)
    )
    geomStamp(nw_lv ntapi buttOrOver)
    geomStamp(nw_hv ntapi buttOrOver)
    geomStamp(psub_implant nsdi buttOrOver)

)

; procedure for switches METAL_OPTION_6LM_1TM
procedure( switchProc0()
TV1_down_metal=geomCat(EMPTY)
TV2_down_metal=geomCat(M5)
    geomConnect(
        buttOrOver(ALPA PABAR)
        buttOrOver(ALPA PA)
        buttOrOver(PABAR MTT2i)
        buttOrOver(PABAR TM2i)
        buttOrOver(PA MTT2i)
        buttOrOver(PA TM2i)
        buttOrOver(MTT2i VnBAR_topvia2)
        buttOrOver(TM2i VnBAR_topvia2)
        buttOrOver(MTT2i TV2i)  
        buttOrOver(TM2i TV2i)
        buttOrOver(VnBAR_topvia2 M5i)
        buttOrOver(TV2i M5i)
        buttOrOver(M5i VnBAR_via4)
        buttOrOver(M5i V4i)
        buttOrOver(VnBAR_via4 M4i)
        buttOrOver(V4i M4i)
        buttOrOver(M4i VnBAR_via3)
        buttOrOver(M4i V3i)
        buttOrOver(resaa_implant aa_res)
        buttOrOver(respoly_implant poly_res)
        buttOrOver(VnBAR_via3 M3i)
        buttOrOver(V3i M3i)
        buttOrOver(M3i VnBAR_via2)
        buttOrOver(M3i V2i)
        buttOrOver(VnBAR_via2 M2i)
        buttOrOver(V2i M2i)
        buttOrOver(M2i VnBAR_via1)
        buttOrOver(M2i V1i)
        buttOrOver(VnBAR_via1 M1i)
        buttOrOver(V1i M1i)
        via(CTi M1i ntapi)
        via(CTi M1i nsdi)
        via(CTi M1i ptapi)
        via(CTi M1i psdi)
        via(CTi M1i polyInt)
        via(sqct M1i ntapi)
        via(sqct M1i nsdi)
        via(sqct M1i ptapi)
        via(sqct M1i psdi)
        via(sqct M1i polyInt)
        buttOrOver(rule_esd3_aa ESD_all)
        buttOrOver(rule_esd3_aa rule_esd3_sn)
        buttOrOver(rule_esd3_aa rule_esd3_sp)
        label(TM2_text TM2i)
        label(M5_text M5i)
        label(M4_text M4i)
        label(M3_text M3i)
        label(M2_text M2i)
        label(M1_text M1i)
    )
    geomStamp(nw_lv ntapi buttOrOver)
    geomStamp(nw_hv ntapi buttOrOver)
    geomStamp(psub_implant nsdi buttOrOver)

)

; procediure for switches METAL_OPTION_6LM_2TM
procedure( switchProc01()
TV1_down_metal=geomCat(M4)
TV2_down_metal=geomCat(TM1)
    geomConnect(
        buttOrOver(ALPA PABAR)
        buttOrOver(ALPA PA)
        buttOrOver(PABAR MTT2i)
        buttOrOver(PABAR TM2i)
        buttOrOver(PA MTT2i)
        buttOrOver(PA TM2i)
        buttOrOver(MTT2i VnBAR_topvia2)
        buttOrOver(TM2i VnBAR_topvia2)
        buttOrOver(MTT2i TV2i)  
        buttOrOver(TM2i TV2i)
        buttOrOver(VnBAR_topvia2 TM1i)
        buttOrOver(TV2i TM1i)
        buttOrOver(TM1i VnBAR_topvia1)
        buttOrOver(TM1i TV1i)
        buttOrOver(VnBAR_topvia1 M4i)
        buttOrOver(TV1i M4i)
        buttOrOver(M4i VnBAR_via3)
        buttOrOver(M4i V3i)
        buttOrOver(resaa_implant aa_res)
        buttOrOver(respoly_implant poly_res)
        buttOrOver(VnBAR_via3 M3i)
        buttOrOver(V3i M3i)
        buttOrOver(M3i VnBAR_via2)
        buttOrOver(M3i V2i)
        buttOrOver(VnBAR_via2 M2i)
        buttOrOver(V2i M2i)
        buttOrOver(M2i VnBAR_via1)
        buttOrOver(M2i V1i)
        buttOrOver(VnBAR_via1 M1i)
        buttOrOver(V1i M1i)
        via(CTi M1i ntapi)
        via(CTi M1i nsdi)
        via(CTi M1i ptapi)
        via(CTi M1i psdi)
        via(CTi M1i polyInt)
        via(sqct M1i ntapi)
        via(sqct M1i nsdi)
        via(sqct M1i ptapi)
        via(sqct M1i psdi)
        via(sqct M1i polyInt)
        buttOrOver(rule_esd3_aa ESD_all)
        buttOrOver(rule_esd3_aa rule_esd3_sn)
        buttOrOver(rule_esd3_aa rule_esd3_sp)
        label(TM2_text TM2i)
        label(TM1_text TM1i)
        label(M4_text M4i)
        label(M3_text M3i)
        label(M2_text M2i)
        label(M1_text M1i)
    )
    geomStamp(nw_lv ntapi buttOrOver)
    geomStamp(nw_hv ntapi buttOrOver)
    geomStamp(psub_implant nsdi buttOrOver)

)

; procedure for switches METAL_OPTION_7LM_1TM
procedure( switchProc1()
TV1_down_metal=geomCat(EMPTY)
TV2_down_metal=geomCat(M6)
    geomConnect(
        buttOrOver(ALPA PABAR)
        buttOrOver(ALPA PA)
        buttOrOver(PABAR MTT2i)
        buttOrOver(PABAR TM2i)
        buttOrOver(PA MTT2i)
        buttOrOver(PA TM2i)
        buttOrOver(MTT2i VnBAR_topvia2)
        buttOrOver(TM2i VnBAR_topvia2)
        buttOrOver(MTT2i TV2i)  
        buttOrOver(TM2i TV2i)
        buttOrOver(VnBAR_topvia2 M6i)
        buttOrOver(TV2i M6i)
        buttOrOver(M6i VnBAR_via5)
        buttOrOver(M6i V5i)
        buttOrOver(VnBAR_via5 M5i)
        buttOrOver(V5i M5i)
        buttOrOver(M5i VnBAR_via4)
        buttOrOver(M5i V4i)
        buttOrOver(VnBAR_via4 M4i)
        buttOrOver(V4i M4i)
        buttOrOver(M4i VnBAR_via3)
        buttOrOver(M4i V3i)
        buttOrOver(resaa_implant aa_res)
        buttOrOver(respoly_implant poly_res)
        buttOrOver(VnBAR_via3 M3i)
        buttOrOver(V3i M3i)
        buttOrOver(M3i VnBAR_via2)
        buttOrOver(M3i V2i)
        buttOrOver(VnBAR_via2 M2i)
        buttOrOver(V2i M2i)
        buttOrOver(M2i VnBAR_via1)
        buttOrOver(M2i V1i)
        buttOrOver(VnBAR_via1 M1i)
        buttOrOver(V1i M1i)
        via(CTi M1i ntapi)
        via(CTi M1i nsdi)
        via(CTi M1i ptapi)
        via(CTi M1i psdi)
        via(CTi M1i polyInt)
        via(sqct M1i ntapi)
        via(sqct M1i nsdi)
        via(sqct M1i ptapi)
        via(sqct M1i psdi)
        via(sqct M1i polyInt)
        buttOrOver(rule_esd3_aa ESD_all)
        buttOrOver(rule_esd3_aa rule_esd3_sn)
        buttOrOver(rule_esd3_aa rule_esd3_sp)
        label(TM2_text TM2i)
        label(M6_text M6i)
        label(M5_text M5i)
        label(M4_text M4i)
        label(M3_text M3i)
        label(M2_text M2i)
        label(M1_text M1i)
    )
    geomStamp(nw_lv ntapi buttOrOver)
    geomStamp(nw_hv ntapi buttOrOver)
    geomStamp(psub_implant nsdi buttOrOver)

)

; procedure for switches METAL_OPTION_7LM_2TM
procedure( switchProc2()
TV1_down_metal=geomCat(M5)
TV2_down_metal=geomCat(TM1)
    geomConnect(
        buttOrOver(ALPA PABAR)
        buttOrOver(ALPA PA)
        buttOrOver(PABAR MTT2i)
        buttOrOver(PABAR TM2i)
        buttOrOver(PA MTT2i)
        buttOrOver(PA TM2i)
        buttOrOver(MTT2i VnBAR_topvia2)
        buttOrOver(TM2i VnBAR_topvia2)
        buttOrOver(MTT2i TV2i)  
        buttOrOver(TM2i TV2i)
        buttOrOver(VnBAR_topvia2 TM1i)
        buttOrOver(TV2i TM1i)
        buttOrOver(TM1i VnBAR_topvia1)
        buttOrOver(TM1i TV1i)
        buttOrOver(VnBAR_topvia1 M5i)
        buttOrOver(TV1i M5i)
        buttOrOver(M5i VnBAR_via4)
        buttOrOver(M5i V4i)
        buttOrOver(VnBAR_via4 M4i)
        buttOrOver(V4i M4i)
        buttOrOver(M4i VnBAR_via3)
        buttOrOver(M4i V3i)
        buttOrOver(resaa_implant aa_res)
        buttOrOver(respoly_implant poly_res)
        buttOrOver(VnBAR_via3 M3i)
        buttOrOver(V3i M3i)
        buttOrOver(M3i VnBAR_via2)
        buttOrOver(M3i V2i)
        buttOrOver(VnBAR_via2 M2i)
        buttOrOver(V2i M2i)
        buttOrOver(M2i VnBAR_via1)
        buttOrOver(M2i V1i)
        buttOrOver(VnBAR_via1 M1i)
        buttOrOver(V1i M1i)
        via(CTi M1i ntapi)
        via(CTi M1i nsdi)
        via(CTi M1i ptapi)
        via(CTi M1i psdi)
        via(CTi M1i polyInt)
        via(sqct M1i ntapi)
        via(sqct M1i nsdi)
        via(sqct M1i ptapi)
        via(sqct M1i psdi)
        via(sqct M1i polyInt)
        buttOrOver(rule_esd3_aa ESD_all)
        buttOrOver(rule_esd3_aa rule_esd3_sn)
        buttOrOver(rule_esd3_aa rule_esd3_sp)
        label(TM2_text TM2i)
        label(TM1_text TM1i)
        label(M5_text M5i)
        label(M4_text M4i)
        label(M3_text M3i)
        label(M2_text M2i)
        label(M1_text M1i)
    )
    geomStamp(nw_lv ntapi buttOrOver)
    geomStamp(nw_hv ntapi buttOrOver)
    geomStamp(psub_implant nsdi buttOrOver)

)

; procedure for switches METAL_OPTION_8LM_1TM
procedure( switchProc3()
TV1_down_metal=geomCat(EMPTY)
TV2_down_metal=geomCat(M7)
    geomConnect(
        buttOrOver(ALPA PABAR)
        buttOrOver(ALPA PA)
        buttOrOver(PABAR MTT2i)
        buttOrOver(PABAR TM2i)
        buttOrOver(PA MTT2i)
        buttOrOver(PA TM2i)
        buttOrOver(MTT2i VnBAR_topvia2)
        buttOrOver(TM2i VnBAR_topvia2)
        buttOrOver(MTT2i TV2i)  
        buttOrOver(TM2i TV2i)
        buttOrOver(VnBAR_topvia2 M7i)
        buttOrOver(TV2i M7i)
        buttOrOver(M7i VnBAR_via6)
        buttOrOver(M7i V6i)
        buttOrOver(VnBAR_via6 M6i)
        buttOrOver(V6i M6i)
        buttOrOver(M6i VnBAR_via5)
        buttOrOver(M6i V5i)
        buttOrOver(VnBAR_via5 M5i)
        buttOrOver(V5i M5i)
        buttOrOver(M5i VnBAR_via4)
        buttOrOver(M5i V4i)
        buttOrOver(VnBAR_via4 M4i)
        buttOrOver(V4i M4i)
        buttOrOver(M4i VnBAR_via3)
        buttOrOver(M4i V3i)
        buttOrOver(resaa_implant aa_res)
        buttOrOver(respoly_implant poly_res)
        buttOrOver(VnBAR_via3 M3i)
        buttOrOver(V3i M3i)
        buttOrOver(M3i VnBAR_via2)
        buttOrOver(M3i V2i)
        buttOrOver(VnBAR_via2 M2i)
        buttOrOver(V2i M2i)
        buttOrOver(M2i VnBAR_via1)
        buttOrOver(M2i V1i)
        buttOrOver(VnBAR_via1 M1i)
        buttOrOver(V1i M1i)
        via(CTi M1i ntapi)
        via(CTi M1i nsdi)
        via(CTi M1i ptapi)
        via(CTi M1i psdi)
        via(CTi M1i polyInt)
        via(sqct M1i ntapi)
        via(sqct M1i nsdi)
        via(sqct M1i ptapi)
        via(sqct M1i psdi)
        via(sqct M1i polyInt)
        buttOrOver(rule_esd3_aa ESD_all)
        buttOrOver(rule_esd3_aa rule_esd3_sn)
        buttOrOver(rule_esd3_aa rule_esd3_sp)
        label(TM2_text TM2i)
        label(M7_text M7i)
        label(M6_text M6i)
        label(M5_text M5i)
        label(M4_text M4i)
        label(M3_text M3i)
        label(M2_text M2i)
        label(M1_text M1i)
    )
    geomStamp(nw_lv ntapi buttOrOver)
    geomStamp(nw_hv ntapi buttOrOver)
    geomStamp(psub_implant nsdi buttOrOver)

)

; procedure for switches METAL_OPTION_8LM_2TM
procedure( switchProc4()
TV1_down_metal=geomCat(M6)
TV2_down_metal=geomCat(TM1)
    geomConnect(
        buttOrOver(ALPA PABAR)
        buttOrOver(ALPA PA)
        buttOrOver(PABAR MTT2i)
        buttOrOver(PABAR TM2i)
        buttOrOver(PA MTT2i)
        buttOrOver(PA TM2i)
        buttOrOver(MTT2i VnBAR_topvia2)
        buttOrOver(TM2i VnBAR_topvia2)
        buttOrOver(MTT2i TV2i)  
        buttOrOver(TM2i TV2i)
        buttOrOver(VnBAR_topvia2 TM1i)
        buttOrOver(TV2i TM1i)
        buttOrOver(TM1i VnBAR_topvia1)
        buttOrOver(TM1i TV1i)
        buttOrOver(VnBAR_topvia1 M6i)
        buttOrOver(TV1i M6i)
        buttOrOver(M6i VnBAR_via5)
        buttOrOver(M6i V5i)
        buttOrOver(VnBAR_via5 M5i)
        buttOrOver(V5i M5i)
        buttOrOver(M5i VnBAR_via4)
        buttOrOver(M5i V4i)
        buttOrOver(VnBAR_via4 M4i)
        buttOrOver(V4i M4i)
        buttOrOver(M4i VnBAR_via3)
        buttOrOver(M4i V3i)
        buttOrOver(resaa_implant aa_res)
        buttOrOver(respoly_implant poly_res)
        buttOrOver(VnBAR_via3 M3i)
        buttOrOver(V3i M3i)
        buttOrOver(M3i VnBAR_via2)
        buttOrOver(M3i V2i)
        buttOrOver(VnBAR_via2 M2i)
        buttOrOver(V2i M2i)
        buttOrOver(M2i VnBAR_via1)
        buttOrOver(M2i V1i)
        buttOrOver(VnBAR_via1 M1i)
        buttOrOver(V1i M1i)
        via(CTi M1i ntapi)
        via(CTi M1i nsdi)
        via(CTi M1i ptapi)
        via(CTi M1i psdi)
        via(CTi M1i polyInt)
        via(sqct M1i ntapi)
        via(sqct M1i nsdi)
        via(sqct M1i ptapi)
        via(sqct M1i psdi)
        via(sqct M1i polyInt)
        buttOrOver(rule_esd3_aa ESD_all)
        buttOrOver(rule_esd3_aa rule_esd3_sn)
        buttOrOver(rule_esd3_aa rule_esd3_sp)
        label(TM2_text TM2i)
        label(TM1_text TM1i)
        label(M6_text M6i)
        label(M5_text M5i)
        label(M4_text M4i)
        label(M3_text M3i)
        label(M2_text M2i)
        label(M1_text M1i)
    )
    geomStamp(nw_lv ntapi buttOrOver)
    geomStamp(nw_hv ntapi buttOrOver)
    geomStamp(psub_implant nsdi buttOrOver)

)

; procedure for switches METAL_OPTION_9LM_1TM
procedure( switchProc5()
TV1_down_metal=geomCat(EMPTY)
TV2_down_metal=geomCat(M8)
    geomConnect(
        buttOrOver(ALPA PABAR)
        buttOrOver(ALPA PA)
        buttOrOver(PABAR MTT2i)
        buttOrOver(PABAR TM2i)
        buttOrOver(PA MTT2i)
        buttOrOver(PA TM2i)
        buttOrOver(MTT2i VnBAR_topvia2)
        buttOrOver(TM2i VnBAR_topvia2)
        buttOrOver(MTT2i TV2i)
        buttOrOver(TM2i TV2i)
        buttOrOver(VnBAR_topvia2 M8i)
        buttOrOver(TV2i M8i)
        buttOrOver(M8i VnBAR_via7)
        buttOrOver(M8i V7i)
        buttOrOver(VnBAR_via7 M7i)
        buttOrOver(V7i M7i)
        buttOrOver(M7i VnBAR_via6)
        buttOrOver(M7i V6i)
        buttOrOver(VnBAR_via6 M6i)
        buttOrOver(V6i M6i)
        buttOrOver(M6i VnBAR_via5)
        buttOrOver(M6i V5i)
        buttOrOver(VnBAR_via5 M5i)
        buttOrOver(V5i M5i)
        buttOrOver(M5i VnBAR_via4)
        buttOrOver(M5i V4i)
        buttOrOver(VnBAR_via4 M4i)
        buttOrOver(V4i M4i)
        buttOrOver(M4i VnBAR_via3)
        buttOrOver(M4i V3i)
        buttOrOver(resaa_implant aa_res)
        buttOrOver(respoly_implant poly_res)
        buttOrOver(VnBAR_via3 M3i)
        buttOrOver(V3i M3i)
        buttOrOver(M3i VnBAR_via2)
        buttOrOver(M3i V2i)
        buttOrOver(VnBAR_via2 M2i)
        buttOrOver(V2i M2i)
        buttOrOver(M2i VnBAR_via1)
        buttOrOver(M2i V1i)
        buttOrOver(VnBAR_via1 M1i)
        buttOrOver(V1i M1i)
        via(CTi M1i ntapi)
        via(CTi M1i nsdi)
        via(CTi M1i ptapi)
        via(CTi M1i psdi)
        via(CTi M1i polyInt)
        via(sqct M1i ntapi)
        via(sqct M1i nsdi)
        via(sqct M1i ptapi)
        via(sqct M1i psdi)
        via(sqct M1i polyInt)
        buttOrOver(rule_esd3_aa ESD_all)
        buttOrOver(rule_esd3_aa rule_esd3_sn)
        buttOrOver(rule_esd3_aa rule_esd3_sp)
        label(TM2_text TM2i)
        label(M8_text M8i)
        label(M7_text M7i)
        label(M6_text M6i)
        label(M5_text M5i)
        label(M4_text M4i)
        label(M3_text M3i)
        label(M2_text M2i)
        label(M1_text M1i)
    )
    geomStamp(nw_lv ntapi buttOrOver)
    geomStamp(nw_hv ntapi buttOrOver)
    geomStamp(psub_implant nsdi buttOrOver)

)

; procedure for switches METAL_OPTION_9LM_2TM
procedure( switchProc6()
TV1_down_metal=geomCat(M7)
TV2_down_metal=geomCat(TM1)
    geomConnect(
        buttOrOver(ALPA PABAR)
        buttOrOver(ALPA PA)
        buttOrOver(PABAR MTT2i)
        buttOrOver(PABAR TM2i)
        buttOrOver(PA MTT2i)
        buttOrOver(PA TM2i)
        buttOrOver(MTT2i VnBAR_topvia2)
        buttOrOver(TM2i VnBAR_topvia2)
        buttOrOver(MTT2i TV2i)
        buttOrOver(TM2i TV2i)
        buttOrOver(VnBAR_topvia2 TM1i)
        buttOrOver(TV2i TM1i)
        buttOrOver(TM1i VnBAR_topvia1)
        buttOrOver(TM1i TV1i)
        buttOrOver(VnBAR_topvia1 M7i)
        buttOrOver(TV1i M7i)
        buttOrOver(M7i VnBAR_via6)
        buttOrOver(M7i V6i)
        buttOrOver(VnBAR_via6 M6i)
        buttOrOver(V6i M6i)
        buttOrOver(M6i VnBAR_via5)
        buttOrOver(M6i V5i)
        buttOrOver(VnBAR_via5 M5i)
        buttOrOver(V5i M5i)
        buttOrOver(M5i VnBAR_via4)
        buttOrOver(M5i V4i)
        buttOrOver(VnBAR_via4 M4i)
        buttOrOver(V4i M4i)
        buttOrOver(M4i VnBAR_via3)
        buttOrOver(M4i V3i)
        buttOrOver(resaa_implant aa_res)
        buttOrOver(respoly_implant poly_res)
        buttOrOver(VnBAR_via3 M3i)
        buttOrOver(V3i M3i)
        buttOrOver(M3i VnBAR_via2)
        buttOrOver(M3i V2i)
        buttOrOver(VnBAR_via2 M2i)
        buttOrOver(V2i M2i)
        buttOrOver(M2i VnBAR_via1)
        buttOrOver(M2i V1i)
        buttOrOver(VnBAR_via1 M1i)
        buttOrOver(V1i M1i)
        via(CTi M1i ntapi)
        via(CTi M1i nsdi)
        via(CTi M1i ptapi)
        via(CTi M1i psdi)
        via(CTi M1i polyInt)
        via(sqct M1i ntapi)
        via(sqct M1i nsdi)
        via(sqct M1i ptapi)
        via(sqct M1i psdi)
        via(sqct M1i polyInt)
        buttOrOver(rule_esd3_aa ESD_all)
        buttOrOver(rule_esd3_aa rule_esd3_sn)
        buttOrOver(rule_esd3_aa rule_esd3_sp)
        label(TM2_text TM2i)
        label(TM1_text TM1i)
        label(M7_text M7i)
        label(M6_text M6i)
        label(M5_text M5i)
        label(M4_text M4i)
        label(M3_text M3i)
        label(M2_text M2i)
        label(M1_text M1i)
    )
    geomStamp(nw_lv ntapi buttOrOver)
    geomStamp(nw_hv ntapi buttOrOver)
    geomStamp(psub_implant nsdi buttOrOver)

)

; procedure for switches METAL_OPTION_10LM_2TM || !METAL_OPTION_10LM_2TM && !METAL_OPTION_6LM_1TM
; !METAL_OPTION_6LM_2TM && !METAL_OPTION_5LM_2TM && !METAL_OPTION_5LM_1TM && !METAL_OPTION_4LM_1TM
;&& !METAL_OPTION_7LM_1TM && !METAL_OPTION_7LM_2TM && !METAL_OPTION_8LM_1TM && !METAL_OPTION_8LM_2TM
;  && !METAL_OPTION_9LM_1TM && !METAL_OPTION_9LM_2TM
procedure( switchProc7()
TV1_down_metal=geomCat(M8)
TV2_down_metal=geomCat(TM1)
    geomConnect(
        buttOrOver(ALPA PABAR)
        buttOrOver(ALPA PA)
        buttOrOver(PABAR MTT2i)
        buttOrOver(PABAR TM2i)
        buttOrOver(PA MTT2i)
        buttOrOver(PA TM2i)
        buttOrOver(MTT2i VnBAR_topvia2)
        buttOrOver(TM2i VnBAR_topvia2)
        buttOrOver(MTT2i TV2i)
        buttOrOver(TM2i TV2i)
        buttOrOver(VnBAR_topvia2 TM1i)
        buttOrOver(TV2i TM1i)
        buttOrOver(TM1i VnBAR_topvia1)
        buttOrOver(TM1i TV1i)
        buttOrOver(VnBAR_topvia1 M8i)
        buttOrOver(TV1i M8i)
        buttOrOver(M8i VnBAR_via7)
        buttOrOver(M8i V7i)
        buttOrOver(VnBAR_via7 M7i)
        buttOrOver(V7i M7i)
        buttOrOver(M7i VnBAR_via6)
        buttOrOver(M7i V6i)
        buttOrOver(VnBAR_via6 M6i)
        buttOrOver(V6i M6i)
        buttOrOver(M6i VnBAR_via5)
        buttOrOver(M6i V5i)
        buttOrOver(VnBAR_via5 M5i)
        buttOrOver(V5i M5i)
        buttOrOver(M5i VnBAR_via4)
        buttOrOver(M5i V4i)
        buttOrOver(VnBAR_via4 M4i)
        buttOrOver(V4i M4i)
        buttOrOver(M4i VnBAR_via3)
        buttOrOver(M4i V3i)
        buttOrOver(resaa_implant aa_res)
        buttOrOver(respoly_implant poly_res)
        buttOrOver(VnBAR_via3 M3i)
        buttOrOver(V3i M3i)
        via(VnBAR_via2 M3i M2i)
        via(V2i M3i M2i)
        via(VnBAR_via1 M2i M1i)
        via(V1i M2i M1i)
        via(CTi M1i ntapi)
        via(CTi M1i nsdi)
        via(CTi M1i ptapi)
        via(CTi M1i psdi)
        via(CTi M1i polyInt)
        via(sqct M1i ntapi)
        via(sqct M1i nsdi)
        via(sqct M1i ptapi)
        via(sqct M1i psdi)
        via(sqct M1i polyInt)
        buttOrOver(rule_esd3_aa ESD_all)
        buttOrOver(rule_esd3_aa rule_esd3_sn)
        buttOrOver(rule_esd3_aa rule_esd3_sp)
        label(TM2_text TM2i)
        label(TM1_text TM1i)
        label(M8_text M8i)
        label(M7_text M7i)
        label(M6_text M6i)
        label(M5_text M5i)
        label(M4_text M4i)
        label(M3_text M3i)
        label(M2_text M2i)
        label(M1_text M1i)
    )
    geomStamp(nw_lv ntapi buttOrOver)
    geomStamp(nw_hv ntapi buttOrOver)
    geomStamp(psub_implant nsdi buttOrOver)

)


exclu1=geomGetLength(EXCLU keep>0.001)
exclu2=geomWithEdge(EXCLU exclu1)
errorLayer(exclu1 "EXCLU_1: report DRC alert if EXCLU is used")

procedure(
  kshBuildRect( inLayer1 inLayer2 edgeLayer12 incr_value maxLay2Width )
    rect = geomOr( inLayer1 )
    let((i)
    k     = ceiling( maxLay2Width / (incr_value + 0.05) )
    incr1 = incr_value
    incr2 = incr_value + 0.01
   for( i 1 k
     rect1 = geomSize( edgeLayer12 incr1 ) ; smaller rect
     rect2 = geomSize( rect1 0.005 )       ; medium rect
     rect3 = geomSize( edgeLayer12 incr2 ) ; bigger rect
     rect  = geomOr( geomAnd( geomAnd( rect2 rect3 ) inLayer2 ) rect )
     edgeLayer12 = geomGetEdge( rect2 inside geomAnd( rect3 inLayer2 ) )
      );for
    );let
); end proc KshBuildRect

procedure(
  V67Dold( inVIA inME1 inME2)
  X0_M_W=geomWidth(inME1 keep>0.14)
  inME12=geomAnd(inME1 inME2)
  X0_M_AND = geomEncloseRect(inME12 0.07 0.27)
  X0_V = geomInside(inVIA X0_M_AND)
  X0_V1=drc(X0_M_W X0_V enc < 0.015)
  X0_V2=geomGetEdge(X0_V butting X0_M_W)
  X0_V3=geomSize(X0_V2 0.01 edges)
  X1_SMALL_ENC = geomOr(X0_V1 X0_V3)
  X1_V = geomButtOrOver(X0_V X1_SMALL_ENC)
  X1_AND = geomButtOrOver(X0_M_AND X1_V)
  X2_M_SINGLE1=geomButtOrOver(X0_M_AND X0_V keep==1)
  X2_M_SINGLE2=geomButtOrOver(X2_M_SINGLE1 X0_M_W)
  X2_M_SINGLE =geomButtOrOver(X2_M_SINGLE2 X1_SMALL_ENC)
  X2_V_SINGLE =geomInside( X1_V X2_M_SINGLE)
  X3_V =geomAndNot(X1_V X2_V_SINGLE)
  X3_FAIL = drc(inME1 X3_V venc(enc1<0 enc2<0.03 enc3<0.03 enc4<0.03))
  V67D_Fold=geomOr(X2_V_SINGLE X3_FAIL)
)

;Procedure for M1_6_6a_6b_6c Mn_6_6a_6b_6c

procedure( Mn_6( MTLAY MTLEN MTWID MTSPA )
mtw=geomWidth(MTLAY keep>MTWID)
mtsi=drc(mtw sepNotch<MTSPA opposite parallel shielded)
mts=geomWithEdge(mtsi geomGetLength(mtsi keep>MTLEN))
)

procedure( Mn_6a( MTLAY MTLEN MTWID MTSPA )
mtw=geomWidth(MTLAY keep>MTWID)
mtsi=drc(MTLAY mtw sep<MTSPA opposite parallel shielded)
mts=geomWithEdge(mtsi geomGetLength(mtsi keep>MTLEN))
)

procedure( Mn_6b( MTLAY MTLEN MTW1 MTW2 MTSPA )
mtww1=geomWidth(MTLAY keep>MTW1)
mtww2=geomWidth(MTLAY keep>MTW2)
mtsi=drc(mtww1 mtww2 sep<MTSPA opposite parallel shielded)
mts=geomWithEdge(mtsi geomGetLength(mtsi keep>MTLEN))
)

procedure( Mn_6c( MTLAY MTLEN MTW MTSPA )
mtww=geomWidth(MTLAY keep>MTW)
mtsi=drc(MTLAY mtww sep<MTSPA opposite parallel shielded)
mts=geomWithEdge(mtsi geomGetLength(mtsi keep>MTLEN))
)

procedure(
   V67D(VLAY M_WIDE M_OTHER)
   XO_M_W= geomWidth(M_WIDE keep>0.14)
   inME12=geomAnd(M_WIDE M_OTHER)
  X0_M_AND = geomEncloseRect(inME12 0.07 0.27)
  XO_M_AND_W=geomButtOrOver(X0_M_AND XO_M_W)
  V67D_F=geomButtOrOver(XO_M_AND_W VLAY keep ==1)
)

procedure( TM56( MTLAY MTLEN MTWID MTSPA )
span_edge1=drc(MTLAY width<=MTWID opposite)
span_edge=geomAndNot(MTLAY geomOr(geomGetEdge(MTLAY coincident span_edge1) geomGetEdge(MTLAY butting span_edge1)))
span_region=drc(span_edge MTLAY sep<MTSPA opposite)
X_length=geomGetLength(span_region keep>MTLEN)
tms=drc( X_length width<MTSPA opposite)
)

; procedure for switches DENSITY_CHECKS
procedure( switchProc9()
    errorLayer(rule_AAC1
        "AA_C_1: Maximum containing rectangle of HDA(um) 250x250")

    errorLayer(rule_AAC3
        "AA_C_3: Maximum containing rectangle of LDA(um) 50x50")

    errorLayer(rule_AAC4
        "AA_C_4: Maximum containing rectangle of MDA(um) 125x125")

    L27630=geomWidth(aa_LDA keep>=50)
    aac5a=geomSize(L27630 20)
    aac5b=geomGetLength(geomOr(geomGetEdge(AA coincident gate) geomGetEdge(AA butting gate)) keep<0.06)
    aac5c=geomAnd(geomAndNot(geomWithEdge(gate aac5b) L27630) aac5a)
    errorLayer(aac5c
        "AA_C_5: Minimum space between gate and minimum 50*50um LDA >= 20.000,Waive if the gate channel length >= 0.06um")

)
; procedure for switches DFM_priority_1_CHECKS
procedure( switchProc10()
    MOMM1=geomButtOrOver(geomOr(M1 M2) geomButtOrOver(MnPIN geomSize(MOMDMY 0.114)))
    rule_DFM5_11=drc(geomAndNot(M1 geomOr(geomOr(MOMM1 INDMY) MOMDMY)) sepNotch==0.070 opposite parallel)
    rule_DFM5_12=geomWithEdge(rule_DFM5_11 geomGetLength(rule_DFM5_11 keep>20))
    errorLayer(rule_DFM5_12
          "DFM_5_M1: Maximum length of parallel M1 lines with minimum spacing, designer can waive the violations if design passes sign-off level signal integrity check  <= 20.000")

    MOMM2=geomButtOrOver(geomOr(geomOr(M2 M1) M3) geomButtOrOver(MnPIN geomSize(MOMDMY 0.114)))
    rule_DFM5_21=drc(geomAndNot(M2 geomOr(geomOr(MOMM2 INDMY) MOMDMY)) sepNotch==0.070 opposite parallel)
    rule_DFM5_22=geomWithEdge(rule_DFM5_21 geomGetLength(rule_DFM5_21 keep>20))
    errorLayer(rule_DFM5_22
          "DFM_5_M2: Maximum length of parallel M2 lines with minimum spacing, designer can waive the violations if design passes sign-off level signal integrity check  <= 20.000")

MOMM3=geomButtOrOver(geomOr(geomOr(M3 M2) M4) geomButtOrOver(MnPIN geomSize(MOMDMY 0.114)))
    rule_DFM5_31=drc(geomAndNot(M3 geomOr(geomOr(MOMM3 INDMY) MOMDMY)) sepNotch==0.070 opposite parallel)
    rule_DFM5_32=geomWithEdge(rule_DFM5_31 geomGetLength(rule_DFM5_31 keep>20))
    errorLayer(rule_DFM5_32
          "DFM_5_M3: Maximum length of parallel M3 lines with minimum spacing, designer can waive the violations if design passes sign-off level signal integrity check  <= 20.000")

    MOMM4=geomButtOrOver(geomOr(geomOr(M4 M3) M5) geomButtOrOver(MnPIN geomSize(MOMDMY 0.114)))
    rule_DFM5_1=drc(geomAndNot(M4 geomOr(geomOr(MOMM4 INDMY) MOMDMY)) sepNotch==0.070 opposite parallel)
    rule_DFM5_2=geomWithEdge(rule_DFM5_1 geomGetLength(rule_DFM5_1 keep>20))
    errorLayer(rule_DFM5_2
          "DFM_5_M4: Maximum length of parallel M4 lines with minimum spacing, designer can waive the violations if design passes sign-off level signal integrity check  <= 20.000")

    
    MOMM5=geomButtOrOver(geomOr(geomOr(M5 M4) M6) geomButtOrOver(MnPIN geomSize(MOMDMY 0.114)))
    rule_DFM5_51=drc(geomAndNot(M5 geomOr(geomOr(MOMM5 INDMY) MOMDMY)) sepNotch==0.070 opposite parallel)
    rule_DFM5_52=geomWithEdge(rule_DFM5_51 geomGetLength(rule_DFM5_51 keep>20))
    errorLayer(rule_DFM5_52
          "DFM_5_M5: Maximum length of parallel M5 lines with minimum spacing, designer can waive the violations if design passes sign-off level signal integrity check  <= 20.000")




    L94349=geomWidth(NW keep>=0.89)
    L41167=geomAndNot(NW L94349)
    L97892=geomGetEdge(NW coincident L41167)
    L82937=drc(L97892 sepNotch<0.89 opposite edgea)
    L69558=geomGetLength(L82937 keep>50)
    errorLayer(L69558
        "DFM_26: For parallel long NW (length > 50um), must make NW width larger than 0.89um or NW to NW space larger than 0.89um")



;DFM.4
m1m2 = geomStraddle( M1 M2  )
ma = geomOverlap( M2 m1m2 )
m12 = geomAnd( m1m2 M2 )
m12_edge_sized = geomSize( m1m2 0.005 edges )
m_edge_sized_inside_12 = geomInside( m12_edge_sized ma )
m_edge_inside_12 = geomGetEdge( m12 butting m_edge_sized_inside_12 )
kshBuildRect(m12 ma m_edge_inside_12 0.07 4.5 )
m12_c = drc( m12 rect coverage > 0.2 )
dfm4_v1 = geomGetCoverage( m12_c keep > 0.2 )
errorLayer( geomEnclose( dfm4_v1 V1 keep < 2 ) "DFM_4_V1: Insert one V1 if single V1 and (Wm1>=5Wm2 or Wm2>=5Wm1) at enclosure" )

m2m3 = geomStraddle( M2 M3  )
mb = geomOverlap( M3 m2m3 )
m23 = geomAnd( m2m3 M3 )
m23_edge_sized = geomSize( m2m3 0.005 edges )
m_edge_sized_inside_23 = geomInside( m23_edge_sized mb )
m_edge_inside_23 = geomGetEdge( m23 butting m_edge_sized_inside_23 )
kshBuildRect(m23 mb m_edge_inside_23 0.07 4.5 )
m23_c = drc( m23 rect coverage > 0.2 )
dfm4_v2 = geomGetCoverage( m23_c keep > 0.2 )
errorLayer( geomEnclose( dfm4_v2 V2 keep < 2 ) "DFM_4_V2: Insert one V2 if single V2 and (Wm2>=5Wm3 or Wm3>=5Wm2) at enclosure" )

m3m4 = geomStraddle( M3 M4  )
mb = geomOverlap( M4 m3m4 )
m34 = geomAnd( m3m4 M4 )
m34_edge_sized = geomSize( m3m4 0.005 edges )
m_edge_sized_inside_34 = geomInside( m34_edge_sized mb )
m_edge_inside_34 = geomGetEdge( m34 butting m_edge_sized_inside_34 )
kshBuildRect(m34 mb m_edge_inside_34 0.07 4.5 )
m34_c = drc( m34 rect coverage > 0.2 )
dfm4_v3 = geomGetCoverage( m34_c keep > 0.2 )
errorLayer( geomEnclose( dfm4_v3 V3 keep < 2 ) "DFM_4_V3: Insert one V3 if single V3 and (Wm2>=5Wm3 or Wm3>=5Wm2) at enclosure" )

m4m5 = geomStraddle( M4 M5  )
ma = geomOverlap( M5 m4m5 )
m45 = geomAnd( m4m5 M5 )
m45_edge_sized = geomSize( m4m5 0.005 edges )
m_edge_sized_inside_45 = geomInside( m45_edge_sized ma )
m_edge_inside_45 = geomGetEdge( m45 butting m_edge_sized_inside_45 )
kshBuildRect(m45 ma m_edge_inside_45 0.07 4.5 )
m45_c = drc( m45 rect coverage > 0.2 )
dfm4_v4 = geomGetCoverage( m45_c keep > 0.2 )
errorLayer( geomEnclose( dfm4_v4 V4 keep < 2 ) "DFM_4_V4: Insert one V4 if single V4 and (Wm1>=5Wm2 or Wm2>=5Wm1) at enclosure" )


)

; procedure for switches DFM_priority_2_CHECKS
procedure( switchProc11()

    L89705=drc(aa90c_e poly_mos_l2w45 sep<0.050 parallel)
    L89706=geomAndNot(geomOverlap(L89705 aa_mos) INST)
    errorLayer(L89706
        "DFM_1: Space between L-shaped AA to GT in the same MOS >= 0.050")

    L20793=drc(gt90c_e L23337 sep<0.050 parallel opposite)
    L20794=geomGetEdge(L20793 butting AA)
    L20795=geomAndNot(geomGetLength(L20794 keep>=0.055) INST)
    errorLayer(L20795
        "DFM_2: Space between L-shaped GT to AA in the same MOS >= 0.050")

    rule_dfm_1a_a=drc(aa90c_e poly_mos_l2wl45 sep<0.050 parallel)
    rule_dfm_1a=geomOverlap(rule_dfm_1a_a aa_mos)
    errorLayer(rule_dfm_1a
        "DFM_1a: If channel length < 0.2um, channel width>0.45um, space between L-shaped AA to GT in the same MOS is 0.05")

    rule_dfm_2a_a=drc(gt90c_e L23338 sep<0.050 parallel)
    rule_dfm_2a=geomOverlap(rule_dfm_2a_a poly_mos)
    errorLayer(rule_dfm_2a
        "DFM_2a: If channel length < 0.2um, channel width>0.45um, and L-shape GT length ( L R 0.055um), space between L-shaped GT to AA in the same MOS.")

    dfm03a=geomAndNot(AA geomOr(INDMY LDBK))
    dfm03b=drc(geomAndNot(GT geomOr(INDMY LDBK)) geomOr(geomGetEdge(dfm03a coincident gate) geomGetEdge(dfm03a butting gate)) enc<0.1 withIntersection)
    errorLayer(dfm03b
        "DFM_3: Minimum extension of poly outside of AA to form poly end-cap >= 0.100")

    ;L31591=geomStraddle(CT M1)
    L80696=geomAndNot(ctm1 M1)
    errorLayer(L80696 "DFM_6: CT minimum within M1 >= 0.025")
    L74308=drc(ctm1 CT venc(enc1<0.025 enc2<0.025 enc3<0.025 enc4<0.025))
    errorLayer(L74308 "DFM_6: CT minimum within M1 >= 0.025")
    
    dfm07aa1=geomGetLength(AA keep>0.001)
    dfm07aa=geomSelectEdge(dfm07aa1 length keep<0.06 angle1(keep>0 length keep<0.06) angle2(keep>0))
    errorLayer(dfm07aa "DFM_7_AA:For any geometry on AA,an edge of length < 1.0xWmin can not have any adjacent edge with length < 1.0xWmin")

    dfm07gt1=geomGetLength(GT keep>0.001)
    dfm07gt=geomSelectEdge(dfm07gt1 length keep<0.04 angle1(keep>0 length keep<0.04) angle2(keep>0))
    errorLayer(dfm07gt "DFM_7_GT:For any geometry on GT,an edge of length < 1.0xWmin can not have any adjacent edge with length < 1.0xWmin")

    dfm07nw1=geomGetLength(NW keep>0.001)
    dfm07nw=geomSelectEdge(dfm07nw1 length keep<0.33 angle1(keep>0 length keep<0.33) angle2(keep>0))
    errorLayer(dfm07nw "DFM_7_NW:For any geometry on NW,an edge of length < 1.0xWmin can not have any adjacent edge with length < 1.0xWmin")

    dfm07m11=geomGetLength(M1 keep>0.001)
    dfm07m1=geomSelectEdge(dfm07m11 length keep<0.07 angle1(keep>0 length keep<0.07) angle2(keep>0))
    errorLayer(dfm07m1 "DFM_7_M1:For any geometry on M1,an edge of length < 1.0xWmin can not have any adjacent edge with length < 1.0xWmin")

    
    dfm07m21=geomGetLength(M2 keep>0.001)
    dfm07m2=geomSelectEdge(dfm07m21 length keep<0.07 angle1(keep>0 length keep<0.07) angle2(keep>0))
    errorLayer(dfm07m2 "DFM_7_M2:For any geometry on M2,an edge of length < 1.0xWmin can not have any adjacent edge with length < 1.0xWmin")

    dfm07m31=geomGetLength(M3 keep>0.001)
    dfm07m3=geomSelectEdge(dfm07m31 length keep<0.07 angle1(keep>0 length keep<0.07) angle2(keep>0))
    errorLayer(dfm07m3 "DFM_7_M3:For any geometry on m3,an edge of length < 1.0xWmin can not have any adjacent edge with length < 1.0xWmin")

    dfm07m41=geomGetLength(M4 keep>0.001)
    dfm07m4=geomSelectEdge(dfm07m41 length keep<0.07 angle1(keep>0 length keep<0.07) angle2(keep>0))
    errorLayer(dfm07m4 "DFM_7_M4:For any geometry on m4,an edge of length < 1.0xWmin can not have any adjacent edge with length < 1.0xWmin")

    dfm07m51=geomGetLength(M5 keep>0.001)
    dfm07m5=geomSelectEdge(dfm07m51 length keep<0.07 angle1(keep>0 length keep<0.07) angle2(keep>0))
    errorLayer(dfm07m5 "DFM_7_M5:For any geometry on m5,an edge of length < 1.0xWmin can not have any adjacent edge with length < 1.0xWmin")

    dfm07m61=geomGetLength(M6 keep>0.001)
    dfm07m6=geomSelectEdge(dfm07m61 length keep<0.07 angle1(keep>0 length keep<0.07) angle2(keep>0))
    errorLayer(dfm07m6 "DFM_7_M6:For any geometry on m6,an edge of length < 1.0xWmin can not have any adjacent edge with length < 1.0xWmin")

    dfm07m71=geomGetLength(M7 keep>0.001)
    dfm07m7=geomSelectEdge(dfm07m71 length keep<0.07 angle1(keep>0 length keep<0.07) angle2(keep>0))
    errorLayer(dfm07m7 "DFM_7_M7:For any geometry on m7,an edge of length < 1.0xWmin can not have any adjacent edge with length < 1.0xWmin")

    dfm07m81=geomGetLength(M8 keep>0.001)
    dfm07m8=geomSelectEdge(dfm07m81 length keep<0.07 angle1(keep>0 length keep<0.07) angle2(keep>0))
    errorLayer(dfm07m8 "DFM_7_M8:For any geometry on m8,an edge of length < 1.0xWmin can not have any adjacent edge with length < 1.0xWmin")

    ;L65891=geomGetEdge(gate_lv inside aa_mos_lv)
    dfm08a=geomGetEdge(GT inside geomAndNot(AA geomOr(DG TG)))
    L65131=drc(dfm08a width<0.044)
    errorLayer(L65131
        "DFM_8: GT minimum length for 0.9/1.1/1.2V N/P MOS transistors (std, high, or low VT) >= 0.044")
     
     dfm09a=drc(geomAndNot(AA geomOr(LDBK INDMY)) geomAndNot(geomOutside(GT INST) geomOr(LDBK INDMY)) enc<0.07 withIntersection withSingularPoint)
     errorLayer(dfm09a "DFM_9: Extension of AA outside of GT >= 0.070")

    aa_notch=drc(AA sepNotch<=0.210 opposite)
    aa_edge1=geomGetLength(AA keep>0.001)
    aa_edge=geomSelectEdge(aa_edge1 length keep<=0.21 angle1(269.9<keep<270.1) angle2(269.9<keep<270.1))
    aa_region=geomSize(aa_edge 0.001 edges)
    dfm10x=drc(geomButtOrOver(GT AA) aa_edge sep<0.09 opposite)
    dfm10=geomInside(geomEnclose(dfm10x aa_region) aa_notch)
    errorLayer(dfm10
        "DFM_10: Distance from poly to a perpendicular AA U inside vertex, where the AA vertex distance is <= 0.210 um >= 0.090")

   ; errorLayer(rule_DFM11
       ; "DFM_11: poly minimum overlap past AA when poly to AA inner vertex distance < 0.060 um >= 0.110")

    gtextaa=drc(GT AA enc<0.13 opposite)
    gatespcaa=drc(gate AA sep<0.04 only_perp)
    dfm12=geomWithEdge(gtextaa geomOr(geomGetEdge(gtextaa coincident gatespcaa wholeEdge) geomGetEdge(gtextaa butting gatespcaa wholeEdge)))
    errorLayer(dfm12
        "DFM_12: poly minimum overlap past AA when poly to AA inner vertex distance < 0.040 um >= 0.130")
    
    dfm13_array=geomSize(geomSize(geomSize(CT 0.09) -0.3) 0.21)
    L64957=drc(dfm13_array sepNotch<0.18 opposite)
    L99496=geomGetLength(L64957 keep>0.34)
    dfm13=geomOr(geomGetEdge(L64957 coincident L99496) geomGetEdge(L64957 butting L99496))
    errorLayer(dfm13
        "DFM_13: CT array minimum space to CT array for run length > 0.34 um >= 0.180")

    dfm14a=drc(geomOutside(interct INST) AA sep<0.05 withIntersection withSingularPoint)
    errorLayer(dfm14a
        "DFM_14: Minimum space between AA region and contact overlap poly >= 0.050")

    dfm15=drc(gate geomOutside(act_ct INST) sep<0.05 withIntersection withSingularPoint)
    errorLayer(dfm15
        "DFM_15: 0.9/1.1/1.2V device minimum space between poly region and contact overlap AA >= 0.050")

    errorLayer(rule_m17dfm28
    "DFM_28: CT enclosed by M1 when M1 width >= 0.12")

    v1_inter=geomInside(V1 geomAnd(M1 M2))
    dfm29v1a=geomButtOrOver(geomAnd(M1 M2) v1_inter keep<2)
    dfm29v1= geomOutside(dfm29v1a INST)
   errorLayer(dfm29v1 "DFM_29_V1:At least two vias Vn, TV1, TV2, n=1~7 in Mn and Mn+1 M1, Mn, n=2~8, TM1, TM2 intersection area,This rule is not applicable for SRAM region, but SRAM region should follow main rule: V1_16, V1_17, Vn.16, Vn.17, TV1_13, TV2_13, TV2_14")

    v2_inter=geomInside(V2 geomAnd(M2 M3))
    dfm29v2a=geomButtOrOver(geomAnd(M3 M2) v2_inter keep<2)
    dfm29v2= geomOutside(dfm29v2a INST)
   errorLayer(dfm29v2 "DFM_29_V2:At least two vias Vn, TV1, TV2, n=1~7 in Mn and Mn+1 M1, Mn, n=2~8, TM1, TM2 intersection area,This rule is not applicable for SRAM region, but SRAM region should follow main rule: V1_16, V1_17, Vn.16, Vn.17, TV1_13, TV2_13, TV2_14")

 v3_inter=geomInside(V3 geomAnd(M4 M3))
    dfm29v3a=geomButtOrOver(geomAnd(M3 M4) v3_inter keep<2)
    dfm29v3= geomOutside(dfm29v3a INST)
   errorLayer(dfm29v3 "DFM_29_V3:At least two vias Vn, TV1, TV2, n=1~7 in Mn and Mn+1 M1, Mn, n=2~8, TM1, TM2 intersection area,This rule is not applicable for SRAM region, but SRAM region should follow main rule: V1_16, V1_17, Vn.16, Vn.17, TV1_13, TV2_13, TV2_14")


 v4_inter=geomInside(V4 geomAnd(M4 M5))
    dfm29v4a=geomButtOrOver(geomAnd(M4 M5) v4_inter keep<2)
    dfm29v4= geomOutside(dfm29v4a INST)
   errorLayer(dfm29v4 "DFM_29_V4:At least two vias Vn, TV1, TV2, n=1~7 in Mn and Mn+1 M1, Mn, n=2~8, TM1, TM2 intersection area,This rule is not applicable for SRAM region, but SRAM region should follow main rule: V1_16, V1_17, Vn.16, Vn.17, TV1_13, TV2_13, TV2_14")


 v5_inter=geomInside(V5 geomAnd(M5 M6))
    dfm29v5a=geomButtOrOver(geomAnd(M5 M6) v5_inter keep<2)
    dfm29v5= geomOutside(dfm29v5a INST)
   errorLayer(dfm29v5 "DFM_29_V5:At least two vias Vn, TV1, TV2, n=1~7 in Mn and Mn+1 M1, Mn, n=2~8, TM1, TM2 intersection area,This rule is not applicable for SRAM region, but SRAM region should follow main rule: V1_16, V1_17, Vn.16, Vn.17, TV1_13, TV2_13, TV2_14")


 v6_inter=geomInside(V6 geomAnd(M6 M7))
    dfm29v6a=geomButtOrOver(geomAnd(M6 M7) v6_inter keep<2)
    dfm29v6= geomOutside(dfm29v6a INST)
   errorLayer(dfm29v6 "DFM_29_V6:At least two vias Vn, TV1, TV2, n=1~7 in Mn and Mn+1 M1, Mn, n=2~8, TM1, TM2 intersection area,This rule is not applicable for SRAM region, but SRAM region should follow main rule: V1_16, V1_17, Vn.16, Vn.17, TV1_13, TV2_13, TV2_14")


 v7_inter=geomInside(V7 geomAnd(M7 M8))
    dfm29v7a=geomButtOrOver(geomAnd(M7 M8) v7_inter keep<2)
    dfm29v7= geomOutside(dfm29v7a INST)
   errorLayer(dfm29v7 "DFM_29_V7:At least two vias Vn, TV1, TV2, n=1~7 in Mn and Mn+1 M1, Mn, n=2~8, TM1, TM2 intersection area,This rule is not applicable for SRAM region, but SRAM region should follow main rule: V1_16, V1_17, Vn.16, Vn.17, TV1_13, TV2_13, TV2_14")


 tv1_inter=geomInside(TV1 geomAnd(TM1 TV1_down_metal))
    dfm29tv1a=geomButtOrOver(geomAnd(TM1 TV1_down_metal) tv1_inter keep<2)
    dfm29tv1= geomOutside(dfm29tv1a INST)
   errorLayer(dfm29tv1 "DFM_29_TV1:At least two vias Vn, TV1, TV2, n=1~7 in Mn and Mn+1 M1, Mn, n=2~8, TM1, TM2 intersection area,This rule is not applicable for SRAM region, but SRAM region should follow main rule: V1_16, V1_17, Vn.16, Vn.17, TV1_13, TV2_13, TV2_14")

 tv2_inter=geomInside(TV2 geomAnd(TV2_down_metal TM2))
    dfm29tv2a=geomButtOrOver(geomAnd(TV2_down_metal TM2) tv2_inter keep<2)
    dfm29tv2= geomOutside(dfm29tv2a INST)
   errorLayer(dfm29tv2 "DFM_29_TV2:At least two vias Vn, TV1, TV2, n=1~7 in Mn and Mn+1 M1, Mn, n=2~8, TM1, TM2 intersection area,This rule is not applicable for SRAM region, but SRAM region should follow main rule: V1_16, V1_17, Vn.16, Vn.17, TV1_13, TV2_13, TV2_14")



)
; procedure for switches DFM_priority_3_CHECKS
procedure( switchProc12()
    L38364=drc(M1 width<0.08)
    errorLayer(L38364 "DFM_18: M1 minimum width >= 0.080")

    L11626=drc(geomOutside(M1 SRAM) sepNotch<0.08)
    errorLayer(L11626 "DFM_19: M1 minimum space >= 0.080")

    m1si=drc(M1W sep<0.12 opposite parallel)
    M1S=geomAndNot(m1si geomInside(m1si INST))
    L26188=geomWithEdge(M1S geomGetLength(M1S keep>0.300))
    errorLayer(L26188
        "DFM_20: Minimum space between two length >= 0.3um parallel lines with one or both metal line width is >= 0.22um >= 0.120")


    rule_DFM21_V1=drc(V1i sep<0.1100 diffNet opposite)
        errorLayer(geomOutside(rule_DFM21_V1 INST)
            "DFM_21: V1 (different net) minimum space for run length > 0um >= 0.100")

    L41371=drc(M2 width<0.08)
    errorLayer(L41371 "DFM_22_M2: M2 minimum width >= 0.080")

    L77449=drc(geomOutside(M2 INST) sepNotch<0.08)
    errorLayer(L77449 "DFM_23_M2: M2 minimum space >= 0.080")

    L95252=drc(M2W sep<0.12 opposite parallel)
    L76983=geomWithEdge(L95252 geomGetLength(L95252 keep>0.300))
    errorLayer(L76983
        "DFM_24_M2: Minimum space between two length >= 0.3um parallel lines with one or both metal line width is >= 0.22um >= 0.120")

    L44378=drc(M3 width<0.08)
    errorLayer(L44378 "DFM_22_M3: M3 minimum width >= 0.080")

    L43272=drc(M3 sepNotch<0.08)
    errorLayer(L43272 "DFM_23_M3: M3 minimum space >= 0.080")

    L63021=drc(M3W sep<0.12 opposite parallel)
    L59530=geomWithEdge(L63021 geomGetLength(L63021 keep>0.300))
    errorLayer(L59530
        "DFM_24_M3: Minimum space between two length >= 0.3um parallel lines with one or both metal line width is >= 0.22um >= 0.120")



    rule_DFM25_V2=drc(V2i sep<0.1100 diffNet opposite)
    errorLayer(rule_DFM25_V2
        "DFM_25_V2: minimum space in different net for run length > 0 um")


)

; procedure for switches METAL_OPTION_10LM_2TM
procedure( switchProc13()
    L52989=geomAndNot(TV1 M8)
    L66105=drc(M8 TV1 enc<0.01 figb)
    L52928=geomOr(L52989 L66105)
    errorLayer(L52928
        "TV1_4_5_6: TV1 enclosure by M8 >= 0.010, Extension of M8 line end outside of TV1 >= 0.050, For TV1 located at the 90 degree corner, one side of M8 enclosure must be as TV1_4 and the other side follows TV1_5")
    L76738=geomAnd(M8 TV1)
;   L66105=drc(M8 L76738 enc<0.01 figb)
;   L57664=geomAndNot(L76738 L66105)
;   L64072=drc(M8 L57664 venc(enc1<0.05 enc2<0 enc3<0.05 enc4<0))
    L64072=drc(M8 L76738 venc(enc1<0.05 enc2<0.01 enc3<0.05 enc4<0.01))
    errorLayer(L64072
        "TV1_4_5_6: TV1 enclosure by M8 >= 0.010, Extension of M8 line end outside of TV1 >= 0.050, For TV1 located at the 90 degree corner, one side of M8 enclosure must be as TV1_4 and the other side follows TV1_5")

    L87307=geomWidth(M8 keep>1.8)
    tv1_13a1=geomButtOrOver( geomAnd(M8 TM1) L87307)
    tv1_13a=geomWidth(TM1 keep>1.8)
    tv1_13a2=geomButtOrOver( geomAnd(M8 TM1) tv1_13a)
    tv1_13a3=geomButtOrOver(geomOr(tv1_13a1 tv1_13a2) TV1 keep==1)
      errorLayer(tv1_13a3
        "TV1_13: At least 2 TV1 if Mx width>1.8 um")



if( avSwitch("DFM_priority_1_CHECKS") then

;DFM.4
m8tm1 = geomStraddle( M8 TM1  )
ma = geomOverlap( TM1 m8tm1 )
m81 = geomAnd( m8tm1 TM1 )
m81_edge_sized = geomSize( m8tm1 0.005 edges )
m_edge_sized_inside_81 = geomInside( m81_edge_sized ma )
m_edge_inside_81 = geomGetEdge( m81 butting m_edge_sized_inside_81 )
kshBuildRect(m81 ma m_edge_inside_81 0.07 4.5 )
m81_c = drc( m81 rect coverage > 0.2 )
dfm4_tv1 = geomGetCoverage( m81_c keep > 0.2 )
errorLayer( geomEnclose( dfm4_tv1 TV1 keep < 2 ) "DFM_4: Insert one TV1 if single TV1 and (Wm1>=5Wm2 or Wm2>=5Wm1) at enclosure" )

)


)




; procedure for switches METAL_OPTION_7LM_1TM
procedure( switchProc14()
    L76448=geomAndNot(TV2 M6)
    L15514=drc(M6 TV2 enc<0.01 figb)
    L15515=geomOr(L76448 L15514)
    errorLayer(L15515
        "TV2_4_5_6: TV2 enclosure by M6 >= 0.010, Extension of M6 line end outside of TV2 >= 0.050, For TV2 located at the 90 degree corner, one side of M6 enclosure must be as TV2_4 and the other side follows TV2_5")
    L18467=geomAnd(M6 TV2)
;   L15514=drc(M6 L18467 enc<0.01 figb)
;   L25395=geomAndNot(L18467 L15514)
;   L92004=drc(M6 L25395 venc(enc1<0.05 enc2<0 enc3<0.05 enc4<0))
    L92004=drc(M6 L18467 venc(enc1<0.05 enc2<0.01 enc3<0.05 enc4<0.01))
    errorLayer(L92004
        "TV2_4_5_6: TV2 enclosure by M6 >= 0.010, Extension of M6 line end outside of TV2 >= 0.050, For TV2 located at the 90 degree corner, one side of M6 enclosure must be as TV2_4 and the other side follows TV2_5")

    L87307=geomWidth(M6 keep>1.8)
    tv2_14a1=geomButtOrOver( geomAnd(M6 TM2) L87307)
    tv2_14a=geomWidth(TM2 keep>1.8)
    tv2_14a2=geomButtOrOver( geomAnd(M6 TM2) tv2_14a)
    tv2_14a3=geomButtOrOver(geomOr(tv2_14a1 tv2_14a2) TV2 keep<2)
      errorLayer(tv2_14a3
        "TV2_14: At least 2 TV2 within M6 and TM2 intersection area.  One of the M6 and TM2 width > 1.8 um")


)

; procedure for switches METAL_OPTION_6LM_1TM
procedure( switchProc217()
    L76448=geomAndNot(TV2 M5)
    L15514=drc(M5 TV2 enc<0.01 figb)
    L15515=geomOr(L76448 L15514)
    errorLayer(L15515
        "TV2_4_5_6: TV2 enclosure by M5 >= 0.010, Extension of M5 line end outside of TV2 >= 0.050, For TV2 located at the 90 degree corner, one side of M5 enclosure must be as TV2_4 and the other side follows TV2_5")
    L18467=geomAnd(M5 TV2)
;    L15514=drc(M5 L18467 enc<0.01 figb)
;    L25395=geomAndNot(L18467 L15514)
;    L92004=drc(M5 L25395 venc(enc1<0.05 enc2<0 enc3<0.05 enc4<0))
    L92004=drc(M5 L18467 venc(enc1<0.05 enc2<0.01 enc3<0.05 enc4<0.01))
    errorLayer(L92004
        "TV2_4_5_6: TV2 enclosure by M5 >= 0.010, Extension of M5 line end outside of TV2 >= 0.050, For TV2 located at the 90 degree corner, one side of M5 enclosure must be as TV2_4 and the other side follows TV2_5")

    L87307=geomWidth(M5 keep>1.8)
    tv2_14a1=geomButtOrOver( geomAnd(M5 TM2) L87307)
    tv2_14a=geomWidth(TM2 keep>1.8)
    tv2_14a2=geomButtOrOver( geomAnd(M5 TM2) tv2_14a)
    tv2_14a3=geomButtOrOver(geomOr(tv2_14a1 tv2_14a2) TV2 keep<2)
      errorLayer(tv2_14a3
        "TV2_14: At least 2 TV2 within M5 and TM2 intersection area.  One of the M5 and TM2 width > 1.8 um")

)

; procedure for switches METAL_OPTION_5LM_1TM
procedure( switchProc218()
    L76448=geomAndNot(TV2 M4)
    L15514=drc(M4 TV2 enc<0.01 figb)
    L15515=geomOr(L76448 L15514)
    errorLayer(L15515
        "TV2_4_5_6: TV2 enclosure by M4 >= 0.010, Extension of M4 line end outside of TV2 >= 0.050, For TV2 located at the 90 degree corner, one side of M4 enclosure must be as TV2_4 and the other side follows TV2_5")
    L18467=geomAnd(M4 TV2)
;   L15514=drc(M4 L18467 enc<0.01 figb)
;   L25395=geomAndNot(L18467 L15514)
;   L92004=drc(M4 L25395 venc(enc1<0.05 enc2<0 enc3<0.05 enc4<0))
    L92004=drc(M4 L18467 venc(enc1<0.05 enc2<0.01 enc3<0.05 enc4<0.01))
    errorLayer(L92004
        "TV2_4_5_6: TV2 enclosure by M4 >= 0.010, Extension of M4 line end outside of TV2 >= 0.050, For TV2 located at the 90 degree corner, one side of M4 enclosure must be as TV2_4 and the other side follows TV2_5")

    L87307=geomWidth(M4 keep>1.8)
    tv2_14a1=geomButtOrOver( geomAnd(M4 TM2) L87307)
    tv2_14a=geomWidth(TM2 keep>1.8)
    tv2_14a2=geomButtOrOver( geomAnd(M4 TM2) tv2_14a)
    tv2_14a3=geomButtOrOver(geomOr(tv2_14a1 tv2_14a2) TV2 keep<2)
      errorLayer(tv2_14a3
        "TV2_14: At least 2 TV2 within M4 and TM2 intersection area.  One of the M4 and TM2 width > 1.8 um")


)

; procedure for switches METAL_OPTION_4LM_1TM
procedure( switchProc219()
    L76448=geomAndNot(TV2 M3)
    L15514=drc(M3 TV2 enc<0.01 figb)
    L15515=geomOr(L76448 L15514)
    errorLayer(L15515
        "TV2_4_5_6: TV2 enclosure by M3 >= 0.010, Extension of M3 line end outside of TV2 >= 0.050, For TV2 located at the 90 degree corner, one side of M3 enclosure must be as TV2_4 and the other side follows TV2_5")
    L18467=geomAnd(M3 TV2)
;   L15514=drc(M3 L18467 enc<0.01 figb)
;   L25395=geomAndNot(L18467 L15514)
;   L92004=drc(M3 L25395 venc(enc1<0.05 enc2<0 enc3<0.05 enc4<0))
    L92004=drc(M3 L18467 venc(enc1<0.05 enc2<0.01 enc3<0.05 enc4<0.01))
    errorLayer(L92004
        "TV2_4_5_6: TV2 enclosure by M3 >= 0.010, Extension of M3 line end outside of TV2 >= 0.050, For TV2 located at the 90 degree corner, one side of M3 enclosure must be as TV2_4 and the other side follows TV2_5")

    L87307=geomWidth(M3 keep>1.8)
    tv2_14a1=geomButtOrOver( geomAnd(M3 TM2) L87307)
    tv2_14a=geomWidth(TM2 keep>1.8)
    tv2_14a2=geomButtOrOver( geomAnd(M3 TM2) tv2_14a)
    tv2_14a3=geomButtOrOver(geomOr(tv2_14a1 tv2_14a2) TV2 keep<2)
      errorLayer(tv2_14a3
        "TV2_14: At least 2 TV2 within M3 and TM2 intersection area.  One of the M3 and TM2 width > 1.8 um")

)

; procedure for switches METAL_OPTION_8LM_1TM
procedure( switchProc15()
    L76479=geomAndNot(TV2 M7)
    L44613=drc(M7 TV2 enc<0.01 figb)
    L15515=geomOr(L76479 L44613)
    errorLayer(L15515
        "TV2_4_5_6: TV2 enclosure by M7 >= 0.010, Extension of M7 line end outside of TV2 >= 0.050, For TV2 located at the 90 degree corner, one side of M7 enclosure must be as TV2_4 and the other side follows TV2_5")
    L47618=geomAnd(M7 TV2)
;   L44613=drc(M7 L47618 enc<0.01 figb)
;   L4987=geomAndNot(L47618 L44613)
;   L27635=drc(M7 L4987 venc(enc1<0.05 enc2<0 enc3<0.05 enc4<0))
    L27635=drc(M7 L47618 venc(enc1<0.05 enc2<0.01 enc3<0.05 enc4<0.01))
    errorLayer(L27635
        "TV2_4_5_6: TV2 enclosure by M7 >= 0.010, Extension of M7 line end outside of TV2 >= 0.050, For TV2 located at the 90 degree corner, one side of M7 enclosure must be as TV2_4 and the other side follows TV2_5")

    L87307=geomWidth(M7 keep>1.8)
    tv2_14a1=geomButtOrOver( geomAnd(M7 TM2) L87307)
    tv2_14a=geomWidth(TM2 keep>1.8)
    tv2_14a2=geomButtOrOver( geomAnd(M7 TM2) tv2_14a)
    tv2_14a3=geomButtOrOver(geomOr(tv2_14a1 tv2_14a2) TV2 keep<2)
      errorLayer(tv2_14a3
        "TV2_14: At least 2 TV2 within M7 and TM2 intersection area.  One of the M7 and TM2 width > 1.8 um")

)

; procedure for switches METAL_OPTION_8LM_2TM
procedure( switchProc16()
    L52927=geomAndNot(TV1 M6)
    L43132=drc(M6 TV1 enc<0.01 figb)
    L52928=geomOr(L52927 L43132)
    errorLayer(L52928
        "TV1_4_5_6: TV1 enclosure by M6 >= 0.010, Extension of M6 line end outside of TV1 >= 0.050, For TV1 located at the 90 degree corner, one side of M6 enclosure must be as TV1_4 and the other side follows TV1_5")
    L18436=geomAnd(M6 TV1)
;   L43132=drc(M6 L18436 enc<0.01 figb)
;   L23816=geomAndNot(L18436 L43132)
;   L65708=drc(M6 L23816 venc(enc1<0.05 enc2<0 enc3<0.05 enc4<0))
    L65708=drc(M6 L18436 venc(enc1<0.05 enc2<0.01 enc3<0.05 enc4<0.01))
    errorLayer(L65708
        "TV1_4_5_6: TV1 enclosure by M6 >= 0.010, Extension of M6 line end outside of TV1 >= 0.050, For TV1 located at the 90 degree corner, one side of M6 enclosure must be as TV1_4 and the other side follows TV1_5")

  L87307=geomWidth(M6 keep>1.8)
    tv1_13a1=geomButtOrOver( geomAnd(M6 TM1) L87307)
    tv1_13a=geomWidth(TM1 keep>1.8)
    tv1_13a2=geomButtOrOver( geomAnd(M6 TM1) tv1_13a)
    tv1_13a3=geomButtOrOver(geomOr(tv1_13a1 tv1_13a2) TV1 keep==1)
      errorLayer(tv1_13a3
        "TV1_13: At least 2 TV1 if Mx width>1.8 um")



if( avSwitch("DFM_priority_1_CHECKS") then

;DFM.4
m6tm1 = geomStraddle( M6 TM1  )
ma = geomOverlap( TM1 m6tm1 )
m61 = geomAnd( m6tm1 TM1 )
m61_edge_sized = geomSize( m6tm1 0.005 edges )
m_edge_sized_inside_61 = geomInside( m61_edge_sized ma )
m_edge_inside_61 = geomGetEdge( m61 butting m_edge_sized_inside_61 )
kshBuildRect(m61 ma m_edge_inside_61 0.07 4.5 )
m61_c = drc( m61 rect coverage > 0.2 )
dfm4_tv1 = geomGetCoverage( m61_c keep > 0.2 )
errorLayer( geomEnclose( dfm4_tv1 TV1 keep < 2 ) "DFM_4: Insert one TV1 if single TV1 and (Wm1>=5Wm2 or Wm2>=5Wm1) at enclosure" )

)

)

; procedure for switches METAL_OPTION_7LM_2TM
procedure( switchProc214()
    L52927=geomAndNot(TV1 M5)
    L43132=drc(M5 TV1 enc<0.01 figb)
    L52928=geomOr(L52927 L43132)
    errorLayer(L52928
        "TV1_4_5_6: TV1 enclosure by M5 >= 0.010, Extension of M5 line end outside of TV1 >= 0.050, For TV1 located at the 90 degree corner, one side of M5 enclosure must be as TV1_4 and the other side follows TV1_5")
    L18436=geomAnd(M5 TV1)
;    L43132=drc(M5 L18436 enc<0.01 figb)
;    L23816=geomAndNot(L18436 L43132)
;    L65708=drc(M5 L23816 venc(enc1<0.05 enc2<0 enc3<0.05 enc4<0))
    L65708=drc(M5 L18436 venc(enc1<0.05 enc2<0.01 enc3<0.05 enc4<0.01))
    errorLayer(L65708
        "TV1_4_5_6: TV1 enclosure by M5 >= 0.010, Extension of M5 line end outside of TV1 >= 0.050, For TV1 located at the 90 degree corner, one side of M5 enclosure must be as TV1_4 and the other side follows TV1_5")

     L87307=geomWidth(M5 keep>1.8)
    tv1_13a1=geomButtOrOver( geomAnd(M5 TM1) L87307)
    tv1_13a=geomWidth(TM1 keep>1.8)
    tv1_13a2=geomButtOrOver( geomAnd(M5 TM1) tv1_13a)
    tv1_13a3=geomButtOrOver(geomOr(tv1_13a1 tv1_13a2) TV1 keep==1)
      errorLayer(tv1_13a3
        "TV1_13: At least 2 TV1 if Mx width>1.8 um")



if( avSwitch("DFM_priority_1_CHECKS") then

;DFM.4
m5tm1 = geomStraddle( M5 TM1  )
ma = geomOverlap( TM1 m5tm1 )
m51 = geomAnd( m5tm1 TM1 )
m51_edge_sized = geomSize( m5tm1 0.005 edges )
m_edge_sized_inside_51 = geomInside( m51_edge_sized ma )
m_edge_inside_51 = geomGetEdge( m51 butting m_edge_sized_inside_51 )
kshBuildRect(m51 ma m_edge_inside_51 0.07 4.5 )
m51_c = drc( m51 rect coverage > 0.2 )
dfm4_tv1 = geomGetCoverage( m51_c keep > 0.2 )
errorLayer( geomEnclose( dfm4_tv1 TV1 keep < 2 ) "DFM_4: Insert one TV1 if single TV1 and (Wm1>=5Wm2 or Wm2>=5Wm1) at enclosure" )

)

)

; procedure for switches METAL_OPTION_6LM_2TM
procedure( switchProc215()
    L52927=geomAndNot(TV1 M4)
    L43132=drc(M4 TV1 enc<0.01 figb)
    L52928=geomOr(L52927 L43132)
    errorLayer(L52928
        "TV1_4_5_6: TV1 enclosure by M4 >= 0.010, Extension of M4 line end outside of TV1 >= 0.050, For TV1 located at the 90 degree corner, one side of M4 enclosure must be as TV1_4 and the other side follows TV1_5")
    L18436=geomAnd(M4 TV1)
;   L43132=drc(M4 L18436 enc<0.01 figb)
;   L23816=geomAndNot(L18436 L43132)
;   L65708=drc(M4 L23816 venc(enc1<0.05 enc2<0 enc3<0.05 enc4<0))
    L65708=drc(M4 L18436 venc(enc1<0.05 enc2<0.01 enc3<0.05 enc4<0.01))
    errorLayer(L65708
        "TV1_4_5_6: TV1 enclosure by M4 >= 0.010, Extension of M4 line end outside of TV1 >= 0.050, For TV1 located at the 90 degree corner, one side of M4 enclosure must be as TV1_4 and the other side follows TV1_5")

     L87307=geomWidth(M4 keep>1.8)
    tv1_13a1=geomButtOrOver( geomAnd(M4 TM1) L87307)
    tv1_13a=geomWidth(TM1 keep>1.8)
    tv1_13a2=geomButtOrOver( geomAnd(M4 TM1) tv1_13a)
    tv1_13a3=geomButtOrOver(geomOr(tv1_13a1 tv1_13a2) TV1 keep==1)
      errorLayer(tv1_13a3
        "TV1_13: At least 2 TV1 if Mx width>1.8 um")



if( avSwitch("DFM_priority_1_CHECKS") then

;DFM.4
m4tm1 = geomStraddle( M4 TM1  )
ma = geomOverlap( TM1 m4tm1 )
m41 = geomAnd( m4tm1 TM1 )
m41_edge_sized = geomSize( m4tm1 0.005 edges )
m_edge_sized_inside_41 = geomInside( m41_edge_sized ma )
m_edge_inside_41 = geomGetEdge( m41 butting m_edge_sized_inside_41 )
kshBuildRect(m41 ma m_edge_inside_41 0.07 4.5 )
m41_c = drc( m41 rect coverage > 0.2 )
dfm4_tv1 = geomGetCoverage( m41_c keep > 0.2 )
errorLayer( geomEnclose( dfm4_tv1 TV1 keep < 2 ) "DFM_4: Insert one TV1 if single TV1 and (Wm1>=5Wm2 or Wm2>=5Wm1) at enclosure" )

)

)

; procedure for switches METAL_OPTION_5LM_2TM
procedure( switchProc216()
    L52927=geomAndNot(TV1 M3)
    L43132=drc(M3 TV1 enc<0.01 figb)
    L52928=geomOr(L52927 L43132)
    errorLayer(L52928
        "TV1_4_5_6: TV1 enclosure by M3 >= 0.010, Extension of M3 line end outside of TV1 >= 0.050, For TV1 located at the 90 degree corner, one side of M3 enclosure must be as TV1_4 and the other side follows TV1_5")
    L18436=geomAnd(M3 TV1)
;   L43132=drc(M3 L18436 enc<0.01 figb)
;   L23816=geomAndNot(L18436 L43132)
;   L65708=drc(M3 L23816 venc(enc1<0.05 enc2<0 enc3<0.05 enc4<0))
    L65708=drc(M3 L18436 venc(enc1<0.05 enc2<0.01 enc3<0.05 enc4<0.01))
    errorLayer(L65708
        "TV1_4_5_6: TV1 enclosure by M3 >= 0.010, Extension of M3 line end outside of TV1 >= 0.050, For TV1 located at the 90 degree corner, one side of M3 enclosure must be as TV1_4 and the other side follows TV1_5")

      L87307=geomWidth(M3 keep>1.8)
    tv1_13a1=geomButtOrOver( geomAnd(M3 TM1) L87307)
    tv1_13a=geomWidth(TM1 keep>1.8)
    tv1_13a2=geomButtOrOver( geomAnd(M3 TM1) tv1_13a)
    tv1_13a3=geomButtOrOver(geomOr(tv1_13a1 tv1_13a2) TV1 keep==1)
      errorLayer(tv1_13a3
        "TV1_13: At least 2 TV1 if Mx width>1.8 um")

if( avSwitch("DFM_priority_1_CHECKS") then

;DFM.4
m3tm1 = geomStraddle( M3 TM1  )
ma = geomOverlap( TM1 m3tm1 )
m31 = geomAnd( m3tm1 TM1 )
m31_edge_sized = geomSize( m3tm1 0.005 edges )
m_edge_sized_inside_31 = geomInside( m31_edge_sized ma )
m_edge_inside_31 = geomGetEdge( m31 butting m_edge_sized_inside_31 )
kshBuildRect(m31 ma m_edge_inside_31 0.07 4.5 )
m31_c = drc( m31 rect coverage > 0.2 )
dfm4_tv1 = geomGetCoverage( m31_c keep > 0.2 )
errorLayer( geomEnclose( dfm4_tv1 TV1 keep < 2 ) "DFM_4: Insert one TV1 if single TV1 and (Wm1>=5Wm2 or Wm2>=5Wm1) at enclosure" )

)

)


; procedure for switches METAL_OPTION_9LM_1TM
procedure( switchProc17()
    L76510=geomAndNot(TV2 M8)
    L93723=drc(M8 TV2 enc<0.01 figb)
    L15515=geomOr(L76510 L93723)
    errorLayer(L15515
        "TV2_4_5_6: TV2 enclosure by M8 >= 0.010, Extension of M8 line end outside of TV2 >= 0.050, For TV2 located at the 90 degree corner, one side of M8 enclosure must be as TV2_4 and the other side follows TV2_5")
    L76769=geomAnd(M8 TV2)
;   L93723=drc(M8 L76769 enc<0.01 figb)
;   L39818=geomAndNot(L76769 L93723)
;   L62095=drc(M8 L39818 venc(enc1<0.05 enc2<0 enc3<0.05 enc4<0))
    L62095=drc(M8 L76769 venc(enc1<0.05 enc2<0.01 enc3<0.05 enc4<0.01))
    errorLayer(L62095
        "TV2_4_5_6: TV2 enclosure by M8 >= 0.010, Extension of M8 line end outside of TV2 >= 0.050, For TV2 located at the 90 degree corner, one side of M8 enclosure must be as TV2_4 and the other side follows TV2_5")

    L87307=geomWidth(M8 keep>1.8)
    tv2_14a1=geomButtOrOver( geomAnd(M8 TM2) L87307)
    tv2_14a=geomWidth(TM2 keep>1.8)
    tv2_14a2=geomButtOrOver( geomAnd(M8 TM2) tv2_14a)
    tv2_14a3=geomButtOrOver(geomOr(tv2_14a1 tv2_14a2) TV2 keep<2)
      errorLayer(tv2_14a3
        "TV2_14: At least 2 TV2 within M3 and TM2 intersection area.  One of the M3 and TM2 width > 1.8 um")

)

; procedure for switches METAL_OPTION_9LM_2TM
procedure( switchProc18()
    L52958=geomAndNot(TV1 M7)
    L43132=drc(M7 TV1 enc<0.01 figb)
    L52928=geomOr(L52958 L43132)
    errorLayer(L52928
        "TV1_4_5_6: TV1 enclosure by M7 >= 0.010, Extension of M7 line end outside of TV1 >= 0.050, For TV1 located at the 90 degree corner, one side of M7 enclosure must be as TV1_4 and the other side follows TV1_5")
    L47587=geomAnd(M7 TV1)
;    L95204=drc(M7 L47587 enc<0.01 figb)
;    L1840=geomAndNot(L47587 L95204)
;    L17772=drc(M7 L1840 venc(enc1<0.05 enc2<0 enc3<0.05 enc4<0))
    L17772=drc(M7 L47587 venc(enc1<0.05 enc2<0.01 enc3<0.05 enc4<0.01))
    errorLayer(L17772
        "TV1_4_5_6: TV1 enclosure by M7 >= 0.010, Extension of M7 line end outside of TV1 >= 0.050, For TV1 located at the 90 degree corner, one side of M7 enclosure must be as TV1_4 and the other side follows TV1_5")

    L87307=geomWidth(M7 keep>1.8)
    tv1_13a1=geomButtOrOver( geomAnd(M7 TM1) L87307)
    tv1_13a=geomWidth(TM1 keep>1.8)
    tv1_13a2=geomButtOrOver( geomAnd(M7 TM1) tv1_13a)
    tv1_13a3=geomButtOrOver(geomOr(tv1_13a1 tv1_13a2) TV1 keep==1)
      errorLayer(tv1_13a3
        "TV1_13: At least 2 TV1 if Mx width>1.8 um")



if( avSwitch("DFM_priority_1_CHECKS") then

;DFM.4
m7tm1 = geomStraddle( M7 TM1  )
ma = geomOverlap( TM1 m7tm1 )
m71 = geomAnd( m7tm1 TM1 )
m71_edge_sized = geomSize( m7tm1 0.005 edges )
m_edge_sized_inside_71 = geomInside( m71_edge_sized ma )
m_edge_inside_71 = geomGetEdge( m71 butting m_edge_sized_inside_71 )
kshBuildRect(m71 ma m_edge_inside_71 0.07 4.5 )
m71_c = drc( m71 rect coverage > 0.2 )
dfm4_tv1 = geomGetCoverage( m71_c keep > 0.2 )
errorLayer( geomEnclose( dfm4_tv1 TV1 keep < 2 ) "DFM_4: Insert one TV1 if single TV1 and (Wm1>=5Wm2 or Wm2>=5Wm1) at enclosure" )

)

)





; procedure for switches RECOMMEND_CHECKS
;procedure( switchProc19()
;    L53649=geomGetEdge(poly_mos coincident poly_mos_corner_edge)
;    L69631=drc(L23336 L53649 sep<0.100)
;    errorLayer(L69631
;        "GT_24a: Recommend L-shape poly minimum space to AA >= 0.100")

;    L41464=geomGetEdge(aa_mos coincident aa_mos_corner_edge)
;    L13806=drc(L41464 poly_mos sep<0.100)
;    errorLayer(L13806
;        "GT_25a: Recommend L-shape AA minimum space to poly(in same transistor) >= 0.100")
;
;)

; procedure for switches !METAL_OPTION_6LM_1TM && !METAL_OPTION_7LM_2TM
procedure( switchProc20()
    L79336=drc(M6 width<0.070)
    errorLayer(L79336 "M6_1: M6 minimum width >= 0.070")

;    L8782=geomWidth(M6 keep>4.500)
;    errorLayer(L8782 "M6_2: M6 maximum width <= 4.500")
slwide_m6 = geomButtOrOver( M6 geomSize( M6 -2.25))
slwdm6_45 = geomGetAngledEdge( slwide_m6  0 < keep < 90 )
slwdm6_90 = geomGetAngledEdge( slwide_m6  0 < ignore < 90 )
slwdm6_exp_45 = geomSize( slwdm6_45 -3.1815 edges )
slwdm6_exp_90 = geomSize( geomStretch( slwdm6_90 2.25 ) -2.25 edges )
slthin_m6_tmp = geomAndNot( slwide_m6  geomOr( slwdm6_exp_45 slwdm6_exp_90 ) )
slthin_m6 = geomSnap( slthin_m6_tmp 0.001 )
sltnm6_45 = geomGetAngledEdge( slthin_m6  0 < keep < 90 )
sltnm6_90 = geomGetAngledEdge( slthin_m6  0 < ignore < 90 )
sltnm6_exp_45_tmp = geomSize( sltnm6_45 3.1815 edges )
sltnm6_exp_45 = geomSnap( sltnm6_exp_45_tmp 0.001 )
sltnm6_exp_90 = geomSize( geomStretch( sltnm6_90 2.25 ) 2.25 edges )
sltnm6_exp = geomOr( sltnm6_exp_45 sltnm6_exp_90 )
slwdm6_pre = geomOr( sltnm6_exp slthin_m6 )
m6wide1 = geomAndNot( M6 slwdm6_exp_90 )
m6wide2 = geomWidth( m6wide1 keep>4.5 )
m6wide3 = geomSize( geomSize( M6 -2.25 ) 2.25 )
m6wide4 = geomAnd( geomOr( m6wide2 slwdm6_pre) m6wide3 )
errorLayer( m6wide4 "M6_2: M6 maximum width <= 4.500")

M6_in=geomAndNot(M6 geomOutside(M6 INST))

m603a=drc(M6 sepNotch<0.070 withIntersection withSingularPoint)
errorLayer(m603a "M6_3: M6 minimum space >= 0.070")

    L25666=drc(M6 area<0.0196)
    errorLayer(L25666 "M6_4: M6 minimum area (um^2) >= 0.0196")

    L23247=geomHoles(M6 innermost)
    L26984=geomAndNot(L23247 M6)
    L28829=drc(L26984 area<0.2)
    errorLayer(L28829 "M6_5: M6 minimum enclosed area (um^2) >= 0.2")

    Mn_6(M6i 0.3 0.22 0.1)
    errorLayer(mts
        "M6_6: Minimum space between two (run length >= 0.3um) parallel metal lines with one or both metal line width is >= 0.22um >= 0.100")
    
    Mn_6a(M6i 0.6 0.7 0.12)
     errorLayer(mts
        "M6_6a: Minimum space between two (run length >= 0.3um) parallel metal lines with one or both metal line width is >= 0.7um >= 0.175")
    
    Mn_6b(M6i 0.6 0.22 0.7 0.14)
     errorLayer(mts
        "M6_6b: Minimum space between two (run length >= 0.3um) parallel metal lines with one metal line width is > 0.22um and other metal line width is > 0.7um >= 0.210")
    
    Mn_6c(M6i 1.5 1.5 0.3)
    errorLayer(mts
        "M6_6c: Minimum space between two (run length >= 1.5um) parallel metal lines with one or both metal line width is >1.5um >= 0.500")
    
    m68a=geomGetAngledEdge(M6 keep==45 fig)
    L1568=drc(m68a width<0.17 opposite)
    errorLayer(L1568 "M6_8: minimum 45 M6 width >= 0.17")

    L52829=drc(m68a sep<0.17 opposite)
    errorLayer(L52829 "M6_9: minimum space to parallel M6 >= 0.17")

m6end1=geomGetLength(M6 keep>0.001)
m6end=geomSelectEdge(m6end1 length keep<=0.11 angle1(keep==90 length keep>=0.08) angle2(keep==90 length keep>=0.08))

m610a=geomOutside(drc(m6end M6 sep<0.07 opposite) INST)
errorLayer(m610a "M6_10a: Minimum space between an Mn line end to an Mn (the parallel run length >0um) is 0.07")

m610b1=drc(m6end M6 sep<0.07 opposite)
m610b2=geomOr(geomGetEdge(m6end coincident m610b1) geomGetEdge(m6end butting m610b1))
m610b3=drc(m610b2 V6 enc<0.05 opposite)
m610b4=drc(m610b2 V6 enc<0.03 opposite)
m610b5=geomButtOrOver(V6 m610b3)
m610b6=geomButtOrOver(V6 m610b4)
m610b7=geomAndNot(m610b5 m610b6)
m610b7=geomOutside(geomButtOnly(m610b1 geomButtOrOver(m610b3 m610b7)) INST)
errorLayer(m610b7 "M6_10b: Minimum space between an Mn line end (with Vn) to an Mn (the parallel run length >0um) is 0.07. The Mn line end extend Q from Vn, 0.03 <= Q <0.05um")

M6_LINE_END=geomLineEnd(M6 0.099 legs(0.08))
M6_X1=drc(M6_LINE_END V5 enc<0.05 opposite)
M6_X2=geomButtOrOver(V5 M6_X1)
M6_X3=geomInside(M6_X2 geomAnd(M5 M6))
M6_X8=geomOr(geomGetEdge( M6_X3 butting M6_X1 wholeEdge) geomGetEdge( M6_X3 coincident M6_X1 wholeEdge))
M6_LINE_END_SHAPE=geomSize(M6_LINE_END -0.095 edges)
M6_LINE_SIDE_a=geomOr( geomGetEdge(M6 butting M6_LINE_END_SHAPE) geomGetEdge(M6 coincident M6_LINE_END_SHAPE) edges)
M6_LINE_SIDE_b=geomOr( geomGetEdge(M6_LINE_SIDE_a butting M6_LINE_END) geomGetEdge(M6_LINE_SIDE_a coincident M6_LINE_END) edges)
M6_LINE_SIDE=geomAndNot(M6_LINE_SIDE_a M6_LINE_SIDE_b edges)
M6_LINE_SIDE1=drc(M6_LINE_SIDE M6_X3 enc<0.03 opposite)
M6_V5_EDGE_a=geomOr(M6_LINE_SIDE1 M6_X3) 
M6_V5_EDGE=geomOr( geomGetEdge(M6_V5_EDGE_a butting M6_X8 wholeEdge) geomGetEdge(M6_V5_EDGE_a coincident M6_X8 wholeEdge) edges)
M6_LINE_END_EXP_a=geomStretch(M6_V5_EDGE 0.031)
M6_LINE_END_EXP=geomSize(M6_LINE_END_EXP_a -0.001 edges)
M6_LINE_SIDE_EXP=geomSize(M6_LINE_SIDE -0.001 edges)
M6_LINE_END_1=geomOr( geomGetEdge(M6_LINE_END_EXP butting M6_V5_EDGE wholeEdge) geomGetEdge(M6_LINE_END_EXP coincident M6_V5_EDGE wholeEdge) edges)
M6_LINE_SIDE_1=geomOr( geomGetEdge(M6_LINE_SIDE_EXP butting M6_LINE_SIDE wholeEdge) geomGetEdge(M6_LINE_SIDE_EXP coincident M6_LINE_SIDE wholeEdge) edges)
M6_E1=drc(M6_LINE_END_1 M6 sep<0.12 opposite with_perp edgea)
M6_E2=drc(M6_LINE_SIDE_1 M6 sep<0.08 opposite with_perp edgea)
M6_LINE_END_E1=geomOr(geomGetEdge(M6_LINE_END_1 butting M6_E1 wholeEdge) geomGetEdge(M6_LINE_END_1 coincident M6_E1 wholeEdge) edges)
M6_LINE_SIDE_E2=geomOr(geomGetEdge(M6_LINE_SIDE_1 butting M6_E2 wholeEdge) geomGetEdge(M6_LINE_SIDE_1 coincident M6_E2 wholeEdge) edges)
M6_V52_a=geomOr( geomGetEdge(M6_X8 butting M6_LINE_END_E1 wholeEdge) geomGetEdge(M6_X8 coincident M6_LINE_END_E1 wholeEdge) edges)
M6_V52=geomWithEdge(M6_X3 M6_V52_a)
M6_X5=geomButtOrOver(V5 M6_V52)
M6_X6=geomAndNot(V5 M6_X5)
M6_X7=geomEnclose(geomEnclose( geomAnd(M5 M6) M6_X5) M6_X6)
M6_LINE_END_E1_a=geomSize(M6_LINE_END_E1 -0.001 edges)
M6_LINE_SIDE_E2_a=geomSize(M6_LINE_SIDE_E2 -0.001 edges)
M6_CORNER1=drc(M6_LINE_END_E1_a M6_LINE_SIDE_E2_a sep<=0.002 only_perp withIntersection)
M6_CORNER1_a=geomAnd(M6_LINE_END_E1_a M6_LINE_SIDE_E2_a)
M6_CORNER1_b=geomGetEdge(M6_CORNER1_a coincident M6_LINE_END_E1)
M6_CORNER1_c=geomGetEdge(M6_CORNER1_a coincident M6_LINE_SIDE_E2)
M6_CORNER1=geomWithEdge(geomWithEdge(M6_CORNER1_a M6_CORNER1_b) M6_CORNER1_c)
rule_M6_11=geomOutside(geomAvoiding(M6_CORNER1 M6_X7) INST)
errorLayer(rule_M6_11 "M6_11:Space between Vn-1,Vn-1 is enclosed by Mn[A] to neighbouring metal line Mn[B], when the layout structures meet the following conditions:Mn[A] line end definition: line width W <0.1um,Vn-1 enclosure by Mn[A] line end: E < 0.05um,The parallel run length of Mn[A] and Mn[B]:E1 >=-0.03um,Space between Mn[A] to the neighbouring parallel metal line: Ds<0.08um,Any one edge distance from the corner of the two edges of Mn[A]: K1 <0.095um,At least one Vn-1 in the Mn[A] and Mn-1 intersection meet this rule is ok,This rule is not applicable for SRAM region DRC check")

M612_LINE_END=geomLineEnd(M6 0.099 legs(0.07))
M612_LINE_END_SHAPE=geomSize(M612_LINE_END -0.064 edges)
M612_LINE_SIDE_a=geomGetEdge(M6 coincident M612_LINE_END_SHAPE)
M612_LINE_SIDE_b=geomGetEdge(M612_LINE_SIDE_a coincident M612_LINE_END)
M612_LINE_SIDE=geomAndNot(M612_LINE_SIDE_a M612_LINE_SIDE_b edges)
M612_LINE_END_EXP_a=geomStretch(M612_LINE_END 0.031)
M612_LINE_END_EXP=geomSize(M612_LINE_END_EXP_a -0.001 edges)
M612_LINE_SIDE_EXP_a=geomStretch(M612_LINE_SIDE 0.031)
M612_LINE_SIDE_EXP=geomSize(M612_LINE_SIDE_EXP_a -0.001 edges)
M612_LINE_END_1=geomGetEdge(M612_LINE_END_EXP coincident M612_LINE_END wholeEdge)
M612_LINE_SIDE_1=geomGetEdge(M612_LINE_SIDE_EXP coincident M612_LINE_SIDE wholeEdge)
M6E1=drc(M612_LINE_END_1 M6 sep<0.1 opposite with_perp edgea)
M6E2=drc(M612_LINE_SIDE_1 M6 sep<0.1 opposite with_perp edgea)
M612_LINE_END_E1=geomGetEdge(M612_LINE_END_1 coincident M6E1 wholeEdge)
M612_LINE_SIDE_E2=geomGetEdge(M612_LINE_SIDE_1 coincident M6E2 wholeEdge)
M6_CORNER=drc(M612_LINE_END_E1 M612_LINE_SIDE_E2 ovlp<=0.002 only_perp)
MOM_M6=geomButtOrOver(geomOr(geomOr(M5 M6) M7) geomButtOrOver(MnPIN geomSize(MOMDMY 0.114)))
rule_M6_12=geomAndNot(geomOutside(geomButtOrOver(M612_LINE_END_SHAPE M6_CORNER) INST) geomOr(MOM_M6 MOMDMY))
errorLayer(rule_M6_12 "M6_12:Minimum Mn to Mn space S at Mn line-end 0.1. Width W < 0.1um.The minimum space can be line end head to other Mn or line end side to other M1.  Rule check:S >= (Dh or Ds ).  E1 =0.03, K1=0.095 , Dh=Ds=0.1 in the illustration,Outside of SRAM(INST) area,Waive extrusion F < 0.07")



    L52770=geomContactCheck(V5 width==0.070 length==0.070 ignore)
    errorLayer(L52770 "V5_1: V5 exact length and width == 0.070")

    L29398=drc(V5 sepNotch<0.070 withIntersection withSingularPoint)
    errorLayer(L29398 "V5_2: V5 minimum space >= 0.070")

    L9395=drc(V5i sep<0.1 diffNet opposite)
    L9396=geomOutside(L9395 INST)
    errorLayer(L9396
        "V5_5: minimum space in different net for run length > 0um >= 0.11")

v55a1=drc(V5i sep<0.09 diffNet )
errorLayer(v55a1
    "V5_5a: minimum space in different net for run length > 0um >= 0.11")

v53a1=geomSize(geomSize(V5 0.05) -0.05)
v53a2=geomSize(v53a1 -0.17 downUp)
v53a3=geomButtOrOver(V5 v53a2)
v53a4a=drc(v53a3 sepNotch<0.09 opposite edge)
v53a4=geomGetLength(v53a4a keep>0)
v53a5=geomWithEdge(v53a3 v53a4 keep>=2)
errorLayer(v53a5 "V5_3:Space between Vns (with run length>=0) at least two least two sides is 0.09, when array equal to or greater than 3x3,Two Via areas whose space is within 0.10um are considered to be in the same array. An array does not have both row and column greater than or equal to 3 can apply smaller spacing Vn.2 instead of Vn.3")

   
    L99568=geomAndNot(V5 M5)
    rule_V5_6a=geomCat(L99568 rule_V5_6)
    errorLayer(rule_V5_6a
        "V5_6abc: At least one V5, per M5 and M6 intersection containing a V5, must meet rule V5_6a, V5_6b or V5_6c. V5 within M5 with width > 0.14um must meet rule V5_6a or V5_6d")


    L99599=geomAndNot(V5 M6)
    rule_V5_7a=geomCat(L99599 rule_V5_7)
    errorLayer(rule_V5_7a
        "V5_7abc: At least one V5, per M5 and M6 intersection containing a V5, must meet rule V5_7a, V5_7b or V5_7c. V5 within M6 with width > 0.14um must meet rule V5_7a or V5_7d")


    errorLayer(rule_V5_8
        "V5_8: At least two V5 vias must connect M5 to M6 when the M5 or M6 width is > 0.26um")

    errorLayer(rule_V5_9
        "V5_9: At least three V5 vias must connect M5 to M6 when the M5 or M6 width is > 0.52um")

    errorLayer(rule_V5_10
        "V5_10: At least four V5 vias must connect M5 to M6 when the M5 or M6 width is > 0.645um")

V5_square=geomGetRectangle(V5 aspectRatio==1)
v5_empty=geomOr(EMPTY geomInside(V5_square geomAnd(M5 M6)))
v5_inter_empty=geomOr(EMPTY geomAnd(M5 M6))
v5_16x1a=geomWidth(M5 keep>0.24)
v5_16x1b=geomWidth(M6 keep>0.24)
v5_16wide=geomOr(v5_16x1a v5_16x1b)
v5_empty1=geomInside(v5_empty v5_16wide)
geomConnect(
incremental
    buttOrOver( v5_empty v5_inter_empty )
    buttOrOver( v5_empty1 v5_inter_empty )
)

v5_16x2=geomEnclose(geomAnd(M5 M6) V5_square)
v5_16x3=geomInside(V5_square v5_16x2)
v5_16x5c=drc(v5_empty1 v5_empty sep<=0.16 withIntersection sameNet)
v5_16x6c=geomEnclose(v5_16x2 v5_16x5c)
v5_16x7=geomEnclose(geomAnd(geomSize(v5_16x3 0.325) v5_16x2) V5 keep>2)
v5_16x7c=geomEnclose(v5_16x2 v5_16x7)
v5_16x=geomEnclose(geomAndNot(geomAndNot(v5_16x2 v5_16x6c) v5_16x7c) geomInside(V5_square v5_16wide))
v5_16all=geomOutside(v5_16x INST)
errorLayer(v5_16all "V5_16:At least two V5s with space <=0.16um when one of  M5 or M6 with both length and width  >0.24um")

/*
v5_17x1a=geomWidth(M5 keep>0.24)
v5_17x1b=geomWidth(M6 keep>0.24)
v5_17wide=geomOr(v5_17x1a v5_17x1b)
v5_17x2=geomEnclose(geomAnd(M5 M6) V5_square)
v5_17x3=geomInside(V5_square v5_17x2)
v5_17x5c=drc(geomButtOrOver(v5_17x3 v5_17wide) v5_17x3 sep<=0.16 withIntersection opposite)
v5_17x6c=geomEnclose(v5_17x2 v5_17x5c)
v5_17x4a=drc(v5_17x1a geomInside(v5_17x3 geomButtOrOver(M5 v5_17x1a)) sep<1.1 withIntersection opposite shielded)
v5_17x4b=drc(v5_17x1b geomInside(v5_17x3 geomButtOrOver(M6 v5_17x1b)) sep<1.1 withIntersection opposite shielded)
v5_17x7a=geomWithEdge(geomButtOrOver(v5_17x4a geomButtOrOver(M5 v5_17x1a)) geomGetLength(v5_17x1a keep>0))
v5_17x7b=geomWithEdge(geomButtOrOver(v5_17x4b geomButtOrOver(M6 v5_17x1b)) geomGetLength(v5_17x1b keep>0))
v5_17x7=geomOr(v5_17x7a v5_17x7b)
v5_17x5a=drc(geomInside(v5_17x3 geomButtOrOver(M5 v5_17x1a)) geomButtOrOver(v5_17x3 v5_17x7) sep<=0.16 withIntersection opposite)
v5_17x5b=drc(geomInside(v5_17x3 geomButtOrOver(M6 v5_17x1b)) geomButtOrOver(v5_17x3 v5_17x7) sep<=0.16 withIntersection opposite)
v5_17x5=geomOr(v5_17x5a v5_17x5b)
v5_17x6=geomEnclose(v5_17x2 v5_17x5)
v5_17x8=geomButtOnly(v5_17x7 geomAndNot(V5_square geomWithEdge(V5_square geomGetEdge(geomInside(V5_square v5_17x2) coincident v5_17wide wholeEdge))))
v5_17all1=geomAndNot(geomButtOrOver(geomInside(geomAndNot(v5_17x2 v5_17x6) geomButtOrOver(M5 v5_17x1a)) v5_17x8) v5_17x6c)
v5_17all2=geomAndNot(geomButtOrOver(geomInside(geomAndNot(v5_17x2 v5_17x6) geomButtOrOver(M6 v5_17x1b)) v5_17x8) v5_17x6c)
v5_17all=geomCat(v5_17all1 v5_17all2)
errorLayer(v5_17all "V5_17:At least two Vns with space S1<=0.14um when either wide metal of Mn or Mn+1 with both length L>0.24um and width W>0.24um, and the distance D<=1.2um away from this wide metal")
*/
v5_a=geomButtOrOver(V5_square wm5_exp)
geomConnect(
 incremental
 buttOrOver(v5_a M5)
 buttOrOver(WM5 M5)
)

WM6=geomWidth(M6 keep>0.24)
wm6_edge=geomGetLength(WM6 keep>0)
wm6_exp=geomSize(wm6_edge 1.1 edges)
wm6_l1=geomButtOnly(geomAndNot(M6 WM6) WM6)
v5_a2=geomButtOrOver(V5_square wm6_exp)
geomConnect(
 incremental
 buttOrOver(v5_a2 M6)
 buttOrOver(WM6 M6)
)

wm5_ext=drc(WM5 v5_a sep<1.1 0<=withIntersection<90 opposite sameNet edgeb)
v5_b=geomWithEdge(V5_square wm5_ext)
v5bx1=geomEnclose(geomAnd(M5 M6) V5_square keep>1)
v5sing1=geomButtOrOver(geomAndNot(geomAnd(geomAnd(M5 M6) geomAnd(wm5_l1 wm5_exp)) v5bx1) v5_b keep==1)
v5singall1=geomOutside(v5sing1 INST)

wm6_ext=drc(WM6 v5_a2 sep<1.1 0<=withIntersection<90 opposite sameNet edgeb)
v5_b2=geomWithEdge(V5_square wm6_ext)
v5sing2=geomButtOrOver(geomAndNot(geomAnd(geomAnd(M5 M6) geomAnd(wm6_l1 wm6_exp)) v5bx1) v5_b2 keep==1)
v5singall2=geomOutside(v5sing2 INST)
v5_17all=geomCat(v5singall1 v5singall2)
errorLayer(v5_17all "V5_17:At least two V5s with space S1<=0.16um when either wide metal of M5 or M6 with both length L>0.24um and width W>0.24um, and the distance D<=1.1um away from this wide metal")


if( !avSwitch("CUSTOMER_DUMMY_CHECKS") then
    errorLayer(rule_M6DUMC18
        "DUMC_18: Mx Dummy must not touch (Mx, LOGO, PTCT), where Mx=M1-M8,TM1, TM2.")

    L95345=drc(MnDUB_metal6  MnDUM_metal6 sep<0.6 withIntersection withSingularPoint)
    errorLayer(L95345
        "DUMC_20: Mx Dummy space to (MxDUB, DUMBM, LOGO, PTCT), where Mx=M1-M8. >=0.60")

    L84670=drc(DUPL MnDUM_metal6 sep<0.6 withIntersection withSingularPoint)
    errorLayer(L84670
        "DUMC_20: Mx Dummy space to (MxDUB, DUMBM, LOGO, PTCT), where Mx=M1-M8. >=0.60")

    L83460=drc(geomAvoiding(MnDUM_metal6 INDMY) M6 sep<0.6 withIntersection withSingularPoint)
    errorLayer(L83460 "DUMC_21_M6: M6 Dummy space to M6, where Mx=M1-M8. >=0.60")

    L14865=geomContactCheck(VnDUM_via5 width==.07 length==.07 ignore)
    L14866=geomContactCheck(VnDUM_via5 width==.077 length==.077)
    errorLayer(geomAndNot(L14865 L14866)
        "DUMC_23_24_V5: Vx Dummy exact width, where Vx=V1-V7 ==0.070 or 0.077. Vx Dummy must be square.")
    
    LPI=geomOr(geomOr(geomOr(LOGO PTCT) INDMY) MARKG)
    dumc22v5=geomButtOrOver(VnDUM_via5 geomOr(geomOr(V5 LPI) geomOr(M5 M6)))
    errorLayer(dumc22v5
        "DUMC_22_V5: Vx Dummy must not touch (Vx, LOGO, PTCT, INDMY),where Vx=V1-V7.")

    m5d_and_m6d=geomAnd(MnDUM_metal5 MnDUM_metal6)
    v5dm1d=drc(m5d_and_m6d VnDUM_via5 enc<0.06 withIntersection withSingularPoint)
    L8475=geomAndNot(VnDUM_via5 m5d_and_m6d)
    errorLayer(geomCat(v5dm1d L8475)
    "DUMC_25_a_b_V5: Vx Dummy must be within Mx Dummy, where Vx=V1-V7 and Mx= metal level below Vx. >= 0.030")

    L96934=geomAnd(MIM MnDUM_metal6)
    errorLayer(L96934
        "DUMC_38: Dummy metal should not be next layer to MIM. Next Layer: means upper or lower metal layer.")

   
    L94920=geomAnd(MOMDMY MnDUM_metal6)
    errorLayer(L94920 "DUMC_39: Dummy metal must not be in MOM area")

    L48480=geomAndNot(MnDUM_metal6 BORDER_all)
    errorLayer(L48480
        "DUMC_31: xx Dummy must be within BORDER, where xx=all metal and via levels")

    L41745=geomAndNot(VnDUM_via5 BORDER_all)
    errorLayer(L41745
        "DUMC_31: xx Dummy must be within BORDER, where xx=all metal and via levels")

    L87097=drc(MnDUM_metal6 width<0.220)
    errorLayer(L87097
        "DUMC_32: Min. width of Mx Dummy, where Mx=M1-M8. >= 0.220")

    L44477=drc(MnDUM_metal6 sepNotch<0.22 withIntersection withSingularPoint)
    errorLayer(L44477
        "DUMC_33_M6: Min. space of Mx Dummy, where Mx=M1-M8.>= 0.220")
)

)

; procedure for switches !METAL_OPTION_6LM_1TM && !METAL_OPTION_7LM_2TM && DFM_priority_3_CHECKS
procedure( switchProc21()
    L13897=drc(M6 width<0.08)
    errorLayer(L13897 "DFM_22_M6: M6 minimum width >= 0.080")

    L59259=drc(M6 sepNotch<0.08)
    errorLayer(L59259 "DFM_23_M6: M6 minimum space >= 0.080")

    L85571=drc(M6W sep<0.12 opposite parallel)
    L55082=geomWithEdge(L85571 geomGetLength(L85571 keep>0.300))
    errorLayer(L55082
        "DFM_24_M6: Minimum space between two length > 0.3um parallel lines with one or both metal line width is >= 0.22um >= 0.120")

)

; procedure for switches DFM_priority_1_CHECKS && !METAL_OPTION_6LM_1TM && !METAL_OPTION_7LM_2TM
procedure( switchProc22()
MOMM6=geomButtOrOver(geomOr(geomOr(M6 M5) M7) geomButtOrOver(MnPIN geomSize(MOMDMY 0.114)))
    rule_DFM5_61=drc(geomAndNot(M6 geomOr(geomOr(MOMM6 INDMY) MOMDMY)) sepNotch==0.070 opposite parallel)
    rule_DFM5_62=geomWithEdge(rule_DFM5_61 geomGetLength(rule_DFM5_61 keep>20))
    errorLayer(rule_DFM5_62
          "DFM_5_M6: Maximum length of parallel M6 lines with minimum spacing, designer can waive the violations if design passes sign-off level signal integrity check  <= 20.000")

;DFM.4
m5m6 = geomStraddle( M5 M6  )
ma = geomOverlap( M6 m5m6 )
m56 = geomAnd( m5m6 M6 )
m56_edge_sized = geomSize( m5m6 0.005 edges )
m_edge_sized_inside_56 = geomInside( m56_edge_sized ma )
m_edge_inside_56 = geomGetEdge( m56 butting m_edge_sized_inside_56 )
kshBuildRect(m56 ma m_edge_inside_56 0.07 4.5 )
m56_c = drc( m56 rect coverage > 0.2 )
dfm4_v5 = geomGetCoverage( m56_c keep > 0.2 )
errorLayer( geomEnclose( dfm4_v5 V5 keep < 2 ) "DFM_4_V5: Insert one V5 if single V5 and (Wm1>=5Wm2 or Wm2>=5Wm1) at enclosure" )


)

; procedure for switches DFM_priority_3_CHECKS && !METAL_OPTION_6LM_1TM && !METAL_OPTION_7LM_2TM
procedure( switchProc23()

    rule_DFM25_V5=drc(V5i sep<0.100 diffNet opposite)
    errorLayer(rule_DFM25_V5
         "DFM_25_V5: minimum space in different net for run length > 0 um >=0.10")

)

; procedure for switches !METAL_OPTION_6LM_1TM && !METAL_OPTION_7LM_2TM && !METAL_OPTION_7LM_1TM
;  && !METAL_OPTION_8LM_2TM
procedure( switchProc24()
if( !avSwitch("CUSTOMER_DUMMY_CHECKS") then
    errorLayer(rule_M7DUMC18
        "DUMC_18: Mx Dummy must not touch (Mx, LOGO, PTCT), where Mx=M1-M8,TM1, TM2.")

    L13839=drc(MnDUB_metal7 MnDUM_metal7 sep<0.6 withIntersection withSingularPoint)
    errorLayer(L13839
        "DUMC_20: Mx Dummy space to (MxDUB, DUMBM, LOGO, PTCT), where Mx=M1-M8. >=0.60")

    L31267=drc(DUPL MnDUM_metal7 sep<0.6 withIntersection withSingularPoint)
    errorLayer(L31267
        "DUMC_20: Mx Dummy space to (MxDUB, DUMBM, LOGO, PTCT), where Mx=M1-M8. >=0.60")

    L74652=drc(geomAvoiding(MnDUM_metal7 INDMY) M7 sep<0.6 withIntersection withSingularPoint)
    errorLayer(L74652 "DUMC_21_M7: M7 Dummy space to M7, where Mx=M1-M8. >=0.60")
    
    LPI=geomOr(geomOr(geomOr(LOGO PTCT) INDMY) MARKG)
    dumc22v6=geomButtOrOver(VnDUM_via6 geomOr(geomOr(V6 LPI) geomOr(M6 M7)))
    errorLayer(dumc22v6
        "DUMC_22_V6: Vx Dummy must not touch (Vx, LOGO, PTCT, INDMY),where Vx=V1-V7.")

    L48590=geomContactCheck(VnDUM_via6 width==.07 length==.07 ignore)
    L48591=geomContactCheck(VnDUM_via6 width==.077 length==.077)
    errorLayer(geomAndNot(L48590 L48591)
        "DUMC_23_24_V6: Vx Dummy exact width, where Vx=V1-V7 ==0.070 or 0.077. Vx Dummy must be square.")
    
   m6d_and_m7d=geomAnd(MnDUM_metal6 MnDUM_metal7)
   v6dm1d=drc(m6d_and_m7d VnDUM_via6 enc<0.06 withIntersection withSingularPoint)
   L8476=geomAndNot(VnDUM_via6 m6d_and_m7d)
    errorLayer(geomCat(v6dm1d L8476)
    "DUMC_25_a_b_V6: Vx Dummy must be within Mx Dummy, where Vx=V1-V7 and Mx= metal level below Vx. >= 0.030")

   
    L94951=geomAnd(MOMDMY MnDUM_metal7)
    errorLayer(L94951 "DUMC_39: Dummy metal must not be in MOM area")

    L96903=geomAnd(MIM MnDUM_metal7)
    errorLayer(L96903
        "DUMC_38: Dummy metal should not be next layer to MIM. Next Layer: means upper or lower metal layer.")

    )

)

; procedure for switches !METAL_OPTION_7LM_1TM && !METAL_OPTION_8LM_2TM && !METAL_OPTION_6LM_1TM
;  && !METAL_OPTION_7LM_2TM
procedure( switchProc25()
    L37961=drc(M7 width<0.070)
    errorLayer(L37961 "M7_1: M7 minimum width >= 0.070")

;    L5775=geomWidth(M7 keep>4.500)
;    errorLayer(L5775 "M7_2: M7 maximum width <= 4.500")
slwide_m7 = geomButtOrOver( M7 geomSize( M7 -2.25))
slwdm7_45 = geomGetAngledEdge( slwide_m7  0 < keep < 90 )
slwdm7_90 = geomGetAngledEdge( slwide_m7  0 < ignore < 90 )
slwdm7_exp_45 = geomSize( slwdm7_45 -3.1815 edges )
slwdm7_exp_90 = geomSize( geomStretch( slwdm7_90 2.25 ) -2.25 edges )
slthin_m7_tmp = geomAndNot( slwide_m7  geomOr( slwdm7_exp_45 slwdm7_exp_90 ) )
slthin_m7 = geomSnap( slthin_m7_tmp 0.001 )
sltnm7_45 = geomGetAngledEdge( slthin_m7  0 < keep < 90 )
sltnm7_90 = geomGetAngledEdge( slthin_m7  0 < ignore < 90 )
sltnm7_exp_45_tmp = geomSize( sltnm7_45 3.1815 edges )
sltnm7_exp_45 = geomSnap( sltnm7_exp_45_tmp 0.001 )
sltnm7_exp_90 = geomSize( geomStretch( sltnm7_90 2.25 ) 2.25 edges )
sltnm7_exp = geomOr( sltnm7_exp_45 sltnm7_exp_90 )
slwdm7_pre = geomOr( sltnm7_exp slthin_m7 )
m7wide1 = geomAndNot( M7 slwdm7_exp_90 )
m7wide2 = geomWidth( m7wide1 keep>4.5 )
m7wide3 = geomSize( geomSize( M7 -2.25 ) 2.25 )
m7wide4 = geomAnd( geomOr( m7wide2 slwdm7_pre) m7wide3 )
errorLayer( m7wide4 "M7_2: M7 maximum width <= 4.500")

M7_in=geomAndNot(M7 geomOutside(M7 INST))

m703a=drc(M7 sepNotch<0.070 withIntersection withSingularPoint)
errorLayer(m703a "M7_3: M7 minimum space >= 0.070")


    L67041=drc(M7 area<0.0196)
    errorLayer(L67041 "M7_4: M7 minimum area (um^2) >= 0.0196")

    L23278=geomHoles(M7 innermost)
    L15979=geomAndNot(L23278 M7)
    L3101=drc(L15979 area<0.2)
    errorLayer(L3101 "M7_5: M7 minimum enclosed area (um^2) >= 0.2")

    Mn_6(M7i 0.3 0.22 0.1)
    errorLayer(mts
        "M7_6: Minimum space between two (runlength >= 0.3um) parallel metal lines with one or both metal line width is >= 0.22um >= 0.100")
    
    Mn_6a(M7i 0.6 0.7 0.12)
    errorLayer(mts
        "M7_6a: Minimum space between two (run length >= 0.3um) parallel metal lines with one or both metal line width is >= 0.7um >= 0.175")

    Mn_6b(M7i 0.6 0.22 0.7 0.14)
    errorLayer(mts
        "M7_6b: Minimum space between two (run length >= 0.3um) parallel metal lines with one metal line width is > 0.22um and other metal line width is > 0.7um >= 0.210")

    Mn_6c(M7i 1.5 1.5 0.3)
    errorLayer(mts
        "M7_6c: Minimum space between two (run length >= 1.5um) parallel metal lines with one or both metal line width is >1.5um >= 0.500")

    m78a=geomGetAngledEdge(M7 keep==45 fig)
    L54302=drc(m78a width<0.17 opposite)
    errorLayer(L54302 "M7_8: minimum 45 M7 width >= 0.17")

    L16222=drc(m78a sep<0.17 opposite)
    errorLayer(L16222 "M7_9: minimum space to parallel M7 >= 0.17")

m7end1=geomGetLength(M7 keep>0.001)
m7end=geomSelectEdge(m7end1 length keep<=0.11 angle1(keep==90 length keep>=0.08) angle2(keep==90 length keep>=0.08))

m710a=geomOutside(drc(m7end M7 sep<0.07 opposite) INST)
errorLayer(m710a "M7_10a: Minimum space between an Mn line end to an Mn (the parallel run length >0um) is 0.07")

m710b1=drc(m7end M7 sep<0.07 opposite)
m710b2=geomOr(geomGetEdge(m7end coincident m710b1) geomGetEdge(m7end butting m710b1))
m710b3=drc(m710b2 V7 enc<0.05 opposite)
m710b4=drc(m710b2 V7 enc<0.03 opposite)
m710b5=geomButtOrOver(V7 m710b3)
m710b6=geomButtOrOver(V7 m710b4)
m710b7=geomAndNot(m710b5 m710b6)
m710b7=geomOutside(geomButtOnly(m710b1 geomButtOrOver(m710b3 m710b7)) INST)
errorLayer(m710b7 "M7_10b: Minimum space between an Mn line end (with Vn) to an Mn (the parallel run length >0um) is 0.07. The Mn line end extend Q from Vn, 0.03 <= Q <0.05um")

M7_LINE_END=geomLineEnd(M7 0.099 legs(0.08))
M7_X1=drc(M7_LINE_END V6 enc<0.05 opposite)
M7_X2=geomButtOrOver(V6 M7_X1)
M7_X3=geomInside(M7_X2 geomAnd(M6 M7))
M7_X8=geomOr(geomGetEdge( M7_X3 butting M7_X1 wholeEdge) geomGetEdge( M7_X3 coincident M7_X1 wholeEdge))
M7_LINE_END_SHAPE=geomSize(M7_LINE_END -0.095 edges)
M7_LINE_SIDE_a=geomOr( geomGetEdge(M7 butting M7_LINE_END_SHAPE) geomGetEdge(M7 coincident M7_LINE_END_SHAPE) edges)
M7_LINE_SIDE_b=geomOr( geomGetEdge(M7_LINE_SIDE_a butting M7_LINE_END) geomGetEdge(M7_LINE_SIDE_a coincident M7_LINE_END) edges)
M7_LINE_SIDE=geomAndNot(M7_LINE_SIDE_a M7_LINE_SIDE_b edges)
M7_LINE_SIDE1=drc(M7_LINE_SIDE M7_X3 enc<0.03 opposite)
M7_V6_EDGE_a=geomOr(M7_LINE_SIDE1 M7_X3) 
M7_V6_EDGE=geomOr( geomGetEdge(M7_V6_EDGE_a butting M7_X8 wholeEdge) geomGetEdge(M7_V6_EDGE_a coincident M7_X8 wholeEdge) edges)
M7_LINE_END_EXP_a=geomStretch(M7_V6_EDGE 0.031)
M7_LINE_END_EXP=geomSize(M7_LINE_END_EXP_a -0.001 edges)
M7_LINE_SIDE_EXP=geomSize(M7_LINE_SIDE -0.001 edges)
M7_LINE_END_1=geomOr( geomGetEdge(M7_LINE_END_EXP butting M7_V6_EDGE wholeEdge) geomGetEdge(M7_LINE_END_EXP coincident M7_V6_EDGE wholeEdge) edges)
M7_LINE_SIDE_1=geomOr( geomGetEdge(M7_LINE_SIDE_EXP butting M7_LINE_SIDE wholeEdge) geomGetEdge(M7_LINE_SIDE_EXP coincident M7_LINE_SIDE wholeEdge) edges)
M7_E1=drc(M7_LINE_END_1 M7 sep<0.12 opposite with_perp edgea)
M7_E2=drc(M7_LINE_SIDE_1 M7 sep<0.08 opposite with_perp edgea)
M7_LINE_END_E1=geomOr(geomGetEdge(M7_LINE_END_1 butting M7_E1 wholeEdge) geomGetEdge(M7_LINE_END_1 coincident M7_E1 wholeEdge) edges)
M7_LINE_SIDE_E2=geomOr(geomGetEdge(M7_LINE_SIDE_1 butting M7_E2 wholeEdge) geomGetEdge(M7_LINE_SIDE_1 coincident M7_E2 wholeEdge) edges)
M7_V62_a=geomOr( geomGetEdge(M7_X8 butting M7_LINE_END_E1 wholeEdge) geomGetEdge(M7_X8 coincident M7_LINE_END_E1 wholeEdge) edges)
M7_V62=geomWithEdge(M7_X3 M7_V62_a)
M7_X5=geomButtOrOver(V6 M7_V62)
M7_X6=geomAndNot(V6 M7_X5)
M7_X7=geomEnclose(geomEnclose( geomAnd(M6 M7) M7_X5) M7_X6)
M7_LINE_END_E1_a=geomSize(M7_LINE_END_E1 -0.001 edges)
M7_LINE_SIDE_E2_a=geomSize(M7_LINE_SIDE_E2 -0.001 edges)
M7_CORNER1=drc(M7_LINE_END_E1_a M7_LINE_SIDE_E2_a sep<=0.002 only_perp withIntersection)
M7_CORNER1_a=geomAnd(M7_LINE_END_E1_a M7_LINE_SIDE_E2_a)
M7_CORNER1_b=geomGetEdge(M7_CORNER1_a coincident M7_LINE_END_E1)
M7_CORNER1_c=geomGetEdge(M7_CORNER1_a coincident M7_LINE_SIDE_E2)
M7_CORNER1=geomWithEdge(geomWithEdge(M7_CORNER1_a M7_CORNER1_b) M7_CORNER1_c)
rule_M7_11=geomOutside(geomAvoiding(M7_CORNER1 M7_X7) INST)
errorLayer(rule_M7_11 "M7_11:Space between Vn-1,Vn-1 is enclosed by Mn[A] to neighbouring metal line Mn[B], when the layout structures meet the following conditions:Mn[A] line end definition: line width W <0.1um,Vn-1 enclosure by Mn[A] line end: E < 0.05um,The parallel run length of Mn[A] and Mn[B]:E1 >=-0.03um,Space between Mn[A] to the neighbouring parallel metal line: Ds<0.08um,Any one edge distance from the corner of the two edges of Mn[A]: K1 <0.095um,At least one Vn-1 in the Mn[A] and Mn-1 intersection meet this rule is ok,This rule is not applicable for SRAM region DRC check")

M712_LINE_END=geomLineEnd(M7 0.099 legs(0.07))
M712_LINE_END_SHAPE=geomSize(M712_LINE_END -0.064 edges)
M712_LINE_SIDE_a=geomGetEdge(M7 coincident M712_LINE_END_SHAPE)
M712_LINE_SIDE_b=geomGetEdge(M712_LINE_SIDE_a coincident M712_LINE_END)
M712_LINE_SIDE=geomAndNot(M712_LINE_SIDE_a M712_LINE_SIDE_b edges)
M712_LINE_END_EXP_a=geomStretch(M712_LINE_END 0.031)
M712_LINE_END_EXP=geomSize(M712_LINE_END_EXP_a -0.001 edges)
M712_LINE_SIDE_EXP_a=geomStretch(M712_LINE_SIDE 0.031)
M712_LINE_SIDE_EXP=geomSize(M712_LINE_SIDE_EXP_a -0.001 edges)
M712_LINE_END_1=geomGetEdge(M712_LINE_END_EXP coincident M712_LINE_END wholeEdge)
M712_LINE_SIDE_1=geomGetEdge(M712_LINE_SIDE_EXP coincident M712_LINE_SIDE wholeEdge)
M7E1=drc(M712_LINE_END_1 M7 sep<0.1 opposite with_perp edgea)
M7E2=drc(M712_LINE_SIDE_1 M7 sep<0.1 opposite with_perp edgea)
M712_LINE_END_E1=geomGetEdge(M712_LINE_END_1 coincident M7E1 wholeEdge)
M712_LINE_SIDE_E2=geomGetEdge(M712_LINE_SIDE_1 coincident M7E2 wholeEdge)
M7_CORNER=drc(M712_LINE_END_E1 M712_LINE_SIDE_E2 ovlp<=0.002 only_perp)
MOM_M7=geomButtOrOver(geomOr(geomOr(M6 M7) M8) geomButtOrOver(MnPIN geomSize(MOMDMY 0.114)))
rule_M7_12=geomAndNot(geomOutside(geomButtOrOver(M712_LINE_END_SHAPE M7_CORNER) INST) geomOr(MOM_M7 MOMDMY))
errorLayer(rule_M7_12 "M7_12:Minimum Mn to Mn space S at Mn line-end 0.1. Width W < 0.1um.The minimum space can be line end head to other Mn or line end side to other M1.  Rule check:S >= (Dh or Ds ).  E1 =0.03, K1=0.095 , Dh=Ds=0.1 in the illustration,Outside of SRAM(INST) area,Waive extrusion F < 0.07")


    L52515=geomContactCheck(V6 width==0.070 length==0.070 ignore)
    errorLayer(L52515 "V6_1: V6 exact length and width == 0.070")

    L46679=drc(V6 sepNotch<0.070 withIntersection withSingularPoint)
    errorLayer(L46679 "V6_2: V6 minimum space >= 0.070")

    L50504=drc(V6i sep<0.1 diffNet opposite)
    L50505=geomOutside(L50504 INST)
    errorLayer(L50504
        "V6_5: minimum space in different net for run length > 0um >= 0.11")

v65a1=drc(V6i sep<0.09 diffNet )
errorLayer(v65a1
    "V6_5a: minimum space in different net for run length > 0um >= 0.11")


v63a1=geomSize(geomSize(V6 0.05) -0.05)
v63a2=geomSize(v63a1 -0.17 downUp)
v63a3=geomButtOrOver(V6 v63a2)
v63a4a=drc(v63a3 sepNotch<0.09 opposite edge)
v63a4=geomGetLength(v63a4a keep>0)
v63a5=geomWithEdge(v63a3 v63a4 keep>=2)
errorLayer(v63a5 "V6_3:Space between Vns (with run length>=0) at least two least two sides is 0.09, when array equal to or greater than 3x3,Two Via areas whose space is within 0.10um are considered to be in the same array. An array does not have both row and column greater than or equal to 3 can apply smaller spacing Vn.2 instead of Vn.3")

    L23120=geomAndNot(V6 M6)
    rule_V6_6a=geomCat(L23120 rule_V6_6)
    errorLayer(rule_V6_6a
        "V6_6abc: At least one V6, per M6 and M7 intersection containing a V6, must meet rule V6_6a, V6_6b or V6_6c. V6 within M6 with width > 0.14um must meet rule V6_6a or V6_6d")

    L23151=geomAndNot(V6 M7)
    rule_V6_7a=geomCat(L23151 rule_V6_7)
    errorLayer(rule_V6_7a
        "V6_7abc: At least one V6, per M6 and M7 intersection containing a V6, must meet rule V6_7a, V6_7b or V6_7c. V6 within M7 with width > 0.14um must meet rule V6_7a or V6_7d")

    errorLayer(rule_V6_8
        "V6_8: At least two V6 vias must connect M6 to M7 when the M6 or M7 width is > 0.26um")

    errorLayer(rule_V6_9
        "V6_9: At least three V6 vias must connect M6 to M7 when the M6 or M7 width is > 0.52um")

    errorLayer(rule_V6_10
        "V6_10: At least four V6 vias must connect M6 to M7 when the M6 or M7 width is > 0.645um")

V6_square=geomGetRectangle(V6 aspectRatio==1)
v6_empty=geomOr(EMPTY geomInside(V6_square geomAnd(M6 M7)))
v6_inter_empty=geomOr(EMPTY geomAnd(M6 M7))
v6_16x1a=geomWidth(M6 keep>0.24)
v6_16x1b=geomWidth(M7 keep>0.24)
v6_16wide=geomOr(v6_16x1a v6_16x1b)
v6_empty1=geomInside(v6_empty v6_16wide)
geomConnect(
    incremental
    buttOrOver( v6_empty v6_inter_empty )
    buttOrOver( v6_empty1 v6_inter_empty )
)

v6_16x2=geomEnclose(geomAnd(M6 M7) V6_square)
v6_16x3=geomInside(V6_square v6_16x2)
v6_16x5c=drc(v6_empty1 v6_empty sep<=0.16 withIntersection sameNet)
v6_16x6c=geomEnclose(v6_16x2 v6_16x5c)
v6_16x7=geomEnclose(geomAnd(geomSize(v6_16x3 0.325) v6_16x2) V6 keep>2)
v6_16x7c=geomEnclose(v6_16x2 v6_16x7)
v6_16x=geomEnclose(geomAndNot(geomAndNot(v6_16x2 v6_16x6c) v6_16x7c) geomInside(V6_square v6_16wide))
v6_16all=geomOutside(v6_16x INST)
errorLayer(v6_16all "V6_16:At least two V6s with space <=0.16um when one of  M6 or M7 with both length and width  >0.24um")

/*
v6_17x1a=geomWidth(M6 keep>0.24)
v6_17x1b=geomWidth(M7 keep>0.24)
v6_17wide=geomOr(v6_17x1a v6_17x1b)
v6_17x2=geomEnclose(geomAnd(M6 M7) V6_square)
v6_17x3=geomInside(V6_square v6_17x2)
v6_17x5c=drc(geomButtOrOver(v6_17x3 v6_17wide) v6_17x3 sep<=0.16 withIntersection opposite)
v6_17x6c=geomEnclose(v6_17x2 v6_17x5c)
v6_17x4a=drc(v6_17x1a geomInside(v6_17x3 geomButtOrOver(M6 v6_17x1a)) sep<1.1 withIntersection opposite shielded)
v6_17x4b=drc(v6_17x1b geomInside(v6_17x3 geomButtOrOver(M7 v6_17x1b)) sep<1.1 withIntersection opposite shielded)
v6_17x7a=geomWithEdge(geomButtOrOver(v6_17x4a geomButtOrOver(M6 v6_17x1a)) geomGetLength(v6_17x1a keep>0))
v6_17x7b=geomWithEdge(geomButtOrOver(v6_17x4b geomButtOrOver(M7 v6_17x1b)) geomGetLength(v6_17x1b keep>0))
v6_17x7=geomOr(v6_17x7a v6_17x7b)
v6_17x5a=drc(geomInside(v6_17x3 geomButtOrOver(M6 v6_17x1a)) geomButtOrOver(v6_17x3 v6_17x7) sep<=0.16 withIntersection opposite)
v6_17x5b=drc(geomInside(v6_17x3 geomButtOrOver(M7 v6_17x1b)) geomButtOrOver(v6_17x3 v6_17x7) sep<=0.16 withIntersection opposite)
v6_17x5=geomOr(v6_17x5a v6_17x5b)
v6_17x6=geomEnclose(v6_17x2 v6_17x5)
v6_17x8=geomButtOnly(v6_17x7 geomAndNot(V6_square geomWithEdge(V6_square geomGetEdge(geomInside(V6_square v6_17x2) coincident v6_17wide wholeEdge))))
v6_17all1=geomAndNot(geomButtOrOver(geomInside(geomAndNot(v6_17x2 v6_17x6) geomButtOrOver(M6 v6_17x1a)) v6_17x8) v6_17x6c)
v6_17all2=geomAndNot(geomButtOrOver(geomInside(geomAndNot(v6_17x2 v6_17x6) geomButtOrOver(M7 v6_17x1b)) v6_17x8) v6_17x6c)
v6_17all=geomCat(v6_17all1 v6_17all2)
errorLayer(v6_17all "V6_17:At least two Vns with space S1<=0.14um when either wide metal of Mn or Mn+1 with both length L>0.24um and width W>0.24um, and the distance D<=1.2um away from this wide metal")
*/

v6_a=geomButtOrOver(V6_square wm6_exp)
geomConnect(
 incremental
 buttOrOver(v6_a M6)
 buttOrOver(WM6 M6)
)
WM7=geomWidth(M7 keep>0.24)
wm7_edge=geomGetLength(WM7 keep>0)
wm7_exp=geomSize(wm7_edge 1.1 edges)
wm7_l1=geomButtOnly(geomAndNot(M7 WM7) WM7)
v6_a2=geomButtOrOver(V6_square wm7_exp)
geomConnect(
 incremental
 buttOrOver(v6_a2 M7)
 buttOrOver(WM7 M7)
)
wm6_ext=drc(WM6 v6_a sep<1.1 0<=withIntersection<90 opposite sameNet edgeb)
v6_b=geomWithEdge(V6_square wm6_ext)
v6bx1=geomEnclose(geomAnd(M6 M7) V6 keep>1)
v6sing1=geomButtOrOver(geomAndNot(geomAnd(geomAnd(M6 M7) geomAnd(wm6_l1 wm6_exp)) v6bx1) v6_b keep==1)
v6singall1=geomOutside(v6sing1 INST)

wm7_ext=drc(WM7 v6_a2 sep<1.1 0<=withIntersection<90 opposite sameNet edgeb)
v6_b2=geomWithEdge(V6_square wm7_ext)
v6sing2=geomButtOrOver(geomAndNot(geomAnd(geomAnd(M6 M7) geomAnd(wm7_l1 wm7_exp)) v6bx1) v6_b2 keep==1)
v6singall2=geomOutside(v6sing2 INST)
v6_17all=geomCat(v6singall1 v6singall2)
errorLayer(v6_17all "V6_17:At least two V6s with space S1<=0.16um when either wide metal of M6 or M7 with both length L>0.24um and width W>0.24um, and the distance D<=1.1um away from this wide metal")

if( !avSwitch("CUSTOMER_DUMMY_CHECKS") then
    L64353=geomAndNot(MnDUM_metal7 BORDER_all)
    errorLayer(L64353
        "DUMC_31: xx Dummy must be within BORDER, where xx=all metal and via levels")

    L71088=geomAndNot(VnDUM_via6 BORDER_all)
    errorLayer(L71088
        "DUMC_31: xx Dummy must be within BORDER, where xx=all metal and via levels")

    L42684=drc(MnDUM_metal7 width<0.22)
    errorLayer(L42684
        "DUMC_32: Min. width of Mx Dummy, where Mx=M1-M8. >= 0.220")

    L78654=drc(MnDUM_metal7 sepNotch<0.22 withIntersection withSingularPoint)
    errorLayer(L78654
        "DUMC_33_M7: Min. space of Mx Dummy, where Mx=M1-M8.>= 0.220")
)

)

; procedure for switches !METAL_OPTION_7LM_1TM && !METAL_OPTION_8LM_2TM && !METAL_OPTION_6LM_1TM
;  && !METAL_OPTION_7LM_2TM && DFM_priority_3_CHECKS
procedure( switchProc26()
    L10890=drc(M7 width<0.08)
    errorLayer(L10890 "DFM_22_M7: M7 minimum width >= 0.080")

    L93436=drc(M7 sepNotch<0.08)
    errorLayer(L93436 "DFM_23_M7: M7 minimum space >= 0.080")

    L32059=drc(M7W sep<0.12 opposite parallel )
    L13977=geomWithEdge(L32059 geomGetLength(L32059 keep>0.300))
    errorLayer(L13977
        "DFM_24_M7: Minimum space between two length > 0.3um parallel lines with one or both metal line width is >= 0.22um >= 0.120")

)

; procedure for switches DFM_priority_1_CHECKS && !METAL_OPTION_6LM_1TM && !METAL_OPTION_7LM_2TM
;  && !METAL_OPTION_7LM_1TM && !METAL_OPTION_8LM_2TM
procedure( switchProc27()
MOMM7=geomButtOrOver(geomOr(geomOr(M7 M6) M8) geomButtOrOver(MnPIN geomSize(MOMDMY 0.114)))
    rule_DFM5_71=drc(geomAndNot(M7 geomOr(geomOr(MOMM7 INDMY) MOMDMY)) sepNotch==0.070 opposite parallel)
    rule_DFM5_72=geomWithEdge(rule_DFM5_71 geomGetLength(rule_DFM5_71 keep>20))
    errorLayer(rule_DFM5_72
          "DFM_5_M7: Maximum length of parallel M7 lines with minimum spacing, designer can waive the violations if design passes sign-off level signal integrity check  <= 20.000")

;DFM.4
m6m7 = geomStraddle( M6 M7  )
ma = geomOverlap( M7 m6m7 )
m67 = geomAnd( m6m7 M7 )
m67_edge_sized = geomSize( m6m7 0.005 edges )
m_edge_sized_inside_67 = geomInside( m67_edge_sized ma )
m_edge_inside_67 = geomGetEdge( m67 butting m_edge_sized_inside_67 )
kshBuildRect(m67 ma m_edge_inside_67 0.07 4.5 )
m67_c = drc( m67 rect coverage > 0.2 )
dfm4_v6 = geomGetCoverage( m67_c keep > 0.2 )
errorLayer( geomEnclose( dfm4_v6 V6 keep < 2 ) "DFM_4_V6: Insert one V6 if single V6 and (Wm1>=5Wm2 or Wm2>=5Wm1) at enclosure" )



)

; procedure for switches DFM_priority_3_CHECKS && !METAL_OPTION_6LM_1TM && !METAL_OPTION_7LM_2TM
;  && !METAL_OPTION_7LM_1TM && !METAL_OPTION_8LM_2TM
procedure( switchProc28()
    rule_DFM25_V6=drc(V6i sep<0.100 diffNet opposite)
    errorLayer(rule_DFM25_V6
        "DFM_25_V6: minimum space in different net for run length > 0 um >=0.10")

)

; procedure for switches !METAL_OPTION_6LM_1TM && !METAL_OPTION_7LM_2TM && !METAL_OPTION_7LM_1TM
;  && !METAL_OPTION_8LM_2TM && !METAL_OPTION_8LM_1TM && !METAL_OPTION_9LM_2TM
procedure( switchProc29()
if( !avSwitch("CUSTOMER_DUMMY_CHECKS") then
    errorLayer(rule_M8DUMC18
        "DUMC_18: Mx Dummy must not touch (Mx, LOGO, PTCT), where Mx=M1-M8,TM1, TM2.")

    L55727=drc(MnDUB_metal8 MnDUM_metal8 sep<0.6 withIntersection withSingularPoint)
    errorLayer(L55727
        "DUMC_20: Mx Dummy space to (MxDUB, DUMBM, LOGO, PTCT), where Mx=M1-M8. >=0.220")

    L20092=drc(DUPL MnDUM_metal8 sep<0.6 withIntersection withSingularPoint)
    errorLayer(L20092
        "DUMC_20: Mx Dummy space to (MxDUB, DUMBM, LOGO, PTCT), where Mx=M1-M8. >=0.220")

    L28527=drc(geomAvoiding(MnDUM_metal8 INDMY) M8 sep<0.6 withIntersection withSingularPoint)
    errorLayer(L28527 "DUMC_21_M8: M8 Dummy space to M8, where Mx=M1-M8. >=0.220")

    L44749=geomContactCheck(VnDUM_via7 width==.07 length==.07 ignore)
    L44750=geomContactCheck(VnDUM_via7 width==.077 length==.077)
    errorLayer(geomAndNot(L44749 L44750)
        "DUMC_23_24_V7: Vx Dummy exact width, where Vx=V1-V7 ==0.070 or 0.077. Vx Dummy must be square.")
    
    LPI=geomOr(geomOr(geomOr(LOGO PTCT) INDMY) MARKG)
    dumc22v7=geomButtOrOver(VnDUM_via7 geomOr(geomOr(V7 LPI) geomOr(M7 M8)))
    errorLayer(dumc22v7
        "DUMC_22_V7: Vx Dummy must not touch (Vx, LOGO, PTCT, INDMY),where Vx=V1-V7.")

    m7d_and_m8d=geomAnd(MnDUM_metal7 MnDUM_metal8)
   v7dm1d=drc(m7d_and_m8d VnDUM_via7 enc<0.06 withIntersection withSingularPoint)
   L8477=geomAndNot(VnDUM_via7 m7d_and_m8d)
    errorLayer(geomCat(v7dm1d L8477)
    "DUMC_25_a_b_V7: Vx Dummy must be within Mx Dummy, where Vx=V1-V7 and Mx= metal level below Vx. >= 0.030")

    L96872=geomAnd(MIM MnDUM_metal8)
    errorLayer(L96872
        "DUMC_38: Dummy metal should not be next layer to MIM. Next Layer: means upper or lower metal layer.")

    L94982=geomAnd(MOMDMY MnDUM_metal8)
    errorLayer(L94982 "DUMC_39: Dummy metal must not be in MOM area")

)
)

; procedure for switches !METAL_OPTION_8LM_1TM && !METAL_OPTION_9LM_2TM && !METAL_OPTION_7LM_1TM
;  && !METAL_OPTION_8LM_2TM && !METAL_OPTION_6LM_1TM && !METAL_OPTION_7LM_2TM
procedure( switchProc30()
    L96586=drc(M8 width<0.070)
    errorLayer(L96586 "M8_1: M8 minimum width >= 0.070")

slwide_m8 = geomButtOrOver( M8 geomSize( M8 -2.25))
slwdm8_45 = geomGetAngledEdge( slwide_m8  0 < keep < 90 )
slwdm8_90 = geomGetAngledEdge( slwide_m8  0 < ignore < 90 )
slwdm8_exp_45 = geomSize( slwdm8_45 -3.1815 edges )
slwdm8_exp_90 = geomSize( geomStretch( slwdm8_90 2.25 ) -2.25 edges )
slthin_m8_tmp = geomAndNot( slwide_m8  geomOr( slwdm8_exp_45 slwdm8_exp_90 ) )
slthin_m8 = geomSnap( slthin_m8_tmp 0.001 )
sltnm8_45 = geomGetAngledEdge( slthin_m8  0 < keep < 90 )
sltnm8_90 = geomGetAngledEdge( slthin_m8  0 < ignore < 90 )
sltnm8_exp_45_tmp = geomSize( sltnm8_45 3.1815 edges )
sltnm8_exp_45 = geomSnap( sltnm8_exp_45_tmp 0.001 )
sltnm8_exp_90 = geomSize( geomStretch( sltnm8_90 2.25 ) 2.25 edges )
sltnm8_exp = geomOr( sltnm8_exp_45 sltnm8_exp_90 )
slwdm8_pre = geomOr( sltnm8_exp slthin_m8 )
m8wide1 = geomAndNot( M8 slwdm8_exp_90 )
m8wide2 = geomWidth( m8wide1 keep>4.5 )
m8wide3 = geomSize( geomSize( M8 -2.25 ) 2.25 )
m8wide4 = geomAnd( geomOr( m8wide2 slwdm8_pre) m8wide3 )
errorLayer( m8wide4 "M8_2: M8 maximum width <= 4.500")

M8_in=geomAndNot(M8 geomOutside(M8 INST))

m803a=drc(M8 sepNotch<0.070 withIntersection withSingularPoint)
errorLayer(m803a "M8_3: M8 minimum space >= 0.070")

    L91584=drc(M8 area<0.0196)
    errorLayer(L91584 "M8_4: M8 minimum area (um^2) >= 0.0196")

    L23309=geomHoles(M8 innermost)
    L92803=geomAndNot(L23309 M8)
    L15570=drc(L92803 area<0.2)
    errorLayer(L15570 "M8_5: M8 minimum enclosed area (um^2) >= 0.2")

    Mn_6(M8i 0.3 0.22 0.1)
    errorLayer(mts
        "M8_6: Minimum space between two (run length >= 0.3um) parallel metal lines with one or both metal line width is >= 0.22um >= 0.100")
    
    Mn_6a(M8i 0.6 0.7 0.12)
    errorLayer(mts
        "M8_6a: Minimum space between two (run length >= 0.3um) parallel metal lines with one or both metal line width is >= 0.7um >= 0.175")

    Mn_6b(M8i 0.6 0.22 0.7 0.14)
    errorLayer(mts
        "M8_6b: Minimum space between two (run length >= 0.3um) parallel metal lines with one metal line width is > 0.22um and other metal line width is > 0.7um >= 0.210")

    Mn_6c(M8i 1.5 1.5 0.3)
    errorLayer(mts
        "M8_6c: Minimum space between two (run length >= 1.5um) parallel metal lines with one or both metal line width is >1.5um >= 0.500")

    m88a=geomGetAngledEdge(M8 keep==45 fig)
       L68772=drc(m88a width<0.17 opposite)
    errorLayer(L68772 "M8_8: minimum 45 M8 width >= 0.17")

    L11873=drc(m88a sep<0.17 opposite)
    errorLayer(L11873 "M8_9: minimum space to parallel M8 >= 0.17")

   m8end1=geomGetLength(M8 keep>0.001)
m8end=geomSelectEdge(m8end1 length keep<=0.11 angle1(keep==90 length keep>=0.08) angle2(keep==90 length keep>=0.08))

m810a=geomOutside(drc(m8end M8 sep<0.07 opposite) INST)
errorLayer(m810a "M8_10a: Minimum space between an Mn line end to an Mn (the parallel run length >0um) is 0.07")

M8_LINE_END=geomLineEnd(M8 0.099 legs(0.08))
M8_X1=drc(M8_LINE_END V7 enc<0.05 opposite)
M8_X2=geomButtOrOver(V7 M8_X1)
M8_X3=geomInside(M8_X2 geomAnd(M7 M8))
M8_X8=geomOr(geomGetEdge( M8_X3 butting M8_X1 wholeEdge) geomGetEdge( M8_X3 coincident M8_X1 wholeEdge))
M8_LINE_END_SHAPE=geomSize(M8_LINE_END -0.095 edges)
M8_LINE_SIDE_a=geomOr( geomGetEdge(M8 butting M8_LINE_END_SHAPE) geomGetEdge(M8 coincident M8_LINE_END_SHAPE) edges)
M8_LINE_SIDE_b=geomOr( geomGetEdge(M8_LINE_SIDE_a butting M8_LINE_END) geomGetEdge(M8_LINE_SIDE_a coincident M8_LINE_END) edges)
M8_LINE_SIDE=geomAndNot(M8_LINE_SIDE_a M8_LINE_SIDE_b edges)
M8_LINE_SIDE1=drc(M8_LINE_SIDE M8_X3 enc<0.03 opposite)
M8_V7_EDGE_a=geomOr(M8_LINE_SIDE1 M8_X3) 
M8_V7_EDGE=geomOr( geomGetEdge(M8_V7_EDGE_a butting M8_X8 wholeEdge) geomGetEdge(M8_V7_EDGE_a coincident M8_X8 wholeEdge) edges)
M8_LINE_END_EXP_a=geomStretch(M8_V7_EDGE 0.031)
M8_LINE_END_EXP=geomSize(M8_LINE_END_EXP_a -0.001 edges)
M8_LINE_SIDE_EXP=geomSize(M8_LINE_SIDE -0.001 edges)
M8_LINE_END_1=geomOr( geomGetEdge(M8_LINE_END_EXP butting M8_V7_EDGE wholeEdge) geomGetEdge(M8_LINE_END_EXP coincident M8_V7_EDGE wholeEdge) edges)
M8_LINE_SIDE_1=geomOr( geomGetEdge(M8_LINE_SIDE_EXP butting M8_LINE_SIDE wholeEdge) geomGetEdge(M8_LINE_SIDE_EXP coincident M8_LINE_SIDE wholeEdge) edges)
M8_E1=drc(M8_LINE_END_1 M8 sep<0.12 opposite with_perp edgea)
M8_E2=drc(M8_LINE_SIDE_1 M8 sep<0.08 opposite with_perp edgea)
M8_LINE_END_E1=geomOr(geomGetEdge(M8_LINE_END_1 butting M8_E1 wholeEdge) geomGetEdge(M8_LINE_END_1 coincident M8_E1 wholeEdge) edges)
M8_LINE_SIDE_E2=geomOr(geomGetEdge(M8_LINE_SIDE_1 butting M8_E2 wholeEdge) geomGetEdge(M8_LINE_SIDE_1 coincident M8_E2 wholeEdge) edges)
M8_V72_a=geomOr( geomGetEdge(M8_X8 butting M8_LINE_END_E1 wholeEdge) geomGetEdge(M8_X8 coincident M8_LINE_END_E1 wholeEdge) edges)
M8_V72=geomWithEdge(M8_X3 M8_V72_a)
M8_X5=geomButtOrOver(V7 M8_V72)
M8_X6=geomAndNot(V7 M8_X5)
M8_X7=geomEnclose(geomEnclose( geomAnd(M7 M8) M8_X5) M8_X6)
M8_LINE_END_E1_a=geomSize(M8_LINE_END_E1 -0.001 edges)
M8_LINE_SIDE_E2_a=geomSize(M8_LINE_SIDE_E2 -0.001 edges)
M8_CORNER1=drc(M8_LINE_END_E1_a M8_LINE_SIDE_E2_a sep<=0.002 only_perp withIntersection)
M8_CORNER1_a=geomAnd(M8_LINE_END_E1_a M8_LINE_SIDE_E2_a)
M8_CORNER1_b=geomGetEdge(M8_CORNER1_a coincident M8_LINE_END_E1)
M8_CORNER1_c=geomGetEdge(M8_CORNER1_a coincident M8_LINE_SIDE_E2)
M8_CORNER1=geomWithEdge(geomWithEdge(M8_CORNER1_a M8_CORNER1_b) M8_CORNER1_c)
rule_M8_11=geomOutside(geomAvoiding(M8_CORNER1 M8_X7) INST)
errorLayer(rule_M8_11 "M8_11:Space between Vn-1,Vn-1 is enclosed by Mn[A] to neighbouring metal line Mn[B], when the layout structures meet the following conditions:Mn[A] line end definition: line width W <0.1um,Vn-1 enclosure by Mn[A] line end: E < 0.05um,The parallel run length of Mn[A] and Mn[B]:E1 >=-0.03um,Space between Mn[A] to the neighbouring parallel metal line: Ds<0.08um,Any one edge distance from the corner of the two edges of Mn[A]: K1 <0.095um,At least one Vn-1 in the Mn[A] and Mn-1 intersection meet this rule is ok,This rule is not applicable for SRAM region DRC check")

M812_LINE_END=geomLineEnd(M8 0.099 legs(0.07))
M812_LINE_END_SHAPE=geomSize(M812_LINE_END -0.064 edges)
M812_LINE_SIDE_a=geomGetEdge(M8 coincident M812_LINE_END_SHAPE)
M812_LINE_SIDE_b=geomGetEdge(M812_LINE_SIDE_a coincident M812_LINE_END)
M812_LINE_SIDE=geomAndNot(M812_LINE_SIDE_a M812_LINE_SIDE_b edges)
M812_LINE_END_EXP_a=geomStretch(M812_LINE_END 0.031)
M812_LINE_END_EXP=geomSize(M812_LINE_END_EXP_a -0.001 edges)
M812_LINE_SIDE_EXP_a=geomStretch(M812_LINE_SIDE 0.031)
M812_LINE_SIDE_EXP=geomSize(M812_LINE_SIDE_EXP_a -0.001 edges)
M812_LINE_END_1=geomGetEdge(M812_LINE_END_EXP coincident M812_LINE_END wholeEdge)
M812_LINE_SIDE_1=geomGetEdge(M812_LINE_SIDE_EXP coincident M812_LINE_SIDE wholeEdge)
M8E1=drc(M812_LINE_END_1 M8 sep<0.1 opposite with_perp edgea)
M8E2=drc(M812_LINE_SIDE_1 M8 sep<0.1 opposite with_perp edgea)
M812_LINE_END_E1=geomGetEdge(M812_LINE_END_1 coincident M8E1 wholeEdge)
M812_LINE_SIDE_E2=geomGetEdge(M812_LINE_SIDE_1 coincident M8E2 wholeEdge)
M8_CORNER=drc(M812_LINE_END_E1 M812_LINE_SIDE_E2 ovlp<=0.002 only_perp)
MOM_M8=geomButtOrOver(geomOr(M7 M8) geomButtOrOver(MnPIN geomSize(MOMDMY 0.114)))
rule_M8_12=geomAndNot(geomOutside(geomButtOrOver(M812_LINE_END_SHAPE M8_CORNER) INST) geomOr(MOM_M8 MOMDMY))
errorLayer(rule_M8_12 "M8_12:Minimum Mn to Mn space S at Mn line-end 0.1. Width W < 0.1um.The minimum space can be line end head to other Mn or line end side to other M1.  Rule check:S >= (Dh or Ds ).  E1 =0.03, K1=0.095 , Dh=Ds=0.1 in the illustration,Outside of SRAM(INST) area,Waive extrusion F < 0.07")


    L47740=geomContactCheck(V7 width==0.070 length==0.070 ignore)
    errorLayer(L47740 "V7_1: V7 exact length and width == 0.070")

    L63960=drc(V7 sepNotch<0.070 withIntersection withSingularPoint)
    errorLayer(L63960 "V7_2: V7 minimum space >= 0.070")

    L48807=drc(V7i sep<0.1 diffNet opposite)
    L48808=geomOutside(L48807 INST)
    errorLayer(L48808
        "V7_5: minimum space in different net for run length > 0um >= 0.11")

v75a1=drc(V7i sep<0.09 diffNet )
errorLayer(v75a1
    "V7_5a: minimum space in different net for run length > 0um >= 0.11")


v73a1=geomSize(geomSize(V7 0.05) -0.05)
v73a2=geomSize(v73a1 -0.17 downUp)
v73a3=geomButtOrOver(V7 v73a2)
v73a4a=drc(v73a3 sepNotch<0.09 opposite edge)
v73a4=geomGetLength(v73a4a keep>0)
v73a5=geomWithEdge(v73a3 v73a4 keep>=2)
errorLayer(v73a5 "V7_3:Space between Vns (with run length>=0) at least two least two sides is 0.09, when array equal to or greater than 3x3,Two Via areas whose space is within 0.10um are considered to be in the same array. An array does not have both row and column greater than or equal to 3 can apply smaller spacing Vn.2 instead of Vn.3")


    L46672=geomAndNot(V7 M7)
    rule_V7_6a=geomCat(L46672 rule_V7_6)
    errorLayer(rule_V7_6a
        "V7_6abc: At least one V7, per M7 and M8 intersection containing a V7, must meet rule V7_6a, V7_6b or V7_6c. V7 within M7 with width > 0.14um must meet rule V7_6a or V7_6d")


    L46703=geomAndNot(V7 M8)
   rule_V7_7a=geomCat(L46703 rule_V7_7)
    errorLayer(rule_V7_7a
        "V7_7abc: At least one V7, per M7 and M8 intersection containing a V7, must meet rule V7_7a, V7_7b or V7_7c. V7 within M8 with width > 0.14um must meet rule V7_7a or V7_7d")

    errorLayer(rule_V7_8
        "V7_8: At least two V7 vias must connect M7 to M8 when the M7 or M8 width is > 0.26um")

    errorLayer(rule_V7_9
        "V7_9: At least three V7 vias must connect M7 to M8 when the M7 or M8 width is > 0.52um")

    errorLayer(rule_V7_10
        "V7_10: At least four V7 vias must connect M7 to M8 when the M7 or M8 width is > 0.645um")

V7_square=geomGetRectangle(V7 aspectRatio==1)
v7_empty=geomOr(EMPTY geomInside(V7_square geomAnd(M7 M8)))
v7_inter_empty=geomOr(EMPTY geomAnd(M7 M8))
v7_16x1a=geomWidth(M7 keep>0.24)
v7_16x1b=geomWidth(M8 keep>0.24)
v7_16wide=geomOr(v7_16x1a v7_16x1b)
v7_empty1=geomInside(v7_empty v7_16wide)
geomConnect(
    incremental
    buttOrOver( v7_empty v7_inter_empty )
    buttOrOver( v7_empty1 v7_inter_empty )
)

v7_16x2=geomEnclose(geomAnd(M7 M8) V7_square)
v7_16x3=geomInside(V7_square v7_16x2)
v7_16x5c=drc(v7_empty1 v7_empty sep<=0.16 withIntersection sameNet)
v7_16x6c=geomEnclose(v7_16x2 v7_16x5c)
v7_16x7=geomEnclose(geomAnd(geomSize(v7_16x3 0.325) v7_16x2) V7 keep>2)
v7_16x7c=geomEnclose(v7_16x2 v7_16x7)
v7_16x=geomEnclose(geomAndNot(geomAndNot(v7_16x2 v7_16x6c) v7_16x7c) geomInside(V7_square v7_16wide))
v7_16all=geomOutside(v7_16x INST)
errorLayer(v7_16all "V7_16:At least two V7s with space <=0.16um when one of  M7 or M8 with both length and width  >0.24um")

/*
v7_17x1a=geomWidth(M7 keep>0.24)
v7_17x1b=geomWidth(M8 keep>0.24)
v7_17wide=geomOr(v7_17x1a v7_17x1b)
v7_17x2=geomEnclose(geomAnd(M7 M8) V7_square)
v7_17x3=geomInside(V7_square v7_17x2)
v7_17x5c=drc(geomButtOrOver(v7_17x3 v7_17wide) v7_17x3 sep<=0.16 withIntersection opposite)
v7_17x6c=geomEnclose(v7_17x2 v7_17x5c)
v7_17x4a=drc(v7_17x1a geomInside(v7_17x3 geomButtOrOver(M7 v7_17x1a)) sep<1.1 withIntersection opposite shielded)
v7_17x4b=drc(v7_17x1b geomInside(v7_17x3 geomButtOrOver(M8 v7_17x1b)) sep<1.1 withIntersection opposite shielded)
v7_17x7a=geomWithEdge(geomButtOrOver(v7_17x4a geomButtOrOver(M7 v7_17x1a)) geomGetLength(v7_17x1a keep>0))
v7_17x7b=geomWithEdge(geomButtOrOver(v7_17x4b geomButtOrOver(M8 v7_17x1b)) geomGetLength(v7_17x1b keep>0))
v7_17x7=geomOr(v7_17x7a v7_17x7b)
v7_17x5a=drc(geomInside(v7_17x3 geomButtOrOver(M7 v7_17x1a)) geomButtOrOver(v7_17x3 v7_17x7) sep<=0.16 withIntersection opposite)
v7_17x5b=drc(geomInside(v7_17x3 geomButtOrOver(M8 v7_17x1b)) geomButtOrOver(v7_17x3 v7_17x7) sep<=0.16 withIntersection opposite)
v7_17x5=geomOr(v7_17x5a v7_17x5b)
v7_17x6=geomEnclose(v7_17x2 v7_17x5)
v7_17x8=geomButtOnly(v7_17x7 geomAndNot(V7_square geomWithEdge(V7_square geomGetEdge(geomInside(V7_square v7_17x2) coincident v7_17wide wholeEdge))))
v7_17all1=geomAndNot(geomButtOrOver(geomInside(geomAndNot(v7_17x2 v7_17x6) geomButtOrOver(M7 v7_17x1a)) v7_17x8) v7_17x6c)
v7_17all2=geomAndNot(geomButtOrOver(geomInside(geomAndNot(v7_17x2 v7_17x6) geomButtOrOver(M8 v7_17x1b)) v7_17x8) v7_17x6c)
v7_17all=geomCat(v7_17all1 v7_17all2)
errorLayer(v7_17all "V7_17:At least two Vns with space S1<=0.14um when either wide metal of Mn or Mn+1 with both length L>0.24um and width W>0.24um, and the distance D<=1.2um away from this wide metal")
*/
 v7_a=geomButtOrOver(V7_square wm7_exp)

geomConnect(
 incremental
 buttOrOver(v7_a M7)
 buttOrOver(WM7 M7)
)
WM8=geomWidth(M8 keep>0.24)
wm8_edge=geomGetLength(WM8 keep>0)
wm8_exp=geomSize(wm8_edge 1.1 edges)
wm8_l1=geomButtOnly(geomAndNot(M8 WM8) WM8)
v7_a2=geomButtOrOver(V7_square wm8_exp)
geomConnect(
 incremental
 buttOrOver(v7_a2 M8)
 buttOrOver(WM8 M8)
)

wm7_ext=drc(WM7 v7_a sep<1.1 0<=withIntersection<90 opposite sameNet edgeb)
v7_b=geomWithEdge(V7_square wm7_ext)
v7bx1=geomEnclose(geomAnd(M7 M8) V7_square keep>1)
v7sing1=geomButtOrOver(geomAndNot(geomAnd(geomAnd(M7 M8) geomAnd(wm7_l1 wm7_exp)) v7bx1) v7_b keep==1)
v7singall1=geomOutside(v7sing1 INST)

wm8_ext=drc(WM8 v7_a2 sep<1.1 0<=withIntersection<90 opposite sameNet edgeb)
v7_b2=geomWithEdge(V7_square wm8_ext)
v7sing2=geomButtOrOver(geomAndNot(geomAnd(geomAnd(M7 M8) geomAnd(wm8_l1 wm8_exp)) v7bx1) v7_b2 keep==1)
v7singall2=geomOutside(v7sing2 INST)
v7_17all=geomCat(v7singall1 v7singall2)
errorLayer(v7_17all "V7_17:At least two V7s with space S1<=0.16um when either wide metal of M7 or M8 with both length L>0.24um and width W>0.24um, and the distance D<=1.1um away from this wide metal")

if( !avSwitch("CUSTOMER_DUMMY_CHECKS") then
    L9890=geomAndNot(MnDUM_metal8 BORDER_all)
    errorLayer(L9890
        "DUMC_31:  Dummy must be within BORDER, where all metal and via levels")

    L83375=geomAndNot(VnDUM_via7 BORDER_all)
    errorLayer(L83375
        "DUMC_31:  Dummy must be within BORDER, where all metal and via levels")

    L39677=drc(MnDUM_metal8 width<0.22)
    errorLayer(L39677
        "DUMC_32: Min. width of Mx Dummy, where Mx=M1-M8. >= 0.220")

    L12831=drc(MnDUM_metal8 sepNotch<0.22 withIntersection withSingularPoint)
    errorLayer(L12831
        "DUMC_33_M8: Min. space of Mx Dummy, where Mx=M1-M8.>= 0.220")
)

)

; procedure for switches !METAL_OPTION_8LM_1TM && !METAL_OPTION_9LM_2TM && !METAL_OPTION_7LM_1TM
;  && !METAL_OPTION_8LM_2TM && !METAL_OPTION_6LM_1TM && !METAL_OPTION_7LM_2TM && DFM_priority_3_CHECKS
procedure( switchProc31()
    L7883=drc(M8 width<0.08)
    errorLayer(L7883 "DFM_22_M8: M8 minimum width >= 0.080")

    L27613=drc(M8 sepNotch<0.08)
    errorLayer(L27613 "DFM_23_M8: M8 minimum space >= 0.080")

    L57073=drc(M8W sep<0.12 opposite parallel)
    L10578=geomWithEdge(L57073 geomGetLength(L57073 keep>0.300))
    errorLayer(L10578
        "DFM_24_M8: Minimum space between two length > 0.3um parallel lines with one or both metal line width is >= 0.22um >= 0.120")

)

; procedure for switches DFM_priority_1_CHECKS && !METAL_OPTION_6LM_1TM && !METAL_OPTION_7LM_2TM
;  && !METAL_OPTION_7LM_1TM && !METAL_OPTION_8LM_2TM && !METAL_OPTION_8LM_1TM && !METAL_OPTION_9LM_2TM
procedure( switchProc32()
MOMM8=geomButtOrOver(geomOr(M8 M7) geomButtOrOver(MnPIN geomSize(MOMDMY 0.114)))
    rule_DFM5_81=drc(geomAndNot(M8 geomOr(geomOr(MOMM8 INDMY) MOMDMY)) sepNotch==0.070 opposite parallel)
    rule_DFM5_82=geomWithEdge(rule_DFM5_81 geomGetLength(rule_DFM5_81 keep>20))
    errorLayer(rule_DFM5_82
          "DFM_5_M8: Maximum length of parallel M8 lines with minimum spacing, designer can waive the violations if design passes sign-off level signal integrity check  <= 20.000")

;DFM.4
m7m8 = geomStraddle( M7 M8  )
ma = geomOverlap( M8 m7m8 )
m78 = geomAnd( m7m8 M8 )
m78_edge_sized = geomSize( m7m8 0.005 edges )
m_edge_sized_inside_78 = geomInside( m78_edge_sized ma )
m_edge_inside_78 = geomGetEdge( m78 butting m_edge_sized_inside_78 )
kshBuildRect(m78 ma m_edge_inside_78 0.07 4.5 )
m78_c = drc( m78 rect coverage > 0.2 )
dfm4_v7 = geomGetCoverage( m78_c keep > 0.2 )
errorLayer( geomEnclose( dfm4_v7 V7 keep < 2 ) "DFM_4_V7: Insert one V7 if single V7 and (Wm1>=5Wm2 or Wm2>=5Wm1) at enclosure" )



)

; procedure for switches DFM_priority_3_CHECKS && !METAL_OPTION_6LM_1TM && !METAL_OPTION_7LM_2TM
;  && !METAL_OPTION_7LM_1TM && !METAL_OPTION_8LM_2TM && !METAL_OPTION_8LM_1TM && !METAL_OPTION_9LM_2TM
procedure( switchProc33()
    rule_DFM25_V7=drc(V7i sep<0.100 diffNet opposite)
    errorLayer(rule_DFM25_V7
         "DFM_25_V7: minimum space in different net for run length > 0 um >=0.10")

)

; procedure for switches METAL_OPTION_10LM_2TM || METAL_OPTION_8LM_2TM || METAL_OPTION_9LM_2TM
procedure( switchProc34()
    L70772=geomContactCheck(TV1 width==0.36 length==0.36 ignore)
    errorLayer(L70772 "TV1_1: Fixed TV1 size (square shape) == 0.360")

    L37606=drc(TV1 sepNotch<0.34 withIntersection withSingularPoint)
    errorLayer(L37606 "TV1_2: Space between two TV1 >= 0.340")

    L87306=drc(tv1_in_array sepNotch<0.5 withIntersection withSingularPoint)
    errorLayer(L87306
        "TV1_3: Space between two tv1_in_array regions in case tv1_in_array array is larger than or equal to 3x3. Two Via areas whose space is within 0.5um are considered to be in the same array. An array does not have both row and column greater than 3 can apply smaller spacing TV1_2 instead of TV1_3")

    L58673=geomAndNot(TV2 TM1)
    L63705=drc(TM1 TV2 enc<0.01 figb)
    L15515=geomOr(L58673 L63705)
    errorLayer(L15515
        "TV2_4_5_6: TV2 enclosure by TM1 >= 0.010, Extension of TM1 line end outside of TV2 >= 0.050, For TV2 located at the 90 degree corner, one side of TM1 enclosure must be as TV2_4 and the other side follows TV2_5")
    L97554=geomAnd(TM1 TV2)
;   L63705=drc(TM1 L97554 enc<0.01 figb)
;   L65776=geomAndNot(L97554 L63705)
;   L17050=drc(TM1 L65776 venc(enc1<0.05 enc2<0 enc3<0.05 enc4<0))
    L17050=drc(TM1 L97554 venc(enc1<0.05 enc2<0.01 enc3<0.05 enc4<0.01))
    errorLayer(L17050
        "TV2_4_5_6: TV2 enclosure by TM1 >= 0.010, Extension of TM1 line end outside of TV2 >= 0.050, For TV2 located at the 90 degree corner, one side of TM1 enclosure must be as TV2_4 and the other side follows TV2_5")

    L87307=geomWidth(TM1 keep>1.8)
    tv2_13a1=geomButtOrOver( geomAnd(TM1 TM2) L87307)
    tv2_13a=geomWidth(TM2 keep>1.8)
    tv2_13a2=geomButtOrOver( geomAnd(TM1 TM2) tv2_13a)
    tv2_13a3=geomButtOrOver(geomOr(tv2_13a1 tv2_13a2) TV2 keep==1)
      errorLayer(tv2_13a3
        "TV2_13: At least 2 TV2 if Mx width>1.8 um")     

    L39612=drc(TM1 width<0.400)
    errorLayer(L39612 "TM1_1: TM1 width >= 0.400")

    L79893=geomWidth(TM1 keep>12)
    tm1_13a=geomAvoiding(L79893 MD)
    errorLayer(tm1_13a "TM1_13: TM1 maximum width is 12")

    L85318=drc(TM1 sepNotch<0.400 withIntersection withSingularPoint)
    errorLayer(L85318 "TM1_2: Space between two TM1 >= 0.400")

    L3271=drc(TM1 area<0.56)
    errorLayer(L3271 "TM1_8: TM1 area (um^2) >= 0.56")

    L6226=geomAndNot(TV1 TM1)
    L90639=drc(TM1 TV1 venc(enc1<0.02 enc2<0.03 enc3<0.02 enc4<0.03))
    errorLayer(geomOr(L6226 L90639)
        "TM1_3_4_TV1_7: TV1 enclosure by TM1 >= 0.020, Extension of TM1 line end outside of TV1 >= 0.030")

    L78626=geomHoles(TM1 innermost)
    L99668=geomAndNot(L78626 TM1)
    L41475=drc(L99668 area<0.8)
    errorLayer(L41475
        "TM1_9: Dielectric area(um^2) enclosed by TM1 (um^2) >= 0.800")


    TM56(TM1i 1.5 2 0.5)
    errorLayer(tms
        "TM1_5: Minimum space between two length > 1.500um parallel TM1 lines with one or both metal line width is > 2.000um >= 0.500")


       
     TM56(TM1i 4.5 4.5 1.2)
     errorLayer(tms
        "TM1_7: Minimum space between two length >= 1.5um parallel TM1 lines with one metal line width is > 2.000um and other meral line width is > 4.000um >= 1.200")

)


; procedure for switches DENSITY_CHECKS
 procedure( switchProc36()
   processCoverage( backup measure( windowSize=200 stepSize=100
        L11057=calculate(area(aa_all)/area(bulk_no_dt)) ))
    aa14ax=geomGetCoverage(L11057 keep<0.25)
    aa14ay=geomAndNot(aa14ax DGTG )
    processCoverage( backup measure(
        L11057m=calculate(area(aa14ay)/10000 )))
    aa14am1=geomGetCoverage(L11057m keep>0.25)
aa14am=geomCat( aa14am1)
    processCoverage( backup measure(
        L11057w=calculate(area(aa_all)/area(aa14am) )))
    aa14aw=geomGetCoverage(L11057w keep<0.25)
    aa14a_all=geomAndNot(geomAndNot(geomAndNot(geomAndNot(aa14aw MARKG) RESNW) LOGO) DGTG)
    errorLayer(aa14a_all "AA_14_a:For area excluding (DG or TG), AA density (including dummy)is 25%. Density check window size: 200um*200um with step size: 100um,Waive RESNW, LOGO, seal ring(MARKS) areas,DRC check with the said window size and rule number and highlight as X. Y = X not (DG or TG), Z= (Y area)/(100*100),If Z > 25%, highlight Y for AA density inside of Y that cannot meet of rule value requirement")

  processCoverage( backup measure( windowSize=200 stepSize=100
        L11057b=calculate(area(aa_all)/area(bulk_no_dt)) ))
    aa14bx=geomGetCoverage(L11057b keep>0.8)
    aa14by=geomAndNot(aa14bx DGTG )
    processCoverage( backup measure(
        L11057bm=calculate(area(aa14by)/10000 )))
    aa14bm1=geomGetCoverage(L11057bm keep>0.25)
aa14bm=geomCat( aa14bm1)
    processCoverage( backup measure(
        L11057bw=calculate(area(aa_all)/area(aa14bm) )))
    aa14bw=geomGetCoverage(L11057bw keep>0.8)
    aa14b_all=geomAndNot(geomAndNot(geomAndNot(geomAndNot(aa14bw MARKG) RESNW) LOGO) DGTG)
    errorLayer(aa14b_all "AA_14_b:For area excluding (DG or TG), AA density (including dummy)is 80%. Density check window size: 200um*200um with step size: 100um,Waive RESNW, LOGO, seal ring(MARKS) areas,DRC check with the said window size and rule number and highlight as X. Y = X not (DG or TG), Z= (Y area)/(100*100),If Z > 25%, highlight Y for AA density inside of Y that cannot meet of rule value requirement")
    
 processCoverage( backup measure( windowSize=200 stepSize=100
        L11057aa=calculate(area(aa_all)/area(bulk_no_dt)) ))
    aa14aax=geomGetCoverage(L11057aa keep<0.25)
    aa14aay=geomAnd(aa14aax DGTG )
    processCoverage( backup measure(
        L11057aam=calculate(area(aa14aay)/10000 )))
    aa14aam1=geomGetCoverage(L11057aam keep>0.25)
aa14aam=geomCat( aa14aam1)
    processCoverage( backup measure(
        L11057aaw=calculate(area(aa_all)/area(aa14aam) )))
    aa14aaw=geomGetCoverage(L11057aaw keep<0.25)
    aa14aa_all=geomAnd(geomAndNot(aa14aaw MARKG) DGTG)
    errorLayer(aa14aa_all "AA_14a_a:For area in (DG or TG), AA density (including dummy)is 25%. Density check window size: 200um*200um with step size: 100um,Waive RESNW, LOGO, seal ring(MARKS) areas,DRC check with the said window size and rule number and highlight as X. Y = X not (DG or TG), Z= (Y area)/(100*100),If Z > 25%, highlight Y for AA density inside of Y that cannot meet of rule value requirement")
    
processCoverage( backup measure( windowSize=200 stepSize=100
        L11057ab=calculate(area(aa_all)/area(bulk_no_dt)) ))
    aa14abx=geomGetCoverage(L11057ab keep>0.9)
    aa14aby=geomAnd(aa14abx DGTG )
    processCoverage( backup measure(
        L11057abm=calculate(area(aa14aby)/10000 )))
    aa14abm1=geomGetCoverage(L11057abm keep>0.25)
aa14abm=geomCat( aa14abm1)
    processCoverage( backup measure(
        L11057abw=calculate(area(aa_all)/area(aa14abm) )))
    aa14abw=geomGetCoverage(L11057abw keep>0.9)
    aa14ab_all=geomAnd(geomAndNot(aa14abw MARKG) DGTG)
    errorLayer(aa14ab_all "AA_14a_b:For area in (DG or TG), AA density (including dummy)is 90%. Density check window size: 200um*200um with step size: 100um,Waive RESNW, LOGO, seal ring(MARKS) areas,DRC check with the said window size and rule number and highlight as X. Y = X not (DG or TG), Z= (Y area)/(100*100),If Z > 25%, highlight Y for AA density inside of Y that cannot meet of rule value requirement")


    processCoverage( backup measure( windowSize=200 stepSize=100
        L11058=calculate(area(AA)/area(DUMBA)) ))
    aa15a1=geomGetCoverage(L11058 0.20<=ignore<=0.80)
    aa15a2=geomAndNot(geomAnd(aa15a1 DUMBA) MARKG)
    errorLayer(aa15a2 "AA_15ab: AA density overlap by DUMBA. Density check window size: 200um*200um, step size: 100um : 20% <= density <= 80%")

    gt_all=geomOr(GTi GTDUM)


    processCoverage( backup measure( L18239=calculate(area(gt_all)/area()) ))
    errorLayer(geomGetCoverage(L18239 0.15<=ignore<=0.40)
        "GT_20l_h: Poly density(including dummy) : 15% <= density <= 40%")

    processCoverage( backup measure( L65507=calculate(area(GT)/area(DUMBP)) ))
    errorLayer(geomGetCoverage(L65507 0.15<=ignore<=0.40)
        "GT_20bl_bh: Poly density overlap by DUMBP : 15% <= density <= 40%")
    
    processCoverage( backup measure( windowSize=100 stepSize=50
        L11057c=calculate(area(gt_all)/area(bulk_no_dt)) ))
    gt20ax=geomGetCoverage(L11057c keep<0.1)
    gt20ay=geomAndNot(gt20ax DGTG )
    processCoverage( backup measure(
        L11057cm=calculate(area(gt20ay)/10000 )))
    gt20am1=geomGetCoverage(L11057cm keep>0.25)
gt20am=geomCat( gt20am1)
    processCoverage( backup measure(
        L11057gtw=calculate(area(gt_all)/area(gt20am) )))
    gt20aw=geomGetCoverage(L11057gtw keep<0.1)
    gt20a_all=geomAndNot(geomAndNot(gt20aw MARKG)  DGTG)
    errorLayer(gt20a_all "GT_20c:For area excluding (DG or TG), poly density (including dummy)is 10%. Density check window size: 100um*100um with step size: 50um,Waive  seal ring(MARKS) areas,DRC check with the said window size and rule number and highlight as X. Y = X not (DG or TG), Z= (Y area)/(100*100),If Z > 25%, highlight Y for AA density inside of Y that cannot meet of rule value requirement")

processCoverage( backup measure( windowSize=100 stepSize=50
        L11057d=calculate(area(gt_all)/area(bulk_no_dt)) ))
    gt20cx=geomGetCoverage(L11057d keep<0.05)
    gt20cy=geomAnd(gt20cx DGTG )
    processCoverage( backup measure(
        L11057dm=calculate(area(gt20cy)/10000 )))
    gt20cm1=geomGetCoverage(L11057dm keep>0.25)
gt20cm=geomCat( gt20cm1)
    processCoverage( backup measure(
        L11057gtc=calculate(area(gt_all)/area(gt20cm) )))
    gt20cw=geomGetCoverage(L11057gtc keep<0.05)
    gt20c_all=geomAnd(geomAndNot(gt20cw MARKG)  DGTG)
    errorLayer(gt20c_all "GT_20d:For area excluding (DG or TG), poly density (including dummy)is 10%. Density check window size: 100um*100um with step size: 50um,Waive  seal ring(MARKS) areas,DRC check with the said window size and rule number and highlight as X. Y = X not (DG or TG), Z= (Y area)/(100*100),If Z > 25%, highlight Y for AA density inside of Y that cannot meet of rule value requirement")


    processCoverage( backup measure( windowSize=110 stepSize=55
        L56210=calculate(area(m1all)/area()) ))
    errorLayer(geomAndNot(geomGetCoverage(L56210 0.1<=ignore<=0.85) MARKG)
        "M1_8_8a: M1 density in 110um*110um window with step size 55um min 10%,max 85%")

    processCoverage( backup measure( windowSize=200
        rule_den=calculate(area(m1all)/area()) ))
    errorLayer(geomAndNot(geomGetCoverage(rule_den keep>0 gradient>0.5) MARKG)
        "M1_8b: M1 maximum density difference (%) between any two 200um adjacent window (stepped without overlapping ) <= 50%")

    processCoverage( backup measure( windowSize=840
        L16917=calculate(area(m1all)/area()) ))
    errorLayer(geomAndNot(geomGetCoverage(L16917 keep>0.70) MARKG)
        "M1_8c: M1 maximum density (%) with 840 um*840um window <= 70%")

    processCoverage( backup measure( 
        L16918=calculate(area(m1all)/area()) ))
    errorLayer(geomAndNot(geomGetCoverage(L16918 keep<0.20) MARKG)
        "M1_8d:M1 density over the whole chip is >=20%")

    processCoverage( backup measure( windowSize=110 stepSize=55
        L72174=calculate(area(m2all)/area()) ))
    errorLayer(geomAndNot(geomGetCoverage(L72174 0.10<=ignore<=0.85) MARKG)
        "M2_7_7a: M2 minimum/maximum density (%) in 110um*110um window with step size 55um 10% <= density <= 85%")
    processCoverage( backup measure( windowSize=200
        rule_den=calculate(area(m2all)/area()) ))
    errorLayer(geomAndNot(geomGetCoverage(rule_den keep>0 gradient>0.5) MARKG)
        "M2_7b: M2 maximum density difference (%) between any two 200um adjacent window (stepped without overlapping ) <= 50%")

    processCoverage( backup measure( windowSize=840
        L46677=calculate(area(m2all)/area()) ))
    errorLayer(geomAndNot(geomGetCoverage(L46677 keep>0.70) MARKG)
        "M2_7c: M2 maximum density (%) with 840 um*840um window <= 70%")

    processCoverage( backup measure( windowSize=110 stepSize=55
        L70450=calculate(area(m3all)/area()) ))
    errorLayer(geomAndNot(geomGetCoverage(L70450 0.10<=ignore<=0.85) MARKG)
        "M3_7_7a: M3 minimum/maximum density (%) in 110um*110um window with step size 55um 10% <= density <= 85%")
    processCoverage( backup measure( windowSize=200
        rule_den=calculate(area(m3all)/area()) ))
    errorLayer(geomAndNot(geomGetCoverage(rule_den keep>0 gradient>0.5) MARKG)
        "M3_7b: M3 maximum density difference (%) between any two 200um adjacent window (stepped without overlapping ) <= 50%")

    processCoverage( backup measure( windowSize=840
        L76468=calculate(area(m3all)/area()) ))
    errorLayer(geomAndNot(geomGetCoverage(L76468 keep>0.70) MARKG)
        "M3_7c: M3 maximum density (%) with 840 um*840um window <= 70%")

    processCoverage( backup measure( windowSize=200 stepSize=100
        L46678=calculate(area(m2_gt2p8_m1)/area()) ))
    errorLayer(geomAndNot(geomGetCoverage(L46678 keep>0.7) MARKG)
        "M2_7d: [(M2 with width > 2.8 um) over M1] maximum density (%) with 200 um*200um <= 70%")

    processCoverage( backup measure( windowSize=200 stepSize=100
        L46680=calculate(area(m1_gt2p8_m2)/area()) ))
    errorLayer(geomAndNot(geomGetCoverage(L46680 keep>0.7) MARKG)
        "M2_7e: [M2 over [M1 with width > 2.8 um] maximum density (%) with 200 um*200um <= 70%")
    
    processCoverage( backup measure( 
        L46681=calculate(area(m2all)/area()) ))
    errorLayer(geomAndNot(geomGetCoverage(L46681 keep<0.2) MARKG)
        "M2_7f:Mn density over the whole chip is >=20%")


    processCoverage( backup measure( windowSize=200 stepSize=100
        L76469=calculate(area(m3_gt2p8_m2)/area()) ))
    errorLayer(geomAndNot(geomGetCoverage(L76469 keep>0.70) MARKG)
        "M3_7d: [(M3 with width > 2.8 um) over M2] maximum density (%) with 200 um*200um <= 70%")

    processCoverage( backup measure( windowSize=200 stepSize=100
        L76470=calculate(area(m2_gt2p8_m3)/area()) ))
    errorLayer(geomAndNot(geomGetCoverage(L76470 keep>0.70) MARKG)
        "M3_7e: [M3 over [M2 with width > 2.8 um] maximum density (%) with 200 um*200um <= 70%")

   processCoverage( backup measure( 
        L46682=calculate(area(m3all)/area()) ))
    errorLayer(geomAndNot(geomGetCoverage(L46682 keep<0.2) MARKG)
        "M3_7f:Mn density over the whole chip is >=20%")


if( avSwitch("UTM_NO")  then
    processCoverage( backup measure( windowSize=200 stepSize=100
        L72172=calculate(area(tm2all)/area(bulk_no_MIN)) ))
    errorLayer(geomAndNot(geomGetCoverage(L72172 0.2<ignore<0.85) geomOr(MARKG INDMY))
        "TM2_10_ab: Dummy pattern is required in case TM2 density is less than 20%. Density check window: Window size:200um*200um, step size:100um 20% <= density <= 85%")

processCoverage( backup measure( 
        L72173=calculate(area(tm2all)/area(bulk_no_MIN)) ))
    errorLayer(geomAndNot(geomGetCoverage(L72173 keep<0.2) MARKG)
        "TM2_10a: Dummy pattern is required in case TM2 density is less than 20%. Density check window: Window size:200um*200um, step size:100um 20% <= density <= 85%")

    processCoverage( backup measure( windowSize=200
        rule_den=calculate(area(tm2all)/area()) ))
    errorLayer(geomAndNot(geomGetCoverage(rule_den keep>0 gradient>0.5) MARKG)
        "TM2_11: TM2 maximum density difference (%) between any two 200um adjacent window (stepped without overlapping ) <= 50%")
)
    processCoverage( backup measure( windowSize=100
        L29635=calculate(area(ALALPA2)/area(rule_alpa5_zone)) ))
        check_region=geomOr(BORDER INDMY)
    errorLayer(geomAndNot(geomAnd(geomGetCoverage(L29635 keep<0.10) check_region) MARKG)
        "ALPA_5: ALPA minimum density with 100um*100um window, with exemption of touching inductor >= 10%")

    processCoverage( backup measure( L4937=calculate(area(ALALPA2)/area()) ))
    errorLayer(geomAndNot(geomGetCoverage(L4937 0.1<=ignore<=0.7) MARKG)
        "ALPA_9_10: ALALPA min/max density : 10% <= density <= 70%")


)
M1DUM_INDMY=geomAnd(MnDUM_metal1 INDMY)
M2DUM_INDMY=geomAnd(MnDUM_metal2 INDMY)
M3DUM_INDMY=geomAnd(MnDUM_metal3 INDMY)
if( !avSwitch("CUSTOMER_DUMMY_CHECKS") && avSwitch("DENSITY_CHECKS")  then
    processCoverage( backup measure( 
        L28350=calculate(area(M1DUM_INDMY)/area(INDMY)) ))
    errorLayer(geomGetCoverage(L28350 keep>0.12)
        "DUMC_30: Maximum xx Dummy density within INDMY. (Where xx=M1~M8, TM1, TM2. Only check dummy metal density) 12%")

    processCoverage( backup measure( 
        L28351=calculate(area(M2DUM_INDMY)/area(INDMY)) ))
    errorLayer(geomGetCoverage(L28351 keep>0.12)
        "DUMC_30: Maximum xx Dummy density within INDMY. (Where xx=M1~M8, TM1, TM2. Only check dummy metal density) 12%")

    processCoverage( backup measure( 
        L28352=calculate(area(M3DUM_INDMY)/area(INDMY)) ))
    errorLayer(geomGetCoverage(L28352 keep>0.12)
        "DUMC_30: Maximum xx Dummy density within INDMY. (Where xx=M1~M8, TM1, TM2. Only check dummy metal density) 12%")
)

M4DUM_INDMY=geomAnd(MnDUM_metal4 INDMY)
M5DUM_INDMY=geomAnd(MnDUM_metal5 INDMY)
M6DUM_INDMY=geomAnd(MnDUM_metal6 INDMY)

procedure( switchProc371()
    processCoverage( backup measure( 
        L28355=calculate(area(M4DUM_INDMY)/area(INDMY)) ))
    errorLayer(geomGetCoverage(L28355 keep>0.12)
        "DUMC_30: Maximum xx Dummy density within INDMY. (Where xx=M1~M8, TM1, TM2. Only check dummy metal density) 12%")

)

procedure( switchProc370()
    processCoverage( backup measure( 
        L28355=calculate(area(M5DUM_INDMY)/area(INDMY)) ))
    errorLayer(geomGetCoverage(L28355 keep>0.12)
        "DUMC_30: Maximum xx Dummy density within INDMY. (Where xx=M1~M8, TM1, TM2. Only check dummy metal density) 12%")

)

; procedure for switches !METAL_OPTION_6LM_1TM && !METAL_OPTION_7LM_2TM && DENSITY_CHECKS
procedure( switchProc37()
    processCoverage( backup measure( 
        L28355=calculate(area(M6DUM_INDMY)/area(INDMY)) ))
    errorLayer(geomGetCoverage(L28355 keep>0.12)
        "DUMC_30: Maximum xx Dummy density within INDMY. (Where xx=M1~M8, TM1, TM2. Only check dummy metal density) 12%")

)

; procedure for switches DENSITY_CHECKS && !METAL_OPTION_6LM_1TM && !METAL_OPTION_7LM_2TM
procedure( switchProc38()
    processCoverage( backup measure( windowSize=110 stepSize=55
        L63730=calculate(area(m6all)/area()) ))
    errorLayer(geomAndNot(geomGetCoverage(L63730 0.10<=ignore<=0.85) MARKG)
        "M6_7_7a: M6 minimum/maximum density (%) in 110um*110um window with step size 55um 10% <= density <= 85%")
    processCoverage( backup measure( windowSize=200
        rule_den=calculate(area(m6all)/area()) ))
    errorLayer(geomAndNot(geomGetCoverage(rule_den keep>0 gradient>0.5) MARKG)
        "M6_7b: M6 maximum density difference (%) between any two 200um adjacent window (stepped without overlapping ) <= 50%")

    processCoverage( backup measure( windowSize=840
        L65841=calculate(area(m6all)/area()) ))
    errorLayer(geomAndNot(geomGetCoverage(L65841 keep>0.70) MARKG)
        "M6_7c: M6 maximum density (%) with 840 um*840um window <= 70%")

    processCoverage( backup measure( windowSize=200 stepSize=100
        L65842=calculate(area(m6_gt2p8_m5)/area()) ))
    errorLayer(geomAndNot(geomGetCoverage(L65842 keep>0.70) MARKG)
        "M6_7d: [(M6 with width > 2.8 um) over M5] maximum density (%) with 200 um*200um <= 70%")

    processCoverage( backup measure( windowSize=200 stepSize=100
        L65843=calculate(area(m5_gt2p8_m6)/area()) ))
    errorLayer(geomAndNot(geomGetCoverage(L65843 keep>0.7) MARKG)
        "M6_7e: [M6 over [M5 with width > 2.8 um] maximum density (%) with 200 um*200um <= 70%")

   processCoverage( backup measure( 
        L65844=calculate(area(m6all)/area()) ))
    errorLayer(geomAndNot(geomGetCoverage(L65844 keep<0.2) MARKG)
        "M6_7f:Mn density over the whole chip is >=20%")

)
M7DUM_INDMY=geomAnd(MnDUM_metal7 INDMY)
; procedure for switches !METAL_OPTION_7LM_1TM && !METAL_OPTION_8LM_2TM && !METAL_OPTION_6LM_1TM
;  && !METAL_OPTION_7LM_2TM && DENSITY_CHECKS
procedure( switchProc39()
    processCoverage( backup measure( 
        L28356=calculate(area(M7DUM_INDMY)/area(INDMY)) ))
    errorLayer(geomGetCoverage(L28356 keep>0.12)
        "DUMC_30: Maximum xx Dummy density within INDMY. (Where xx=M1~M8, TM1, TM2. Only check dummy metal density) 12%")

)
; procedure for switches DENSITY_CHECKS && !METAL_OPTION_7LM_1TM && !METAL_OPTION_8LM_2TM
;  && !METAL_OPTION_6LM_1TM && !METAL_OPTION_7LM_2TM
procedure( switchProc40()
    processCoverage( backup measure( windowSize=110 stepSize=55
        L60942=calculate(area(m7all)/area()) ))
    errorLayer(geomAndNot(geomGetCoverage(L60942 0.10<=ignore<=0.85) MARKG)
        "M7_7_7a: M7 minimum/maximum density (%) in 110um*110um window with step size 55um 10% <= density <= 85%")
    processCoverage( backup measure( windowSize=200
        rule_den=calculate(area(m7all)/area()) ))
    errorLayer(geomAndNot(geomGetCoverage(rule_den keep>0 gradient>0.5) MARKG)
        "M7_7b: M7 maximum density difference (%) between any two 200um adjacent window (stepped without overlapping ) <= 50%")

    processCoverage( backup measure( windowSize=840
        L95632=calculate(area(m7all)/area()) ))
    errorLayer(geomAndNot(geomGetCoverage(L95632 keep>0.70) MARKG)
        "M7_7c: M7 maximum density (%) with 840 um*840um window <= 70%")

    processCoverage( backup measure( windowSize=200 stepSize=100
        L95633=calculate(area(m7_gt2p8_m6)/area()) ))
    errorLayer(geomAndNot(geomGetCoverage(L95633 keep>0.70) MARKG)
        "M7_7d: [(M7 with width > 2.8 um) over M6] maximum density (%) with 200 um*200um <= 70%")

    processCoverage( backup measure( windowSize=200 stepSize=100
        L95634=calculate(area(m6_gt2p8_m7)/area()) ))
    errorLayer(geomAndNot(geomGetCoverage(L95634 keep>0.70) MARKG)
        "M7_7e: [M7 over [M6 with width > 2.8 um] maximum density (%) with 200 um*200um <= 70%")

    processCoverage(measure( 
        L95635=calculate(area(m7all)/area()) ))
    errorLayer(geomAndNot(geomGetCoverage(L95635 keep<0.20) MARKG)
        "M7_7f: Mn density over the whole chip is >=20%")

)
M8DUM_INDMY=geomAnd(MnDUM_metal8 INDMY)
; procedure for switches !METAL_OPTION_8LM_1TM && !METAL_OPTION_9LM_2TM && !METAL_OPTION_7LM_1TM
;  && !METAL_OPTION_8LM_2TM && !METAL_OPTION_6LM_1TM && !METAL_OPTION_7LM_2TM && DENSITY_CHECKS
procedure( switchProc41()
    processCoverage( backup measure(
        L28357=calculate(area(M8DUM_INDMY)/area(INDMY)) ))
    errorLayer(geomGetCoverage(L28357 keep>0.12)
        "DUMC_30: Maximum xx Dummy density within INDMY. (Where xx=M1~M8, TM1, TM2. Only check dummy metal density) 12%")

)

; procedure for switches DENSITY_CHECKS && !METAL_OPTION_8LM_1TM && !METAL_OPTION_9LM_2TM
;  && !METAL_OPTION_7LM_1TM && !METAL_OPTION_8LM_2TM && !METAL_OPTION_6LM_1TM && !METAL_OPTION_7LM_2TM
procedure( switchProc42()
    processCoverage( backup measure( windowSize=110 stepSize=55
        L81682=calculate(area(m8all)/area()) ))
    errorLayer(geomAndNot(geomGetCoverage(L81682 0.10<=ignore<=0.85) MARKG)
        "M8_7_7a: M8 minimum/maximum density (%) in 110um*110um window with step size 55um 10% <= density <= 85%")
    processCoverage( backup measure( windowSize=200
        rule_den=calculate(area(m8all)/area()) ))
    errorLayer(geomAndNot(geomGetCoverage(rule_den keep>0 gradient>0.5) MARKG)
        "M8_7b: M8 maximum density difference (%) between any two 200um adjacent window (stepped without overlapping ) <= 50%")

    processCoverage( backup measure( windowSize=840
        L25423=calculate(area(m8all)/area()) ))
    errorLayer(geomAndNot(geomGetCoverage(L25423 keep>0.70) MARKG)
        "M8_7c: M8 maximum density (%) with 840 um*840um window <= 70%")

    processCoverage( backup measure( windowSize=200 stepSize=100
        L25424=calculate(area(m8_gt2p8_m7)/area()) ))
    errorLayer(geomAndNot(geomGetCoverage(L25424 keep>0.70) MARKG)
        "M8_7d: [(M8 with width > 2.8 um) over M7] maximum density (%) with 200 um*200um <= 70%")

    processCoverage( backup measure( windowSize=200 stepSize=100
        L25425=calculate(area(m7_gt2p8_m8)/area()) ))
    errorLayer(geomAndNot(geomGetCoverage(L25425 keep>0.70) MARKG)
        "M8_7e: [M8 over [M7 with width > 2.8 um] maximum density (%) with 200 um*200um <= 70%")
   
    processCoverage( backup measure( 
        L25426=calculate(area(m8all)/area()) ))
    errorLayer(geomAndNot(geomGetCoverage(L25426 keep<0.20) MARKG)
        "M8_7f:Mn density over the whole chip is >=20%")

)

; procedure for switches METAL_OPTION_10LM_2TM && DENSITY_CHECKS || METAL_OPTION_8LM_2TM
;  && DENSITY_CHECKS || METAL_OPTION_9LM_2TM && DENSITY_CHECKS
procedure( switchProc43()
    processCoverage( backup measure( windowSize=200 stepSize=100
        L1963=calculate(area(tm1all)/area()) ))
    errorLayer(geomAndNot(geomGetCoverage(L1963 0.20<=ignore<=0.85) geomOr(MARKG INDMY))
        "TM1_10_ab: Dummy pattern is required in case TM1 density is less than 20%. Density check window: Window size:200um*200um, step size:100um 00% <= density <= 85%")

    processCoverage( backup measure( 
        L1964=calculate(area(tm1all)/area()) ))
    errorLayer(geomAndNot(geomGetCoverage(L1964 keep<0.20) MARKG)
       "TM1_10a:TM1 density  over the whole chip is >=20%")

    processCoverage( backup measure( windowSize=200
        rule_den=calculate(area(tm1all)/area()) ))
    errorLayer(geomAndNot(geomGetCoverage(rule_den keep>0 gradient>0.5) MARKG)
        "TM1_12: TM1 maximum density difference (%) between any two 200um adjacent window (stepped without overlapping ) <= 50%")

    processCoverage( backup measure( windowSize=840
        L1962=calculate(area(tm1all)/area()) ))
    errorLayer(geomAndNot(geomGetCoverage(L1962 keep>0.70) MARKG)
        "TM1_11: MAX density(%) with 840um*840um area <= 70%")

)
TM1DUM_INDMY=geomAnd(MnDUM_topmetal1 INDMY)
; procedure for switches METAL_OPTION_10LM_2TM || METAL_OPTION_7LM_2TM || METAL_OPTION_8LM_2TM
;  || METAL_OPTION_9LM_2TM
procedure( switchProc44()
if( !avSwitch("CUSTOMER_DUMMY_CHECKS") && avSwitch("DENSITY_CHECKS")  then
    processCoverage( backup measure( 
        L28358=calculate(area(TM1DUM_INDMY)/area(INDMY)) ))
    errorLayer(geomGetCoverage(L28358 keep>0.12)
        "DUMC_30: Maximum xx Dummy density within INDMY. (Where xx=M1~M8, TM1, TM2. Only check dummy metal density) 12%")

)
)
/*
; procedure for switches ANTENNA_CHECKS
procedure( switchProc45()
    geomConnect(
        buttOrOver(poly_mos GT)
    )

    processAntenna(
        gate((gate GT))
        antenna(poly_mos)
        ratio=(poly_mos.perimeter*0.065) / gate.area
        drcAntenna(poly_mos (poly_mos) ratio keep>500
            "ANT.GT1: Maximum drawn ratio of field poly perimeter area to the active poly gate area connected directly to it : 500")
    )

    processAntenna(
        gate((gate GT))
        antenna(poly_mos)
        ratio=poly_mos.area / gate.area
        drcAntenna(poly_mos (poly_mos) ratio keep>250
            "ANT.GT2: Maximum drawn ratio of field poly top area to the active poly gate area connected directly to it : 250")
    )

    geomConnect(
        incremental
        buttOrOver(ct_poly poly_mos)
    )

    processAntenna(
        gate((gate GT))
        antenna(ct_poly poly_mos)
        ratio=ct_poly.area / gate.area
        drcAntenna(ct_poly (ct_poly) ratio keep>10
            "ANT.GT3: Maximum drawn ratio of CT area to the active poly gate area connected directly to it <= 10")
    )

    geomConnect(
        buttOrOver(ct_aa ant_dio)
        buttOrOver(ct_poly poly_mos)
        buttOrOver(m1_ct ct_aa)
        buttOrOver(m1_ct ct_poly)
        buttOrOver(V1 m1_ct)
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(V1 m1_ct ct_poly ct_aa)
        diffusion(ant_dio)
        ratio=V1.area / gate.area
        drcAntenna(V1 (V1) ratio keep>20
            "ANT.GT6: When the protection diode is not used, the maximum drawn ratio of V1 area to the active poly gate area connected directly to it <= 20")
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(V1 m1_ct ct_poly ct_aa)
        diffusion(ant_dio)
        ratio=( ( V1.area / gate.area ) - ( ant_dio.area*200) )
        drcAntenna(V1 (V1) ratio keep>1000
            "ANT.GT7: When the protection diode with area larger than 0.054um^2 is used, the maximum drawn ratio of V1 area to the active poly gate area can be calculated by the following equation: Ratio = diode area * 200 + 1000")
    )

    geomConnect(
        incremental
        buttOrOver(M2 V1)
        buttOrOver(V2 M2)
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(V2 M2 V1 m1_ct ct_poly ct_aa)
        diffusion(ant_dio)
        ratio=V2.area / gate.area
        drcAntenna(V2 (V2) ratio keep>20
            "ANT.GT6: When the protection diode is not used, the maximum drawn ratio of V2 area to the active poly gate area connected directly to it <= 20")
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(V2 M2 V1 m1_ct ct_poly ct_aa)
        diffusion(ant_dio)
        ratio=( ( V2.area / gate.area ) - ( ant_dio.area*200) )
        drcAntenna(V2 (V2) ratio keep>1000
            "ANT.GT7: When the protection diode with area larger than 0.054um^2 is used, the maximum drawn ratio of V2 area to the active poly gate area can be calculated by the following equation: Ratio = diode area * 200 + 1000")
    )

if( !avSwitch("METAL_OPTION_6LM_2TM") && !avSwitch("METAL_OPTION_5LM_2TM") &&
    !avSwitch("METAL_OPTION_5LM_1TM") && !avSwitch("METAL_OPTION_4LM_1TM") then


    geomConnect(
        incremental
        buttOrOver(M3 V2)
        buttOrOver(V3 M3)
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(V3 M3 V2 M2 V1 m1_ct ct_poly ct_aa)
        diffusion(ant_dio)
        ratio=V3.area / gate.area
        drcAntenna(V3 (V3) ratio keep>20
            "ANT.GT6: When the protection diode is not used, the maximum drawn ratio of V3 area to the active poly gate area connected directly to it <= 20")
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(V3 M3 V2 M2 V1 m1_ct ct_poly ct_aa)
        diffusion(ant_dio)
        ratio=( ( V3.area / gate.area ) - ( ant_dio.area*200) )
        drcAntenna(V3 (V3) ratio keep>1000
            "ANT.GT7: When the protection diode with area larger than 0.054um^2 is used, the maximum drawn ratio of V3 area to the active poly gate area can be calculated by the following equation: Ratio = diode area * 200 + 1000")
    )

    geomConnect(
        incremental
        buttOrOver(M4 V3)
        buttOrOver(V4 M4)
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(V4 M4 V3 M3 V2 M2 V1 m1_ct ct_poly ct_aa)
        diffusion(ant_dio)
        ratio=V4.area / gate.area
        drcAntenna(V4 (V4) ratio keep>20
            "ANT.GT6: When the protection diode is not used, the maximum drawn ratio of V4 area to the active poly gate area connected directly to it <= 20")
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(V4 M4 V3 M3 V2 M2 V1 m1_ct ct_poly ct_aa)
        diffusion(ant_dio)
        ratio=( ( V4.area / gate.area ) - ( ant_dio.area*200) )
        drcAntenna(V4 (V4) ratio keep>1000
            "ANT.GT7: When the protection diode with area larger than 0.054um^2 is used, the maximum drawn ratio of V4 area to the active poly gate area can be calculated by the following equation: Ratio = diode area * 200 + 1000")
    )

)

)
*/
; procedure for switches ANTENNA_CHECKS && !METAL_OPTION_6LM_1TM && !METAL_OPTION_7LM_2TM
/*
procedure( switchProc46()
    geomConnect(
        buttOrOver(ct_aa ant_dio)
        buttOrOver(ct_poly poly_mos)
        buttOrOver(m1_ct ct_aa)
        buttOrOver(m1_ct ct_poly)
        buttOrOver(V1 m1_ct)
        buttOrOver(M2 V1)
        buttOrOver(V2 M2)
        buttOrOver(M3 V2)
        buttOrOver(V3 M3)
        buttOrOver(M4 V3)
        buttOrOver(V4 M4)
        buttOrOver(M5 V4)
        buttOrOver(V5 M5)
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(V5 M5 V4 M4 V3 M3 V2 M2 V1 m1_ct ct_poly ct_aa)
        diffusion(ant_dio)
        ratio=V5.area / gate.area
        drcAntenna(V5 (V5) ratio keep>20
            "ANT.GT6: When the protection diode is not used, the maximum drawn ratio of V5 area to the active poly gate area connected directly to it <= 20")
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(V5 M5 V4 M4 V3 M3 V2 M2 V1 m1_ct ct_poly ct_aa)
        diffusion(ant_dio)
        ratio=( ( V5.area / gate.area ) - ( ant_dio.area*200) )
        drcAntenna(V5 (V5) ratio keep>1000
            "ANT.GT7: When the protection diode with area larger than 0.054um^2 is used, the maximum drawn ratio of V5 area to the active poly gate area can be calculated by the following equation: Ratio = diode area * 200 + 1000")
    )

)
*/
; procedure for switches ANTENNA_CHECKS && !METAL_OPTION_6LM_1TM && !METAL_OPTION_7LM_1TM
;  && !METAL_OPTION_7LM_2TM && !METAL_OPTION_8LM_2TM
/*
procedure( switchProc47()
    geomConnect(
        buttOrOver(ct_aa ant_dio)
        buttOrOver(ct_poly poly_mos)
        buttOrOver(m1_ct ct_aa)
        buttOrOver(m1_ct ct_poly)
        buttOrOver(V1 m1_ct)
        buttOrOver(M2 V1)
        buttOrOver(V2 M2)
        buttOrOver(M3 V2)
        buttOrOver(V3 M3)
        buttOrOver(M4 V3)
        buttOrOver(V4 M4)
        buttOrOver(M5 V4)
        buttOrOver(V5 M5)
        buttOrOver(M6 V5)
        buttOrOver(V6 M6)
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(V6 M6 V5 M5 V4 M4 V3 M3 V2 M2 V1 m1_ct ct_poly ct_aa)
        diffusion(ant_dio)
        ratio=V6.area / gate.area
        drcAntenna(V6 (V6) ratio keep>20
            "ANT.GT6: When the protection diode is not used, the maximum drawn ratio of V6 area to the active poly gate area connected directly to it <= 20")
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(V6 M6 V5 M5 V4 M4 V3 M3 V2 M2 V1 m1_ct ct_poly ct_aa)
        diffusion(ant_dio)
        ratio=( ( V6.area / gate.area ) - ( ant_dio.area*200) )
        drcAntenna(V6 (V6) ratio keep>1000
            "ANT.GT7: When the protection diode with area larger than 0.054um^2 is used, the maximum drawn ratio of V6 area to the active poly gate area can be calculated by the following equation: Ratio = diode area * 200 + 1000")
    )

)
*/
; procedure for switches ANTENNA_CHECKS && !METAL_OPTION_6LM_1TM && !METAL_OPTION_7LM_1TM
;  && !METAL_OPTION_7LM_2TM && !METAL_OPTION_8LM_1TM && !METAL_OPTION_8LM_2TM && !METAL_OPTION_9LM_2TM
/*
procedure( switchProc48()
    geomConnect(
        buttOrOver(ct_aa ant_dio)
        buttOrOver(ct_poly poly_mos)
        buttOrOver(m1_ct ct_aa)
        buttOrOver(m1_ct ct_poly)
        buttOrOver(V1 m1_ct)
        buttOrOver(M2 V1)
        buttOrOver(V2 M2)
        buttOrOver(M3 V2)
        buttOrOver(V3 M3)
        buttOrOver(M4 V3)
        buttOrOver(V4 M4)
        buttOrOver(M5 V4)
        buttOrOver(V5 M5)
        buttOrOver(M6 V5)
        buttOrOver(V6 M6)
        buttOrOver(M7 V6)
        buttOrOver(V7 M7)
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(V7 M7 V6 M6 V5 M5 V4 M4 V3 M3 V2 M2 V1 m1_ct ct_poly ct_aa)
        diffusion(ant_dio)
        ratio=V7.area / gate.area
        drcAntenna(V7 (V7) ratio keep>20
            "ANT.GT6: When the protection diode is not used, the maximum drawn ratio of V7 area to the active poly gate area connected directly to it <= 20")
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(V7 M7 V6 M6 V5 M5 V4 M4 V3 M3 V2 M2 V1 m1_ct ct_poly ct_aa)
        diffusion(ant_dio)
        ratio=( ( V7.area / gate.area ) - ( ant_dio.area*200) )
        drcAntenna(V7 (V7) ratio keep>1000
            "ANT.GT7: When the protection diode with area larger than 0.054um^2 is used, the maximum drawn ratio of V7 area to the active poly gate area can be calculated by the following equation: Ratio = diode area * 200 + 1000")
    )

)
*/
; procedure for switches ANTENNA_CHECKS && METAL_OPTION_9LM_1TM
/*
procedure( switchProc49()
    geomConnect(
        buttOrOver(ct_aa ant_dio)
        buttOrOver(ct_poly poly_mos)
        buttOrOver(m1_ct ct_aa)
        buttOrOver(m1_ct ct_poly)
        buttOrOver(V1 m1_ct)
        buttOrOver(M2 V1)
        buttOrOver(V2 M2)
        buttOrOver(M3 V2)
        buttOrOver(V3 M3)
        buttOrOver(M4 V3)
        buttOrOver(V4 M4)
        buttOrOver(M5 V4)
        buttOrOver(V5 M5)
        buttOrOver(M6 V5)
        buttOrOver(V6 M6)
        buttOrOver(M7 V6)
        buttOrOver(V7 M7)
        buttOrOver(M8 V7)
        buttOrOver(TV2 M8)
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(TV2 M8 V7 M7 V6 M6 V5 M5 V4 M4 V3 M3 V2 M2 V1 m1_ct ct_poly
            ct_aa)
        diffusion(ant_dio)
        ratio=TV2.area / gate.area
        drcAntenna(TV2 (TV2) ratio keep>20
            "ANT.GT6: When the protection diode is not used, the maximum drawn ratio of TV2 area to the active poly gate area connected directly to it <= 20")
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(TV2 M8 V7 M7 V6 M6 V5 M5 V4 M4 V3 M3 V2 M2 V1 m1_ct ct_poly
            ct_aa)
        diffusion(ant_dio)
        ratio=( ( TV2.area / gate.area ) - ( ant_dio.area*200) )
        drcAntenna(TV2 (TV2) ratio keep>1000
            "ANT.GT7: When the protection diode with area larger than 0.054um^2 is used, the maximum drawn ratio of TV2 area to the active poly gate area can be calculated by the following equation: Ratio = diode area * 200 + 1000")
    )

)
*/
; procedure for switches ANTENNA_CHECKS && METAL_OPTION_8LM_1TM
/*
procedure( switchProc50()
    geomConnect(
        buttOrOver(ct_aa ant_dio)
        buttOrOver(ct_poly poly_mos)
        buttOrOver(m1_ct ct_aa)
        buttOrOver(m1_ct ct_poly)
        buttOrOver(V1 m1_ct)
        buttOrOver(M2 V1)
        buttOrOver(V2 M2)
        buttOrOver(M3 V2)
        buttOrOver(V3 M3)
        buttOrOver(M4 V3)
        buttOrOver(V4 M4)
        buttOrOver(M5 V4)
        buttOrOver(V5 M5)
        buttOrOver(M6 V5)
        buttOrOver(V6 M6)
        buttOrOver(M7 V6)
        buttOrOver(TV2 M7)
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(TV2 M7 V6 M6 V5 M5 V4 M4 V3 M3 V2 M2 V1 m1_ct ct_poly ct_aa)
        diffusion(ant_dio)
        ratio=TV2.area / gate.area
        drcAntenna(TV2 (TV2) ratio keep>20
            "ANT.GT6: When the protection diode is not used, the maximum drawn ratio of TV2 area to the active poly gate area connected directly to it <= 20")
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(TV2 M7 V6 M6 V5 M5 V4 M4 V3 M3 V2 M2 V1 m1_ct ct_poly ct_aa)
        diffusion(ant_dio)
        ratio=( ( TV2.area / gate.area ) - ( ant_dio.area*200) )
        drcAntenna(TV2 (TV2) ratio keep>1000
            "ANT.GT7: When the protection diode with area larger than 0.054um^2 is used, the maximum drawn ratio of TV2 area to the active poly gate area can be calculated by the following equation: Ratio = diode area * 200 + 1000")
    )

)
*/
; procedure for switches ANTENNA_CHECKS && METAL_OPTION_7LM_1TM
/*
procedure( switchProc51()
    geomConnect(
        buttOrOver(ct_aa ant_dio)
        buttOrOver(ct_poly poly_mos)
        buttOrOver(m1_ct ct_aa)
        buttOrOver(m1_ct ct_poly)
        buttOrOver(V1 m1_ct)
        buttOrOver(M2 V1)
        buttOrOver(V2 M2)
        buttOrOver(M3 V2)
        buttOrOver(V3 M3)
        buttOrOver(M4 V3)
        buttOrOver(V4 M4)
        buttOrOver(M5 V4)
        buttOrOver(V5 M5)
        buttOrOver(M6 V5)
        buttOrOver(TV2 M6)
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(TV2 M6 V5 M5 V4 M4 V3 M3 V2 M2 V1 m1_ct ct_poly ct_aa)
        diffusion(ant_dio)
        ratio=TV2.area / gate.area
        drcAntenna(TV2 (TV2) ratio keep>20
            "ANT.GT6: When the protection diode is not used, the maximum drawn ratio of TV2 area to the active poly gate area connected directly to it <= 20")
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(TV2 M6 V5 M5 V4 M4 V3 M3 V2 M2 V1 m1_ct ct_poly ct_aa)
        diffusion(ant_dio)
        ratio=( ( TV2.area / gate.area ) - ( ant_dio.area*200) )
        drcAntenna(TV2 (TV2) ratio keep>1000
            "ANT.GT7: When the protection diode with area larger than 0.054um^2 is used, the maximum drawn ratio of TV2 area to the active poly gate area can be calculated by the following equation: Ratio = diode area * 200 + 1000")
    )

)
*/
; procedure for switches ANTENNA_CHECKS && METAL_OPTION_6LM_1TM
/*
procedure( switchProc52()
    geomConnect(
        buttOrOver(ct_aa ant_dio)
        buttOrOver(ct_poly poly_mos)
        buttOrOver(m1_ct ct_aa)
        buttOrOver(m1_ct ct_poly)
        buttOrOver(V1 m1_ct)
        buttOrOver(M2 V1)
        buttOrOver(V2 M2)
        buttOrOver(M3 V2)
        buttOrOver(V3 M3)
        buttOrOver(M4 V3)
        buttOrOver(V4 M4)
        buttOrOver(M5 V4)
        buttOrOver(TV2 M5)
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(TV2 M5 V4 M4 V3 M3 V2 M2 V1 m1_ct ct_poly ct_aa)
        diffusion(ant_dio)
        ratio=TV2.area / gate.area
        drcAntenna(TV2 (TV2) ratio keep>20
            "ANT.GT6: When the protection diode is not used, the maximum drawn ratio of TV2 area to the active poly gate area connected directly to it <= 20")
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(TV2 M5 V4 M4 V3 M3 V2 M2 V1 m1_ct ct_poly ct_aa)
        diffusion(ant_dio)
        ratio=( ( TV2.area / gate.area ) - ( ant_dio.area*200) )
        drcAntenna(TV2 (TV2) ratio keep>1000
            "ANT.GT7: When the protection diode with area larger than 0.054um^2 is used, the maximum drawn ratio of TV2 area to the active poly gate area can be calculated by the following equation: Ratio = diode area * 200 + 1000")
    )

)

*/

; procedure for switches ANTENNA_CHECKS && METAL_OPTION_7LM_2TM
/*
procedure( switchProc53()
    geomConnect(
        buttOrOver(ct_aa ant_dio)
        buttOrOver(ct_poly poly_mos)
        buttOrOver(m1_ct ct_aa)
        buttOrOver(m1_ct ct_poly)
        buttOrOver(V1 m1_ct)
        buttOrOver(M2 V1)
        buttOrOver(V2 M2)
        buttOrOver(M3 V2)
        buttOrOver(V3 M3)
        buttOrOver(M4 V3)
        buttOrOver(V4 M4)
        buttOrOver(M5 V4)
        buttOrOver(TV1 M5)
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(TV1 M5 V4 M4 V3 M3 V2 M2 V1 m1_ct ct_poly ct_aa)
        diffusion(ant_dio)
        ratio=TV1.area / gate.area
        drcAntenna(TV1 (TV1) ratio keep>20
            "ANT.GT6: When the protection diode is not used, the maximum drawn ratio of TV1 area to the active poly gate area connected directly to it <= 20")
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(TV1 M5 V4 M4 V3 M3 V2 M2 V1 m1_ct ct_poly ct_aa)
        diffusion(ant_dio)
        ratio=( ( TV1.area / gate.area ) - ( ant_dio.area*200) )
        drcAntenna(TV1 (TV1) ratio keep>1000
            "ANT.GT7: When the protection diode with area larger than 0.054um^2 is used, the maximum drawn ratio of TV1 area to the active poly gate area can be calculated by the following equation: Ratio = diode area * 200 + 1000")
    )

    geomConnect(
        incremental
        buttOrOver(TM1 TV1)
        buttOrOver(TV2 TM1)
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(TV2 TM1 TV1 M5 V4 M4 V3 M3 V2 M2 V1 m1_ct ct_poly ct_aa)
        diffusion(ant_dio)
        ratio=TV2.area / gate.area
        drcAntenna(TV2 (TV2) ratio keep>20
            "ANT.GT6: When the protection diode is not used, the maximum drawn ratio of TV2 area to the active poly gate area connected directly to it <= 20")
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(TV2 TM1 TV1 M5 V4 M4 V3 M3 V2 M2 V1 m1_ct ct_poly ct_aa)
        diffusion(ant_dio)
        ratio=( ( TV2.area / gate.area ) - ( ant_dio.area*200) )
        drcAntenna(TV2 (TV2) ratio keep>1000
            "ANT.GT7: When the protection diode with area larger than 0.054um^2 is used, the maximum drawn ratio of TV2 area to the active poly gate area can be calculated by the following equation: Ratio = diode area * 200 + 1000")
    )

)
*/
; procedure for switches ANTENNA_CHECKS && METAL_OPTION_8LM_2TM
/*
procedure( switchProc54()
    geomConnect(
        buttOrOver(ct_aa ant_dio)
        buttOrOver(ct_poly poly_mos)
        buttOrOver(m1_ct ct_aa)
        buttOrOver(m1_ct ct_poly)
        buttOrOver(V1 m1_ct)
        buttOrOver(M2 V1)
        buttOrOver(V2 M2)
        buttOrOver(M3 V2)
        buttOrOver(V3 M3)
        buttOrOver(M4 V3)
        buttOrOver(V4 M4)
        buttOrOver(M5 V4)
        buttOrOver(V5 M5)
        buttOrOver(M6 V5)
        buttOrOver(TV1 M6)
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(TV1 M6 V5 M5 V4 M4 V3 M3 V2 M2 V1 m1_ct ct_poly ct_aa)
        diffusion(ant_dio)
        ratio=TV1.area / gate.area
        drcAntenna(TV1 (TV1) ratio keep>20
            "ANT.GT6: When the protection diode is not used, the maximum drawn ratio of TV1 area to the active poly gate area connected directly to it <= 20")
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(TV1 M6 V5 M5 V4 M4 V3 M3 V2 M2 V1 m1_ct ct_poly ct_aa)
        diffusion(ant_dio)
        ratio=( ( TV1.area / gate.area ) - ( ant_dio.area*200) )
        drcAntenna(TV1 (TV1) ratio keep>1000
            "ANT.GT7: When the protection diode with area larger than 0.054um^2 is used, the maximum drawn ratio of TV1 area to the active poly gate area can be calculated by the following equation: Ratio = diode area * 200 + 1000")
    )

    geomConnect(
        incremental
        buttOrOver(TM1 TV1)
        buttOrOver(TV2 TM1)
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(TV2 TM1 TV1 M6 V5 M5 V4 M4 V3 M3 V2 M2 V1 m1_ct ct_poly ct_aa)
        diffusion(ant_dio)
        ratio=TV2.area / gate.area
        drcAntenna(TV2 (TV2) ratio keep>20
            "ANT.GT6: When the protection diode is not used, the maximum drawn ratio of TV2 area to the active poly gate area connected directly to it <= 20")
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(TV2 TM1 TV1 M6 V5 M5 V4 M4 V3 M3 V2 M2 V1 m1_ct ct_poly ct_aa)
        diffusion(ant_dio)
        ratio=( ( TV2.area / gate.area ) - ( ant_dio.area*200) )
        drcAntenna(TV2 (TV2) ratio keep>1000
            "ANT.GT7: When the protection diode with area larger than 0.054um^2 is used, the maximum drawn ratio of TV2 area to the active poly gate area can be calculated by the following equation: Ratio = diode area * 200 + 1000")
    )

)
*/
; procedure for switches ANTENNA_CHECKS && METAL_OPTION_9LM_2TM
/*
procedure( switchProc55()
    geomConnect(
        buttOrOver(ct_aa ant_dio)
        buttOrOver(ct_poly poly_mos)
        buttOrOver(m1_ct ct_aa)
        buttOrOver(m1_ct ct_poly)
        buttOrOver(V1 m1_ct)
        buttOrOver(M2 V1)
        buttOrOver(V2 M2)
        buttOrOver(M3 V2)
        buttOrOver(V3 M3)
        buttOrOver(M4 V3)
        buttOrOver(V4 M4)
        buttOrOver(M5 V4)
        buttOrOver(V5 M5)
        buttOrOver(M6 V5)
        buttOrOver(V6 M6)
        buttOrOver(M7 V6)
        buttOrOver(TV1 M7)
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(TV1 M7 V6 M6 V5 M5 V4 M4 V3 M3 V2 M2 V1 m1_ct ct_poly ct_aa)
        diffusion(ant_dio)
        ratio=TV1.area / gate.area
        drcAntenna(TV1 (TV1) ratio keep>20
            "ANT.GT6: When the protection diode is not used, the maximum drawn ratio of TV1 area to the active poly gate area connected directly to it <= 20")
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(TV1 M7 V6 M6 V5 M5 V4 M4 V3 M3 V2 M2 V1 m1_ct ct_poly ct_aa)
        diffusion(ant_dio)
        ratio=( ( TV1.area / gate.area ) - ( ant_dio.area*200) )
        drcAntenna(TV1 (TV1) ratio keep>1000
            "ANT.GT7: When the protection diode with area larger than 0.054um^2 is used, the maximum drawn ratio of TV1 area to the active poly gate area can be calculated by the following equation: Ratio = diode area * 200 + 1000")
    )

    geomConnect(
        incremental
        buttOrOver(TM1 TV1)
        buttOrOver(TV2 TM1)
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(TV2 TM1 TV1 M7 V6 M6 V5 M5 V4 M4 V3 M3 V2 M2 V1 m1_ct ct_poly
            ct_aa)
        diffusion(ant_dio)
        ratio=TV2.area / gate.area
        drcAntenna(TV2 (TV2) ratio keep>20
            "ANT.GT6: When the protection diode is not used, the maximum drawn ratio of TV2 area to the active poly gate area connected directly to it <= 20")
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(TV2 TM1 TV1 M7 V6 M6 V5 M5 V4 M4 V3 M3 V2 M2 V1 m1_ct ct_poly
            ct_aa)
        diffusion(ant_dio)
        ratio=( ( TV2.area / gate.area ) - ( ant_dio.area*200) )
        drcAntenna(TV2 (TV2) ratio keep>1000
            "ANT.GT7: When the protection diode with area larger than 0.054um^2 is used, the maximum drawn ratio of TV2 area to the active poly gate area can be calculated by the following equation: Ratio = diode area * 200 + 1000")
    )

)
*/
; procedure for switches ANTENNA_CHECKS && METAL_OPTION_10LM_2TM
/*
procedure( switchProc56()
    geomConnect(
        buttOrOver(ct_aa ant_dio)
        buttOrOver(ct_poly poly_mos)
        buttOrOver(m1_ct ct_aa)
        buttOrOver(m1_ct ct_poly)
        buttOrOver(V1 m1_ct)
        buttOrOver(M2 V1)
        buttOrOver(V2 M2)
        buttOrOver(M3 V2)
        buttOrOver(V3 M3)
        buttOrOver(M4 V3)
        buttOrOver(V4 M4)
        buttOrOver(M5 V4)
        buttOrOver(V5 M5)
        buttOrOver(M6 V5)
        buttOrOver(V6 M6)
        buttOrOver(M7 V6)
        buttOrOver(V7 M7)
        buttOrOver(M8 V7)
        buttOrOver(TV1 M8)
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(TV1 M8 V7 M7 V6 M6 V5 M5 V4 M4 V3 M3 V2 M2 V1 m1_ct ct_poly
            ct_aa)
        diffusion(ant_dio)
        ratio=TV1.area / gate.area
        drcAntenna(TV1 (TV1) ratio keep>20
            "ANT.GT6: When the protection diode is not used, the maximum drawn ratio of TV1 area to the active poly gate area connected directly to it <= 20")
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(TV1 M8 V7 M7 V6 M6 V5 M5 V4 M4 V3 M3 V2 M2 V1 m1_ct ct_poly
            ct_aa)
        diffusion(ant_dio)
        ratio=( ( TV1.area / gate.area ) - ( ant_dio.area*200) )
        drcAntenna(TV1 (TV1) ratio keep>1000
            "ANT.GT7: When the protection diode with area larger than 0.054um^2 is used, the maximum drawn ratio of TV1 area to the active poly gate area can be calculated by the following equation: Ratio = diode area * 200 + 1000")
    )

    geomConnect(
        incremental
        buttOrOver(TM1 TV1)
        buttOrOver(TV2 TM1)
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(TV2 TM1 TV1 M8 V7 M7 V6 M6 V5 M5 V4 M4 V3 M3 V2 M2 V1 m1_ct
            ct_poly ct_aa)
        diffusion(ant_dio)
        ratio=TV2.area / gate.area
        drcAntenna(TV2 (TV2) ratio keep>20
            "ANT.GT6: When the protection diode is not used, the maximum drawn ratio of TV2 area to the active poly gate area connected directly to it <= 20")
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(TV2 TM1 TV1 M8 V7 M7 V6 M6 V5 M5 V4 M4 V3 M3 V2 M2 V1 m1_ct
            ct_poly ct_aa)
        diffusion(ant_dio)
        ratio=( ( TV2.area / gate.area ) - ( ant_dio.area*200) )
        drcAntenna(TV2 (TV2) ratio keep>1000
            "ANT.GT7: When the protection diode with area larger than 0.054um^2 is used, the maximum drawn ratio of TV2 area to the active poly gate area can be calculated by the following equation: Ratio = diode area * 200 + 1000")
    )

)
*/
; procedure for switches ANTENNA_CHECKS
/*
procedure( switchProc57()
    geomConnect(
        buttOrOver(ct_aa ant_dio)
        buttOrOver(ct_poly poly_mos)
        buttOrOver(m1_ct ct_aa)
        buttOrOver(m1_ct ct_poly)
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(cumulative m1_ct ct_poly ct_aa)
        diffusion(ant_dio)
        ratio=m1_ct.area/gate.area
        drcAntenna(m1_ct (gate) ratio keep>5000
            "ANT.GT4: When a protection diode is not used, the maximum ratio of cumulative metal area to the active poly gate area from M1 to TM (if double TM used, TM layer defined as TM2 layer) <= 5000")
    )

    geomConnect(
        incremental
        buttOrOver(V1 m1_ct)
        buttOrOver(M2 V1)
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(cumulative M2 V1 m1_ct ct_poly ct_aa)
        diffusion(ant_dio)
        ratio=M2.area/gate.area
        drcAntenna(M2 (gate) ratio keep>5000
            "ANT.GT4: When a protection diode is not used, the maximum ratio of cumulative metal area to the active poly gate area from M1 to TM (if double TM used, TM layer defined as TM2 layer) <= 5000")
    )

    geomConnect(
        incremental
        buttOrOver(V2 M2)
        buttOrOver(M3 V2)
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(cumulative M3 V2 M2 V1 m1_ct ct_poly ct_aa)
        diffusion(ant_dio)
        ratio=M3.area/gate.area
        drcAntenna(M3 (gate) ratio keep>5000
            "ANT.GT4: When a protection diode is not used, the maximum ratio of cumulative metal area to the active poly gate area from M1 to TM (if double TM used, TM layer defined as TM2 layer) <= 5000")
    )

if( !avSwitch("METAL_OPTION_6LM_2TM") && !avSwitch("METAL_OPTION_5LM_2TM") &&
    !avSwitch("METAL_OPTION_5LM_1TM") && !avSwitch("METAL_OPTION_4LM_1TM") then

    geomConnect(
        incremental
        buttOrOver(V3 M3)
        buttOrOver(M4 V3)
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(cumulative M4 V3 M3 V2 M2 V1 m1_ct ct_poly ct_aa)
        diffusion(ant_dio)
        ratio=M4.area/gate.area
        drcAntenna(M4 (gate) ratio keep>5000
            "ANT.GT4: When a protection diode is not used, the maximum ratio of cumulative metal area to the active poly gate area from M1 to TM (if double TM used, TM layer defined as TM2 layer) <= 5000")
    )

    geomConnect(
        incremental
        buttOrOver(V4 M4)
        buttOrOver(M5 V4)
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(cumulative M5 V4 M4 V3 M3 V2 M2 V1 m1_ct ct_poly ct_aa)
        diffusion(ant_dio)
        ratio=M5.area/gate.area
        drcAntenna(M5 (gate) ratio keep>5000
            "ANT.GT4: When a protection diode is not used, the maximum ratio of cumulative metal area to the active poly gate area from M1 to TM (if double TM used, TM layer defined as TM2 layer) <= 5000")
    )
)

)
*/
/*
procedure( switchProc583()
    geomConnect(
        buttOrOver(ct_aa ant_dio)
        buttOrOver(ct_poly poly_mos)
        buttOrOver(m1_ct ct_aa)
        buttOrOver(m1_ct ct_poly)
        buttOrOver(V1 m1_ct)
        buttOrOver(M2 V1)
        buttOrOver(V2 M2)
        buttOrOver(M3 V2)
        buttOrOver(TV2 M3)
        buttOrOver(TM2 TV2)
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(cumulative TM2 TV2 M3 V2 M2 V1 m1_ct ct_poly ct_aa)
        diffusion(ant_dio)
        ratio=TM2.area/gate.area
        drcAntenna(TM2 (gate) ratio keep>5000
            "ANT.GT4: When a protection diode is not used, the maximum ratio of cumulative metal area to the active poly gate area from M1 to TM (if double TM used, TM layer defined as TM2 layer) <= 5000")
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(cumulative TM2 TV2 M3 V2 M2 V1 m1_ct ct_poly ct_aa
            ant_dio)
        ratio=( ( ( m1_ct.area +M2.area +M3.area + TM2.area
            ) / gate.area ) - ( ant_dio.area*9984) )
        drcAntenna(TM2 (gate) ratio keep>55000
            "ANT.GT5: When a protection diode with area larger than 0.054um^2 is used, the maximum ratio of single TM layer: Ratio = diode area*9984+55000")
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(TV2 M3 V2 M2 V1 m1_ct ct_poly ct_aa)
        diffusion(ant_dio)
        ratio=TV2.area / gate.area
        drcAntenna(TV2 (TV2) ratio keep>20
            "ANT.GT6: When the protection diode is not used, the maximum drawn ratio of TV2 area to the active poly gate area connected directly to it <= 20")
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(TV2 M3 V2 M2 V1 m1_ct ct_poly ct_aa)
        diffusion(ant_dio)
        ratio=( ( TV2.area / gate.area ) - ( ant_dio.area*200) )
        drcAntenna(TV2 (TV2) ratio keep>1000
            "ANT.GT7: When the protection diode with area larger than 0.054um^2 is used, the maximum drawn ratio of V4 area to the active poly gate area can be calculated by the following equation: Ratio = diode area * 200 + 1000")
    )

)
*/


; procedure for switches ANTENNA_CHECKS && METAL_OPTION_6LM_1TM
/*
procedure( switchProc58()
    geomConnect(
        buttOrOver(ct_aa ant_dio)
        buttOrOver(ct_poly poly_mos)
        buttOrOver(m1_ct ct_aa)
        buttOrOver(m1_ct ct_poly)
        buttOrOver(V1 m1_ct)
        buttOrOver(M2 V1)
        buttOrOver(V2 M2)
        buttOrOver(M3 V2)
        buttOrOver(V3 M3)
        buttOrOver(M4 V3)
        buttOrOver(V4 M4)
        buttOrOver(M5 V4)
        buttOrOver(TV2 M5)
        buttOrOver(TM2 TV2)
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(cumulative TM2 TV2 M5 V4 M4 V3 M3 V2 M2 V1 m1_ct ct_poly ct_aa)
        diffusion(ant_dio)
        ratio=TM2.area/gate.area
        drcAntenna(TM2 (gate) ratio keep>5000
            "ANT.GT4: When a protection diode is not used, the maximum ratio of cumulative metal area to the active poly gate area from M1 to TM (if double TM used, TM layer defined as TM2 layer) <= 5000")
    )

)
*/
; procedure for switches ANTENNA_CHECKS && METAL_OPTION_7LM_1TM
/*
procedure( switchProc59()
    geomConnect(
        buttOrOver(ct_aa ant_dio)
        buttOrOver(ct_poly poly_mos)
        buttOrOver(m1_ct ct_aa)
        buttOrOver(m1_ct ct_poly)
        buttOrOver(V1 m1_ct)
        buttOrOver(M2 V1)
        buttOrOver(V2 M2)
        buttOrOver(M3 V2)
        buttOrOver(V3 M3)
        buttOrOver(M4 V3)
        buttOrOver(V4 M4)
        buttOrOver(M5 V4)
        buttOrOver(V5 M5)
        buttOrOver(M6 V5)
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(cumulative M6 V5 M5 V4 M4 V3 M3 V2 M2 V1 m1_ct ct_poly ct_aa)
        diffusion(ant_dio)
        ratio=M6.area/gate.area
        drcAntenna(M6 (gate) ratio keep>5000
            "ANT.GT4: When a protection diode is not used, the maximum ratio of cumulative metal area to the active poly gate area from M1 to TM (if double TM used, TM layer defined as TM2 layer) <= 5000")
    )

)
*/
; procedure for switches ANTENNA_CHECKS && METAL_OPTION_8LM_1TM
/*
procedure( switchProc60()
    geomConnect(
        buttOrOver(ct_aa ant_dio)
        buttOrOver(ct_poly poly_mos)
        buttOrOver(m1_ct ct_aa)
        buttOrOver(m1_ct ct_poly)
        buttOrOver(V1 m1_ct)
        buttOrOver(M2 V1)
        buttOrOver(V2 M2)
        buttOrOver(M3 V2)
        buttOrOver(V3 M3)
        buttOrOver(M4 V3)
        buttOrOver(V4 M4)
        buttOrOver(M5 V4)
        buttOrOver(V5 M5)
        buttOrOver(M6 V5)
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(cumulative M6 V5 M5 V4 M4 V3 M3 V2 M2 V1 m1_ct ct_poly ct_aa)
        diffusion(ant_dio)
        ratio=M6.area/gate.area
        drcAntenna(M6 (gate) ratio keep>5000
            "ANT.GT4: When a protection diode is not used, the maximum ratio of cumulative metal area to the active poly gate area from M1 to TM (if double TM used, TM layer defined as TM2 layer) <= 5000")
    )

)
*/
; procedure for switches ANTENNA_CHECKS && METAL_OPTION_9LM_1TM
/*
procedure( switchProc61()
    geomConnect(
        buttOrOver(ct_aa ant_dio)
        buttOrOver(ct_poly poly_mos)
        buttOrOver(m1_ct ct_aa)
        buttOrOver(m1_ct ct_poly)
        buttOrOver(V1 m1_ct)
        buttOrOver(M2 V1)
        buttOrOver(V2 M2)
        buttOrOver(M3 V2)
        buttOrOver(V3 M3)
        buttOrOver(M4 V3)
        buttOrOver(V4 M4)
        buttOrOver(M5 V4)
        buttOrOver(V5 M5)
        buttOrOver(M6 V5)
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(cumulative M6 V5 M5 V4 M4 V3 M3 V2 M2 V1 m1_ct ct_poly ct_aa)
        diffusion(ant_dio)
        ratio=M6.area/gate.area
        drcAntenna(M6 (gate) ratio keep>5000
            "ANT.GT4: When a protection diode is not used, the maximum ratio of cumulative metal area to the active poly gate area from M1 to TM (if double TM used, TM layer defined as TM2 layer) <= 5000")
    )

)
*/
/*
procedure( switchProc582()

    geomConnect(
        buttOrOver(ct_aa ant_dio)
        buttOrOver(ct_poly poly_mos)
        buttOrOver(m1_ct ct_aa)
        buttOrOver(m1_ct ct_poly)
        buttOrOver(V1 m1_ct)
        buttOrOver(M2 V1)
        buttOrOver(V2 M2)
        buttOrOver(M3 V2)
        buttOrOver(V3 M3)
        buttOrOver(M4 V3)
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(cumulative M4 V3 M3 V2 M2 V1 m1_ct ct_poly ct_aa)
        diffusion(ant_dio)
        ratio=M4.area/gate.area
        drcAntenna(M4 (gate) ratio keep>5000
            "ANT.GT4: When a protection diode is not used, the maximum ratio of cumulative metal area to the active poly gate area from M1 to TM (if double TM used, TM layer defined as TM2 layer) <= 5000")
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(cumulative M4 V3 M3 V2 M2 V1 m1_ct ct_poly ct_aa
            ant_dio)
        ratio=( ( ( m1_ct.area +M2.area +M3.area + M4.area
            ) / gate.area ) - ( ant_dio.area*9984) )
        drcAntenna(M4 (gate) ratio keep>55000
            "ANT.GT5: When a protection diode with area larger than 0.054um^2 is used, the maximum ratio of single TM layer: Ratio = diode area*9984+55000")
    )

   processAntenna(
        gate((gate poly_mos))
        antenna(V3 M3 V2 M2 V1 m1_ct ct_poly ct_aa)
        diffusion(ant_dio)
        ratio=V3.area / gate.area
        drcAntenna(V3 (V3) ratio keep>20
            "ANT.GT6: When the protection diode is not used, the maximum drawn ratio of V3 area to the active poly gate area connected directly to it <= 20")
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(V3 M3 V2 M2 V1 m1_ct ct_poly ct_aa)
        diffusion(ant_dio)
        ratio=( ( V3.area / gate.area ) - ( ant_dio.area*200) )
        drcAntenna(V3 (V3) ratio keep>1000
            "ANT.GT7: When the protection diode with area larger than 0.054um^2 is used, the maximum drawn ratio of V3 area to the active poly gate area can be calculated by the following equation: Ratio = diode area * 200 + 1000")
    )

    geomConnect(
        buttOrOver(ct_aa ant_dio)
        buttOrOver(ct_poly poly_mos)
        buttOrOver(m1_ct ct_aa)
        buttOrOver(m1_ct ct_poly)
        buttOrOver(V1 m1_ct)
        buttOrOver(M2 V1)
        buttOrOver(V2 M2)
        buttOrOver(M3 V2)
        buttOrOver(V3 M3)
        buttOrOver(M4 V3)
        buttOrOver(TV2 M4)
        buttOrOver(TM2 TV2)
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(cumulative TM2 TV2 M4 V3 M3 V2 M2 V1 m1_ct ct_poly ct_aa)
        diffusion(ant_dio)
        ratio=TM2.area/gate.area
        drcAntenna(TM2 (gate) ratio keep>5000
            "ANT.GT4: When a protection diode is not used, the maximum ratio of cumulative metal area to the active poly gate area from M1 to TM (if double TM used, TM layer defined as TM2 layer) <= 5000")
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(cumulative TM2 TV2 M4 V3 M3 V2 M2 V1 m1_ct ct_poly ct_aa
            ant_dio)
        ratio=( ( ( m1_ct.area +M2.area +M3.area + M4.area + TM2.area
            ) / gate.area ) - ( ant_dio.area*9984) )
        drcAntenna(TM2 (gate) ratio keep>55000
            "ANT.GT5: When a protection diode with area larger than 0.054um^2 is used, the maximum ratio of single TM layer: Ratio = diode area*9984+55000")
    )

   processAntenna(
        gate((gate poly_mos))
        antenna(TV2 M4 V3 M3 V2 M2 V1 m1_ct ct_poly ct_aa)
        diffusion(ant_dio)
        ratio=TV2.area / gate.area
        drcAntenna(TV2 (TV2) ratio keep>20
            "ANT.GT6: When the protection diode is not used, the maximum drawn ratio of TV2 area to the active poly gate area connected directly to it <= 20")
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(TV2 M4 V3 M3 V2 M2 V1 m1_ct ct_poly ct_aa)
        diffusion(ant_dio)
        ratio=( ( TV2.area / gate.area ) - ( ant_dio.area*200) )
        drcAntenna(TV2 (TV2) ratio keep>1000
            "ANT.GT7: When the protection diode with area larger than 0.054um^2 is used, the maximum drawn ratio of V4 area to the active poly gate area can be calculated by the following equation: Ratio = diode area * 200 + 1000")
    )

)
*/
/*
procedure( switchProc581()

    geomConnect(
        buttOrOver(ct_aa ant_dio)
        buttOrOver(ct_poly poly_mos)
        buttOrOver(m1_ct ct_aa)
        buttOrOver(m1_ct ct_poly)
        buttOrOver(V1 m1_ct)
        buttOrOver(M2 V1)
        buttOrOver(V2 M2)
        buttOrOver(M3 V2)
        buttOrOver(TV1 M3)
        buttOrOver(TM1 TV1)
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(cumulative TM1 TV1 M3 V2 M2 V1 m1_ct ct_poly ct_aa)
        diffusion(ant_dio)
        ratio=TM1.area/gate.area
        drcAntenna(TM1 (gate) ratio keep>5000
            "ANT.GT4: When a protection diode is not used, the maximum ratio of cumulative metal area to the active poly gate area from M1 to TM (if double TM used, TM layer defined as TM2 layer) <= 5000")
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(cumulative TM1 TV1 M3 V2 M2 V1 m1_ct ct_poly ct_aa
            ant_dio)
        ratio=( ( ( m1_ct.area +M2.area +M3.area + TM1.area
            ) / gate.area ) - ( ant_dio.area*9984) )
        drcAntenna(TM1 (gate) ratio keep>55000
            "ANT.GT5: When a protection diode with area larger than 0.054um^2 is used, the maximum ratio of single TM layer: Ratio = diode area*9984+55000")
    )

   processAntenna(
        gate((gate poly_mos))
        antenna(TV1 M3 V2 M2 V1 m1_ct ct_poly ct_aa)
        diffusion(ant_dio)
        ratio=TV1.area / gate.area
        drcAntenna(TV1 (TV1) ratio keep>20
            "ANT.GT6: When the protection diode is not used, the maximum drawn ratio of TV1 area to the active poly gate area connected directly to it <= 20")
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(TV1 M3 V2 M2 V1 m1_ct ct_poly ct_aa)
        diffusion(ant_dio)
        ratio=( ( TV1.area / gate.area ) - ( ant_dio.area*200) )
        drcAntenna(TV1 (TV1) ratio keep>1000
            "ANT.GT7: When the protection diode with area larger than 0.054um^2 is used, the maximum drawn ratio of V4 area to the active poly gate area can be calculated by the following equation: Ratio = diode area * 200 + 1000")
    )

    geomConnect(
        buttOrOver(ct_aa ant_dio)
        buttOrOver(ct_poly poly_mos)
        buttOrOver(m1_ct ct_aa)
        buttOrOver(m1_ct ct_poly)
        buttOrOver(V1 m1_ct)
        buttOrOver(M2 V1)
        buttOrOver(V2 M2)
        buttOrOver(M3 V2)
        buttOrOver(TV1 M3)
        buttOrOver(TM1 TV1)
        buttOrOver(TV2 TM1)
        buttOrOver(TM2 TV2)
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(cumulative TM2 TV2 TM1 TV1 M3 V2 M2 V1 m1_ct ct_poly ct_aa)
        diffusion(ant_dio)
        ratio=TM2.area/gate.area
        drcAntenna(TM2 (gate) ratio keep>5000
            "ANT.GT4: When a protection diode is not used, the maximum ratio of cumulative metal area to the active poly gate area from M1 to TM (if double TM used, TM layer defined as TM2 layer) <= 5000")
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(cumulative TM2 TV2 TM1 TV1 M3 V2 M2 V1 m1_ct ct_poly ct_aa
            ant_dio)
        ratio=( ( ( m1_ct.area +M2.area +M3.area + TM1.area + TM2.area
            ) / gate.area ) - ( ant_dio.area*9984) )
        drcAntenna(TM2 (gate) ratio keep>55000
            "ANT.GT5: When a protection diode with area larger than 0.054um^2 is used, the maximum ratio of single TM layer: Ratio = diode area*9984+55000")
    )

   processAntenna(
        gate((gate poly_mos))
        antenna(TV2 TM1 TV1 M3 V2 M2 V1 m1_ct ct_poly ct_aa)
        diffusion(ant_dio)
        ratio=TV2.area / gate.area
        drcAntenna(TV2 (TV2) ratio keep>20
            "ANT.GT6: When the protection diode is not used, the maximum drawn ratio of TV2 area to the active poly gate area connected directly to it <= 20")
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(TV2 TM1 TV1 M3 V2 M2 V1 m1_ct ct_poly ct_aa)
        diffusion(ant_dio)
        ratio=( ( TV2.area / gate.area ) - ( ant_dio.area*200) )
        drcAntenna(TV2 (TV2) ratio keep>1000
            "ANT.GT7: When the protection diode with area larger than 0.054um^2 is used, the maximum drawn ratio of V4 area to the active poly gate area can be calculated by the following equation: Ratio = diode area * 200 + 1000")
    )

)
*/
/*
procedure( switchProc580()
    geomConnect(
        buttOrOver(ct_aa ant_dio)
        buttOrOver(ct_poly poly_mos)
        buttOrOver(m1_ct ct_aa)
        buttOrOver(m1_ct ct_poly)
        buttOrOver(V1 m1_ct)
        buttOrOver(M2 V1)
        buttOrOver(V2 M2)
        buttOrOver(M3 V2)
        buttOrOver(V3 M3)
        buttOrOver(M4 V3)
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(cumulative M4 V3 M3 V2 M2 V1 m1_ct ct_poly ct_aa)
        diffusion(ant_dio)
        ratio=M4.area/gate.area
        drcAntenna(M4 (gate) ratio keep>5000
            "ANT.GT4: When a protection diode is not used, the maximum ratio of cumulative metal area to the active poly gate area from M1 to TM (if double TM used, TM layer defined as TM2 layer) <= 5000")
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(cumulative M4 V3 M3 V2 M2 V1 m1_ct ct_poly ct_aa
            ant_dio)
        ratio=( ( ( m1_ct.area +M2.area +M3.area + M4.area
            ) / gate.area ) - ( ant_dio.area*9984) )
        drcAntenna(M4 (gate) ratio keep>55000
            "ANT.GT5: When a protection diode with area larger than 0.054um^2 is used, the maximum ratio of single TM layer: Ratio = diode area*9984+55000")
    )

   processAntenna(
        gate((gate poly_mos))
        antenna(V3 M3 V2 M2 V1 m1_ct ct_poly ct_aa)
        diffusion(ant_dio)
        ratio=V3.area / gate.area
        drcAntenna(V3 (V3) ratio keep>20
            "ANT.GT6: When the protection diode is not used, the maximum drawn ratio of V3 area to the active poly gate area connected directly to it <= 20")
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(V3 M3 V2 M2 V1 m1_ct ct_poly ct_aa)
        diffusion(ant_dio)
        ratio=( ( V3.area / gate.area ) - ( ant_dio.area*200) )
        drcAntenna(V3 (V3) ratio keep>1000
            "ANT.GT7: When the protection diode with area larger than 0.054um^2 is used, the maximum drawn ratio of V4 area to the active poly gate area can be calculated by the following equation: Ratio = diode area * 200 + 1000")
    )

    geomConnect(
        buttOrOver(ct_aa ant_dio)
        buttOrOver(ct_poly poly_mos)
        buttOrOver(m1_ct ct_aa)
        buttOrOver(m1_ct ct_poly)
        buttOrOver(V1 m1_ct)
        buttOrOver(M2 V1)
        buttOrOver(V2 M2)
        buttOrOver(M3 V2)
        buttOrOver(V3 M3)
        buttOrOver(M4 V3)
        buttOrOver(TV1 M4)
        buttOrOver(TM1 TV1)
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(cumulative TM1 TV1 M4 V3 M3 V2 M2 V1 m1_ct ct_poly ct_aa)
        diffusion(ant_dio)
        ratio=TM1.area/gate.area
        drcAntenna(TM1 (gate) ratio keep>5000
            "ANT.GT4: When a protection diode is not used, the maximum ratio of cumulative metal area to the active poly gate area from M1 to TM (if double TM used, TM layer defined as TM2 layer) <= 5000")
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(cumulative TM1 TV1 M4 V3 M3 V2 M2 V1 m1_ct ct_poly ct_aa
            ant_dio)
        ratio=( ( ( m1_ct.area +M2.area +M3.area + M4.area + TM1.area
            ) / gate.area ) - ( ant_dio.area*9984) )
        drcAntenna(TM1 (gate) ratio keep>55000
            "ANT.GT5: When a protection diode with area larger than 0.054um^2 is used, the maximum ratio of single TM layer: Ratio = diode area*9984+55000")
    )

   processAntenna(
        gate((gate poly_mos))
        antenna(TV1 M4 V3 M3 V2 M2 V1 m1_ct ct_poly ct_aa)
        diffusion(ant_dio)
        ratio=TV1.area / gate.area
        drcAntenna(TV1 (TV1) ratio keep>20
            "ANT.GT6: When the protection diode is not used, the maximum drawn ratio of TV1 area to the active poly gate area connected directly to it <= 20")
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(TV1 M4 V3 M3 V2 M2 V1 m1_ct ct_poly ct_aa)
        diffusion(ant_dio)
        ratio=( ( TV1.area / gate.area ) - ( ant_dio.area*200) )
        drcAntenna(TV1 (TV1) ratio keep>1000
            "ANT.GT7: When the protection diode with area larger than 0.054um^2 is used, the maximum drawn ratio of V4 area to the active poly gate area can be calculated by the following equation: Ratio = diode area * 200 + 1000")
    )

    geomConnect(
        buttOrOver(ct_aa ant_dio)
        buttOrOver(ct_poly poly_mos)
        buttOrOver(m1_ct ct_aa)
        buttOrOver(m1_ct ct_poly)
        buttOrOver(V1 m1_ct)
        buttOrOver(M2 V1)
        buttOrOver(V2 M2)
        buttOrOver(M3 V2)
        buttOrOver(V3 M3)
        buttOrOver(M4 V3)
        buttOrOver(TV1 M4)
        buttOrOver(TM1 TV1)
        buttOrOver(TV2 TM1)
        buttOrOver(TM2 TV2)
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(cumulative TM2 TV2 TM1 TV1 M4 V3 M3 V2 M2 V1 m1_ct ct_poly ct_aa)
        diffusion(ant_dio)
        ratio=TM2.area/gate.area
        drcAntenna(TM2 (gate) ratio keep>5000
            "ANT.GT4: When a protection diode is not used, the maximum ratio of cumulative metal area to the active poly gate area from M1 to TM (if double TM used, TM layer defined as TM2 layer) <= 5000")
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(cumulative TM2 TV2 TM1 TV1 M4 V3 M3 V2 M2 V1 m1_ct ct_poly ct_aa
            ant_dio)
        ratio=( ( ( m1_ct.area +M2.area +M3.area + M4.area + TM1.area + TM2.area
            ) / gate.area ) - ( ant_dio.area*9984) )
        drcAntenna(TM2 (gate) ratio keep>55000
            "ANT.GT5: When a protection diode with area larger than 0.054um^2 is used, the maximum ratio of single TM layer: Ratio = diode area*9984+55000")
    )

   processAntenna(
        gate((gate poly_mos))
        antenna(TV2 TM1 TV1 M4 V3 M3 V2 M2 V1 m1_ct ct_poly ct_aa)
        diffusion(ant_dio)
        ratio=TV2.area / gate.area
        drcAntenna(TV2 (TV2) ratio keep>20
            "ANT.GT6: When the protection diode is not used, the maximum drawn ratio of TV2 area to the active poly gate area connected directly to it <= 20")
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(TV2 TM1 TV1 M4 V3 M3 V2 M2 V1 m1_ct ct_poly ct_aa)
        diffusion(ant_dio)
        ratio=( ( TV2.area / gate.area ) - ( ant_dio.area*200) )
        drcAntenna(TV2 (TV2) ratio keep>1000
            "ANT.GT7: When the protection diode with area larger than 0.054um^2 is used, the maximum drawn ratio of V4 area to the active poly gate area can be calculated by the following equation: Ratio = diode area * 200 + 1000")
    )

)
*/
; procedure for switches ANTENNA_CHECKS && METAL_OPTION_7LM_2TM
/*
procedure( switchProc62()
    geomConnect(
        buttOrOver(ct_aa ant_dio)
        buttOrOver(ct_poly poly_mos)
        buttOrOver(m1_ct ct_aa)
        buttOrOver(m1_ct ct_poly)
        buttOrOver(V1 m1_ct)
        buttOrOver(M2 V1)
        buttOrOver(V2 M2)
        buttOrOver(M3 V2)
        buttOrOver(V3 M3)
        buttOrOver(M4 V3)
        buttOrOver(V4 M4)
        buttOrOver(M5 V4)
        buttOrOver(TV1 M5)
        buttOrOver(TM1 TV1)
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(cumulative TM1 TV1 M5 V4 M4 V3 M3 V2 M2 V1 m1_ct ct_poly ct_aa)
        diffusion(ant_dio)
        ratio=TM1.area/gate.area
        drcAntenna(TM1 (gate) ratio keep>5000
            "ANT.GT4: When a protection diode is not used, the maximum ratio of cumulative metal area to the active poly gate area from M1 to TM (if double TM used, TM layer defined as TM2 layer) <= 5000")
    )

)
*/
/*
; procedure for switches ANTENNA_CHECKS && METAL_OPTION_8LM_2TM
procedure( switchProc63()
    geomConnect(
        buttOrOver(ct_aa ant_dio)
        buttOrOver(ct_poly poly_mos)
        buttOrOver(m1_ct ct_aa)
        buttOrOver(m1_ct ct_poly)
        buttOrOver(V1 m1_ct)
        buttOrOver(M2 V1)
        buttOrOver(V2 M2)
        buttOrOver(M3 V2)
        buttOrOver(V3 M3)
        buttOrOver(M4 V3)
        buttOrOver(V4 M4)
        buttOrOver(M5 V4)
        buttOrOver(V5 M5)
        buttOrOver(M6 V5)
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(cumulative M6 V5 M5 V4 M4 V3 M3 V2 M2 V1 m1_ct ct_poly ct_aa)
        diffusion(ant_dio)
        ratio=M6.area/gate.area
        drcAntenna(M6 (gate) ratio keep>5000
            "ANT.GT4: When a protection diode is not used, the maximum ratio of cumulative metal area to the active poly gate area from M1 to TM (if double TM used, TM layer defined as TM2 layer) <= 5000")
    )

)
*/
; procedure for switches ANTENNA_CHECKS && METAL_OPTION_9LM_2TM
/*
procedure( switchProc64()
    geomConnect(
        buttOrOver(ct_aa ant_dio)
        buttOrOver(ct_poly poly_mos)
        buttOrOver(m1_ct ct_aa)
        buttOrOver(m1_ct ct_poly)
        buttOrOver(V1 m1_ct)
        buttOrOver(M2 V1)
        buttOrOver(V2 M2)
        buttOrOver(M3 V2)
        buttOrOver(V3 M3)
        buttOrOver(M4 V3)
        buttOrOver(V4 M4)
        buttOrOver(M5 V4)
        buttOrOver(V5 M5)
        buttOrOver(M6 V5)
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(cumulative M6 V5 M5 V4 M4 V3 M3 V2 M2 V1 m1_ct ct_poly ct_aa)
        diffusion(ant_dio)
        ratio=M6.area/gate.area
        drcAntenna(M6 (gate) ratio keep>5000
            "ANT.GT4: When a protection diode is not used, the maximum ratio of cumulative metal area to the active poly gate area from M1 to TM (if double TM used, TM layer defined as TM2 layer) <= 5000")
    )

)
*/
; procedure for switches ANTENNA_CHECKS && METAL_OPTION_10LM_2TM
/*
procedure( switchProc65()
    geomConnect(
        buttOrOver(ct_aa ant_dio)
        buttOrOver(ct_poly poly_mos)
        buttOrOver(m1_ct ct_aa)
        buttOrOver(m1_ct ct_poly)
        buttOrOver(V1 m1_ct)
        buttOrOver(M2 V1)
        buttOrOver(V2 M2)
        buttOrOver(M3 V2)
        buttOrOver(V3 M3)
        buttOrOver(M4 V3)
        buttOrOver(V4 M4)
        buttOrOver(M5 V4)
        buttOrOver(V5 M5)
        buttOrOver(M6 V5)
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(cumulative M6 V5 M5 V4 M4 V3 M3 V2 M2 V1 m1_ct ct_poly ct_aa)
        diffusion(ant_dio)
        ratio=M6.area/gate.area
        drcAntenna(M6 (gate) ratio keep>5000
            "ANT.GT4: When a protection diode is not used, the maximum ratio of cumulative metal area to the active poly gate area from M1 to TM (if double TM used, TM layer defined as TM2 layer) <= 5000")
    )

)
*/
; procedure for switches ANTENNA_CHECKS && METAL_OPTION_7LM_1TM
/*
procedure( switchProc66()
    geomConnect(
        buttOrOver(ct_aa ant_dio)
        buttOrOver(ct_poly poly_mos)
        buttOrOver(m1_ct ct_aa)
        buttOrOver(m1_ct ct_poly)
        buttOrOver(V1 m1_ct)
        buttOrOver(M2 V1)
        buttOrOver(V2 M2)
        buttOrOver(M3 V2)
        buttOrOver(V3 M3)
        buttOrOver(M4 V3)
        buttOrOver(V4 M4)
        buttOrOver(M5 V4)
        buttOrOver(V5 M5)
        buttOrOver(M6 V5)
        buttOrOver(TV2 M6)
        buttOrOver(TM2 TV2)
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(cumulative TM2 TV2 M6 V5 M5 V4 M4 V3 M3 V2 M2 V1 m1_ct ct_poly
            ct_aa)
        diffusion(ant_dio)
        ratio=TM2.area/gate.area
        drcAntenna(TM2 (gate) ratio keep>5000
            "ANT.GT4: When a protection diode is not used, the maximum ratio of cumulative metal area to the active poly gate area from M1 to TM (if double TM used, TM layer defined as TM2 layer) <= 5000")
    )

)
*/
; procedure for switches ANTENNA_CHECKS && METAL_OPTION_8LM_1TM
/*
procedure( switchProc67()
    geomConnect(
        buttOrOver(ct_aa ant_dio)
        buttOrOver(ct_poly poly_mos)
        buttOrOver(m1_ct ct_aa)
        buttOrOver(m1_ct ct_poly)
        buttOrOver(V1 m1_ct)
        buttOrOver(M2 V1)
        buttOrOver(V2 M2)
        buttOrOver(M3 V2)
        buttOrOver(V3 M3)
        buttOrOver(M4 V3)
        buttOrOver(V4 M4)
        buttOrOver(M5 V4)
        buttOrOver(V5 M5)
        buttOrOver(M6 V5)
        buttOrOver(V6 M6)
        buttOrOver(M7 V6)
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(cumulative M7 V6 M6 V5 M5 V4 M4 V3 M3 V2 M2 V1 m1_ct ct_poly
            ct_aa)
        diffusion(ant_dio)
        ratio=M7.area/gate.area
        drcAntenna(M7 (gate) ratio keep>5000
            "ANT.GT4: When a protection diode is not used, the maximum ratio of cumulative metal area to the active poly gate area from M1 to TM (if double TM used, TM layer defined as TM2 layer) <= 5000")
    )

)
*/
; procedure for switches ANTENNA_CHECKS && METAL_OPTION_9LM_1TM
/*
procedure( switchProc68()
    geomConnect(
        buttOrOver(ct_aa ant_dio)
        buttOrOver(ct_poly poly_mos)
        buttOrOver(m1_ct ct_aa)
        buttOrOver(m1_ct ct_poly)
        buttOrOver(V1 m1_ct)
        buttOrOver(M2 V1)
        buttOrOver(V2 M2)
        buttOrOver(M3 V2)
        buttOrOver(V3 M3)
        buttOrOver(M4 V3)
        buttOrOver(V4 M4)
        buttOrOver(M5 V4)
        buttOrOver(V5 M5)
        buttOrOver(M6 V5)
        buttOrOver(V6 M6)
        buttOrOver(M7 V6)
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(cumulative M7 V6 M6 V5 M5 V4 M4 V3 M3 V2 M2 V1 m1_ct ct_poly
            ct_aa)
        diffusion(ant_dio)
        ratio=M7.area/gate.area
        drcAntenna(M7 (gate) ratio keep>5000
            "ANT.GT4: When a protection diode is not used, the maximum ratio of cumulative metal area to the active poly gate area from M1 to TM (if double TM used, TM layer defined as TM2 layer) <= 5000")
    )

)
*/
; procedure for switches ANTENNA_CHECKS && METAL_OPTION_7LM_2TM
/*
procedure( switchProc69()
    geomConnect(
        buttOrOver(ct_aa ant_dio)
        buttOrOver(ct_poly poly_mos)
        buttOrOver(m1_ct ct_aa)
        buttOrOver(m1_ct ct_poly)
        buttOrOver(V1 m1_ct)
        buttOrOver(M2 V1)
        buttOrOver(V2 M2)
        buttOrOver(M3 V2)
        buttOrOver(V3 M3)
        buttOrOver(M4 V3)
        buttOrOver(V4 M4)
        buttOrOver(M5 V4)
        buttOrOver(TV1 M5)
        buttOrOver(TM1 TV1)
        buttOrOver(TV2 TM1)
        buttOrOver(TM2 TV2)
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(cumulative TM2 TV2 TM1 TV1 M5 V4 M4 V3 M3 V2 M2 V1 m1_ct ct_poly
            ct_aa)
        diffusion(ant_dio)
        ratio=TM2.area/gate.area
        drcAntenna(TM2 (gate) ratio keep>5000
            "ANT.GT4: When a protection diode is not used, the maximum ratio of cumulative metal area to the active poly gate area from M1 to TM (if double TM used, TM layer defined as TM2 layer) <= 5000")
    )

)
*/
; procedure for switches ANTENNA_CHECKS && METAL_OPTION_8LM_2TM
/*
procedure( switchProc70()
    geomConnect(
        buttOrOver(ct_aa ant_dio)
        buttOrOver(ct_poly poly_mos)
        buttOrOver(m1_ct ct_aa)
        buttOrOver(m1_ct ct_poly)
        buttOrOver(V1 m1_ct)
        buttOrOver(M2 V1)
        buttOrOver(V2 M2)
        buttOrOver(M3 V2)
        buttOrOver(V3 M3)
        buttOrOver(M4 V3)
        buttOrOver(V4 M4)
        buttOrOver(M5 V4)
        buttOrOver(V5 M5)
        buttOrOver(M6 V5)
        buttOrOver(TV1 M6)
        buttOrOver(TM1 TV1)
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(cumulative TM1 TV1 M6 V5 M5 V4 M4 V3 M3 V2 M2 V1 m1_ct ct_poly
            ct_aa)
        diffusion(ant_dio)
        ratio=TM1.area/gate.area
        drcAntenna(TM1 (gate) ratio keep>5000
            "ANT.GT4: When a protection diode is not used, the maximum ratio of cumulative metal area to the active poly gate area from M1 to TM (if double TM used, TM layer defined as TM2 layer) <= 5000")
    )

)
*/
; procedure for switches ANTENNA_CHECKS && METAL_OPTION_9LM_2TM
/*
procedure( switchProc71()
    geomConnect(
        buttOrOver(ct_aa ant_dio)
        buttOrOver(ct_poly poly_mos)
        buttOrOver(m1_ct ct_aa)
        buttOrOver(m1_ct ct_poly)
        buttOrOver(V1 m1_ct)
        buttOrOver(M2 V1)
        buttOrOver(V2 M2)
        buttOrOver(M3 V2)
        buttOrOver(V3 M3)
        buttOrOver(M4 V3)
        buttOrOver(V4 M4)
        buttOrOver(M5 V4)
        buttOrOver(V5 M5)
        buttOrOver(M6 V5)
        buttOrOver(V6 M6)
        buttOrOver(M7 V6)
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(cumulative M7 V6 M6 V5 M5 V4 M4 V3 M3 V2 M2 V1 m1_ct ct_poly
            ct_aa)
        diffusion(ant_dio)
        ratio=M7.area/gate.area
        drcAntenna(M7 (gate) ratio keep>5000
            "ANT.GT4: When a protection diode is not used, the maximum ratio of cumulative metal area to the active poly gate area from M1 to TM (if double TM used, TM layer defined as TM2 layer) <= 5000")
    )

)
*/
; procedure for switches ANTENNA_CHECKS && METAL_OPTION_10LM_2TM
/*
procedure( switchProc72()
    geomConnect(
        buttOrOver(ct_aa ant_dio)
        buttOrOver(ct_poly poly_mos)
        buttOrOver(m1_ct ct_aa)
        buttOrOver(m1_ct ct_poly)
        buttOrOver(V1 m1_ct)
        buttOrOver(M2 V1)
        buttOrOver(V2 M2)
        buttOrOver(M3 V2)
        buttOrOver(V3 M3)
        buttOrOver(M4 V3)
        buttOrOver(V4 M4)
        buttOrOver(M5 V4)
        buttOrOver(V5 M5)
        buttOrOver(M6 V5)
        buttOrOver(V6 M6)
        buttOrOver(M7 V6)
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(cumulative M7 V6 M6 V5 M5 V4 M4 V3 M3 V2 M2 V1 m1_ct ct_poly
            ct_aa)
        diffusion(ant_dio)
        ratio=M7.area/gate.area
        drcAntenna(M7 (gate) ratio keep>5000
            "ANT.GT4: When a protection diode is not used, the maximum ratio of cumulative metal area to the active poly gate area from M1 to TM (if double TM used, TM layer defined as TM2 layer) <= 5000")
    )

)
*/
; procedure for switches ANTENNA_CHECKS && METAL_OPTION_8LM_1TM
/*
procedure( switchProc73()
    geomConnect(
        buttOrOver(ct_aa ant_dio)
        buttOrOver(ct_poly poly_mos)
        buttOrOver(m1_ct ct_aa)
        buttOrOver(m1_ct ct_poly)
        buttOrOver(V1 m1_ct)
        buttOrOver(M2 V1)
        buttOrOver(V2 M2)
        buttOrOver(M3 V2)
        buttOrOver(V3 M3)
        buttOrOver(M4 V3)
        buttOrOver(V4 M4)
        buttOrOver(M5 V4)
        buttOrOver(V5 M5)
        buttOrOver(M6 V5)
        buttOrOver(V6 M6)
        buttOrOver(M7 V6)
        buttOrOver(TV2 M7)
        buttOrOver(TM2 TV2)
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(cumulative TM2 TV2 M7 V6 M6 V5 M5 V4 M4 V3 M3 V2 M2 V1 m1_ct
            ct_poly ct_aa)
        diffusion(ant_dio)
        ratio=TM2.area/gate.area
        drcAntenna(TM2 (gate) ratio keep>5000
            "ANT.GT4: When a protection diode is not used, the maximum ratio of cumulative metal area to the active poly gate area from M1 to TM (if double TM used, TM layer defined as TM2 layer) <= 5000")
    )

)
*/
; procedure for switches ANTENNA_CHECKS && METAL_OPTION_9LM_1TM
/*
procedure( switchProc74()
    geomConnect(
        buttOrOver(ct_aa ant_dio)
        buttOrOver(ct_poly poly_mos)
        buttOrOver(m1_ct ct_aa)
        buttOrOver(m1_ct ct_poly)
        buttOrOver(V1 m1_ct)
        buttOrOver(M2 V1)
        buttOrOver(V2 M2)
        buttOrOver(M3 V2)
        buttOrOver(V3 M3)
        buttOrOver(M4 V3)
        buttOrOver(V4 M4)
        buttOrOver(M5 V4)
        buttOrOver(V5 M5)
        buttOrOver(M6 V5)
        buttOrOver(V6 M6)
        buttOrOver(M7 V6)
        buttOrOver(V7 M7)
        buttOrOver(M8 V7)
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(cumulative M8 V7 M7 V6 M6 V5 M5 V4 M4 V3 M3 V2 M2 V1 m1_ct
            ct_poly ct_aa)
        diffusion(ant_dio)
        ratio=M8.area/gate.area
        drcAntenna(M8 (gate) ratio keep>5000
            "ANT.GT4: When a protection diode is not used, the maximum ratio of cumulative metal area to the active poly gate area from M1 to TM (if double TM used, TM layer defined as TM2 layer) <= 5000")
    )

)
*/
; procedure for switches ANTENNA_CHECKS && METAL_OPTION_8LM_2TM
/*
procedure( switchProc75()
    geomConnect(
        buttOrOver(ct_aa ant_dio)
        buttOrOver(ct_poly poly_mos)
        buttOrOver(m1_ct ct_aa)
        buttOrOver(m1_ct ct_poly)
        buttOrOver(V1 m1_ct)
        buttOrOver(M2 V1)
        buttOrOver(V2 M2)
        buttOrOver(M3 V2)
        buttOrOver(V3 M3)
        buttOrOver(M4 V3)
        buttOrOver(V4 M4)
        buttOrOver(M5 V4)
        buttOrOver(V5 M5)
        buttOrOver(M6 V5)
        buttOrOver(TV1 M6)
        buttOrOver(TM1 TV1)
        buttOrOver(TV2 TM1)
        buttOrOver(TM2 TV2)
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(cumulative TM2 TV2 TM1 TV1 M6 V5 M5 V4 M4 V3 M3 V2 M2 V1 m1_ct
            ct_poly ct_aa)
        diffusion(ant_dio)
        ratio=TM2.area/gate.area
        drcAntenna(TM2 (gate) ratio keep>5000
            "ANT.GT4: When a protection diode is not used, the maximum ratio of cumulative metal area to the active poly gate area from M1 to TM (if double TM used, TM layer defined as TM2 layer) <= 5000")
    )

)
*/
; procedure for switches ANTENNA_CHECKS && METAL_OPTION_9LM_2TM
/*
procedure( switchProc76()
    geomConnect(
        buttOrOver(ct_aa ant_dio)
        buttOrOver(ct_poly poly_mos)
        buttOrOver(m1_ct ct_aa)
        buttOrOver(m1_ct ct_poly)
        buttOrOver(V1 m1_ct)
        buttOrOver(M2 V1)
        buttOrOver(V2 M2)
        buttOrOver(M3 V2)
        buttOrOver(V3 M3)
        buttOrOver(M4 V3)
        buttOrOver(V4 M4)
        buttOrOver(M5 V4)
        buttOrOver(V5 M5)
        buttOrOver(M6 V5)
        buttOrOver(V6 M6)
        buttOrOver(M7 V6)
        buttOrOver(TV1 M7)
        buttOrOver(TM1 TV1)
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(cumulative TM1 TV1 M7 V6 M6 V5 M5 V4 M4 V3 M3 V2 M2 V1 m1_ct
            ct_poly ct_aa)
        diffusion(ant_dio)
        ratio=TM1.area/gate.area
        drcAntenna(TM1 (gate) ratio keep>5000
            "ANT.GT4: When a protection diode is not used, the maximum ratio of cumulative metal area to the active poly gate area from M1 to TM (if double TM used, TM layer defined as TM2 layer) <= 5000")
    )

)
*/
; procedure for switches ANTENNA_CHECKS && METAL_OPTION_10LM_2TM
/*
procedure( switchProc77()
    geomConnect(
        buttOrOver(ct_aa ant_dio)
        buttOrOver(ct_poly poly_mos)
        buttOrOver(m1_ct ct_aa)
        buttOrOver(m1_ct ct_poly)
        buttOrOver(V1 m1_ct)
        buttOrOver(M2 V1)
        buttOrOver(V2 M2)
        buttOrOver(M3 V2)
        buttOrOver(V3 M3)
        buttOrOver(M4 V3)
        buttOrOver(V4 M4)
        buttOrOver(M5 V4)
        buttOrOver(V5 M5)
        buttOrOver(M6 V5)
        buttOrOver(V6 M6)
        buttOrOver(M7 V6)
        buttOrOver(V7 M7)
        buttOrOver(M8 V7)
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(cumulative M8 V7 M7 V6 M6 V5 M5 V4 M4 V3 M3 V2 M2 V1 m1_ct
            ct_poly ct_aa)
        diffusion(ant_dio)
        ratio=M8.area/gate.area
        drcAntenna(M8 (gate) ratio keep>5000
            "ANT.GT4: When a protection diode is not used, the maximum ratio of cumulative metal area to the active poly gate area from M1 to TM (if double TM used, TM layer defined as TM2 layer) <= 5000")
    )

)
*/
; procedure for switches ANTENNA_CHECKS && METAL_OPTION_9LM_1TM
/*
procedure( switchProc78()
    geomConnect(
        buttOrOver(ct_aa ant_dio)
        buttOrOver(ct_poly poly_mos)
        buttOrOver(m1_ct ct_aa)
        buttOrOver(m1_ct ct_poly)
        buttOrOver(V1 m1_ct)
        buttOrOver(M2 V1)
        buttOrOver(V2 M2)
        buttOrOver(M3 V2)
        buttOrOver(V3 M3)
        buttOrOver(M4 V3)
        buttOrOver(V4 M4)
        buttOrOver(M5 V4)
        buttOrOver(V5 M5)
        buttOrOver(M6 V5)
        buttOrOver(V6 M6)
        buttOrOver(M7 V6)
        buttOrOver(V7 M7)
        buttOrOver(M8 V7)
        buttOrOver(TV2 M8)
        buttOrOver(TM2 TV2)
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(cumulative TM2 TV2 M8 V7 M7 V6 M6 V5 M5 V4 M4 V3 M3 V2 M2 V1
            m1_ct ct_poly ct_aa)
        diffusion(ant_dio)
        ratio=TM2.area/gate.area
        drcAntenna(TM2 (gate) ratio keep>5000
            "ANT.GT4: When a protection diode is not used, the maximum ratio of cumulative metal area to the active poly gate area from M1 to TM (if double TM used, TM layer defined as TM2 layer) <= 5000")
    )

)
*/
; procedure for switches ANTENNA_CHECKS && METAL_OPTION_9LM_2TM
/*
procedure( switchProc79()
    geomConnect(
        buttOrOver(ct_aa ant_dio)
        buttOrOver(ct_poly poly_mos)
        buttOrOver(m1_ct ct_aa)
        buttOrOver(m1_ct ct_poly)
        buttOrOver(V1 m1_ct)
        buttOrOver(M2 V1)
        buttOrOver(V2 M2)
        buttOrOver(M3 V2)
        buttOrOver(V3 M3)
        buttOrOver(M4 V3)
        buttOrOver(V4 M4)
        buttOrOver(M5 V4)
        buttOrOver(V5 M5)
        buttOrOver(M6 V5)
        buttOrOver(V6 M6)
        buttOrOver(M7 V6)
        buttOrOver(TV1 M7)
        buttOrOver(TM1 TV1)
        buttOrOver(TV2 TM1)
        buttOrOver(TM2 TV2)
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(cumulative TM2 TV2 TM1 TV1 M7 V6 M6 V5 M5 V4 M4 V3 M3 V2 M2 V1
            m1_ct ct_poly ct_aa)
        diffusion(ant_dio)
        ratio=TM2.area/gate.area
        drcAntenna(TM2 (gate) ratio keep>5000
            "ANT.GT4: When a protection diode is not used, the maximum ratio of cumulative metal area to the active poly gate area from M1 to TM (if double TM used, TM layer defined as TM2 layer) <= 5000")
    )

)
*/
; procedure for switches ANTENNA_CHECKS && METAL_OPTION_10LM_2TM
/*
procedure( switchProc80()
    geomConnect(
        buttOrOver(ct_aa ant_dio)
        buttOrOver(ct_poly poly_mos)
        buttOrOver(m1_ct ct_aa)
        buttOrOver(m1_ct ct_poly)
        buttOrOver(V1 m1_ct)
        buttOrOver(M2 V1)
        buttOrOver(V2 M2)
        buttOrOver(M3 V2)
        buttOrOver(V3 M3)
        buttOrOver(M4 V3)
        buttOrOver(V4 M4)
        buttOrOver(M5 V4)
        buttOrOver(V5 M5)
        buttOrOver(M6 V5)
        buttOrOver(V6 M6)
        buttOrOver(M7 V6)
        buttOrOver(V7 M7)
        buttOrOver(M8 V7)
        buttOrOver(TV1 M8)
        buttOrOver(TM1 TV1)
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(cumulative TM1 TV1 M8 V7 M7 V6 M6 V5 M5 V4 M4 V3 M3 V2 M2 V1
            m1_ct ct_poly ct_aa)
        diffusion(ant_dio)
        ratio=TM1.area/gate.area
        drcAntenna(TM1 (gate) ratio keep>5000
            "ANT.GT4: When a protection diode is not used, the maximum ratio of cumulative metal area to the active poly gate area from M1 to TM (if double TM used, TM layer defined as TM2 layer) <= 5000")
    )

    geomConnect(
        incremental
        buttOrOver(TV2 TM1)
        buttOrOver(TM2 TV2)
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(cumulative TM2 TV2 TM1 TV1 M8 V7 M7 V6 M6 V5 M5 V4 M4 V3 M3 V2
            M2 V1 m1_ct ct_poly ct_aa)
        diffusion(ant_dio)
        ratio=TM2.area/gate.area
        drcAntenna(TM2 (gate) ratio keep>5000
            "ANT.GT4: When a protection diode is not used, the maximum ratio of cumulative metal area to the active poly gate area from M1 to TM (if double TM used, TM layer defined as TM2 layer) <= 5000")
    )

    resetCumulative()

)
*/
; procedure for switches ANTENNA_CHECKS
/*
procedure( switchProc81()
    geomConnect(
        buttOrOver(ct_aa ant_dio)
        buttOrOver(ct_poly poly_mos)
        buttOrOver(m1_ct ct_aa)
        buttOrOver(m1_ct ct_poly)
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(cumulative m1_ct ct_poly ct_aa ant_dio)
        ratio=( ( m1_ct.area / gate.area ) - ( ant_dio.area*500) )
        drcAntenna(m1_ct (gate) ratio keep>44000
            "ANT.GT5: When a protection diode with area larger than 0.054um^2 is used, the maximum ratio of cumulative metal area to the active poly gate area can be calculated by the following equation from M1 to Sub-TM and single TM layer: Ratio = diode area*500+44000")
    )

    geomConnect(
        incremental
        buttOrOver(V1 m1_ct)
        buttOrOver(M2 V1)
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(cumulative M2 V1 m1_ct ct_poly ct_aa ant_dio)
        ratio=( ( ( m1_ct.area +M2.area ) / gate.area ) - ( ant_dio.area*500) )
        drcAntenna(M2 (gate) ratio keep>44000
            "ANT.GT5: When a protection diode with area larger than 0.054um^2 is used, the maximum ratio of cumulative metal area to the active poly gate area can be calculated by the following equation from M1 to Sub-TM and single TM layer: Ratio = diode area*500+44000")
    )

    geomConnect(
        incremental
        buttOrOver(V2 M2)
        buttOrOver(M3 V2)
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(cumulative M3 V2 M2 V1 m1_ct ct_poly ct_aa ant_dio)
        ratio=( ( ( m1_ct.area +M2.area +M3.area ) / gate.area ) - (
            ant_dio.area*500) )
        drcAntenna(M3 (gate) ratio keep>44000
            "ANT.GT5: When a protection diode with area larger than 0.054um^2 is used, the maximum ratio of cumulative metal area to the active poly gate area can be calculated by the following equation from M1 to Sub-TM and single TM layer: Ratio = diode area*500+44000")
    )

if( !avSwitch("METAL_OPTION_6LM_2TM") && !avSwitch("METAL_OPTION_5LM_2TM") &&
    !avSwitch("METAL_OPTION_5LM_1TM") && !avSwitch("METAL_OPTION_4LM_1TM") then

    geomConnect(
        incremental
        buttOrOver(V3 M3)
        buttOrOver(M4 V3)
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(cumulative M4 V3 M3 V2 M2 V1 m1_ct ct_poly ct_aa ant_dio)
        ratio=( ( ( m1_ct.area +M2.area +M3.area + M4.area ) / gate.area ) - (
            ant_dio.area*500) )
        drcAntenna(M4 (gate) ratio keep>44000
            "ANT.GT5: When a protection diode with area larger than 0.054um^2 is used, the maximum ratio of cumulative metal area to the active poly gate area can be calculated by the following equation from M1 to Sub-TM and single TM layer: Ratio = diode area*500+44000")
    )

    geomConnect(
        incremental
        buttOrOver(V4 M4)
        buttOrOver(M5 V4)
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(cumulative M5 V4 M4 V3 M3 V2 M2 V1 m1_ct ct_poly ct_aa ant_dio)
        ratio=( ( ( m1_ct.area +M2.area +M3.area + M4.area + M5.area ) /
            gate.area ) - ( ant_dio.area*500) )
        drcAntenna(M5 (gate) ratio keep>44000
            "ANT.GT5: When a protection diode with area larger than 0.054um^2 is used, the maximum ratio of cumulative metal area to the active poly gate area can be calculated by the following equation from M1 to Sub-TM and single TM layer: Ratio = diode area*500+44000")
    )

)

)
*/
; procedure for switches ANTENNA_CHECKS && METAL_OPTION_6LM_1TM
/*
procedure( switchProc82()
    geomConnect(
        buttOrOver(ct_aa ant_dio)
        buttOrOver(ct_poly poly_mos)
        buttOrOver(m1_ct ct_aa)
        buttOrOver(m1_ct ct_poly)
        buttOrOver(V1 m1_ct)
        buttOrOver(M2 V1)
        buttOrOver(V2 M2)
        buttOrOver(M3 V2)
        buttOrOver(V3 M3)
        buttOrOver(M4 V3)
        buttOrOver(V4 M4)
        buttOrOver(M5 V4)
        buttOrOver(TV2 M5)
        buttOrOver(TM2 TV2)
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(cumulative TM2 TV2 M5 V4 M4 V3 M3 V2 M2 V1 m1_ct ct_poly ct_aa
            ant_dio)
        ratio=( ( ( m1_ct.area +M2.area +M3.area + M4.area + M5.area + TM2.area
            ) / gate.area ) - ( ant_dio.area*9984) )
        drcAntenna(TM2 (gate) ratio keep>55000
            "ANT.GT5: When a protection diode with area larger than 0.054um^2 is used, the maximum ratio of single TM layer: Ratio = diode area*9984+55000")
    )

)
*/

; procedure for switches ANTENNA_CHECKS && METAL_OPTION_7LM_1TM
/*
procedure( switchProc83()
    geomConnect(
        buttOrOver(ct_aa ant_dio)
        buttOrOver(ct_poly poly_mos)
        buttOrOver(m1_ct ct_aa)
        buttOrOver(m1_ct ct_poly)
        buttOrOver(V1 m1_ct)
        buttOrOver(M2 V1)
        buttOrOver(V2 M2)
        buttOrOver(M3 V2)
        buttOrOver(V3 M3)
        buttOrOver(M4 V3)
        buttOrOver(V4 M4)
        buttOrOver(M5 V4)
        buttOrOver(V5 M5)
        buttOrOver(M6 V5)
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(cumulative M6 V5 M5 V4 M4 V3 M3 V2 M2 V1 m1_ct ct_poly ct_aa
            ant_dio)
        ratio=( ( ( m1_ct.area +M2.area +M3.area + M4.area + M5.area + M6.area )
            / gate.area ) - ( ant_dio.area*9984) )
        drcAntenna(M6 (gate) ratio keep>55000
            "ANT.GT5: When a protection diode with area larger than 0.054um^2 is used, the maximum ratio of single TM layer: Ratio = diode area*9984+55000")
    )

)
*/
; procedure for switches ANTENNA_CHECKS && METAL_OPTION_8LM_1TM
/*
procedure( switchProc84()
    geomConnect(
        buttOrOver(ct_aa ant_dio)
        buttOrOver(ct_poly poly_mos)
        buttOrOver(m1_ct ct_aa)
        buttOrOver(m1_ct ct_poly)
        buttOrOver(V1 m1_ct)
        buttOrOver(M2 V1)
        buttOrOver(V2 M2)
        buttOrOver(M3 V2)
        buttOrOver(V3 M3)
        buttOrOver(M4 V3)
        buttOrOver(V4 M4)
        buttOrOver(M5 V4)
        buttOrOver(V5 M5)
        buttOrOver(M6 V5)
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(cumulative M6 V5 M5 V4 M4 V3 M3 V2 M2 V1 m1_ct ct_poly ct_aa
            ant_dio)
        ratio=( ( ( m1_ct.area +M2.area +M3.area + M4.area + M5.area + M6.area )
            / gate.area ) - ( ant_dio.area*9984) )
        drcAntenna(M6 (gate) ratio keep>55000
            "ANT.GT5: When a protection diode with area larger than 0.054um^2 is used, the maximum ratio of single TM layer: Ratio = diode area*9984+55000")
    )

)
*/
; procedure for switches ANTENNA_CHECKS && METAL_OPTION_9LM_1TM
/*
procedure( switchProc85()
    geomConnect(
        buttOrOver(ct_aa ant_dio)
        buttOrOver(ct_poly poly_mos)
        buttOrOver(m1_ct ct_aa)
        buttOrOver(m1_ct ct_poly)
        buttOrOver(V1 m1_ct)
        buttOrOver(M2 V1)
        buttOrOver(V2 M2)
        buttOrOver(M3 V2)
        buttOrOver(V3 M3)
        buttOrOver(M4 V3)
        buttOrOver(V4 M4)
        buttOrOver(M5 V4)
        buttOrOver(V5 M5)
        buttOrOver(M6 V5)
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(cumulative M6 V5 M5 V4 M4 V3 M3 V2 M2 V1 m1_ct ct_poly ct_aa
            ant_dio)
        ratio=( ( ( m1_ct.area +M2.area +M3.area + M4.area + M5.area + M6.area )
            / gate.area ) - ( ant_dio.area*9984) )
        drcAntenna(M6 (gate) ratio keep>55000
            "ANT.GT5: When a protection diode with area larger than 0.054um^2 is used, the maximum ratio of single TM layer: Ratio = diode area*9984+55000")
    )

)
*/
; procedure for switches ANTENNA_CHECKS && METAL_OPTION_7LM_2TM
/*
procedure( switchProc86()
    geomConnect(
        buttOrOver(ct_aa ant_dio)
        buttOrOver(ct_poly poly_mos)
        buttOrOver(m1_ct ct_aa)
        buttOrOver(m1_ct ct_poly)
        buttOrOver(V1 m1_ct)
        buttOrOver(M2 V1)
        buttOrOver(V2 M2)
        buttOrOver(M3 V2)
        buttOrOver(V3 M3)
        buttOrOver(M4 V3)
        buttOrOver(V4 M4)
        buttOrOver(M5 V4)
        buttOrOver(TV1 M5)
        buttOrOver(TM1 TV1)
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(cumulative TM1 TV1 M5 V4 M4 V3 M3 V2 M2 V1 m1_ct ct_poly ct_aa
            ant_dio)
        ratio=( ( ( m1_ct.area +M2.area +M3.area + M4.area + M5.area + TM1.area
            )/ gate.area ) - ( ant_dio.area*9984) )
        drcAntenna(TM1 (gate) ratio keep>55000
            "ANT.GT5: When a protection diode with area larger than 0.054um^2 is used, the maximum ratio of single TM layer: Ratio = diode area*9984+55000")
    )

)
*/

; procedure for switches ANTENNA_CHECKS && METAL_OPTION_8LM_2TM
/*
procedure( switchProc87()
    geomConnect(
        buttOrOver(ct_aa ant_dio)
        buttOrOver(ct_poly poly_mos)
        buttOrOver(m1_ct ct_aa)
        buttOrOver(m1_ct ct_poly)
        buttOrOver(V1 m1_ct)
        buttOrOver(M2 V1)
        buttOrOver(V2 M2)
        buttOrOver(M3 V2)
        buttOrOver(V3 M3)
        buttOrOver(M4 V3)
        buttOrOver(V4 M4)
        buttOrOver(M5 V4)
        buttOrOver(V5 M5)
        buttOrOver(M6 V5)
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(cumulative M6 V5 M5 V4 M4 V3 M3 V2 M2 V1 m1_ct ct_poly ct_aa
            ant_dio)
        ratio=( ( ( m1_ct.area +M2.area +M3.area + M4.area + M5.area + M6.area )
            / gate.area ) - ( ant_dio.area*9984) )
        drcAntenna(M6 (gate) ratio keep>55000
            "ANT.GT5: When a protection diode with area larger than 0.054um^2 is used, the maximum ratio of single TM layer: Ratio = diode area*9984+55000")
    )

)
*/
; procedure for switches ANTENNA_CHECKS && METAL_OPTION_9LM_2TM
/*
procedure( switchProc88()
    geomConnect(
        buttOrOver(ct_aa ant_dio)
        buttOrOver(ct_poly poly_mos)
        buttOrOver(m1_ct ct_aa)
        buttOrOver(m1_ct ct_poly)
        buttOrOver(V1 m1_ct)
        buttOrOver(M2 V1)
        buttOrOver(V2 M2)
        buttOrOver(M3 V2)
        buttOrOver(V3 M3)
        buttOrOver(M4 V3)
        buttOrOver(V4 M4)
        buttOrOver(M5 V4)
        buttOrOver(V5 M5)
        buttOrOver(M6 V5)
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(cumulative M6 V5 M5 V4 M4 V3 M3 V2 M2 V1 m1_ct ct_poly ct_aa
            ant_dio)
        ratio=( ( ( m1_ct.area +M2.area +M3.area + M4.area + M5.area + M6.area )
            / gate.area ) - ( ant_dio.area*9984) )
        drcAntenna(M6 (gate) ratio keep>55000
            "ANT.GT5: When a protection diode with area larger than 0.054um^2 is used, the maximum ratio of single TM layer: Ratio = diode area*9984+55000")
    )

)
*/
; procedure for switches ANTENNA_CHECKS && METAL_OPTION_10LM_2TM
/*
procedure( switchProc89()
    geomConnect(
        buttOrOver(ct_aa ant_dio)
        buttOrOver(ct_poly poly_mos)
        buttOrOver(m1_ct ct_aa)
        buttOrOver(m1_ct ct_poly)
        buttOrOver(V1 m1_ct)
        buttOrOver(M2 V1)
        buttOrOver(V2 M2)
        buttOrOver(M3 V2)
        buttOrOver(V3 M3)
        buttOrOver(M4 V3)
        buttOrOver(V4 M4)
        buttOrOver(M5 V4)
        buttOrOver(V5 M5)
        buttOrOver(M6 V5)
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(cumulative M6 V5 M5 V4 M4 V3 M3 V2 M2 V1 m1_ct ct_poly ct_aa
            ant_dio)
        ratio=( ( ( m1_ct.area +M2.area +M3.area + M4.area + M5.area + M6.area )
            / gate.area ) - ( ant_dio.area*9984) )
        drcAntenna(M6 (gate) ratio keep>55000
            "ANT.GT5: When a protection diode with area larger than 0.054um^2 is used, the maximum ratio of single TM layer: Ratio = diode area*9984+55000")
    )

)
*/
; procedure for switches ANTENNA_CHECKS && METAL_OPTION_7LM_1TM
/*
procedure( switchProc90()
    geomConnect(
        buttOrOver(ct_aa ant_dio)
        buttOrOver(ct_poly poly_mos)
        buttOrOver(m1_ct ct_aa)
        buttOrOver(m1_ct ct_poly)
        buttOrOver(V1 m1_ct)
        buttOrOver(M2 V1)
        buttOrOver(V2 M2)
        buttOrOver(M3 V2)
        buttOrOver(V3 M3)
        buttOrOver(M4 V3)
        buttOrOver(V4 M4)
        buttOrOver(M5 V4)
        buttOrOver(V5 M5)
        buttOrOver(M6 V5)
        buttOrOver(TV2 M6)
        buttOrOver(TM2 TV2)
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(cumulative TM2 TV2 M6 V5 M5 V4 M4 V3 M3 V2 M2 V1 m1_ct ct_poly
            ct_aa ant_dio)
        ratio=( ( ( m1_ct.area +M2.area +M3.area + M4.area + M5.area + M6.area +
            TM2.area ) / gate.area ) - ( ant_dio.area*9984) )
        drcAntenna(TM2 (gate) ratio keep>55000
            "ANT.GT5: When a protection diode with area larger than 0.054um^2 is used, the maximum ratio of single TM layer: Ratio = diode area*9984+55000")
    )

)
*/
; procedure for switches ANTENNA_CHECKS && METAL_OPTION_8LM_1TM
/*
procedure( switchProc91()
    geomConnect(
        buttOrOver(ct_aa ant_dio)
        buttOrOver(ct_poly poly_mos)
        buttOrOver(m1_ct ct_aa)
        buttOrOver(m1_ct ct_poly)
        buttOrOver(V1 m1_ct)
        buttOrOver(M2 V1)
        buttOrOver(V2 M2)
        buttOrOver(M3 V2)
        buttOrOver(V3 M3)
        buttOrOver(M4 V3)
        buttOrOver(V4 M4)
        buttOrOver(M5 V4)
        buttOrOver(V5 M5)
        buttOrOver(M6 V5)
        buttOrOver(V6 M6)
        buttOrOver(M7 V6)
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(cumulative M7 V6 M6 V5 M5 V4 M4 V3 M3 V2 M2 V1 m1_ct ct_poly
            ct_aa ant_dio)
        ratio=( ( ( m1_ct.area +M2.area +M3.area + M4.area + M5.area + M6.area +
            M7.area ) / gate.area ) - ( ant_dio.area*9984) )
        drcAntenna(M7 (gate) ratio keep>55000
            "ANT.GT5: When a protection diode with area larger than 0.054um^2 is used, the maximum ratio of single TM layer: Ratio = diode area*9984+55000")
    )

)
*/
; procedure for switches ANTENNA_CHECKS && METAL_OPTION_9LM_1TM
/*
procedure( switchProc92()
    geomConnect(
        buttOrOver(ct_aa ant_dio)
        buttOrOver(ct_poly poly_mos)
        buttOrOver(m1_ct ct_aa)
        buttOrOver(m1_ct ct_poly)
        buttOrOver(V1 m1_ct)
        buttOrOver(M2 V1)
        buttOrOver(V2 M2)
        buttOrOver(M3 V2)
        buttOrOver(V3 M3)
        buttOrOver(M4 V3)
        buttOrOver(V4 M4)
        buttOrOver(M5 V4)
        buttOrOver(V5 M5)
        buttOrOver(M6 V5)
        buttOrOver(V6 M6)
        buttOrOver(M7 V6)
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(cumulative M7 V6 M6 V5 M5 V4 M4 V3 M3 V2 M2 V1 m1_ct ct_poly
            ct_aa ant_dio)
        ratio=( ( ( m1_ct.area +M2.area +M3.area + M4.area + M5.area + M6.area +
            M7.area ) / gate.area ) - ( ant_dio.area*9984) )
        drcAntenna(M7 (gate) ratio keep>55000
            "ANT.GT5: When a protection diode with area larger than 0.054um^2 is used, the maximum ratio of single TM layer: Ratio = diode area*9984+55000")
    )

)
*/
; procedure for switches ANTENNA_CHECKS && METAL_OPTION_7LM_2TM
/*
procedure( switchProc93()
    geomConnect(
        buttOrOver(ct_aa ant_dio)
        buttOrOver(ct_poly poly_mos)
        buttOrOver(m1_ct ct_aa)
        buttOrOver(m1_ct ct_poly)
        buttOrOver(V1 m1_ct)
        buttOrOver(M2 V1)
        buttOrOver(V2 M2)
        buttOrOver(M3 V2)
        buttOrOver(V3 M3)
        buttOrOver(M4 V3)
        buttOrOver(V4 M4)
        buttOrOver(M5 V4)
        buttOrOver(TV1 M5)
        buttOrOver(TM1 TV1)
        buttOrOver(TV2 TM1)
        buttOrOver(TM2 TV2)
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(cumulative TM2 TV2 TM1 TV1 M5 V4 M4 V3 M3 V2 M2 V1 m1_ct ct_poly
            ct_aa ant_dio)
        ratio=( ( ( m1_ct.area +M2.area +M3.area + M4.area + M5.area + TM1.area
            + TM2.area )/ gate.area ) - ( ant_dio.area*9984) )
        drcAntenna(TM2 (gate) ratio keep>55000
            "ANT.GT5: When a protection diode with area larger than 0.054um^2 is used, the maximum ratio of single TM layer: Ratio = diode area*9984+55000")
    )

)
*/
; procedure for switches ANTENNA_CHECKS && METAL_OPTION_8LM_2TM
/*
procedure( switchProc94()
    geomConnect(
        buttOrOver(ct_aa ant_dio)
        buttOrOver(ct_poly poly_mos)
        buttOrOver(m1_ct ct_aa)
        buttOrOver(m1_ct ct_poly)
        buttOrOver(V1 m1_ct)
        buttOrOver(M2 V1)
        buttOrOver(V2 M2)
        buttOrOver(M3 V2)
        buttOrOver(V3 M3)
        buttOrOver(M4 V3)
        buttOrOver(V4 M4)
        buttOrOver(M5 V4)
        buttOrOver(V5 M5)
        buttOrOver(M6 V5)
        buttOrOver(TV1 M6)
        buttOrOver(TM1 TV1)
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(cumulative TM1 TV1 M6 V5 M5 V4 M4 V3 M3 V2 M2 V1 m1_ct ct_poly
            ct_aa ant_dio)
        ratio=( ( ( m1_ct.area +M2.area +M3.area + M4.area + M5.area + M6.area +
            TM1.area ) / gate.area ) - ( ant_dio.area*9984) )
        drcAntenna(TM1 (gate) ratio keep>55000
            "ANT.GT5: When a protection diode with area larger than 0.054um^2 is used, the maximum ratio of single TM layer: Ratio = diode area*9984+55000")
    )

)
*/
; procedure for switches ANTENNA_CHECKS && METAL_OPTION_9LM_2TM
/*
procedure( switchProc95()
    geomConnect(
        buttOrOver(ct_aa ant_dio)
        buttOrOver(ct_poly poly_mos)
        buttOrOver(m1_ct ct_aa)
        buttOrOver(m1_ct ct_poly)
        buttOrOver(V1 m1_ct)
        buttOrOver(M2 V1)
        buttOrOver(V2 M2)
        buttOrOver(M3 V2)
        buttOrOver(V3 M3)
        buttOrOver(M4 V3)
        buttOrOver(V4 M4)
        buttOrOver(M5 V4)
        buttOrOver(V5 M5)
        buttOrOver(M6 V5)
        buttOrOver(V6 M6)
        buttOrOver(M7 V6)
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(cumulative M7 V6 M6 V5 M5 V4 M4 V3 M3 V2 M2 V1 m1_ct ct_poly
            ct_aa ant_dio)
        ratio=( ( ( m1_ct.area +M2.area +M3.area + M4.area + M5.area + M6.area +
            M7.area ) / gate.area ) - ( ant_dio.area*9984) )
        drcAntenna(M7 (gate) ratio keep>55000
            "ANT.GT5: When a protection diode with area larger than 0.054um^2 is used, the maximum ratio of single TM layer: Ratio = diode area*9984+55000")
    )

)

; procedure for switches ANTENNA_CHECKS && METAL_OPTION_10LM_2TM
procedure( switchProc96()
    geomConnect(
        buttOrOver(ct_aa ant_dio)
        buttOrOver(ct_poly poly_mos)
        buttOrOver(m1_ct ct_aa)
        buttOrOver(m1_ct ct_poly)
        buttOrOver(V1 m1_ct)
        buttOrOver(M2 V1)
        buttOrOver(V2 M2)
        buttOrOver(M3 V2)
        buttOrOver(V3 M3)
        buttOrOver(M4 V3)
        buttOrOver(V4 M4)
        buttOrOver(M5 V4)
        buttOrOver(V5 M5)
        buttOrOver(M6 V5)
        buttOrOver(V6 M6)
        buttOrOver(M7 V6)
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(cumulative M7 V6 M6 V5 M5 V4 M4 V3 M3 V2 M2 V1 m1_ct ct_poly
            ct_aa ant_dio)
        ratio=( ( ( m1_ct.area +M2.area +M3.area + M4.area + M5.area + M6.area +
            M7.area ) / gate.area ) - ( ant_dio.area*9984) )
        drcAntenna(M7 (gate) ratio keep>55000
            "ANT.GT5: When a protection diode with area larger than 0.054um^2 is used, the maximum ratio of single TM layer: Ratio = diode area*9984+55000")
    )

)

; procedure for switches ANTENNA_CHECKS && METAL_OPTION_8LM_1TM
procedure( switchProc97()
    geomConnect(
        buttOrOver(ct_aa ant_dio)
        buttOrOver(ct_poly poly_mos)
        buttOrOver(m1_ct ct_aa)
        buttOrOver(m1_ct ct_poly)
        buttOrOver(V1 m1_ct)
        buttOrOver(M2 V1)
        buttOrOver(V2 M2)
        buttOrOver(M3 V2)
        buttOrOver(V3 M3)
        buttOrOver(M4 V3)
        buttOrOver(V4 M4)
        buttOrOver(M5 V4)
        buttOrOver(V5 M5)
        buttOrOver(M6 V5)
        buttOrOver(V6 M6)
        buttOrOver(M7 V6)
        buttOrOver(TV2 M7)
        buttOrOver(TM2 TV2)
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(cumulative TM2 TV2 M7 V6 M6 V5 M5 V4 M4 V3 M3 V2 M2 V1 m1_ct
            ct_poly ct_aa ant_dio)
        ratio=( ( ( m1_ct.area +M2.area +M3.area + M4.area + M5.area + M6.area +
            M7.area + TM2.area ) / gate.area ) - ( ant_dio.area*9984) )
        drcAntenna(TM2 (gate) ratio keep>55000
            "ANT.GT5: When a protection diode with area larger than 0.054um^2 is used, the maximum ratio of single TM layer: Ratio = diode area*9984+55000")
    )

)

; procedure for switches ANTENNA_CHECKS && METAL_OPTION_9LM_1TM
procedure( switchProc98()
    geomConnect(
        buttOrOver(ct_aa ant_dio)
        buttOrOver(ct_poly poly_mos)
        buttOrOver(m1_ct ct_aa)
        buttOrOver(m1_ct ct_poly)
        buttOrOver(V1 m1_ct)
        buttOrOver(M2 V1)
        buttOrOver(V2 M2)
        buttOrOver(M3 V2)
        buttOrOver(V3 M3)
        buttOrOver(M4 V3)
        buttOrOver(V4 M4)
        buttOrOver(M5 V4)
        buttOrOver(V5 M5)
        buttOrOver(M6 V5)
        buttOrOver(V6 M6)
        buttOrOver(M7 V6)
        buttOrOver(V7 M7)
        buttOrOver(M8 V7)
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(cumulative M8 V7 M7 V6 M6 V5 M5 V4 M4 V3 M3 V2 M2 V1 m1_ct
            ct_poly ct_aa ant_dio)
        ratio=( ( ( m1_ct.area +M2.area +M3.area + M4.area + M5.area + M6.area +
            M7.area + M8.area ) / gate.area ) - ( ant_dio.area*9984) )
        drcAntenna(M8 (gate) ratio keep>55000
            "ANT.GT5: When a protection diode with area larger than 0.054um^2 is used, the maximum ratio of single TM layer: Ratio = diode area*9984+55000")
    )

)

; procedure for switches ANTENNA_CHECKS && METAL_OPTION_8LM_2TM
procedure( switchProc99()
    geomConnect(
        buttOrOver(ct_aa ant_dio)
        buttOrOver(ct_poly poly_mos)
        buttOrOver(m1_ct ct_aa)
        buttOrOver(m1_ct ct_poly)
        buttOrOver(V1 m1_ct)
        buttOrOver(M2 V1)
        buttOrOver(V2 M2)
        buttOrOver(M3 V2)
        buttOrOver(V3 M3)
        buttOrOver(M4 V3)
        buttOrOver(V4 M4)
        buttOrOver(M5 V4)
        buttOrOver(V5 M5)
        buttOrOver(M6 V5)
        buttOrOver(TV1 M6)
        buttOrOver(TM1 TV1)
        buttOrOver(TV2 TM1)
        buttOrOver(TM2 TV2)
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(cumulative TM2 TV2 TM1 TV1 M6 V5 M5 V4 M4 V3 M3 V2 M2 V1 m1_ct
            ct_poly ct_aa ant_dio)
        ratio=( ( ( m1_ct.area +M2.area +M3.area + M4.area + M5.area + M6.area +
            TM1.area + TM2.area ) / gate.area ) - ( ant_dio.area*9984) )
        drcAntenna(TM2 (gate) ratio keep>55000
            "ANT.GT5: When a protection diode with area larger than 0.054um^2 is used, the maximum ratio of single TM layer: Ratio = diode area*9984+55000")
    )

)

; procedure for switches ANTENNA_CHECKS && METAL_OPTION_9LM_2TM
procedure( switchProc100()
    geomConnect(
        buttOrOver(ct_aa ant_dio)
        buttOrOver(ct_poly poly_mos)
        buttOrOver(m1_ct ct_aa)
        buttOrOver(m1_ct ct_poly)
        buttOrOver(V1 m1_ct)
        buttOrOver(M2 V1)
        buttOrOver(V2 M2)
        buttOrOver(M3 V2)
        buttOrOver(V3 M3)
        buttOrOver(M4 V3)
        buttOrOver(V4 M4)
        buttOrOver(M5 V4)
        buttOrOver(V5 M5)
        buttOrOver(M6 V5)
        buttOrOver(V6 M6)
        buttOrOver(M7 V6)
        buttOrOver(TV1 M7)
        buttOrOver(TM1 TV1)
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(cumulative TM1 TV1 M7 V6 M6 V5 M5 V4 M4 V3 M3 V2 M2 V1 m1_ct
            ct_poly ct_aa ant_dio)
        ratio=( ( ( m1_ct.area +M2.area +M3.area + M4.area + M5.area + M6.area +
            M7.area + TM1.area ) / gate.area ) - ( ant_dio.area*9984) )
        drcAntenna(TM1 (gate) ratio keep>55000
            "ANT.GT5: When a protection diode with area larger than 0.054um^2 is used, the maximum ratio of single TM layer: Ratio = diode area*9984+55000")
    )

)

; procedure for switches ANTENNA_CHECKS && METAL_OPTION_10LM_2TM
procedure( switchProc101()
    geomConnect(
        buttOrOver(ct_aa ant_dio)
        buttOrOver(ct_poly poly_mos)
        buttOrOver(m1_ct ct_aa)
        buttOrOver(m1_ct ct_poly)
        buttOrOver(V1 m1_ct)
        buttOrOver(M2 V1)
        buttOrOver(V2 M2)
        buttOrOver(M3 V2)
        buttOrOver(V3 M3)
        buttOrOver(M4 V3)
        buttOrOver(V4 M4)
        buttOrOver(M5 V4)
        buttOrOver(V5 M5)
        buttOrOver(M6 V5)
        buttOrOver(V6 M6)
        buttOrOver(M7 V6)
        buttOrOver(V7 M7)
        buttOrOver(M8 V7)
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(cumulative M8 V7 M7 V6 M6 V5 M5 V4 M4 V3 M3 V2 M2 V1 m1_ct
            ct_poly ct_aa ant_dio)
        ratio=( ( ( m1_ct.area +M2.area +M3.area + M4.area + M5.area + M6.area +
            M7.area + M8.area ) / gate.area ) - ( ant_dio.area*9984) )
        drcAntenna(M8 (gate) ratio keep>55000
            "ANT.GT5: When a protection diode with area larger than 0.054um^2 is used, the maximum ratio of single TM layer: Ratio = diode area*9984+55000")
    )

)

; procedure for switches ANTENNA_CHECKS && METAL_OPTION_9LM_1TM
procedure( switchProc102()
    geomConnect(
        buttOrOver(ct_aa ant_dio)
        buttOrOver(ct_poly poly_mos)
        buttOrOver(m1_ct ct_aa)
        buttOrOver(m1_ct ct_poly)
        buttOrOver(V1 m1_ct)
        buttOrOver(M2 V1)
        buttOrOver(V2 M2)
        buttOrOver(M3 V2)
        buttOrOver(V3 M3)
        buttOrOver(M4 V3)
        buttOrOver(V4 M4)
        buttOrOver(M5 V4)
        buttOrOver(V5 M5)
        buttOrOver(M6 V5)
        buttOrOver(V6 M6)
        buttOrOver(M7 V6)
        buttOrOver(V7 M7)
        buttOrOver(M8 V7)
        buttOrOver(TV2 M8)
        buttOrOver(TM2 TV2)
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(cumulative TM2 TV2 M8 V7 M7 V6 M6 V5 M5 V4 M4 V3 M3 V2 M2 V1
            m1_ct ct_poly ct_aa ant_dio)
        ratio=( ( ( m1_ct.area +M2.area +M3.area + M4.area + M5.area + M6.area +
            M7.area + M8.area + TM2.area ) / gate.area ) - ( ant_dio.area*9984)
            )
        drcAntenna(TM2 (gate) ratio keep>55000
            "ANT.GT5: When a protection diode with area larger than 0.054um^2 is used, the maximum ratio of single TM layer: Ratio = diode area*9984+55000")
    )

)

; procedure for switches ANTENNA_CHECKS && METAL_OPTION_9LM_2TM
procedure( switchProc103()
    geomConnect(
        buttOrOver(ct_aa ant_dio)
        buttOrOver(ct_poly poly_mos)
        buttOrOver(m1_ct ct_aa)
        buttOrOver(m1_ct ct_poly)
        buttOrOver(V1 m1_ct)
        buttOrOver(M2 V1)
        buttOrOver(V2 M2)
        buttOrOver(M3 V2)
        buttOrOver(V3 M3)
        buttOrOver(M4 V3)
        buttOrOver(V4 M4)
        buttOrOver(M5 V4)
        buttOrOver(V5 M5)
        buttOrOver(M6 V5)
        buttOrOver(V6 M6)
        buttOrOver(M7 V6)
        buttOrOver(TV1 M7)
        buttOrOver(TM1 TV1)
        buttOrOver(TV2 TM1)
        buttOrOver(TM2 TV2)
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(cumulative TM2 TV2 TM1 TV1 M7 V6 M6 V5 M5 V4 M4 V3 M3 V2 M2 V1
            m1_ct ct_poly ct_aa ant_dio)
        ratio=( ( ( m1_ct.area +M2.area +M3.area + M4.area + M5.area + M6.area +
            M7.area + TM1.area + TM2.area ) / gate.area ) - ( ant_dio.area*9984)
            )
        drcAntenna(TM2 (gate) ratio keep>55000
            "ANT.GT5: When a protection diode with area larger than 0.054um^2 is used, the maximum ratio of single TM layer: Ratio = diode area*9984+55000")
    )

)

; procedure for switches ANTENNA_CHECKS && METAL_OPTION_10LM_2TM
procedure( switchProc104()
    geomConnect(
        buttOrOver(ct_aa ant_dio)
        buttOrOver(ct_poly poly_mos)
        buttOrOver(m1_ct ct_aa)
        buttOrOver(m1_ct ct_poly)
        buttOrOver(V1 m1_ct)
        buttOrOver(M2 V1)
        buttOrOver(V2 M2)
        buttOrOver(M3 V2)
        buttOrOver(V3 M3)
        buttOrOver(M4 V3)
        buttOrOver(V4 M4)
        buttOrOver(M5 V4)
        buttOrOver(V5 M5)
        buttOrOver(M6 V5)
        buttOrOver(V6 M6)
        buttOrOver(M7 V6)
        buttOrOver(V7 M7)
        buttOrOver(M8 V7)
        buttOrOver(TV1 M8)
        buttOrOver(TM1 TV1)
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(cumulative TM1 TV1 M8 V7 M7 V6 M6 V5 M5 V4 M4 V3 M3 V2 M2 V1
            m1_ct ct_poly ct_aa ant_dio)
        ratio=( ( ( m1_ct.area +M2.area +M3.area + M4.area + M5.area + M6.area +
            M7.area + M8.area + TM1.area ) / gate.area ) - ( ant_dio.area*9984)
            )
        drcAntenna(TM1 (gate) ratio keep>55000
            "ANT.GT5: When a protection diode with area larger than 0.054um^2 is used, the maximum ratio of single TM layer: Ratio = diode area*9984+55000")
    )

    geomConnect(
        incremental
        buttOrOver(TV2 TM1)
        buttOrOver(TM2 TV2)
    )

    processAntenna(
        gate((gate poly_mos))
        antenna(cumulative TM2 TV2 TM1 TV1 M8 V7 M7 V6 M6 V5 M5 V4 M4 V3 M3 V2
            M2 V1 m1_ct ct_poly ct_aa ant_dio)
        ratio=( ( ( m1_ct.area +M2.area +M3.area + M4.area + M5.area + M6.area +
            M7.area + M8.area + TM1.area + TM2.area ) / gate.area ) - (
            ant_dio.area*9984) )
        drcAntenna(TM2 (gate) ratio keep>55000
            "ANT.GT5: When a protection diode with area larger than 0.054um^2 is used, the maximum ratio of single TM layer: Ratio = diode area*9984+55000")
    )

)

*/

if( avSwitch("GRID_CHECKS") then
    offGrid(AA 0.0010 "off grid polygon on layer AA")
    offGrid(AADUM 0.0010 "off grid polygon on layer AADUM")
    offGrid(ALDUB 0.0010 "off grid polygon on layer ALDUB")
    offGrid(ALDUM 0.0010 "off grid polygon on layer ALDUM")
    offGrid(ALPA 0.0010 "off grid polygon on layer ALPA")
    offGrid(BORDER 0.0010 "off grid polygon on layer BORDER")
    offGrid(CT 0.0010 "off grid polygon on layer CT")
    offGrid(DG 0.0010 "off grid polygon on layer DG")
    offGrid(DNW 0.0010 "off grid polygon on layer DNW")
    offGrid(DUMBA 0.0010 "off grid polygon on layer DUMBA")
    offGrid(DUMBM 0.0010 "off grid polygon on layer DUMBM")
    offGrid(DUMBP 0.0010 "off grid polygon on layer DUMBP")
    offGrid(ESD1 0.0010 "off grid polygon on layer ESD1")
    offGrid(ESD2 0.0010 "off grid polygon on layer ESD2")
    offGrid(ESD3 0.0010 "off grid polygon on layer ESD3")
    offGrid(FUSE 0.0010 "off grid polygon on layer FUSE")
    offGrid(GT 0.0010 "off grid polygon on layer GT")
    offGrid(GTDUM 0.0010 "off grid polygon on layer GTDUM")
    offGrid(GTFUSE 0.0010 "off grid polygon on layer GTFUSE")
    offGrid(HRP 0.0010 "off grid polygon on layer HRP")
    offGrid(HRPDMY 0.0010 "off grid polygon on layer HRPDMY")
    offGrid(HVT 0.0010 "off grid polygon on layer HVT")
    offGrid(INDMY 0.0010 "off grid polygon on layer INDMY")
    offGrid(LOGO 0.0010 "off grid polygon on layer LOGO")
    offGrid(LVN 0.0010 "off grid polygon on layer LVN")
    offGrid(LVP 0.0010 "off grid polygon on layer LVP")
    offGrid(LVT 0.0010 "off grid polygon on layer LVT")
    offGrid(M1 0.0010 "off grid polygon on layer M1")
    offGrid(M2 0.0010 "off grid polygon on layer M2")
    offGrid(M3 0.0010 "off grid polygon on layer M3")
    offGrid(M4 0.0010 "off grid polygon on layer M4")
    offGrid(M5 0.0010 "off grid polygon on layer M5")
    offGrid(M6 0.0010 "off grid polygon on layer M6")
    offGrid(M7 0.0010 "off grid polygon on layer M7")
    offGrid(M8 0.0010 "off grid polygon on layer M8")
    offGrid(MARKG 0.0010 "off grid polygon on layer MARKG")
    offGrid(MD 0.0010 "off grid polygon on layer MD")
    offGrid(MIM 0.0010 "off grid polygon on layer MIM")
    offGrid(MOMDMY 0.0010 "off grid polygon on layer MOMDMY")
    offGrid(MnDUB_metal1 0.0010 "off grid polygon on layer MnDUB_metal1")
    offGrid(MnDUB_metal2 0.0010 "off grid polygon on layer MnDUB_metal2")
    offGrid(MnDUB_metal3 0.0010 "off grid polygon on layer MnDUB_metal3")
    offGrid(MnDUB_metal4 0.0010 "off grid polygon on layer MnDUB_metal4")
    offGrid(MnDUB_metal5 0.0010 "off grid polygon on layer MnDUB_metal5")
    offGrid(MnDUB_metal6 0.0010 "off grid polygon on layer MnDUB_metal6")
    offGrid(MnDUB_metal7 0.0010 "off grid polygon on layer MnDUB_metal7")
    offGrid(MnDUB_metal8 0.0010 "off grid polygon on layer MnDUB_metal8")
    offGrid(MnDUB_topmetal1 0.0010 "off grid polygon on layer MnDUB_topmetal1")
    offGrid(MnDUB_topmetal2 0.0010 "off grid polygon on layer MnDUB_topmetal2")
    offGrid(MnDUM_metal1a 0.0010 "off grid polygon on layer MnDUM_metal1")
    offGrid(MnDUM_metal2a 0.0010 "off grid polygon on layer MnDUM_metal2")
    offGrid(MnDUM_metal3a 0.0010 "off grid polygon on layer MnDUM_metal3")
    offGrid(MnDUM_metal4a 0.0010 "off grid polygon on layer MnDUM_metal4")
    offGrid(MnDUM_metal5a 0.0010 "off grid polygon on layer MnDUM_metal5")
    offGrid(MnDUM_metal6a 0.0010 "off grid polygon on layer MnDUM_metal6")
    offGrid(MnDUM_metal7a 0.0010 "off grid polygon on layer MnDUM_metal7")
    offGrid(MnDUM_metal8a 0.0010 "off grid polygon on layer MnDUM_metal8")
    offGrid(MnDUM_topmetal1 0.0010 "off grid polygon on layer MnDUM_topmetal1")
    offGrid(MnDUM_topmetal2 0.0010 "off grid polygon on layer MnDUM_topmetal2")
    offGrid(M1DOP 0.0010 "off grid polygon on layer M1DOP")
    offGrid(M2DOP 0.0010 "off grid polygon on layer M2DOP")
    offGrid(M3DOP 0.0010 "off grid polygon on layer M3DOP")
    offGrid(M4DOP 0.0010 "off grid polygon on layer M4DOP")
    offGrid(M5DOP 0.0010 "off grid polygon on layer M5DOP")
    offGrid(M6DOP 0.0010 "off grid polygon on layer M6DOP")
    offGrid(M7DOP 0.0010 "off grid polygon on layer M7DOP")
    offGrid(M8DOP 0.0010 "off grid polygon on layer M8DOP")
    offGrid(V1DOP 0.0010 "off grid polygon on layer V1DOP")
    offGrid(V2DOP 0.0010 "off grid polygon on layer V2DOP")
    offGrid(V3DOP 0.0010 "off grid polygon on layer V3DOP")
    offGrid(V4DOP 0.0010 "off grid polygon on layer V4DOP")
    offGrid(V5DOP 0.0010 "off grid polygon on layer V5DOP")
    offGrid(V6DOP 0.0010 "off grid polygon on layer V6DOP")
    offGrid(V7DOP 0.0010 "off grid polygon on layer V7DOP")
    offGrid(MTT2DM 0.0010 "off grid polygon on layer VTT2DM")
    offGrid(MTT2DB 0.0010 "off grid polygon on layer VTT2DB")
    offGrid(MTT2 0.0010 "off grid polygon on layer VTT2")
    offGrid(NCAP 0.0010 "off grid polygon on layer NCAP")
    offGrid(NLH 0.0010 "off grid polygon on layer NLH")
    offGrid(NLHT 0.0010 "off grid polygon on layer NLHT")
    offGrid(NLL 0.0010 "off grid polygon on layer NLL")
    offGrid(NW 0.0010 "off grid polygon on layer NW")
    offGrid(OVERDR 0.0010 "off grid polygon on layer OVERDR")
    offGrid(PA 0.0010 "off grid polygon on layer PA")
    offGrid(PABAR 0.0010 "off grid polygon on layer PABAR")
    offGrid(PLH 0.0010 "off grid polygon on layer PLH")
    offGrid(PLHT 0.0010 "off grid polygon on layer PLHT")
    offGrid(PLL 0.0010 "off grid polygon on layer PLL")
    offGrid(PSUB 0.0010 "off grid polygon on layer PSUB")
    offGrid(RESAA 0.0010 "off grid polygon on layer RESAA")
    offGrid(RESNW 0.0010 "off grid polygon on layer RESNW")
    offGrid(RESP1 0.0010 "off grid polygon on layer RESP1")
    offGrid(DIFRES 0.0010 "off grid polygon on layer DIFRES")
    offGrid(PLRES 0.0010 "off grid polygon on layer PLRES")
    offGrid(SAB 0.0010 "off grid polygon on layer SAB")
    offGrid(SN 0.0010 "off grid polygon on layer SN")
    offGrid(SP 0.0010 "off grid polygon on layer SP")
    offGrid(TG 0.0010 "off grid polygon on layer TG")
    offGrid(TGV 0.0010 "off grid polygon on layer TGV")
    offGrid(TM1 0.0010 "off grid polygon on layer TM1")
    offGrid(TM2 0.0010 "off grid polygon on layer TM2")
    offGrid(TV1 0.0010 "off grid polygon on layer TV1")
    offGrid(TV2 0.0010 "off grid polygon on layer TV2")
    offGrid(V1 0.0010 "off grid polygon on layer V1")
    offGrid(V2 0.0010 "off grid polygon on layer V2")
    offGrid(V3 0.0010 "off grid polygon on layer V3")
    offGrid(V4 0.0010 "off grid polygon on layer V4")
    offGrid(V5 0.0010 "off grid polygon on layer V5")
    offGrid(V6 0.0010 "off grid polygon on layer V6")
    offGrid(V7 0.0010 "off grid polygon on layer V7")
    offGrid(VTNH 0.0010 "off grid polygon on layer VTNH")
    offGrid(VTPH 0.0010 "off grid polygon on layer VTPH")
    offGrid(VnBAR_topvia1 0.0010 "off grid polygon on layer VnBAR_topvia1")
    offGrid(VnBAR_topvia2 0.0010 "off grid polygon on layer VnBAR_topvia2")
    offGrid(VnBAR_via1 0.0010 "off grid polygon on layer VnBAR_via1")
    offGrid(VnBAR_via2 0.0010 "off grid polygon on layer VnBAR_via2")
    offGrid(VnBAR_via3 0.0010 "off grid polygon on layer VnBAR_via3")
    offGrid(VnBAR_via4 0.0010 "off grid polygon on layer VnBAR_via4")
    offGrid(VnBAR_via5 0.0010 "off grid polygon on layer VnBAR_via5")
    offGrid(VnBAR_via6 0.0010 "off grid polygon on layer VnBAR_via6")
    offGrid(VnBAR_via7 0.0010 "off grid polygon on layer VnBAR_via7")
    offGrid(VnDUM_via1a 0.0010 "off grid polygon on layer VnDUM_via1")
    offGrid(VnDUM_via2a 0.0010 "off grid polygon on layer VnDUM_via2")
    offGrid(VnDUM_via3a 0.0010 "off grid polygon on layer VnDUM_via3")
    offGrid(VnDUM_via4a 0.0010 "off grid polygon on layer VnDUM_via4")
    offGrid(VnDUM_via5a 0.0010 "off grid polygon on layer VnDUM_via5")
    offGrid(VnDUM_via6a 0.0010 "off grid polygon on layer VnDUM_via6")
    offGrid(VnDUM_via7a 0.0010 "off grid polygon on layer VnDUM_via7")
    offGrid(LDBK 0.0010 "off grid polygon on layer LDBK")
    offGrid(PTCT 0.0010 "off grid polygon on layer PTCT")
    offGrid(ULVT 0.0010 "off grid polygon on layer ULVT")
    offGrid(BUMP 0.0010 "off grid polygon on layer BUMP")
    offGrid(OCOVL 0.0010 "off grid polygon on layer OCOVL")
)

errorLayer(geomGetNon45(AA) "non45 degree polygon on layer AA")
errorLayer(geomGetNon45(AADUM) "non45 degree polygon on layer AADUM")
errorLayer(geomGetNon45(ALDUB) "non45 degree polygon on layer ALDUB")
errorLayer(geomGetNon45(ALDUM) "non45 degree polygon on layer ALDUM")
errorLayer(geomGetNon45(ALPA) "non45 degree polygon on layer ALPA")
errorLayer(geomGetNon45(BORDER) "non45 degree polygon on layer BORDER")
errorLayer(geomGetNon45(CT) "non45 degree polygon on layer CT")
errorLayer(geomGetNon45(DG) "non45 degree polygon on layer DG")
errorLayer(geomGetNon45(DNW) "non45 degree polygon on layer DNW")
errorLayer(geomGetNon45(DUMBA) "non45 degree polygon on layer DUMBA")
errorLayer(geomGetNon45(DUMBM) "non45 degree polygon on layer DUMBM")
errorLayer(geomGetNon45(DUMBP) "non45 degree polygon on layer DUMBP")
errorLayer(geomGetNon45(ESD1) "non45 degree polygon on layer ESD1")
errorLayer(geomGetNon45(ESD2) "non45 degree polygon on layer ESD2")
errorLayer(geomGetNon45(ESD3) "non45 degree polygon on layer ESD3")
errorLayer(geomGetNon45(FUSE) "non45 degree polygon on layer FUSE")
errorLayer(geomGetNon45(GT) "non45 degree polygon on layer GT")
errorLayer(geomGetNon45(GTDUM) "non45 degree polygon on layer GTDUM")
errorLayer(geomGetNon45(GTFUSE) "non45 degree polygon on layer GTFUSE")
errorLayer(geomGetNon45(HRP) "non45 degree polygon on layer HRP")
errorLayer(geomGetNon45(HRPDMY) "non45 degree polygon on layer HRPDMY")
errorLayer(geomGetNon45(HVT) "non45 degree polygon on layer HVT")
errorLayer(geomGetNon45(INDMY) "non45 degree polygon on layer INDMY")
errorLayer(geomGetNon45(LOGO) "non45 degree polygon on layer LOGO")
errorLayer(geomGetNon45(LVN) "non45 degree polygon on layer LVN")
errorLayer(geomGetNon45(LVP) "non45 degree polygon on layer LVP")
errorLayer(geomGetNon45(LVT) "non45 degree polygon on layer LVT")
errorLayer(geomGetNon45(M1) "non45 degree polygon on layer M1")
errorLayer(geomGetNon45(M2) "non45 degree polygon on layer M2")
errorLayer(geomGetNon45(M3) "non45 degree polygon on layer M3")
errorLayer(geomGetNon45(M4) "non45 degree polygon on layer M4")
errorLayer(geomGetNon45(M5) "non45 degree polygon on layer M5")
errorLayer(geomGetNon45(M6) "non45 degree polygon on layer M6")
errorLayer(geomGetNon45(M7) "non45 degree polygon on layer M7")
errorLayer(geomGetNon45(M8) "non45 degree polygon on layer M8")
errorLayer(geomGetNon45(MARKG) "non45 degree polygon on layer MARKG")
errorLayer(geomGetNon45(MD) "non45 degree polygon on layer MD")
errorLayer(geomGetNon45(MIM) "non45 degree polygon on layer MIM")
errorLayer(geomGetNon45(MOMDMY) "non45 degree polygon on layer MOMDMY")
errorLayer(geomGetNon45(MnDUB_metal1)
    "non45 degree polygon on layer MnDUB_metal1")
errorLayer(geomGetNon45(MnDUB_metal2)
    "non45 degree polygon on layer MnDUB_metal2")
errorLayer(geomGetNon45(MnDUB_metal3)
    "non45 degree polygon on layer MnDUB_metal3")
errorLayer(geomGetNon45(MnDUB_metal4)
    "non45 degree polygon on layer MnDUB_metal4")
errorLayer(geomGetNon45(MnDUB_metal5)
    "non45 degree polygon on layer MnDUB_metal5")
errorLayer(geomGetNon45(MnDUB_metal6)
    "non45 degree polygon on layer MnDUB_metal6")
errorLayer(geomGetNon45(MnDUB_metal7)
    "non45 degree polygon on layer MnDUB_metal7")
errorLayer(geomGetNon45(MnDUB_metal8)
    "non45 degree polygon on layer MnDUB_metal8")
errorLayer(geomGetNon45(MnDUB_topmetal1)
    "non45 degree polygon on layer MnDUB_topmetal1")
errorLayer(geomGetNon45(MnDUB_topmetal2)
    "non45 degree polygon on layer MnDUB_topmetal2")
errorLayer(geomGetNon45(MnDUM_metal1a)
    "non45 degree polygon on layer MnDUM_metal1")
errorLayer(geomGetNon45(MnDUM_metal2a)
    "non45 degree polygon on layer MnDUM_metal2")
errorLayer(geomGetNon45(MnDUM_metal3a)
    "non45 degree polygon on layer MnDUM_metal3")
errorLayer(geomGetNon45(MnDUM_metal4a)
    "non45 degree polygon on layer MnDUM_metal4")
errorLayer(geomGetNon45(MnDUM_metal5a)
    "non45 degree polygon on layer MnDUM_metal5")
errorLayer(geomGetNon45(MnDUM_metal6a)
    "non45 degree polygon on layer MnDUM_metal6")
errorLayer(geomGetNon45(MnDUM_metal7a)
    "non45 degree polygon on layer MnDUM_metal7")
errorLayer(geomGetNon45(MnDUM_metal8a)
    "non45 degree polygon on layer MnDUM_metal8")
errorLayer(geomGetNon45(MnDUM_topmetal1)
    "non45 degree polygon on layer MnDUM_topmetal1")
errorLayer(geomGetNon45(MnDUM_topmetal2)
    "non45 degree polygon on layer MnDUM_topmetal2")
errorLayer(geomGetNon45(M1DOP)
    "non45 degree polygon on layer M1DOP")
errorLayer(geomGetNon45(M2DOP)
    "non45 degree polygon on layer M2DOP")
errorLayer(geomGetNon45(M3DOP)
    "non45 degree polygon on layer M3DOP")
errorLayer(geomGetNon45(M4DOP)
    "non45 degree polygon on layer M4DOP")
errorLayer(geomGetNon45(M5DOP)
    "non45 degree polygon on layer M5DOP")
errorLayer(geomGetNon45(M6DOP)
    "non45 degree polygon on layer M6DOP")
errorLayer(geomGetNon45(M7DOP)
    "non45 degree polygon on layer M7DOP")
errorLayer(geomGetNon45(M8DOP)
    "non45 degree polygon on layer M8DOP")
errorLayer(geomGetNon45(V1DOP)
    "non45 degree polygon on layer V1DOP")
errorLayer(geomGetNon45(V2DOP)
    "non45 degree polygon on layer V2DOP")
errorLayer(geomGetNon45(V3DOP)
    "non45 degree polygon on layer V3DOP")
errorLayer(geomGetNon45(V4DOP)
    "non45 degree polygon on layer V4DOP")
errorLayer(geomGetNon45(V5DOP)
    "non45 degree polygon on layer V5DOP")
errorLayer(geomGetNon45(V6DOP)
    "non45 degree polygon on layer V6DOP")
errorLayer(geomGetNon45(V7DOP)
    "non45 degree polygon on layer V7DOP")
errorLayer(geomGetNon45(MTT2DM)
    "non45 degree polygon on layer MTT2DM")
errorLayer(geomGetNon45(MTT2DB)
    "non45 degree polygon on layer MTT2DB")
errorLayer(geomGetNon45(MTT2)
    "non45 degree polygon on layer MTT2")
errorLayer(geomGetNon45(M1PIN)
    "non45 degree polygon on layer M1PIN")
errorLayer(geomGetNon45(M2PIN)
    "non45 degree polygon on layer M2PIN")
errorLayer(geomGetNon45(M3PIN)
    "non45 degree polygon on layer M3PIN")
errorLayer(geomGetNon45(M4PIN)
    "non45 degree polygon on layer M4PIN")
errorLayer(geomGetNon45(M5PIN)
    "non45 degree polygon on layer M5PIN")
errorLayer(geomGetNon45(M6PIN)
    "non45 degree polygon on layer M6PIN")
errorLayer(geomGetNon45(M7PIN)
    "non45 degree polygon on layer M7PIN")
errorLayer(geomGetNon45(M8PIN)
    "non45 degree polygon on layer M8PIN")
errorLayer(geomGetNon45(DNSRAM)
    "non45 degree polygon on layer DNSRAM")
errorLayer(geomGetNon45(LRSRAM)
    "non45 degree polygon on layer LRSRAM")
errorLayer(geomGetNon45(D2SRAM)
    "non45 degree polygon on layer D2SRAM")
errorLayer(geomGetNon45(RFSRAM)
    "non45 degree polygon on layer RFSRAM")
errorLayer(geomGetNon45(HPBL)
    "non45 degree polygon on layer HPBL")

errorLayer(geomGetNon45(NCAP) "non45 degree polygon on layer NCAP")
errorLayer(geomGetNon45(NLH) "non45 degree polygon on layer NLH")
errorLayer(geomGetNon45(NLHT) "non45 degree polygon on layer NLHT")
errorLayer(geomGetNon45(NLL) "non45 degree polygon on layer NLL")
errorLayer(geomGetNon45(NW) "non45 degree polygon on layer NW")
errorLayer(geomGetNon45(OVERDR) "non45 degree polygon on layer OVERDR")
errorLayer(geomGetNon45(PA) "non45 degree polygon on layer PA")
errorLayer(geomGetNon45(PABAR) "non45 degree polygon on layer PABAR")
errorLayer(geomGetNon45(PLH) "non45 degree polygon on layer PLH")
errorLayer(geomGetNon45(PLHT) "non45 degree polygon on layer PLHT")
errorLayer(geomGetNon45(PLL) "non45 degree polygon on layer PLL")
errorLayer(geomGetNon45(PSUB) "non45 degree polygon on layer PSUB")
errorLayer(geomGetNon45(RESAA) "non45 degree polygon on layer RESAA")
errorLayer(geomGetNon45(RESNW) "non45 degree polygon on layer RESNW")
errorLayer(geomGetNon45(RESP1) "non45 degree polygon on layer RESP1")
errorLayer(geomGetNon45(DIFRES) "non45 degree polygon on layer DIFRES")
errorLayer(geomGetNon45(PLRES) "non45 degree polygon on layer PLRES")
errorLayer(geomGetNon45(SAB) "non45 degree polygon on layer SAB")
errorLayer(geomGetNon45(SN) "non45 degree polygon on layer SN")
errorLayer(geomGetNon45(SP) "non45 degree polygon on layer SP")
errorLayer(geomGetNon45(TG) "non45 degree polygon on layer TG")
errorLayer(geomGetNon45(TGV) "non45 degree polygon on layer TGV")
errorLayer(geomGetNon45(TM1) "non45 degree polygon on layer TM1")
errorLayer(geomGetNon45(TM2) "non45 degree polygon on layer TM2")
errorLayer(geomGetNon45(TV1) "non45 degree polygon on layer TV1")
errorLayer(geomGetNon45(TV2) "non45 degree polygon on layer TV2")
errorLayer(geomGetNon45(V1) "non45 degree polygon on layer V1")
errorLayer(geomGetNon45(V2) "non45 degree polygon on layer V2")
errorLayer(geomGetNon45(V3) "non45 degree polygon on layer V3")
errorLayer(geomGetNon45(V4) "non45 degree polygon on layer V4")
errorLayer(geomGetNon45(V5) "non45 degree polygon on layer V5")
errorLayer(geomGetNon45(V6) "non45 degree polygon on layer V6")
errorLayer(geomGetNon45(V7) "non45 degree polygon on layer V7")
errorLayer(geomGetNon45(VTNH) "non45 degree polygon on layer VTNH")
errorLayer(geomGetNon45(VTPH) "non45 degree polygon on layer VTPH")
errorLayer(geomGetNon45(VnBAR_topvia1)
    "non45 degree polygon on layer VnBAR_topvia1")
errorLayer(geomGetNon45(VnBAR_topvia2)
    "non45 degree polygon on layer VnBAR_topvia2")
errorLayer(geomGetNon45(VnBAR_via1) "non45 degree polygon on layer VnBAR_via1")
errorLayer(geomGetNon45(VnBAR_via2) "non45 degree polygon on layer VnBAR_via2")
errorLayer(geomGetNon45(VnBAR_via3) "non45 degree polygon on layer VnBAR_via3")
errorLayer(geomGetNon45(VnBAR_via4) "non45 degree polygon on layer VnBAR_via4")
errorLayer(geomGetNon45(VnBAR_via5) "non45 degree polygon on layer VnBAR_via5")
errorLayer(geomGetNon45(VnBAR_via6) "non45 degree polygon on layer VnBAR_via6")
errorLayer(geomGetNon45(VnBAR_via7) "non45 degree polygon on layer VnBAR_via7")
errorLayer(geomGetNon45(VnDUM_via1) "non45 degree polygon on layer VnDUM_via1")
errorLayer(geomGetNon45(VnDUM_via2) "non45 degree polygon on layer VnDUM_via2")
errorLayer(geomGetNon45(VnDUM_via3) "non45 degree polygon on layer VnDUM_via3")
errorLayer(geomGetNon45(VnDUM_via4) "non45 degree polygon on layer VnDUM_via4")
errorLayer(geomGetNon45(VnDUM_via5) "non45 degree polygon on layer VnDUM_via5")
errorLayer(geomGetNon45(VnDUM_via6) "non45 degree polygon on layer VnDUM_via6")
errorLayer(geomGetNon45(VnDUM_via7) "non45 degree polygon on layer VnDUM_via7")
errorLayer(geomGetNon45(LDBK) "non45 degree polygon on layer LDBK")
errorLayer(geomGetNon45(PTCT) "non45 degree polygon on layer PTCT")
errorLayer(geomGetNon45(ULVT) "non45 degree polygon on layer ULVT")
errorLayer(geomGetNon45(BUMP) "non45 degree polygon on layer BUMP")
errorLayer(geomGetNon45(OCOVL) "non45 degree polygon on layer OCOVL")


drc(AA width<0.01 "acute angle on layer AA")
drc(AADUM width<0.01 "acute angle on layer AADUM")
drc(ALDUB width<0.01 "acute angle on layer ALDUB")
drc(ALPA width<0.01 "acute angle on layer ALPA")
drc(BORDER width<0.01 "acute angle on layer BORDER")
drc(DUMBA width<0.01 "acute angle on layer DUMBA")
drc(DUMBM width<0.01 "acute angle on layer DUMBM")
drc(DUMBP width<0.01 "acute angle on layer DUMBP")
drc(ESD1 width<0.01 "acute angle on layer ESD1")
drc(ESD2 width<0.01 "acute angle on layer ESD2")
drc(ESD3 width<0.01 "acute angle on layer ESD3")
drc(FUSE width<0.01 "acute angle on layer FUSE")
drc(GTFUSE width<0.01 "acute angle on layer GTFUSE")
drc(HRP width<0.01 "acute angle on layer HRP")
drc(HRPDMY width<0.01 "acute angle on layer HRPDMY")
drc(INDMY width<0.01 "acute angle on layer INDMY")
drc(LOGO width<0.01 "acute angle on layer LOGO")
drc(MARKG width<0.01 "acute angle on layer MARKG")
drc(MIM width<0.01 "acute angle on layer MIM")
drc(MOMDMY width<0.01 "acute angle on layer MOMDMY")
drc(MnDUB_metal1 width<0.01 "acute angle on layer MnDUB_metal1")
drc(MnDUB_metal2 width<0.01 "acute angle on layer MnDUB_metal2")
drc(MnDUB_metal3 width<0.01 "acute angle on layer MnDUB_metal3")
drc(MnDUB_metal4 width<0.01 "acute angle on layer MnDUB_metal4")
drc(MnDUB_metal5 width<0.01 "acute angle on layer MnDUB_metal5")
drc(MnDUB_metal6 width<0.01 "acute angle on layer MnDUB_metal6")
drc(MnDUB_metal7 width<0.01 "acute angle on layer MnDUB_metal7")
drc(MnDUB_metal8 width<0.01 "acute angle on layer MnDUB_metal8")
drc(MnDUB_topmetal1 width<0.01 "acute angle on layer MnDUB_topmetal1")
drc(MnDUB_topmetal2 width<0.01 "acute angle on layer MnDUB_topmetal2")
drc(NCAP width<0.01 "acute angle on layer NCAP")
drc(OVERDR width<0.01 "acute angle on layer OVERDR")
drc(PABAR width<0.01 "acute angle on layer PABAR")
drc(RESAA width<0.01 "acute angle on layer RESAA")
drc(RESNW width<0.01 "acute angle on layer RESNW")
drc(RESP1 width<0.01 "acute angle on layer RESP1")
drc(DIFRES width<0.01 "acute angle on layer DIFRES")
drc(PLRES width<0.01 "acute angle on layer PLRES")
drc(TGV width<0.01 "acute angle on layer TGV")
drc(VnBAR_topvia1 width<0.01 "acute angle on layer VnBAR_topvia1")
drc(VnBAR_topvia2 width<0.01 "acute angle on layer VnBAR_topvia2")
drc(VnBAR_via1 width<0.01 "acute angle on layer VnBAR_via1")
drc(VnBAR_via2 width<0.01 "acute angle on layer VnBAR_via2")
drc(VnBAR_via3 width<0.01 "acute angle on layer VnBAR_via3")
drc(VnBAR_via4 width<0.01 "acute angle on layer VnBAR_via4")
drc(VnBAR_via5 width<0.01 "acute angle on layer VnBAR_via5")
drc(VnBAR_via6 width<0.01 "acute angle on layer VnBAR_via6")
drc(VnBAR_via7 width<0.01 "acute angle on layer VnBAR_via7")
drc(LDBK width<0.01 "acute angle on layer LDBK")
drc(PTCT width<0.01 "acute angle on layer PTCT")
drc(ULVT width<0.01 "acute angle on layer ULVT")
drc(BUMP width<0.01 "acute angle on layer BUMP")
drc(OCOVL width<0.01 "acute angle on layer OCOVL")

; rule_AADUMC6=(GT or LOGO )
rule_AADUMC6=geomOr(GT LOGO)

; rule_AADUMC10=AADUM overlap RESNW
rule_AADUMC10=geomOverlap(AADUM RESNW)

; rule_AADUMC11=AADUM encRect 20 20
rule_AADUMC11=geomEncloseRect(AADUM 20.001 20.001)

; rule_ALDUMC29=ALDUM interact INDMY
rule_ALDUMC29=geomButtOrOver(ALDUM INDMY)

; rule_BORDER1=bulk_copy notInteract BORDER
;rule_BORDER1=geomAvoiding(bulk_copy BORDER_all)
rule_BORDER_corner=geomGetCorner(bulk keep==90)
rule_BORDERa=geomStretchCorner(rule_BORDER_corner 74 angleAll)
rule_BORDERb=geomAndNot(bulk_copy BORDER_all)
rule_BORDER1=geomAndNot(rule_BORDERb rule_BORDERa)


geomConnect(
incremental
    buttOrOver(rule_esd3_aa ESD_all)
    buttOrOver(rule_esd3_aa rule_esd3_sn)
    buttOrOver(rule_esd3_aa rule_esd3_sp)
)

if( avSwitch("METAL_OPTION_4LM_1TM") then switchProc04() )

if( avSwitch("METAL_OPTION_5LM_1TM") then switchProc05() )

if( avSwitch("METAL_OPTION_5LM_2TM") then switchProc06() )

if( avSwitch("METAL_OPTION_6LM_1TM") then switchProc0() )

if( avSwitch("METAL_OPTION_6LM_2TM") then switchProc01() )

if( avSwitch("METAL_OPTION_7LM_1TM") then switchProc1() )

if( avSwitch("METAL_OPTION_7LM_2TM") then switchProc2() )

if( avSwitch("METAL_OPTION_8LM_1TM") then switchProc3() )

if( avSwitch("METAL_OPTION_8LM_2TM") then switchProc4() )

if( avSwitch("METAL_OPTION_9LM_1TM") then switchProc5() )

if( avSwitch("METAL_OPTION_9LM_2TM") then switchProc6() )

if( avSwitch("METAL_OPTION_10LM_2TM") || !avSwitch("METAL_OPTION_10LM_2TM") &&
    !avSwitch("METAL_OPTION_6LM_1TM") && !avSwitch("METAL_OPTION_7LM_1TM") &&
    !avSwitch("METAL_OPTION_7LM_2TM") && !avSwitch("METAL_OPTION_8LM_1TM") &&
    !avSwitch("METAL_OPTION_8LM_2TM") && !avSwitch("METAL_OPTION_9LM_1TM") &&
    !avSwitch("METAL_OPTION_9LM_2TM") && !avSwitch("METAL_OPTION_6LM_2TM") &&
    !avSwitch("METAL_OPTION_5LM_2TM") && !avSwitch("METAL_OPTION_5LM_1TM") &&
    !avSwitch("METAL_OPTION_4LM_1TM") then switchProc7() )


L30882=geomOutside(drc(AA width<0.060) INST)
errorLayer(L30882
    "AA_1: AA minimum width (The INST connected area apply SRAM design rule) >= 0.060")

rule_sraa_1a=drc(AA notch<0.046 opposite)
sraa1a=geomAndNot(rule_sraa_1a geomOutside(rule_sraa_1a INST))
errorLayer(sraa1a "SRAA_1sa:AA inner vertex to inner vertex distance is 0.046")

L6413=geomGetEdge(mos12 inside GT)
L84941=geomOutside(drc(L6413 width<0.12) INST)
errorLayer(L84941
    "AA_1a: AA minimum width of NMOS/PMOS for 0.9/1.1/1.2V transistor >= 0.120")

;L19693=geomGetEdge(aa_mos_hv coincident gate_hv)
;L27835=drc(L19693 width<0.32)
aa2a = drc( geomGetEdge(geomAnd(mos geomOr(DG TG)) inside GT) width<0.32)
errorLayer(aa2a
    "AA_2: AA (enclosure by TG or DG) minimum width for 1.8/2.5V transistor >= 0.320")

L71318=geomOutside(drc(AA sepNotch<0.080 withSingularPoint) INST)
errorLayer(L71318 "AA_4a: AA minimum space >= 0.080")

rule_sraa4=drc(AA sepNotch<0.065 withIntersection withSingularPoint)
sraa4a=geomAndNot(rule_sraa4 geomOutside(rule_sraa4 INST))
errorLayer(sraa4a "SRAA_4a:AA min space is 0.065")

sraa4c1=geomButtOrOver(AA gate)
sraa4b4c1 = geomWidth(sraa4c1 keep >= 0.14 )
sraa4c2=geomOr(geomGetEdge(sraa4c1 coincident gate wholeEdge) geomGetEdge(sraa4c1 butting gate wholeEdge))
sraa4c3=geomOr(geomGetEdge(sraa4b4c1 coincident gate wholeEdge) geomGetEdge(sraa4b4c1 butting gate wholeEdge))
sraa4c4=drc(sraa4c2  sraa4c3 sep <0.085 opposite)
SRL20447=geomAndNot(sraa4c4 geomOutside(sraa4c4 INST))
SRL20448= geomWithEdge(SRL20447 geomGetLength(SRL20447 keep >= 0.14))
errorLayer(SRL20448
    "SRAA_4c:AA minimum space if one of AA width (W3)>=0.14um, and AA to AA overlap (run length) Y2 >=0.14um >= 0.100")

aa4b4c1 = geomButtOrOver(AA gate)
aa4b4c2 = geomWidth(aa4b4c1 keep >= 0.14 )
;L20445=drc(aa4b4c1 aa4b4c2 0<sep<0.100 opposite edgeb)
L20446=drc(aa4b4c1 aa4b4c2 0<sep<0.100 opposite)
L20447=geomOutside(L20446 INST)
L20448= geomWithEdge(L20447 geomGetLength(L20446 keep >= 0.14))
errorLayer(L20448
    "AA_4b_4c:AA minimum space if one of AA width (W3)>=0.14um, and AA to AA overlap (run length) Y2 >=0.14um >= 0.100")

aa04d1=geomInside(AA geomOr(DG TG))
aa04d=drc(aa04d1 sepNotch<0.15 withIntersection withSingularPoint)
errorLayer(aa04d "AA_4d: AA to AA space inside (DG OR TG)>=0.15")

L75555=geomOutside(drc(geomAndNot(AA ftaa) area<0.020) INST)
errorLayer(L75555
    "AA_9: AA minimum area (um2) except floating AA. (The INST connected area apply SRAM design rule) Floating AA is defined as AA that has no CT above it >=0.020")

L96142=drc(ftaa area<0.015)
L96143=geomOutside(L96142 INST)
errorLayer(L96143
    "AA_9a: AA minimum area (um^2) at floating AA (The INST connected area apply SRAM design rule) >= 0.015")

rule_sraa_9=drc(AA area<0.015)
sraa9=geomAndNot(rule_sraa_9 geomOutside(rule_sraa_9 INST))
errorLayer(sraa9 "SRAA_9:AA min area is 0.015")

aa10a=geomStraddle(mos DG)
aa10b=geomStraddle(mos TG)
aa10c=geomButtOrOver(geomButtOrOver(mos DG) TG)
aa10 =geomCat(aa10a aa10b aa10c)
errorLayer(aa10
    "AA_10: DG,TG or core transistors mixed in the same AA are prohibited")

aa11a=geomAndNot(geomAndNot(geomStraddle(nact NW) LDBK) geomButtOrOver(AA RESNW))
aa11b=geomAndNot(geomAndNot(geomStraddle(pact NW) LDBK) geomButtOrOver(AA RESNW))
errorLayer(geomCat(aa11a aa11b) "AA_11: It is not allow if N+AA/P+AA crossing the NW")

;L6414=geomGetEdge(GT inside aa_mos_lv)
;L6415=geomSize(L6414 0.005 unmerged)
;L76684=drc(L6415 area>0.25)
;aa12n=geomButtOrOver(L76684 VARMOS)
;aa12=geomAndNot(L76684 aa12n)
;L29406=geomGrow(gate_lv -25.0 0)
;L76684=geomGrow(L29406 25.0 0)
aa12a1=geomGetLength(geomGetEdge(GT inside geomAndNot(geomAndNot(mos geomOr(DG TG)) VARMOS)) keep>50)
aa12=geomSize(aa12a1 -0.01 edges)
errorLayer(aa12
    "AA_12: AA maximum width of NMOS/PMOS for 0.9/1.1/1.2V transistor <= 50.000")

L12056=geomHoles(AA innermost)
L71517=geomAndNot(L12056 AA)
L95251=drc(L71517 area<0.045)
errorLayer(L95251 "AA_13: AA minimum enclosed area(um2) >=0.045")

aa15a=geomGetAngledEdge(AA keep==45 fig)
aa15b=drc(aa15a width<0.16)
errorLayer(aa15b "AA_16: Bent 45 degree AA width is >= 0.16")

aa16a=geomGetAngledEdge(AA keep==45 fig)
aa16=drc(aa16a AA sep<0.16 parallel)
errorLayer(aa16 "AA_17: 45 degree AA space to parallel AA is >=0.16")

aa18aa1=geomGetLength(AA keep>0.001)
aa18a=geomSelectEdge(aa18aa1 length keep<0.15 angle1(269.9<keep<271.1) angle2(269.9<keep<271.1))
aa18a1=geomSelectEdge(aa18aa1 length keep>0.03 angle1(89.9<keep<90.1) angle2(269.9<keep<271.1))       
aa18az=drc(aa18a aa18a1 sep<0.001 only_perp)
aa18am=drc(aa18a AA ovlp<=0.08 opposite)
aa18b=geomOutside(geomButtOrOver(geomButtOrOver(geomSize(aa18a 0.001 edges) aa18az) aa18am) INST)
errorLayer(aa18b "AA_18: AA space for of U shape (notch) is >=0.15")

aa18a1=geomOr(SN SP) 
aa18a3=geomAndNot(AA geomInside(AA aa18a1))
aa18a4=geomAndNot(aa18a3 geomButtOrOver(AA RESNW))
errorLayer(aa18a4 "AA_19: AA must be fully covered by (SN OR SP),Waive the violations inside (RESNW AND AA) and HRP(HRPDMY) areas")

rule_difres1=drc(aa_difres width<0.2)
errorLayer(rule_difres1
"DIFRES_1:AA Silicide resistor minimum width >= 0.2")

rule_difres2=geomAnd(DIFRES RESAA)
errorLayer(rule_difres2 "DIFRES_2:DIFRES can not overlap with RESAA")

rule_difres3a=geomGetEdge(DIFRES inside aa_difres)
rule_difres3=geomGetLength(rule_difres3a keep <0.2)
errorLayer(rule_difres3 "AA Silicide resistor minimum square number >=1")


rule_difres4=geomGetNonRectangle(aa_difresbody)
errorLayer(rule_difres4 "DIFRES_4:AA silicide resistor must be orthogonal")

difres05a=drc(CT DIFRES sep<=0.07 withIntersection opposite)
difres05b=drc(CT DIFRES sep==0.01 opposite)
difres05c=geomAndNot(difres05a geomAndNot(difres05b geomEnclose(difres05b CT)))
difres05d=geomButtOrOver(CT DIFRES)
difres05=geomOr(difres05c difres05d)
errorLayer(difres05 "DIFRES_5:CT to DIFRES space is 0.01um")

difres06a=geomButtOnly(aa_difres geomAndNot(DIFRES aa_difres) keep > 1)
difres06b=geomOr(geomGetEdge(DIFRES coincident AA) geomGetEdge(DIFRES butting AA))
difres06c=geomSize(difres06b -0.001 edges)
difres06=geomAvoiding(DIFRES geomOr(difres06a geomButtOrOver(DIFRES difres06c)))
errorLayer(difres06 "DIFRES_6:Extension of DIFRES outside of AA minimum distance >=0um")

L41111=drc(aa_difres SN sep<0.160 withIntersection withSingularPoint)
L41112=drc(aa_difres SP sep<0.160 withIntersection withSingularPoint)
L41113=drc(aa_difres ESD1 sep<0.160 withIntersection withSingularPoint)
errorLayer(geomCat(L41111 L41112 L41113)
    "DIFRES_7: The minimum separation between resistors with un-related implant region >= 0.160")

difres8aa=geomEnclose(AA aa_difres)
difres8a1=geomAndNot(difres8aa geomInside(difres8aa SP)) 
difres08a=geomAndNot(difres8a1 geomInside(difres8a1 SN))
difres08b=drc(SN geomEnclose(AA aa_difres) enc<0.18 withIntersection withSingularPoint)
difres08c=drc(SP geomEnclose(AA aa_difres) enc<0.18 withIntersection withSingularPoint)
difres08=geomCat(difres08a difres08b difres08c)
errorLayer(difres08 "DIFRES_8: For AA Silicide resistor, make sure the AA be implanted by either SN or SP. Minimum enclosure by SN or SP >= 0.18um")

rule_difres9a=geomAnd(aa_difres SP)
rule_difres9=geomAndNot(rule_difres9a NW)
errorLayer( rule_difres9 "DIFRES_9:AA Silicide resistor with SP must lay on NW")

rule_difres10a=geomAnd(aa_difres SN)
rule_difres10=geomAnd(rule_difres10a NW)
errorLayer( rule_difres10 "DIFRES_10:AA Silicide resistor with SN must lay on PW")

rule_difres11=drc(DIFRES AA sep < 0.08 withIntersection withSingularPoint)
errorLayer( rule_difres11 "DIFRES_11:Minimum Space between DIFRES and non-related AA >= 0.08um")

rule_difres12=drc(DIFRES GT sep < 0.08 withIntersection withSingularPoint)
errorLayer( rule_difres12 "DIFRES_12:Minimum Space between DIFRES and non-related Poly >=0.08um")

aar=geomAnd(AA RESAA) 
L43905=geomGetEdge(aar inside SAB)
L49979=drc(L43905 width<0.400)
errorLayer(L49979
    "RESAA_2: AA resistor minimum width AA resistor mean AA with RESAA overlap SAB region >= 0.400")

L99819=geomOr(geomGetEdge(SAB butting aar) geomGetEdge(SAB coincident aar))
L9790=drc(L99819 width<0.400)
errorLayer(L9790 "RESAA_3: AA resistor minimum length >= 0.400")


L23128=geomGetNon90(aar)
errorLayer(L23128 "RESAA_4: AA resistor must be orthogonal")

L23129=drc(geomInside(CT geomButtOrOver(AA aar)) SAB sep < 0.20 withIntersection withSingularPoint) 
errorLayer(L23129 "RESAA_5:CT to SAB minimum space is 0.20")

L99220=drc(RESAA AA enc<0.180 withIntersection withSingularPoint)
errorLayer(L99220
    "RESAA_6: Extension of RESAA outside of AA minimum distance >= 0.180")


L37234=drc(aa_res SN sep<0.160 withIntersection withSingularPoint)
L37235=drc(aa_res SP sep<0.160 withIntersection withSingularPoint)
L37236=drc(aa_res ESD1 sep<0.160 withIntersection withSingularPoint)
errorLayer(geomCat(L37234 L37235 L37236 )
    "RESAA_7: The minimum separation between resistors with un-related implant region >= 0.160")


resaa9a1=geomAndNot(geomAnd(AA RESAA) SAB)
resaa9a2=geomAndNot(aar geomInside(aar SP)) 
resaa9a3=geomAndNot(resaa9a2 geomInside(resaa9a2 SN))
resaa9a=geomOr(resaa9a1 resaa9a3)
errorLayer(resaa9a
    "RESAA_9: For AA resistor, make sure the AA is covered by SAB and implanted by either SN or SP.")

resaa10a=geomAndNot(geomAnd(aar SP) NW)
errorLayer(resaa10a "RESAA_10: AA SAB resistor with SP must lay on NW")

;L77811=drc(aa_res SAB enc<0.400)
;errorLayer(L77811 "RESAA_11: Minimum AA extension of SAB >= 0.400")

L95175=drc(AA RESAA sep<0.080 withIntersection withSingularPoint)
errorLayer(L95175 "RESAA_12: Minimum Space RESAA to non-related AA >= 0.160")

L46409=drc(GT RESAA sep<0.080 withIntersection withSingularPoint)
errorLayer(L46409 "RESAA_13: Minimum Space RESAA to non-related Poly >= 0.240")

resaa14a=geomGetEdge(SAB inside AA)
resaa14b=geomGetEdge(RESAA inside AA)
resaa14c=geomAndNot(resaa14b geomOr(geomGetEdge(resaa14b coincident resaa14a) geomGetEdge(resaa14b butting resaa14a)))
resaa14d=geomEnclose(RESAA AA)
resaa14e=geomOr(resaa14c resaa14d)
errorLayer(resaa14e "RESAA_14: RESAA and SAB on AA should have coincident edge")

L2416=drc(DNW width<0.520)
errorLayer(L2416 "DNW_1: DNW minimum width >= 0.520")

L29525=drc(DNW sepNotch<0.800)
errorLayer(L29525 "DNW_2: Minimum space between two DNW regions >= 0.800")

L99903=geomGetEdge(DNW outside NW)
errorLayer(L99903 "DNW_3: Minimum overlap of NW and DNW region >= 0.000")

dnw04a=geomAndNot(NW geomOr(geomGetEdge(NW coincident DNW) geomGetEdge(NW butting DNW)))
L87634=drc(DNW dnw04a sep<0.565 withIntersection)
errorLayer(L87634 "DNW_4: Minimum space between a DNW and a NW >= 0.565")

dnw07a=drc(geomOutside(nact geomOr(DNW NW)) DNW sep<1.6 withIntersection withSingularPoint)
errorLayer(dnw07a "DNW_7:Space between DNW and N+AA outside of DNW or NW >= 1.6")

NW_ni=geomOutside(NW INST)
L11642=geomOutside(drc(NW width<0.330 parallel) INST)
errorLayer(L11642
    "NW_1: NW minimum width.(paralled side to side width. The INST connected area apply SRAM design rule) >= 0.330")

NW_in=geomAndNot(NW geomOutside(NW INST))
rule_srnw_1=drc(NW width<0.27)
srnw1=geomAndNot(rule_srnw_1 geomOutside(rule_srnw_1 INST))
errorLayer(srnw1 "SRNW_1:NW min width is 0.27")

L75706=drc(nw_lv sep<0.330 sameNet opposite)
L75707=geomOutside(L75706 INST)
errorLayer(L75707
    "NW_3: Minimum space between two NW regions of the same net. (with run length > 0 ) >=0.330")
L99545=drc(nw_lv notch<0.330  opposite)
L99546=geomOutside(L99545 INST)
errorLayer(L99546
    "NW_3: Minimum space between two NW regions of the same net. (with run length > 0 ) >=0.330")

L62762=drc(nw_lv sep<0.600 diffNet withIntersection withSingularPoint)
errorLayer(L62762
    "NW_4: Minimum space between two NW regions of different net >=0.600")

L4421=drc(NW area<0.700)
errorLayer(L4421 "NW_7: NW minimum area (um^2) >= 0.700")

L25231=geomHoles(NW innermost)
L25393=geomAndNot(L25231 NW)
L32688=drc(L25393 area<0.700)
errorLayer(L32688 "NW_8: NW minimum enclosed area (um^2) >= 0.700")

L57337=geomInside(nact tg_or_dg)
L56760=drc(NW L57337 sep<0.220 withIntersection withSingularPoint)
errorLayer(L56760
    "NW_9: NW minimum space to N+AA (enclosure by TG or DG) >= 0.220")

pa_in_tg=geomInside(pact DGTG)
rule_nw10=drc(NW pa_in_tg enc<0.22 withIntersection withSingularPoint)
errorLayer(rule_nw10 "NW_10:NW minimum enclosure to P+AA (enclosure by TG or DG) is 0.22um")

nact_edge=geomGetLength(nact keep>0)
nw11Eregion=geomSize(geomStretch(nact_edge 0.001) -0.08 edges)
nw11Eregion_edge=geomGetEdge(nact inside nw11Eregion)
nw11Eregion_=drc(nw11Eregion_edge NW sep<0.16 opposite with_perp edgea)
nw11Eregion_edge_1=geomOr(geomGetEdge(nw11Eregion_edge butting nw11Eregion_ wholeEdge) geomGetEdge(nw11Eregion_edge coincident nw11Eregion_ wholeEdge))
nw11c=geomSize(nw11Eregion_edge_1  -0.002) 
nw11=geomGetNonRectangle(nw11c)
errorLayer(nw11 "NW_11:N+AA adjacent both two edges space opposite to NW is >=0.16. Both of two adjacent edges space to NW smaller than rule value is not permitted,In schematic rule check method, E = 0.08, D=0.16")

pact_edge=geomGetLength(pact keep>0)
nw12Eregion=geomSize(geomStretch(pact_edge 0.001) -0.08 edges)
nw12Eregion_edge=geomGetEdge(pact inside nw12Eregion)
nw12Eregion_=drc(NW nw12Eregion_edge enc<0.16 opposite with_perp edgeb)
nw12Eregion_edge_1=geomOr(geomGetEdge(nw12Eregion_edge butting nw12Eregion_ wholeEdge) geomGetEdge(nw12Eregion_edge coincident nw12Eregion_ wholeEdge))
nw12c=geomSize(nw12Eregion_edge_1  -0.002) 
nw12=geomOutside(geomGetNonRectangle(nw12c) SRAM)
errorLayer(nw12 "NW_12:N+AA adjacent both two edges space opposite to NW is >=0.16. Both of two adjacent edges space to NW smaller than rule value is not permitted,In schematic rule check method, E = 0.08, D=0.16")

srnw13x=drc(NW ntap enc<0.027 withIntersection withSingularPoint)
srnw13=geomAndNot(srnw13x geomOutside(srnw13x INST))
errorLayer(srnw13 "SRNW_13: N+AA enclosure by NW is 0.027")

srnw14a=drc(nact NW sep<0.04 withIntersection opposite)
srnw14b=geomAndNot(srnw14a geomOutside(srnw14a INST))
srnw14c=drc(nact NW sep<0.037 withIntersection cornerToCorner)
srnw14d=geomAndNot(srnw14c geomOutside(srnw14c INST))
srnw14=geomCat(srnw14b srnw14d)
errorLayer(srnw14 "SRNW_14:Space between NW and N+AA inside PW is 0.04,Minimum space between NW outter vertex and N+AA inside PW outter vertex is 0.037")

srnw15x=drc(NW pact enc<0.037 withIntersection withSingularPoint)
srnw15=geomAndNot(srnw15x geomOutside(srnw15x INST))
errorLayer(srnw15 "SRNW_15:P+AA enclosure by NW is 0.037")

nw13a1=geomAnd(geomButtOrOver(AA RESNW) SN)
nw13a=drc(NW geomAndNot(geomOutside(nact geomOr(INST LDBK)) nw13a1) enc<0.08 withIntersection withSingularPoint)
errorLayer(nw13a "NW_13:N+AA Minimum enclosure by NW is 0.08, excluding LDMOS area,Waive (AA interact RESNW) and SN")

nw14a=drc(geomOutside(NW INST) geomOutside(nact geomOr(INST PSUB)) sep<0.08 withIntersection withSingularPoint)
errorLayer(nw14a "NW_14:Minimum Space between NW and N+AA inside PW is 0.08")

nw15a=drc(NW geomOutside(pact geomOr(INST LDBK)) enc<0.08 withIntersection withSingularPoint)
errorLayer(nw15a "NW_15:P+AA minimum enclosure by NW is 0.08, excluding LDMOS area")

nw16=drc(geomAndNot(ptap geomOr(LDBK PSUB)) NW sep<0.08 withIntersection withSingularPoint)
errorLayer(nw16 "NW_16:Minimum Space between NW and P+AA inside PW is 0.08, excluding LDMOS area")

nw_res=geomAnd(NW RESNW)
nwrsti=geomAndNot(nw_res AA)

resnwst12a=geomOr(geomGetEdge(nwrsti coincident AA wholeEdge) geomGetEdge(nwrsti butting AA wholeEdge))
resnwst12b=drc(resnwst12a width<10 opposite)
rule_resnwsti_1_2=geomAndNot(nwrsti geomEncloseRect(nwrsti 1.2 10))
errorLayer(geomCat(resnwst12b rule_resnwsti_1_2) "RESNWST_1_2: NW Resistor width>=1.2")

resnwst3=drc(nwrsti NW sep<1 withIntersection withSingularPoint)
errorLayer(resnwst3 "RESNWST_3:NW-Resistor and NW space S1 >=1")

resnwstx0=geomButtOrOver(RESNW nwrsti)
resnwstx01a=geomOr(geomGetEdge(RESNW coincident nwrsti) geomGetEdge(RESNW butting nwrsti))
resnwstx01=geomOr(geomGetEdge(resnwstx01a coincident AA wholeEdge) geomGetEdge(resnwstx01a butting AA wholeEdge))
resnwstx1=drc(resnwstx01 CT sep<= 0.36 withIntersection opposite)
resnwstx2=drc(resnwstx01 CT sep== 0.3 withIntersection opposite)
resnwst4=geomOr(geomAndNot(resnwstx1 geomAndNot(resnwstx2 geomEnclose(resnwstx2 CT))) geomButtOrOver(CT resnwstx0))
errorLayer(resnwst4 "RESNWST_4:The nearest CT space to (AA edge touch RESNW) S2=0.3")

resnwst5=drc(nwrsti geomAvoiding(AA nwrsti) sep<0.44 withIntersection withSingularPoint)
errorLayer(resnwst5 "RESNWST_5:Minimum space between NWSTI resistor and adjacent AA is 0.44um")

resnwst6=geomButtOnly(geomAnd(RESNW NW) AA keep<2)
errorLayer(resnwst6 "RESNWST_6:Space between RESNW to silicided AA area S4=0.00,DRC check by RESNW AND NW touch AA edge with count 2")

resnwst7=drc(SN geomButtOnly(AA nwrsti) enc<0.4 withIntersection)
errorLayer(resnwst7 "RESNWST_7:SN enclosure of AA 0.4")

resnwst8=drc(AA geomButtOrOver(NW RESNW) enc<0.3 withIntersection)
errorLayer(resnwst8 "RESNWST_8: AA enclosure of NW(the NW interacted with RESNW)>=0.3")

resnwst9=geomAnd(geomAndNot(geomButtOnly(AA nwrsti) ntap) CT)
errorLayer(resnwst9 "RESNWST_9:CT should be in (NW AND ( pick up AA))")

resnwst10=geomAnd(nwrsti AADUM)
errorLayer(resnwst10 "RESNWST_10:NW resistor under STI must not overlap with AADUM")

resnwst11=geomGetNonRectangle(geomAnd(RESNW NW))
errorLayer(resnwst11 "RESNWST_11:(RESNW AND NW) must be an orthogonal rectangle shape to have good simulation accuracy")

;RESNW - N-Well Resistor DRC

resnwaa=geomAnd(geomAnd(NW RESNW) AA)

resnwaa1a=geomGetNonRectangle(geomButtOrOver(RESNW resnwaa))
errorLayer(resnwaa1a "RESNWAA_1: RESNW must be an orthogonal rectangle")

resnwaa23a=geomOr(geomGetEdge(resnwaa coincident SN wholeEdge) geomGetEdge(resnwaa butting SN wholeEdge))
resnwaa23b=drc(resnwaa23a width<10 opposite)
resnwaa23=geomEncloseRect(resnwaa 1.2 10 ignore)
errorLayer(geomCat(resnwaa23b resnwaa23) "RESNWAA_2_3: NW-Resistor minimum length (SMIC 2R)>=10,NW-Resistor width (SMIC 2R, 65nm rule 1.6um)>=1.2")

resnwaa4=drc(AA resnwaa enc<0.3 withIntersection)
errorLayer(resnwaa4 "RESNWAA_4: AA enclosure of RESNWAA (SMIC 2R no rule, 65nm rule number)>=0.3")

resnwaa5=drc(geomEnclose(NW resnwaa) CT enc<0.2 withIntersection)
errorLayer(resnwaa5 "RESNWAA_5: NW enclosure of CT (65nm rule, included in SMIC 2R)>=0.20")

resnwaa6a=geomHoles(SAB) 
resnwaa6b=geomButtOnly(SAB resnwaa6a)
resnwaa6c=drc(resnwaa6a geomButtOrOver(NW resnwaa) enc<0.2 withIntersection withSingularPoint)
resnwaa6d=drc(resnwaa6b geomButtOrOver(NW resnwaa) enc<0.2 withIntersection withSingularPoint)
resnwaa6e=geomAndNot(geomAndNot(geomButtOrOver(geomButtOrOver(NW resnwaa) resnwaa6a) resnwaa6a) SAB)
resnwaa6=geomCat(resnwaa6c resnwaa6d resnwaa6e)
errorLayer(resnwaa6 "RESNWAA_6: Enclosure of SAB beyond related NW (65nm rule)>=0.20")

resnwaa7a=geomAnd(resnwaa SN)
resnwaa7b=geomAnd(resnwaa SP)
resnwaa7c=geomAnd(resnwaa ESD1)
resnwaa7=geomCat(resnwaa7a resnwaa7b resnwaa7c)
errorLayer(resnwaa7 "RESNWAA_7: RESNW must not overlap with other implant layers (except NW) in the NW-Resistor area")

resnwaa8a=geomButtOrOver(RESNW resnwaa)
resnwaa8x01=geomOr(geomGetEdge(resnwaa8a coincident SN) geomGetEdge(resnwaa8a butting SN))
resnwaa8x=geomInside(CT geomButtOrOver(AA RESNW))
resnwaa8b=drc(resnwaa8x01 resnwaa8x sep<=0.76 opposite withIntersection)
resnwaa8c=drc(resnwaa8x01 resnwaa8x sep==0.7 opposite withIntersection)
resnwaa8=geomOr(geomAndNot(resnwaa8b geomAndNot(resnwaa8c geomEnclose(resnwaa8c CT))) geomButtOrOver(CT resnwaa8a))
errorLayer(resnwaa8 "RESNWAA_8: Space between RESNW and CT (65nm rule 0.4, 40nm WAT TK 0.7um)	=0.70")

resnwaa10a=geomButtOnly(resnwaa geomAndNot(RESNW resnwaa) keep>1)
resnwaa10b=geomOr(geomGetEdge(RESNW coincident NW) geomGetEdge(RESNW butting NW))
resnwaa10c=geomSize(resnwaa10b -0.001 edges)
resnwaa10=geomAvoiding(RESNW geomOr(resnwaa10a geomButtOrOver(RESNW resnwaa10c)))
errorLayer(resnwaa10 "RESNWAA_9: Extension of RESNW outside of NW (65nm 0.2um, SMIC 2R RESNW within NW) >= 0.00")

resnwaa11a=geomEnclose(RESNW geomAnd(RESNW AA))
resnwaa11b=geomButtOrOver(geomOr(SAB geomHoles(SAB)) resnwaa11a)
resnwaa11=geomAndNot(resnwaa11b geomEnclose(resnwaa11b resnwaa))
errorLayer(resnwaa11 "RESNWAA_10: SAB must include NW resistor except CT area")

resnwaa12a=geomButtOrOver(RESNW resnwaa)
resnwaa12b=geomAndNot(resnwaa12a geomButtOnly(resnwaa12a SN))
errorLayer(resnwaa12b "RESNWAA_11: Space between RESNW to SN (SMIC 2R no rule, 65nm no rule)=0.00")

resnwaa13=drc(SAB geomButtOrOver(AA resnwaa) enc<0.18 withIntersection)
errorLayer(resnwaa13 "RESNWAA_12: SAB enclosure of AA (SMIC 2R no rule, 65nm rule 0.2um, 0.18um is SMIC SAB main rule)>=0.18")

resnwaa14a=geomOr(geomGetEdge(SN coincident RESNW) geomGetEdge(SN butting RESNW))
resnwaa14b=geomSize(resnwaa14a -0.4 edges)
resnwaa14=geomAndNot(resnwaa14b geomButtOnly(resnwaa14b geomHoles(SAB)))
errorLayer(resnwaa14 "RESNWAA_13: SAB overlap of SN =0.4. Use exact value on sides touch RESNW.(65nm rule 0.2, 40nm WAT TK 0.4um)")

L15638=drc(PSUB width<0.330)
errorLayer(L15638 "PSUB_1: PSUB width >= 0.330")

psub2a=geomGetEdge(pbaa inside GT)
psub2b=geomOr(geomGetEdge(psub2a coincident gate) geomGetEdge(psub2a butting gate))
psub2=drc(psub2b width < 0.4)
errorLayer(psub2
    "PSUB_2: Minimum width of an AA to define the width of native NMOS for 0.9/1.1/1.2/1.8/2.5V transistors >=0.400")

L26283=geomGetEdge(pbgt inside pbaa)
psub3a1=geomOr(geomGetEdge(L26283 coincident gate) geomGetEdge(L26283 butting gate))
L88090=drc(psub3a1 width<0.300)
errorLayer(L88090
    "PSUB_3a: 0.9/1.1/1.2V minimum gate length enclosure by PSUB >= 0.300")

L41518=geomGetEdge(pbgt inside geomButtOrOver(pbaa DG))
psub3b1=geomOr(geomGetEdge(L41518 coincident gate) geomGetEdge(L41518 butting gate))
L77985=drc(psub3b1 width<0.800)
errorLayer(L77985
    "PSUB_3b: 1.8V minimum gate length enclosure by PSUB(enclosure by DG) >= 0.800")

L16350=geomGetEdge(pbgt inside geomButtOrOver(pbaa TG))
psub3cd1=geomOr(geomGetEdge(L16350 coincident gate) geomGetEdge(L16350 butting gate))
L53926=drc(psub3cd1 width<1.200)
errorLayer(L53926
    "PSUB_3cde: 2.5V minimum gate length enclosure by PSUB(enclosure by TG) >= 1.200")

L18372=drc(PSUB sepNotch<0.330)
errorLayer(L18372
    "PSUB_4: Space between two PSUB regions with same potential >= 0.330")

psub5a5b1=geomSize(pbaa 0.2)
psub5a5b2=geomSize(pbaa 0.26)
psub5a5b3=geomAndNot(psub5a5b2 psub5a5b1)
psub5a5b4=geomAndNot(geomButtOrOver(PSUB pbaa) INDMY)
psub5a5b=geomGetEdge(psub5a5b4 outside psub5a5b3)
errorLayer(psub5a5b "PSUB_5: AA enclosure by PSUB is min 0.20, max 0.26, inductor does not need to follow")

PSUB_nIN=geomAndNot(PSUB INDMY)

psub6=geomAndNot(drc(PSUB AA sep<0.08 withIntersection withSingularPoint) INDMY)
errorLayer(psub6 "PSUB_6: Space between PSUB and AA is 0.08, inductor does not need to follow.")

L13312=geomAndNot(drc(NW PSUB sep<1.00 withIntersection withSingularPoint) INDMY)
errorLayer(L13312 "PSUB_7: Space between PSUB and NW is 1.0, inductor does not need to follow")

psub9a=drc( geomAndNot(PSUB geomInside(PSUB INDMY)) gate sep <0.37 withIntersection withSingularPoint)
errorLayer(psub9a "PSUB_9:Minimum space between a PSUB outside INDMY and an unrelated Gate region is 0.37") 

errorLayer(rule_psub_note1
    "PSUB_10: PSUB inside or cross over a NW area is not allowed")

errorLayer(rule_psub_note2
    "PSUB_11: PSUB inside or cross over a DNW area is not allowed")

psub12a=geomButtOrOver(geomAvoiding(PSUB INDMY) AA)
psub12b=geomAndNot(psub12a geomButtOrOver(psub12a geomAvoiding(AA CAPBP) keep==1))
errorLayer(psub12b
    "PSUB_12: Only one AA region is allowed to exist in one PSUB region, except for the NMOS capacitor")

psub13=geomGetNonRectangle(geomAnd(geomAnd(AA GT) PSUB))
errorLayer(psub13
    "PSUB_13: Bent Poly is not allowed to exist on AA in a PSUB region")

L72231=drc(TG width<0.330)
errorLayer(L72231 "TG_1: TG minimum width >= 0.330")

L20233=drc(DG width<0.330)
errorLayer(L20233 "DG_1: DG minimum width >= 0.330")

L93825=drc(TG sepNotch<0.330 withIntersection)
errorLayer(L93825 "TG_2: Minimum space between two TG >= 0.330")

L61935=drc(DG sepNotch<0.330 withIntersection)
errorLayer(L61935 "DG_2: Minimum space between two DG >= 0.330")

tg3=drc(TG mos enc < 0.2 withIntersection withSingularPoint)
errorLayer(tg3
    "TG_3: AA with transistor minimum enclosure by TG (include AA area not under poly) >= 0.2")

dg3=drc(DG mos enc < 0.2 withIntersection withSingularPoint)
errorLayer(dg3
    "DG_3: AA with transistor minimum enclosure by DG (include AA area not under poly) >= 0.2")

L72758=drc(TG gate enc<0.250 withIntersection withSingularPoint)
errorLayer(L72758 "TG_4: Gate minimum enclosure by TG >= 0.250")

L61222=drc(DG gate enc<0.250 withIntersection withSingularPoint)
errorLayer(L61222 "DG_4: Gate minimum enclosure by DG >= 0.250")

tg05a1=geomButtOrOver(AA geomButtOrOver(GT gate))
tg05a2=geomButtOrOver(AA geomOr(DIFRES RESAA))
tg05a3=geomButtOrOver(AA geomSize(geomAvoiding(DSTR PSUB) 0.3))
tg05a4=geomButtOrOver(AA geomSize(geomButtOrOver(DSTR PSUB) 0.4))
tg05a5=geomButtOrOver(AA DMPNP)
tg05a6=geomAndNot(geomOr(geomOr(geomOr(tg05a1 tg05a2) geomOr(tg05a3 tg05a4)) tg05a5) INST)
tg05x1=geomAndNot(geomAnd(AA geomOr(geomAnd(SN NW) geomAndNot(SP NW))) VARMOS)
tg05a7=drc(TG geomAndNot(tg05a6 tg05x1) sep<0.2 withIntersection withSingularPoint)
tg05x2=geomAnd(geomStraddle(tg05a1 TG) TG) 
errorLayer(geomCat(tg05a7 tg05x2) "TG_5:Minimum space between TG and AA with device is 0.2,Prohibit overlap of TG and other voltage AA with transistor")

dg05a1=geomButtOrOver(AA GT)
dg05a2=geomButtOrOver(AA geomOr(DIFRES RESAA))
dg05a3=geomButtOrOver(AA geomSize(geomAvoiding(DSTR PSUB) 0.3))
dg05a4=geomButtOrOver(AA geomSize(geomButtOrOver(DSTR PSUB) 0.4))
dg05a5=geomButtOrOver(AA DMPNP)
dg05a6=geomAndNot(geomOr(geomOr(geomOr(dg05a1 dg05a2) geomOr(dg05a3 dg05a4)) dg05a5) INST)
dg05x1=geomAndNot(geomAnd(AA geomOr(geomAnd(SN NW) geomAndNot(SP NW))) VARMOS)
dg05a7=drc(DG geomAndNot(dg05a6 dg05x1) sep<0.2 withIntersection withSingularPoint)
dg05x2=geomAnd(geomStraddle(dg05a1 DG) DG) 
errorLayer(geomCat(dg05a7 dg05x2) "DG_5: Minimum space between DG and AA with device is 0.2,Prohibit overlap of DG and other voltage AA with transistor")

L97454=drc(TG gate sep<0.250 withIntersection withSingularPoint)
errorLayer(L97454
    "TG_6: Minimum space between TG and gate (Don't be necessary for pick-up to follow these rules) >= 0.250")

L8990=drc(DG gate sep<0.250 withIntersection withSingularPoint)
errorLayer(L8990
    "DG_6: Minimum space between DG and gate (Don't be necessary for pick-up to follow these rules) >= 0.250")

L91573=drc(TG area<0.463)
errorLayer(L91573 "TG_7: Minimum area >= 0.463")

L88165=drc(DG area<0.463)
errorLayer(L88165 "DG_7: Minimum area >= 0.463")

L30501=geomHoles(TG innermost)
L84589=geomAndNot(L30501 TG)
L16154=drc(L84589 area<0.463)
errorLayer(L16154 "TG_8: Minimum enclosed area >= 0.463")

L15125=geomHoles(DG innermost)
L36294=geomAndNot(L15125 DG)
L30122=drc(L36294 area<0.463)
errorLayer(L30122 "DG_8: Minimum enclosed area >= 0.463")


L89695=drc(geomAnd(AA TG) geomAndNot(gate geomOr(LDBK INDMY)) enc<0.170 0<withIntersection<90 withSingularPoint)
errorLayer(L89695
    "TG_11:Extension of AA in TG outside of gate is 0.17. Exclude gate within LDMOS region(within LDBK) and within inductor area(layer INDMY)")

L1935=drc(aa_mos_dg GT enc<0.170 withIntersection withSingularPoint)
errorLayer(L1935
    "DG_11: AA enclosure by DG minimum overlap past non-floating poly >= 0.170")

L62808=drc(DG TG sep<0.330 withIntersection withSingularPoint)
errorLayer(L62808 "TG_12: Space between TG and DG >= 0.330")

tg13a=geomAndNot(TG geomOr(geomGetEdge(TG coincident NW) geomGetEdge(TG butting NW)))
tg13=drc(tg13a NW enc<0.330 withIntersection)
errorLayer(tg13
    "TG_13: TG minimum overlap past NW with abutting permitted >= 0.330")

dg12a=geomAndNot(DG geomOr(geomGetEdge(DG coincident NW) geomGetEdge(DG butting NW)))
dg12=drc(dg12a NW enc<0.330 withIntersection)
errorLayer(dg12
    "DG_12: DG minimum overlap past NW with abutting permitted >= 0.330")

tg14a=geomAndNot(TG geomOr(geomGetEdge(TG coincident NW) geomGetEdge(TG butting NW)))
L31987=drc(tg14a NW ovlp<0.330 shielded)
errorLayer(L31987
    "TG_14: TG minimum overlap of NW with abutting permitted >= 0.330")

dg13a=geomAndNot(DG geomOr(geomGetEdge(DG coincident NW) geomGetEdge(DG butting NW)))
L34799=drc(dg13a NW ovlp<0.330 shielded)
errorLayer(L34799
    "DG_13: DG minimum overlap of NW with abutting permitted >= 0.330")

L402=drc(NW tg14a enc<0.330 withIntersection)
errorLayer(L402
    "TG_15: NW minimum overlap past TG with abutting permitted >= 0.330")

L74430=drc(NW dg13a enc<0.330)
errorLayer(L74430
    "DG_14: NW minimum overlap past DG with abutting permitted >= 0.330")

if( !avSwitch("CHK_CORN_RULES") then

L18214=geomGetNon90(chamfer)
L57401=geomAndNot(chamfer L18214)
L76859=geomGetLength(L57401 ignore==74)
errorLayer(L76859 "CORN_1: CORN_1")

rule_corn2=geomAndNot(chamfer geomOr(geomOr(DUMBA DUMBP) DUMBM) )
errorLayer(rule_corn2 "CORN_2:For the chips needs SMIC mask shop insert dummy and seal ring, the corner area A(see this section figure) should be covered with (DUMBA, DUMBP, DUMBM).")
);end CHK_CORN_RULES

if( !avSwitch("CHK_BORDER_RULES") then
L77452=drc(BORDER_all AAi enc<0.36 withIntersection withSingularPoint)
errorLayer(L77452
    "BORDER_2_AA: Minimum BORDR enclosure s for following AA layers and their related dummy patterns.> 0.360")

L31071=drc(BORDER_all GT enc<0.36 withIntersection withSingularPoint)
errorLayer(L31071
    "BORDER_2_GT: Minimum BORDR enclosure s for following GT layers and their related dummy patterns.> 0.360")

L43099=drc(BORDER_all CT enc<0.36 withIntersection withSingularPoint)
errorLayer(L43099
    "BORDER_2_CT: Minimum BORDR enclosure s for following CT layers and their related dummy patterns.> 0.360")

L14840=drc(BORDER_all M1 enc<0.36 withIntersection withSingularPoint)
errorLayer(L14840
    "BORDER_2_M1: Minimum BORDR enclosure s for following M1 layers and their related dummy patterns.> 0.360")

L32121=drc(BORDER_all M2 enc<0.36 withIntersection withSingularPoint)
errorLayer(L32121
    "BORDER_2_M2: Minimum BORDR enclosure s for following M2 layers and their related dummy patterns.> 0.360")

L49402=drc(BORDER_all M3 enc<0.36 withIntersection withSingularPoint)
errorLayer(L49402
    "BORDER_2_M3: Minimum BORDR enclosure s for following M3 layers and their related dummy patterns.> 0.360")

L66683=drc(BORDER_all M4 enc<0.36 withIntersection withSingularPoint)
errorLayer(L66683
    "BORDER_2_M4: Minimum BORDR enclosure s for following M4 layers and their related dummy patterns.> 0.360")

L83964=drc(BORDER_all M5 enc<0.36 withIntersection withSingularPoint)
errorLayer(L83964
    "BORDER_2_M5: Minimum BORDR enclosure s for following M5 layers and their related dummy patterns.> 0.360")

L1245=drc(BORDER_all M6 enc<0.36 withIntersection withSingularPoint)
errorLayer(L1245
    "BORDER_2_M6: Minimum BORDR enclosure s for following M6 layers and their related dummy patterns.> 0.360")

L18526=drc(BORDER_all M7 enc<0.36 withIntersection withSingularPoint)
errorLayer(L18526
    "BORDER_2_M7: Minimum BORDR enclosure s for following M7 layers and their related dummy patterns.> 0.360")

L35807=drc(BORDER_all M8 enc<0.36 withIntersection withSingularPoint)
errorLayer(L35807
    "BORDER_2_M8: Minimum BORDR enclosure s for following M8 layers and their related dummy patterns.> 0.360")

L25394=drc(BORDER_all V1 enc<0.36 withIntersection withSingularPoint)
errorLayer(L25394
    "BORDER_2_V1: Minimum BORDR enclosure s for following V1 layers and their related dummy patterns.> 0.360")

L8112=drc(BORDER_all V2 enc<0.36 withIntersection withSingularPoint)
errorLayer(L8112
    "BORDER_2_V2: Minimum BORDR enclosure s for following V2 layers and their related dummy patterns.> 0.360")

L90831=drc(BORDER_all V3 enc<0.36 withIntersection withSingularPoint)
errorLayer(L90831
    "BORDER_2_V3: Minimum BORDR enclosure s for following V3 layers and their related dummy patterns.> 0.360")

L73550=drc(BORDER_all V4 enc<0.36 withIntersection withSingularPoint)
errorLayer(L73550
    "BORDER_2_V4: Minimum BORDR enclosure s for following V4 layers and their related dummy patterns.> 0.360")

L56269=drc(BORDER_all V5 enc<0.36 withIntersection withSingularPoint)
errorLayer(L56269
    "BORDER_2_V5: Minimum BORDR enclosure s for following V5 layers and their related dummy patterns.> 0.360")

L38988=drc(BORDER_all V6 enc<0.36 withIntersection withSingularPoint)
errorLayer(L38988
    "BORDER_2_V6: Minimum BORDR enclosure s for following V6 layers and their related dummy patterns.> 0.360")

L21707=drc(BORDER_all V7 enc<0.36 withIntersection withSingularPoint)
errorLayer(L21707
    "BORDER_2_V7: Minimum BORDR enclosure s for following V7 layers and their related dummy patterns.> 0.360")

errorLayer(rule_BORDER1
    "BORDER_1: Designer need to add BORDER (CHIPEDGE) to define chip boundary and have all chip layout patterns inside BORDER")

border3=drc(BORDER_all DNW enc<0.8)
errorLayer(border3
    "BORDER_3: DNW minimum enclosure by BORDER >= 0.8")
if( !avSwitch("CHK_CORN_RULES") then
border4=geomAndNot(BORDER_all geomGetRectangle(geomOr(BORDER_all chamfer)))
errorLayer(border4 "BORDER_4:All designs should place a BORDER at the most outermost edge with straight lines from chip corner area to corner area")
);end CHK_CORN_RULES

if( avSwitch("CHK_CORN_RULES") then
border4=geomAndNot(BORDER_all geomGetRectangle(BORDER_all))
errorLayer(border4 "BORDER_4:All designs should place a BORDER at the most outermost edge with straight lines from chip corner area to corner area")
);end CHK_CORN_RULES
);end CHK_BORDER_RULES


gt1a1=geomGetEdge(GT inside geomAndNot(AA geomOr(DG TG)))
gt1a2=geomOr(geomGetEdge(gt1a1 coincident gate) geomGetEdge(gt1a1 butting gate))
L65255=drc(gt1a2 width<0.040)
errorLayer(L65255
    "GT_1a: Gate minimum length for 0.9/1.1/1.2V N/P MOS transistors (std, high, or low VT) >= 0.040")

gt1b1=geomAndNot(geomAnd(gate DG) DGV)
L12658=geomOr(geomGetEdge(GT coincident gt1b1) geomGetEdge(GT butting gt1b1))
L91508=drc(L12658 width<0.15)
errorLayer(L91508
    "GT_1b: Gate minimum length for 1.8V N/P MOS transistors >= 0.15")

gt1c1=geomAndNot(geomAnd(gate TG) TGV)
L50998=geomOr(geomGetEdge(GT coincident gt1c1) geomGetEdge(GT butting gt1c1))
L78414=drc(L50998 width<0.270)
errorLayer(L78414
    "GT_1c: Gate minimum length for 2.5V N/P MOS transistors >= 0.270")

gt1d1=geomAnd(geomAnd(ngate TG) OVERDR)
L50999=geomOr(geomGetEdge(GT coincident gt1d1) geomGetEdge(GT butting gt1d1))
L7633=drc(L50999 width<0.550)
errorLayer(L7633
    "GT_1d: Gate minimum length for 2.5V overdrive 3.3V NMOS transistors >= 0.550")

gt1e1=geomAnd(geomAnd(pgate TG) OVERDR)
L84751=geomOr(geomGetEdge(GT coincident gt1e1) geomGetEdge(GT butting gt1e1))
L38000=drc(L84751 width<0.440)
errorLayer(L38000
    "GT_1e: Gate minimum length for 2.5V overdrive 3.3V PMOS transistors >= 0.440")

gt1fg1=geomAnd(geomAnd(gate TG) TGV)
L84752=geomOr(geomGetEdge(GT coincident gt1fg1) geomGetEdge(GT butting gt1fg1))
L38000=drc(L84752 width<0.240)
errorLayer(L38000
    "GT_1fg: Gate minimum length for 2.5V underdrive 1.8V N/PMOS transistors >= 0.240")

gt1hx=geomAnd(geomAnd(gate DG) DGV)
gt1hy=geomOr(geomGetEdge(GT coincident gt1hx) geomGetEdge(GT butting gt1hx))
gt1h=drc(gt1hy width<0.125)
errorLayer(gt1h "GT_1h:Gate channel length for 1.8V underdrive 1.5V N/P MOS transistors	0.125")


L51953=drc(GT width<0.040)
errorLayer(L51953 "GT_2a: Poly minimum width >= 0.040")

ftgt=geomAvoiding(GT CTi)

if( !avSwitch("Recommended_rules_check")  then

gt2ba=geomSize(AA 2.5)
gt2bb=geomAndNot(geomAndNot(GT ftgt) gt2ba)
gt2bc=geomAndNot(gt2bb geomOr(geomGetEdge(gt2bb coincident gt2ba) geomGetEdge(gt2bb butting gt2ba)))
gt2bd=geomAndNot( drc(gt2bc width<0.06) EFUSE)
gt2be=geomAndNot(gt2bd geomWidth(GT keep>0.06))
errorLayer(gt2be
    "GT_2b_R: Non-floating poly outside of (extend AA 2.5) region minimum width >= 0.060,except EFUSE")
);end Recommended_rules_check

gt03a=drc(geomOutside(GT INST) sepNotch<0.1 withSingularPoint)
errorLayer(gt03a "GT_3:Space between two poly is 0.1")

gt3c1=geomWidth(GT keep>0.12)
gt3c2=drc(gt3c1 GT sep<0.15 opposite)
gt3y1=drc(gt3c1 GT sep<0.15 opposite edgeb)
gt3cz=geomGetLength(gt3y1 keep>0.14)
gt3c=geomWithEdge(gt3c2 gt3cz)
errorLayer(gt3c "GT_3c: GT to GT space if one GTs width > 0.12um is >=0.15, parallel run length of the two GT > 0.14um")

srgt03a=drc(geomAndNot(GT INDMY) sep<0.07 withSingularPoint withIntersection)
srgt03b=geomAndNot(srgt03a geomOutside(srgt03a INST))
errorLayer(srgt03b "SRGT_3:Space between two poly on field is 0.07")

gt07a=drc(gt_end_head sep<0.1 withIntersection opposite)
gt07=geomOutside(gt07a INST)
errorLayer(gt07
    "GT_7: (poly_end with length < 0.120 um) minimum space to (poly_end with length < 0.120 um) (head to head space) must be >= 0.100")

srgt07a=drc(gt_end_head sep<0.07 withIntersection opposite)
srgt07b=geomAvoiding(geomAndNot(srgt07a geomOutside(srgt07a INST)) ftgt)
errorLayer(srgt07b "SRGT_7:(poly_end with length < 0.120) minimum space to (poly_end with length < 0.120),excluding floating poly,(head to head space) must be > 0.07")

gt08a=geomOutside(drc(gt_end_head gt_nonend sep<0.1 withIntersection) INST)
errorLayer(gt08a "GT_8: (poly_end with length < 0.120) minimum space to poly (head to side) must be > 0.1")

gtLINE_END=geomLineEnd(GT 0.064 legs(0.04))
gtLINE_END_SHAPE=geomSize(gtLINE_END -0.034 edges)
gtLINE_SIDE_a=geomGetEdge(GT coincident gtLINE_END_SHAPE) 
gtLINE_SIDE_b=geomGetEdge(gtLINE_SIDE_a coincident gtLINE_END) 
gtLINE_SIDE=geomAndNot(gtLINE_SIDE_a gtLINE_SIDE_b edges)
gtLINE_END_EXP_a=geomStretch(gtLINE_END 0.031)
gtLINE_END_EXP=geomSize(gtLINE_END_EXP_a -0.001 edges)
gtLINE_SIDE_EXP_a=geomStretch(gtLINE_SIDE 0.031)
gtLINE_SIDE_EXP=geomSize(gtLINE_SIDE_EXP_a -0.001 edges)
gtLINE_END_1=geomGetEdge(gtLINE_END_EXP coincident gtLINE_END wholeEdge) 
gtLINE_SIDE_1=geomGetEdge(gtLINE_SIDE_EXP coincident gtLINE_SIDE wholeEdge)
gtE1=drc(gtLINE_END_1 GT sep<0.11 opposite with_perp edgea)
gtE2=drc(gtLINE_SIDE_1 GT sep<0.11 opposite with_perp edgea)
gtLINE_END_E1=geomGetEdge(gtLINE_END_1 coincident gtE1 wholeEdge) 
gtLINE_SIDE_E2=geomGetEdge(gtLINE_SIDE_1 coincident gtE2 wholeEdge) 
GT_CORNER=drc(gtLINE_END_E1 gtLINE_SIDE_E2 ovlp<=0.002 only_perp)
rule_GT_8a=geomOutside(geomButtOrOver(gtLINE_END_SHAPE GT_CORNER) INST)
errorLayer(rule_GT_8a "GT_8a:Space between GT line end to line Dh or GT line to line Ds when the layout structures meet the conditions of below:Waive the GT small extrusion F<0.04um,GT line end definitionGT width W<0.065um,Runlength of GT line to line or GT line to end: E1>=-0.03um,Any one edge distance from the corner of the two edges: K1 <0.065um,Any one of Dh or Ds meet this rule value is ok,This rule is not applicable for SRAM region check")

;srgt08a=geomAnd(GT AA)
;gt_end=drc(GT AA enc<0.12 opposite)
;gt_end_heada=geomButtOrOver(GT srgt08a)
;gt_end_headb=geomAndNot(gt_end_heada geomOr(geomGetEdge(gt_end_heada coincident srgt08a wholeEdge) geomGetEdge(gt_end_heada butting srgt08a wholeEdge)))
;gt_end_head=geomOr(geomGetEdge(gt_end coincident gt_end_headb) geomGetEdge(gt_end butting gt_end_headb))
;gt_end_head1=geomAndNot(gt_end_heada geomOr(geomGetEdge(gt_end_heada coincident srgt08a wholeEdge) geomGetEdge(gt_end_heada butting srgt08a wholeEdge)))
;gt_nonend=geomAndNot(GT geomOr(geomGetEdge(GT coincident gt_end_head1) geomGetEdge(GT butting gt_end_head1)))
;srgt08b=drc(gt_end_head gt_nonend sep <0.072 withIntersection)
;srgt08c=geomAvoiding(geomAndNot(srgt08b geomOutside(srgt08b INST)) ftgt)
;errorLayer(srgt08c "SRGT_8:(poly_end with length < 0.120) minimum space to poly (head to side) must be > 0.072,excluding floating poly")

L97598=geomGetEdge(GT coincident poly_field)

gt04a=geomOutside(drc(AA GT sep <0.03 0<withIntersection<90 withSingularPoint shielded) INST)
errorLayer(gt04a
    "GT_4: Minimum space between AA and poly on field oxide >= 0.030")

;srgt04a=drc( AA geomAndNot(GT geomOr(ftgt INDMY)) sep <0.01 withIntersection withSingularPoint)
;srgt04b=geomAndNot(srgt04a geomOutside(srgt04a INST))
;errorLayer(srgt04b "SRGT_4:Minimum space between AA and poly on field oxide, floating poly need not follow this rule is 0.01")
;skip SRGT_4

gt05a=drc(geomOutside(AA INST) geomAndNot(gate geomOr(LDBK INDMY)) enc<0.06 0<withIntersection<90 withSingularPoint shielded)
errorLayer(gt05a
    "GT_5: Minimum extension of AA outside of gate. Exclude gate within LDMOS region(within LDBK) and within inductor area(layer INDMY) >= 0.060")

rule_srgt_5=drc(AA geomAndNot(gate INDMY) enc<0.045 0<withIntersection<90 withSingularPoint shielded)
srgt05=geomAndNot(rule_srgt_5 geomOutside(rule_srgt_5 INST))
errorLayer(srgt05 "SRGT_5:Minimum extension of AA outside of gate is 0.045")

gt_head_length=geomGetLength(GT keep>0.001)
gt_head=geomSelectEdge(gt_head_length length keep>0.001 angle1(89.9<keep<90.1) angle2(89.9<keep<90.1))
gt06a=drc(gt_head geomOr(geomGetEdge(AA coincident gate) geomGetEdge(AA butting gate)) enc<0.09 withIntersection opposite)
gt06b=geomOutside(geomAndNot(geomInside(gt06a GT) INDMY) INST)
errorLayer(gt06b
    "GT_6: Minimum extension of poly outside of AA to form poly end-cap >= 0.090,Waive within LDBK area")
if( !avSwitch("Recommended_rules_check")  then
gtAA_L1a=geomGetLength(AA keep >0.001)
gtAA_L1=geomSelectEdge(gtAA_L1a length keep>0.02 angle1(keep==270) angle2(keep==90))
gtAA_La=geomOr(geomGetEdge(AA coincident gate wholeEdge) geomGetEdge(AA butting gate wholeEdge))
gtAA_L=geomAndNot(gtAA_L1 geomOr(geomGetEdge(gtAA_L1 coincident gtAA_La) geomGetEdge(gtAA_L1 butting gtAA_La)))
gt_Sa=geomGetLength(geomOr(AA GT) keep>0.001)
gt_S1=geomSelectEdge(gt_Sa length keep<0.1 angle1(keep==270) angle2(keep==270))
gt_S=geomOr(geomGetEdge(gt_S1 coincident AA) geomGetEdge(gt_S1 butting AA))
gt_SL_CORNER=geomWithEdge(geomGetCorner(AA keep==270 concave) gtAA_L)
gtS_regiona=geomStretch(gt_S 0.001)
gtS_region=geomButtOrOver(geomSize(gtS_regiona -0.001 edges) gt_SL_CORNER)
gt_err=drc(gt_head geomOr(geomGetEdge(gate coincident gtS_region wholeEdge) geomGetEdge(gate butting gtS_region wholeEdge)) enc<0.11 opposite)
gt6a_all=geomOutside(geomInside(gt_err GT) SRAM)
errorLayer(gt6a_all "GT_6a_R:Extension E of GT outside of AA to form poly end-cap is 0.11.  The GT to L shape AA(in the same MOS) space S < 0.1um,The L shape AA height h > 0.02um")
);end Recommended_rules_check

ct_in=geomAndNot(CT geomOutside(CT INST))
srgt06a1=geomOr(geomGetEdge(AA coincident gate) geomGetEdge(AA butting gate))
srgt06a=drc(geomAndNot(GT geomOr(ftgt INDMY)) srgt06a1 enc <0.055 withIntersection)
srgt06b=geomAvoiding(srgt06a RECT)
srgt06=geomAndNot(srgt06b geomOutside(srgt06b INST))
errorLayer(srgt06 "SRGT_6:Minimum extension of poly outside of AA to form poly end-cap is 0.055, floating poly need not follow this rule, area interacted with rectangle contact need not follow this rule")

gate_l=geomGetEdge(gate coincident AA)
gate_ll6=geomGetLength(gate_l keep<0.06)
gate_ll6_p=geomWithEdge(gate gate_ll6) 
gate_lm6=geomGetLength(gate_l keep>=0.06)
gate_lm6_p=geomWithEdge(gate gate_lm6)

L71991=geomGetEdge(gate inside aa_mos)
L71992=geomGetEdge(aa_mos inside gate)
GT_all=geomOr(GT GTDUM) 
act=geomOr(nact pact)
gt09a=geomGetEdge(geomOutside(gate INST) inside act)
gt09b=drc(gt09a width<0.06)
gt09c=drc(gt09b GT_all sep<0.12 withIntersection opposite)
gt09d1=geomSize(gt09a 0.331 edges)
gt09d2=geomAndNot(gt09d1 gate)
gt09d3=drc(gt09b GT_all sep<=0.33 withIntersection opposite)
gt09d4=geomOr(geomButtOrOver(geomAvoiding(gt09d2 gt09d3) gt09b) gt09c)
gt09=geomOutside(gt09d4 INST)
errorLayer(gt09 "GT_9:For GT channel length < 0.06, range of gate space to (GT or GTDUM),GT_9 not applicable for SRAM area.")

;srgt9_a=drc(ngate sep<0.116 opposite)
;srgt9b=geomAnd(srgt9_a AA) 
;srgt9=geomAndNot(srgt9b geomOutside(srgt9b INST))
;errorLayer(srgt9 "SRGT_9:NFET gate minimum space over AA is 0.116")

gt10a=geomGetLength(geomGetEdge(act inside geomOutside(GT INST)) keep>= 0.06)
gt10b=geomWithEdge(gate gt10a)
gt10=drc(gt10b GT_all sep<0.13 withIntersection opposite)
errorLayer(gt10 "GT_10: For GT channel length >= 0.06, minimum gate space to (GT or GTDUM)>= 0.130")

srgt10a=geomGetLength(geomGetEdge(act inside geomAndNot(GT geomOutside(GT INST))) keep>=0.06)
srgt10b=geomWithEdge(gate srgt10a)
srgt10=drc(srgt10b geomOr(GT GTDUM) sep<0.12 withIntersection opposite)
errorLayer(srgt10 "SRGT_10:For GT channel length >= 0.06, minimum gate space to (GT or GTDUM) is 0.12")

;errorLayer(rule_GT13
;    "GT_13: poly minimum overlap past AA when poly to AA inner vertex distance < 0.060 um >= 0.090")

L59835=drc(GT area<0.012)
errorLayer(L59835 "GT_17: Poly minimum area >= 0.012")

L18411=geomHoles(GT innermost)
L48787=geomAndNot(L18411 GT)
L35901=drc(L48787 area<0.040)
errorLayer(L35901 "GT_18: Poly minimum enclosed area >= 0.040")

gt19a=geomEncloseRect(gate 200 200)
L31875=drc(gt19a area>50000)
errorLayer(L31875
    "GT_19: (GT AND AA) area GTAA. GTAA enclose 200x200um area.Maximum area for GTAA (um^2) <=50000")

errorLayer(rule_GT21
    "GT_21: No bent Gate (45 or 135 degree) on AA are allowed. All gate patterns on AA have to be orthogonal to AA edge")

gt22a=geomAvoiding(geomAndNot(GT ftgt) geomAnd(HRP GT))
gt22b=geomAvoiding(gt22a geomOr(MOMDMY GTFUSE))
gt22c=geomOr(SN SP)
gt22=geomAndNot(geomAndNot(gt22b gt22c) OCOVL)
errorLayer(gt22
    "GT_22: GT must be enclosed by (SN or SP) except the MOM, GTFUSE and HRP resistor region (HRPDMY AND GT). Exclude floating GT")

;This rule is already covered by SP_SN_17.
;errorLayer(rule_GT23 "GT_23: SN and SP overlap on gate over AA is not allowed")

    L53646=geomGetEdge(poly_mos coincident poly_mos_corner_edge)
    L4473=drc(L23336 gt90c_e sep<0.040 parallel)
    L4474=geomOverlap(L4473 poly_mos)
    errorLayer(L4474 "GT_24: L-shape poly minimum space to AA >= 0.040")


    L41462=geomGetEdge(geomButtOrOver(aa_mos gate) coincident aa_mos_corner_edge)
    L42540=drc(aa90c_e geomButtOrOver(poly_mos gate) sep<0.030 parallel)
    L42541=geomOverlap(L42540 aa_mos)
    errorLayer(L42541
        "GT_25: L-shape AA minimum space to poly(in same transistor) >= 0.030")

tempLayer = geomGetEdge( geomAnd( GT INST) inside geomAnd( AA INST) )
horiz_gate = geomGetAngledEdge( tempLayer keep == 0  mode1)
vert_gate = geomGetAngledEdge( tempLayer keep == 90  mode1)
tbh = geomWithEdge( GT horiz_gate )
tbt = geomWithEdge( GT vert_gate )
tet = geomAnd( geomGetNonRectangle(gate) INST )
rightH = geomOverlap( INST tbh )
rightT = geomOverlap( INST tbt )
gt26h = geomOverlap(  rightH geomOr( tbt tet)  )
gt26t = geomOverlap(  rightT geomOr( tbh tet)  )
errorLayer( gt26t  "GT_26t: All memory cell transistor(transistors within INST layer), gate GT direction should be unidirectional in one chip")
errorLayer( gt26h  "GT_26h: All memory cell transistor(transistors within INST layer), gate GT direction should be unidirectional in one chip")

gt27a=geomGetAngledEdge(GT keep==45 fig)
gt27b=drc(gt27a width<0.16)
errorLayer(gt27b "GT_27:Bent 45 deg GT min width is 0.16")

gt28a=geomGetAngledEdge(GT keep==45 fig)
gt28b=drc(gt28a sepNotch<0.16 withIntersection)
errorLayer(gt28b "GT_28:The space between two bent 45 degree GTs is 0.16")

;srgt103_a=geomButtOrOver( geomAnd( geomAndNot(GT ftgt) AA) INST)
;srgt103_b=geomSize(srgt103_a 0.001)
;srgt103_c=geomAnd(srgt103_b geomAndNot(AA GT))
;rule_srgt103=geomButtOrOver(srgt103_a srgt103_c keep<2)
;errorLayer(rule_srgt103 "SRGT_103:Poly must divide AA into 2 or more regions, area interacted with share contact need not follow this rule")


gtp=geomAnd(GT PLRES)

rule_plres1=drc(gtp width < 0.15)
errorLayer(rule_plres1 "PLRES_1:POLY Silicide resistor minimum width >= 0.15um")

rule_plres2=geomAnd(PLRES RESP1)
errorLayer(rule_plres2 "PLRES_2:PLRES can not overlap with RESP1")

poly_plres_edge=geomGetEdge(poly_plres inside PLRES)
rule_plres3=geomGetLength(poly_plres_edge keep < 0.15)
errorLayer(rule_plres3 "PLRES_3:POLY Silicide resistor minimum square number >= 1")

rule_plres4=geomGetNonRectangle(gtp)
errorLayer(rule_plres4 "PLRES_4:POLY Silicide resistor must be orthogonal")

plres05a=drc(CT gtp sep<=0.07 withIntersection opposite)
plres05b=drc(CT gtp sep==0.01 withIntersection opposite)
plres05c=geomAndNot(plres05a geomAndNot(plres05b geomEnclose(plres05b CT)))
plres05d=geomButtOrOver(CT PLRES)
plres05=geomOr(plres05c plres05d)
errorLayer(plres05 "PLRES_5:CT to PLRES space is 0.01um")

plres06a=geomButtOnly(gtp geomAndNot(PLRES gtp) keep > 1)
plres06b=geomOr(geomGetEdge(PLRES coincident GT) geomGetEdge(PLRES butting GT))
plres06c=geomSize(plres06b -0.001 edges)
plres06=geomAvoiding(PLRES geomOr(plres06a geomButtOrOver(PLRES plres06c)))
errorLayer(plres06 "PLRES_6:Extension of PLRES outside of poly minimum distance >=0um")

L51111=drc(gtp SN sep<0.160 withIntersection withSingularPoint)
L51112=drc(gtp SP sep<0.160 withIntersection withSingularPoint)
L51113=drc(gtp ESD1 sep<0.160 withIntersection withSingularPoint)
errorLayer(geomCat(L51111 L51112 L51113)
    "PLRES_7: The minimum separation between resistors with un-related implant region >= 0.160")

SNSP=geomOr(SN SP)

plres8a1=geomAndNot(gtp geomInside(gtp SP)) 
plres08a=geomAndNot(plres8a1 geomInside(plres8a1 SN))
plres08b=drc(SN gtp enc<0.18 withIntersection withSingularPoint)
plres08c=drc(SP gtp enc<0.18 withIntersection withSingularPoint)
plres08=geomCat(plres08a plres08b plres08c)
errorLayer(plres08 "PLRES_8: For POLY Silicide resistor, make sure the POLY be implanted by either SN or SP. Minimum enclosure by SN or SP >= 0.18um")

rule_plres9=drc( PLRES AA sep<0.16 withIntersection withSingularPoint)
errorLayer(rule_plres9 "PLRES_9:Minimum Space PLRES to non-related AA >=0.16um")

rule_plres10=drc( PLRES GT sep<0.24 withIntersection withSingularPoint)
errorLayer(rule_plres10 "PLRES_10:Minimum Space PLRES to non-related Poly >=0.24um")

;rule_plresnote=geomGetNonRectangle(plres_pin)
;errorLayer(rule_plresnote
 ;   "PLRES.note: Dog-bone design at the end of POLY resistor for contact pick-up is not suggested")

gtr=geomAnd(GT RESP1)

L46826=geomGetEdge(gtr inside SAB)
L66000=drc(L46826 width<0.4)
errorLayer(L66000 "RESP1_2: POLY resistor minimum width >= 0.4")

L43752=geomOr(geomGetEdge(SAB coincident gtr) geomGetEdge(SAB butting gtr))
L78285=drc(L43752 width<0.400)
errorLayer(L78285 "RESP1_3: POLY resistor minimum length >= 0.400")

L74084=geomGetNon90(  geomButtOrOver( GT RESP1) )
errorLayer(L74084 "RESP1_4: POLY resistor must be orthogonal")

resp15= drc( geomAnd(CT geomButtOrOver(GT gtr)) SAB  sep< 0.2 withIntersection withSingularPoint)
errorLayer( resp15 "RESP1_5: CT to SAB minimum space > 0.2")

L25432=drc(RESP1 geomButtOrOver(GT gtr) enc<0.200 withIntersection withSingularPoint)
errorLayer(L25432
    "RESP1_6: Extension of RESP1 outside of POLY minimum distance >= 0.200")

;L48290=drc(poly_res sep<0.160 diffNet)
resp1_7a=drc(gtr SN sep<0.16 withIntersection withSingularPoint)
resp1_7b=drc(gtr SP sep<0.16 withIntersection withSingularPoint)
resp1_7c=drc(gtr ESD1 sep<0.16 withIntersection withSingularPoint)
rule_resp1_7=geomCat(resp1_7a resp1_7b resp1_7c)
errorLayer(rule_resp1_7
    "RESP1_7: The minimum separation between resistors with un-related implant region >= 0.160")

;errorLayer(rule_RESP18
;"RESP1_8: Dog-bone design at the end of POLY resistor for contact pick-up is not suggested")

resp19a1=geomAndNot(gtr SAB)
resp19a2=geomAndNot(gtr geomInside(gtr SP))
resp19a3=geomAndNot(resp19a2 geomInside(resp19a2 SN))
errorLayer(resp19a3
    "RESP1_9: For POLY resistor, make sure the POLY is covered by SAB and implanted by either SN or SP. No LDD should be implanted into to POLY resistor.")


L17599=drc(geomButtOrOver(GT gtr) SAB enc<0.400 withIntersection withSingularPoint)
errorLayer(L17599 "RESP1_11: extension Poly to SAB >= 0.400")

L6138=drc(AA RESP1 sep<0.160 withIntersection withSingularPoint)
errorLayer(L6138 "RESP1_12: Minimum Space RESP1 to non-related AA >= 0.160")

L19574=drc(GT RESP1 sep<0.240 withIntersection withSingularPoint)
errorLayer(L19574 "RESP1_13: Minimum Space RESP1 to non-related Poly >= 0.240")

;errorLayer(rule_RESP114
;    "RESP1_14: Check existence of N type non-silicide resistor for mask Boolean information with following Boolean: N_poly_resistor = ((RESP1 AND SN) AND SAB ) AND GT")
resp15x=geomGetEdge(RESP1 inside GT)
resp15y=geomGetEdge(SAB inside GT)
resp15a=geomAndNot(resp15x geomOr(geomGetEdge(resp15x coincident resp15y) geomGetEdge(resp15x butting resp15y)))
resp15b=geomEnclose(RESP1 GT)
errorLayer(geomOr(resp15a resp15b) "RESP1_15:RESP1 and SAB on GT should have coincident edge")

L97710=drc(LVT width<0.180 parallel)
errorLayer(L97710
    "LVT_1: LVT minimum width (parallel side to side width) >= 0.180")

lvt_s=drc(LVT sepNotch<0.18 opposite)
errorLayer(lvt_s
    "LVT_2: Space between two LVT. (with run length > 0 ) >= 0.180")

L53456=geomAndNot(nact ntap)

lvt4a=geomButtOrOver(gate LVT)
lvt4b=geomGetEdge(lvt4a inside act)
L36936=drc(LVT lvt4b enc<0.140 withIntersection opposite)
errorLayer(L36936
    "LVT_4: LVT minimum extension outside of gate for MOS along source drain direction >= 0.140")

gateEdgeL = drc( AA geomAnd(GT AA) enc == 0 edgeb opposite )
lvt_4a=drc(LVT gateEdgeL enc<0.08)
errorLayer(lvt_4a
    "LVT_4a: LVT extension outside of gate along poly direction >= 0.08")

lvt5a=geomGetEdge(gate inside act)
lvt5b=drc(LVT lvt5a sep<0.14 withIntersection opposite)
errorLayer(lvt5b "LVT_5:Minimum space between LVT and gate for MOS along source drain direction is 0.14")

lvt5a1=geomGetEdge(gate coincident act wholeEdge) geomGetEdge(gate butting act wholeEdge)
lvt5a2=drc(LVT lvt5a1 sep<0.08 withIntersection)
errorLayer(lvt5a2 "LVT_5a:Minimum Space between LVT and gate along poly direction is 0.08")

aasabr=geomButtOrOver(aar SAB)
gtsabr=geomButtOrOver(gtr SAB)

lvt6a=drc(LVT gtsabr sep<0.18 withIntersection withSingularPoint)
lvt6b=drc(LVT aasabr sep<0.18 withIntersection withSingularPoint)
errorLayer(geomCat(lvt6a lvt6b) "LVT_6:Minimum space between LVT to poly and AA SAB resistor is 0.18")

L490=drc(HVT width<0.180 parallel)
errorLayer(L490
    "HVT_1: HVT minimum width (parallel side to side width) >= 0.180")

hvt_s=drc(HVT sep<0.18 opposite)
errorLayer(hvt_s
    "HVT_2: Space between two HVT. (with run length > 0 ) >= 0.180")

hvt4a=geomButtOrOver(gate HVT)
hvt4b=geomGetEdge(hvt4a inside act)
hvt4c=drc(HVT hvt4b enc<0.14 withIntersection opposite)
errorLayer(hvt4c
    "HVT_4: HVT minimum extension outside of gate for MOS along source drain direction >= 0.140")

hvt_4a=drc(HVT gateEdgeL enc<0.08)
errorLayer(hvt_4a
    "HVT_4a: HVT extension outside of gate along poly direction >= 0.08")

hvt5a=geomGetEdge(gate inside act)
hvt5b=drc(HVT hvt5a sep<0.14 withIntersection opposite)
errorLayer(hvt5b "HVT_5:Minimum space between HVT and gate for MOS along source drain direction is 0.14")

hvt5a1=geomOr(geomGetEdge(gate coincident act wholeEdge) geomGetEdge(gate butting act wholeEdge))
hvt5a2=drc(HVT hvt5a1 sep<0.08 withIntersection)
errorLayer(hvt5a2 "HVT_5a:Minimum Space between HVT and gate along poly direction is 0.08")

hvt6a=drc(HVT gtsabr sep<0.18 withIntersection withSingularPoint)
hvt6b=drc(HVT aasabr sep<0.18 withIntersection withSingularPoint)
errorLayer(geomCat(hvt6a hvt6b) "HVT_6:Minimum space between HVT to poly and AA SAB resistor is 0.18")

L92763=drc(LVT area<0.19)
errorLayer(L92763 "LVT_9: LVT minimum area (um2) >= 0.19")

L34593=drc(HVT area<0.19)
errorLayer(L34593 "HVT_9: HVT minimum area (um2) >= 0.19")

lvt_hole=geomAndNot(geomHoles(LVT innermostEmpty) LVT)
lvt_earea=drc(lvt_hole area<0.19)
errorLayer(lvt_earea "LVT_10: LVT enclosed area >=0.19")

hvt_hole=geomAndNot(geomHoles(HVT innermostEmpty) HVT)
hvt_earea=drc(hvt_hole area<0.19)
errorLayer(hvt_earea "HVT_10: HVT enclosed area >=0.19")

L20307=geomAnd(LVT AA)
lvt13a=geomOr(geomOr(NLL PLL) HVT)
L98842=geomAnd(L20307 lvt13a)
errorLayer(L98842
    "LVT_13: (LVT over AA) over ( NLL, PLL, HVT) is prohibited")

hvt13a=geomAnd(geomAnd(HVT AA) geomOr(TG DG))
hvt13b=geomAnd(geomAnd(HVT AA) geomOr(geomOr(NLL PLL) LVT))
errorLayer(hvt13b
    "HVT_13: (HVT overlap AA) overlap TG or DG or NLL or PLL or LVT is prohibited")


SP_ni=geomOutside(SP INST)
L80711=drc(SP width<0.180 opposite)
errorLayer(L80711
    "SP_1: SP minimum width (with run length > 0) is 0.18")

;srsp1a=drc(SP width<0.135)
;srsp1b=geomAndNot(srsp1a geomOutside(srsp1a INST))
;errorLayer(srsp1b "SRSP_1:SP minimum width is 0.135")

L21243=drc(SP sepNotch<0.180 opposite)
errorLayer(L21243
    "SP_2: Minimum space between two SP (with run length>0) >= 0.180")

;srsp2a=drc(SP sepNotch<0.135)
;srsp2b=geomAndNot(srsp2a geomOutside(srsp2a INST))
;errorLayer(srsp2a "SRSP_2:Minimum space between two SP is 0.135")

SN_ni=geomOutside(SN INST)
L48251=drc(SN width<0.180 opposite)
errorLayer(L48251
    "SN_1: SN minimum width (parallel side to side width,The INST connected area apply SRAM design rule) >= 0.180")

;srsn1a=drc(SN width<0.135 )
;srsn1b=geomAndNot(srsn1a geomOutside(srsn1a INST))
;errorLayer(srsn1b "SRSN_1:NP min width is 0.135")

sn02=drc(SN sepNotch<0.180 opposite withIntersection)
errorLayer(sn02
    "SN_2: Minimum space between two SN (with run length>0) >= 0.180")

;srsn2a=drc(SN sepNotch<0.135)
;srsn2b=geomAndNot(srsn2a geomOutside(srsn2a INST))
;errorLayer(srsn2b "SRSN_2:Minimum space between two SN is 0.135")

L87615=geomGetEdge(SP_ni outside SN)
sp3a1=geomAndNot(geomOutside(nact INST) geomOr(ntap aar))
sp3a2=geomAndNot(sp3a1 geomOr(geomGetEdge(sp3a1 coincident SP wholeEdge) geomGetEdge(sp3a1 butting SP wholeEdge)))
L685=drc(SP sp3a2 sep<0.080 opposite)
L38115=geomWithEdge(L685 geomGetLength(L685 keep>.1))
errorLayer(L38115
    "SP_3a: Minimum space between SP and N+AA inside PW, except AA resistor.(run length>0.1um) >= 0.080")

sp3b1=geomAndNot(geomOutside(nact INST) geomOr(ntap aar))
sp3b2=geomAndNot(sp3a1 geomOr(geomGetEdge(sp3a1 coincident SP wholeEdge) geomGetEdge(sp3a1 butting SP wholeEdge)))
L16374=drc(SP sp3b2 sep<0.050 opposite)
L86585=geomWithEdge(L16374 geomGetLength(L16374 keep<=.1))
errorLayer(L86585
    "SP_3b: Minimum space between SP and N+AA inside PW, except AA resistor.(run length<=0.1um) >= 0.050")

srsp3a1=geomAnd(geomAndNot(nact geomOutside(nact INST)) PW)
srsp3a2=drc(SP srsp3a1 sep<0.041 0<withIntersection<90 opposite)
srsp3a3=geomWithEdge(srsp3a2 geomGetLength(srsp3a2 keep>0.1))
srsp3a4=geomAndNot(srsp3a3 geomOutside(srsp3a3 INST))
errorLayer(srsp3a4 "SRSP_3a:Minimum space between SP and N+ AA inside PW, except AA resistor is 0.04,run length > 0.1um")

srsp3b1=geomAnd(geomAndNot(nact geomOutside(nact INST)) PW)
srsp3b2=drc(SP srsp3b1 sep<0.037 0<withIntersection<90 opposite)
srsp3bb2=geomOr(geomGetEdge(srsp3b2 coincident SP) geomGetEdge(srsp3b2 butting SP))
srsp3b3=geomWithEdge(srsp3b2 geomGetLength(srsp3bb2 keep<=0.1))
srsp3b4=geomAndNot(srsp3b3 geomOutside(srsp3b3 INST))
errorLayer(srsp3b4 "SRSP_3b:Minimum space between SP and N+ AA inside PW, except AA resistor is 0.037,run length <= 0.1um")


sp04a=geomAndNot(ntap geomOr(geomGetEdge(ntap butting pact wholeEdge) geomGetEdge(ntap coincident pact wholeEdge)))
L13212=drc(SP sp04a sep<0.020)
errorLayer(L13212 "SP_4: Minimum space between SP and N+ pick-up AA >= 0.020")

;skip SP.5: Space between a SP and a butted N+ AA is 0

L18461=geomGetEdge(SN outside SP)

sn3a1=geomAndNot(geomAnd(pact NW) aar)
sn3_a=geomOr(geomGetEdge(sn3a1 coincident SN wholeEdge) geomGetEdge(sn3a1 butting SN wholeEdge))
sn3_b=geomAndNot(sn3a1 sn3_a)
L60290=drc(SN sn3_b sep<0.080 0<withIntersection<90 opposite) 
L28066=geomWithEdge(L60290 geomGetLength(L60290 keep>.1)) 
errorLayer(geomOutside(L28066 INST)
    "SN_3a: Minimum space between SN and P+AA inside NW, except AA resistor(run length>0.1um) >= 0.080")

sn3b1=geomAndNot(geomAnd(pact NW) aar)
sn3_b2=geomOr(geomGetEdge(sn3b1 coincident SN wholeEdge) geomGetEdge(sn3b1 butting SN wholeEdge))
sn3_b3=geomAndNot(sn3b1 sn3_b2)
L10053=drc(SN sn3_b3 sep<0.050 0<withIntersection<90 opposite) 
L92811=geomWithEdge(L10053 geomGetLength(L10053 keep<=.1))
errorLayer(geomOutside(L92811 INST)
    "SN_3b: Minimum space between SN and P+AA inside NW, except AA resistor(run length<=0.1um) >= 0.050")

pact_in=geomAndNot(pact geomOutside(pact INST))
srsn3a1=geomAnd(pact_in NW)
srsn3_a=geomOr(geomGetEdge(srsn3a1 coincident SN wholeEdge) geomGetEdge(srsn3a1 butting SN wholeEdge))
srsn3_b=geomAndNot(srsn3a1 srsn3_a edges)
srsn3_c=drc(SN srsn3_b sep<0.043 0<withIntersection<90 opposite)
srsn3a2=geomWithEdge(srsn3_c geomGetLength(srsn3_c keep>.1)) 
errorLayer(srsn3a2 "SRSN_3a:Minimum space between SN and P+ AA inside NW is 0.043, except AA resistor. (run length > 0.1um)")

pact_in=geomAndNot(pact geomOutside(pact INST))
srsn3b1=geomAnd(pact_in NW)
srsn3b2=geomOr(geomGetEdge(srsn3b1 coincident SN wholeEdge) geomGetEdge(srsn3b1 butting SN wholeEdge))
srsn3b3=geomAndNot(srsn3b1 srsn3b2 edges)
srsn3b4=drc(SN srsn3b3 sep<0.038 0<withIntersection<90 opposite)
srsn3b5=geomOr(geomGetEdge(srsn3b4 coincident SN) geomGetEdge(srsn3b4 butting SN))
srsn3b6=geomWithEdge(srsn3b4 geomGetLength(srsn3b5 keep<=.1)) 
errorLayer(srsn3b6 "SRSN_3b:Minimum space between SN and P+ AA inside NW is 0.038, except AA resistor. (run length <= 0.1um)")

sn04a=geomOutside(ptap INST)
sn04b=geomAndNot(sn04a geomOr(geomGetEdge(sn04a coincident nact wholeEdge) geomGetEdge(sn04a butting nact wholeEdge)))
L12429=drc(SN sn04b sep<0.020)
errorLayer(L12429 "SN_4: Minimum space between SN and P+ pick-up AA >= 0.020")

;SRSN.4 skipped
;SN.5 skipped
sp06a=geomOr(geomGetEdge(GT coincident gate) geomGetEdge(GT butting gate))
L67640=drc(SP sp06a enc<0.160 withIntersection opposite)
errorLayer(L67640
    "SP_6: SP minimum extension outside of Poly gate for PMOS along source drain direction >= 0.160")

sd=geomButtOrOver( geomAndNot( geomButtOrOver(AA GT) GT) CT)
gt_in=geomAndNot(GT geomOutside(GT INST))
;srsp6_a=geomGetEdge( geomAndNot(gt_in ftgt) inside pact)
;rule_srsp6=drc(SP srsp6_a enc<0.18 opposite)
;errorLayer(rule_srsp6 "SRSP_6:SP minimum extension outside of Poly gate for PMOS along source drain direction, excluding floating poly is 0.18")

;L42549=geomGetEdge(ngate inside aa_mos )
sn06a=geomOr(geomGetEdge(gate coincident GT) geomGetEdge(gate butting GT))
L66468=drc(SN sn06a enc<0.160 opposite)
errorLayer(L66468
    "SN_6: SN minimum extension outside of Poly gate for NMOS along source drain direction >= 0.160")

;srsn6_a=geomGetEdge(geomAndNot(gt_in ftgt) inside nact)
;srsn6_b=drc(srsn6_a SN enc<0.18 opposite)
;rule_srsn6=geomButtOrOver(srsn6_b sd)
;errorLayer(rule_srsn6 "SRSN_6:SN minimum extension outside of Poly gate for NMOS along source drain direction, excluding floating poly is 0.18")

sp07a=geomOr(geomGetEdge(GT coincident gate) geomGetEdge(GT butting gate))
L13126=drc(SP sp07a sep<0.160 opposite)
errorLayer(L13126
    "SP_7a: Minimum space between SP and S/D direction N-channel poly gate >= 0.160")

L68748=geomOutside(drc(SP ngate  sep<0.080 withIntersection withSingularPoint) SRAM)
errorLayer(L68748
    "SP_7b: Minimum space between SP and non-S/D direction N-channel poly gate >= 0.080")

sp7c1=drc(geomButtOnly(nact psd) pgate sep<0.23 withIntersection withSingularPoint)
errorLayer(sp7c1 "SP_7c:SN AND AA space to PMOS gate on the same AA is >=0.23")

;srsp7_a=geomGetEdge(geomAndNot(gt_in ftgt) inside nact)
;srsp7_b=drc(SP srsp7_a sep<0.18 opposite)
;rule_srsp7=geomButtOrOver(srsp7_b sd)
;errorLayer(rule_srsp7 "SRSP_7a:Minimum space between SP and S/D direction N-channel poly gate, excluding floating poly is 0.18")

;srsp7b_a=drc(SP ngate sep<0.038 opposite)
;srsp7b_b=drc(SP ngate sep<0.037 cornerToCorner)
;srsp7b_c=geomOr(srsp7b_a srsp7b_b)
;rule_srsp7b=geomButtOrOver(srsp7b_c INST)
;errorLayer(rule_srsp7b "SRSP_7b:Minimum space between SP and non-S/D direction N-channel poly gate is 0.038Minimum space between SP outer vertex and non-S/D direction N-channel poly gate outer vertex is 0.037")

srsn7_a=geomGetEdge(geomAndNot(gt_in ftgt) inside pact)
rule_srsn7=drc(srsn7_a SN sep<0.18 opposite)
errorLayer(rule_srsn7 "SRSN_7:Minimum space between SN and S/D direction P-channel poly gate, excluding floating poly is 0.18")

sn07a=geomOr(geomGetEdge(GT coincident pgate) geomGetEdge(GT butting pgate))
sn07a1=drc(SN sn07a sep<0.160 opposite)
errorLayer(sn07a1
    "SN_7a: Minimum space between SP and S/D direction N-channel poly gate >= 0.160")

sn07b1=drc(SN pgate sep<0.08 withIntersection opposite)
sn07b2=geomOutside(sn07b1 INST)
errorLayer(sn07b2 "SN_7b:Minimum space between SN and Non-S/D driection P-channel poly gate is 0.08")

sn07c1=drc(geomButtOnly(pact nsd) ngate sep<0.23 withIntersection withSingularPoint)
errorLayer(sn07c1 "SN_7c:(SP AND AA) space to NMOS gate on the same AA	is >=0.23")

;L49136=geomGetEdge(SP coincident rule_sp8a8b_sp)
;L33546=geomGetEdge(poly_mos inside rule_spsn_8a8b_h)
;L14406=drc(L49136 L33546 sep<0.160 opposite)
;errorLayer(L14406
   ; "SP_8a: Minimum space between SP on a butted AA and poly gate edge in case the extending of butted P+ AA is less than 0.16um (h<0.16) in PW >= 0.160")

;L89059=geomGetEdge(poly_mos outside rule_spsn_8a8b_h)
;L61153=drc(L49136 L89059 sep<0.080 opposite)
;errorLayer(L61153
   ; "SP_8b: Minimum space between a SP on a butted AA and poly gate edge in case the extending of butted P+ AA is larger than 0.16um (h>0.16) in PW >= 0.080")

sp8c1=geomGetEdge(pact coincident pgate wholeEdge)
sp8c2=geomSize(geomStretch(sp8c1 0.01) 0.1 edges)
sp8c3=geomAndNot(pact ptap)
sp8c4=geomOr(geomGetEdge(nact coincident sp8c3) geomGetEdge(nact butting sp8c3))
sp8c5=geomGetEdge(sp8c4 inside sp8c2)
sp8c6=geomWithEdge(geomButtOrOver(nact NW) sp8c5)
sp8c7=geomGetEdge(GT inside geomButtOnly(pact nact))
sp8c8=geomWithEdge(GT sp8c7)
sp8c9=geomOr(geomGetEdge(sp8c8 coincident pgate wholeEdge) geomGetEdge(sp8c8 butting pgate wholeEdge))
sp8c=drc(sp8c6 sp8c9 sep<0.23 withIntersection)
errorLayer(sp8c "SP_8c:(SN AND AA) in L shape space to PMOS gate on the same AA is >=0.23 (0 < h < 0.1um)")

sn8c1=geomGetEdge(nact coincident ngate wholeEdge)
sn8c2=geomSize(geomStretch(sn8c1 0.01) 0.1 edges)
sn8c3=geomAndNot(nact ntap)
sn8c4=geomOr(geomGetEdge(pact coincident sn8c3) geomGetEdge(pact butting sn8c3))
sn8c5=geomGetEdge(sn8c4 inside sn8c2)
sn8c6=geomWithEdge(geomButtOrOver(pact PW) sn8c5)
sn8c7=geomGetEdge(GT inside geomButtOnly(sn8c3 pact))
sn8c8=geomWithEdge(GT sn8c7)
sn8c9=geomOr(geomGetEdge(sn8c8 coincident ngate wholeEdge) geomGetEdge(sn8c8 butting ngate wholeEdge))

sn8c10=geomGetLength(geomOr(nact geomEnclose(GT ngate)) keep>0.001)
sn8c11=geomSelectEdge(sn8c10 angle1(keep==270) angle2(keep==270))
sn8c12=geomSize(sn8c11 0.1 edges)
sn8c=drc(sn8c6 sn8c9 sep<0.23 withIntersection)
errorLayer(sn8c "SN_8c:A butted P+ pick-up AA (in L shape AA) space to NMOS poly in the same AA is >=0.23, when this butted P+ pick-up AA extrusion:0 < h < 0.1")

;L63794=geomGetEdge(SN coincident rule_sn8a8b_sn)
;L12864=drc(L63794 L33546 sep<0.160 opposite)
;errorLayer(L12864
    ;"SN_8a: Minimum space between SN on a butted AA and poly gate edge in case the extending of butted N+ AA is less than 0.16um (h<0.16) in NW >= 0.160")

;L88423=drc(L63794 L89059 sep<0.080 opposite)
;errorLayer(L88423
   ; "SN_8b: Minimum space between a SN on a butted AA and poly gate edge in case the extending of butted N+ AA is larger than 0.16um (h>0.16) in NW >= 0.080")

sp09a=drc(SP geomAnd(aar SN) sep<0.16 withIntersection withSingularPoint)
sp09b=drc(SP geomAnd(gtr SN) sep<0.16 withIntersection withSingularPoint)
sp09=geomCat(sp09a sp09b)
errorLayer(sp09 "SP_9:Space between a SP and a N+AA or N+POLY resistor SN AND RESAA AND AA OR RESP1 AND GT is 0.16")

sn09a=drc(SN geomAnd(aar SP) sep<0.16 withIntersection withSingularPoint)
sn09b=drc(SN geomAnd(gtr SP) sep<0.16 withIntersection withSingularPoint)
sn09=geomCat(sn09a sn09b)
errorLayer(sn09 "SN_9:Space between a SN and a P+AA or P+POLY resistor SP AND RESAA AND AA OR RESP1 AND GT is 0.16")

sp10a1=geomAnd(geomButtOrOver(ptap gate) VARMOS)
sp10a2=geomAndNot(pact geomAndNot(ptap sp10a1))
sp10a3=drc(SP sp10a2 enc<0.08 0<withIntersection<90 withSingularPoint)
sp10a4=geomOutside(sp10a3 INST)
errorLayer(sp10a4
    "SP_10: P+AA minimum enclosure by SP ( not include pick up AA ) >= 0.080")


srsp10a=geomAndNot(pact ptap)
srsp10b=geomAndNot(SP geomOr(geomGetEdge(SP coincident ntap) geomGetEdge(SP butting ntap)))
srsp10c=drc(srsp10b srsp10a enc<0.038 withIntersection opposite)
srsp10=geomAndNot(srsp10c geomOutside(srsp10c INST))
errorLayer(srsp10 "SRSP_10:P+AA minimum enclosure by SP is 0.038 (not include pick up AA)")

nwr=geomAnd(NW RESNW)
nwr_sn=geomButtOrOver(SN nwr)
sn10x=geomAnd(geomButtOrOver(ntap gate) VARMOS)
sn10y=geomAndNot(geomAndNot(AA geomButtOnly(AA RESNW)) geomAndNot(ntap sn10x))
sn10z=drc(SN sn10y enc<0.08 0<withIntersection<90 withSingularPoint shielded)
sn10all=geomOutside(sn10z INST)
errorLayer(sn10all
    "SN_10: N+AA minimum enclosure by SN ( not include pick up AA ) >= 0.080")

srsn10a1=geomAndNot(nact geomOutside(nact INST))
srsn10a2=geomOr(geomGetEdge(srsn10a1 coincident gate wholeEdge) geomGetEdge(srsn10a1 butting gate wholeEdge))
srsn10a3=geomAndNot(SN geomOr(geomGetEdge(SN coincident ptap) geomGetEdge(SN butting ptap)))
srsn10a4=drc(srsn10a3 srsn10a2 enc<0.037 withIntersection) 
srsn10b1=geomAndNot(geomAndNot(nact geomOutside(nact INST)) ntap)
srsn10b2=geomAndNot(SN geomOr(geomGetEdge(SN coincident ptap) geomGetEdge(SN butting ptap)))
srsn10b3=drc(srsn10b2 srsn10b1 enc<0.041 withIntersection opposite)
errorLayer(geomCat(srsn10a4 srsn10b3) "SRSN_10:N+AA minimum enclosure by SN is 0.041 (not include pick up AA),N+AA minimum enclosure by SN is 0.041 (not include pick up AA)")

sp12x0=geomAnd(geomButtOrOver(ptap gate) VARMOS)
sp12x1=geomAndNot(geomOutside(ptap INST) sp12x0)
sp12x=geomAndNot(sp12x1 geomOr(geomGetEdge(sp12x1 coincident nact) geomGetEdge(sp12x1 butting nact)))
sp12=drc(SP sp12x enc<0.02 withIntersection)
errorLayer(sp12 "SP_12: P+ pickup AA pickup minimum enclosure by SP >= 0.020")

;skip SRSP.12

sn12x0=geomAnd(geomButtOrOver(ntap gate) VARMOS)
sn12x1=geomAndNot(geomAndNot(ntap sn12x0) geomButtOrOver(AA RESNW))
sn12x=geomAndNot(sn12x1 geomOr(geomGetEdge(sn12x1 coincident pact) geomGetEdge(sn12x1 butting pact)))
sn12y=drc(SN sn12x enc<0.02 withIntersection)
errorLayer(sn12y "SN_12: N+ pickup AA pickup minimum enclosure by SN >= 0.020")

;Skip SP.13 : AA enclosure by SP along the edge of butted P+AA/N+AA is 0
;skip SN.13:AA enclosure by SN along the edge of butted P+AA/N+AA is 0

sp14a=drc(SP geomAnd(aar SP) enc<0.18 withIntersection withSingularPoint)
sp14b=drc(SP geomAnd(gtr SP) enc<0.18 withIntersection withSingularPoint)
sp14=geomCat(sp14a sp14b)
errorLayer(sp14 "SP_14: P+ AA resistor or P+ Poly resistor minimum enclosure by SP >= 0.180,The resistor here SP AND ((RESAA AND AA) OR (RESP1 AND GT))")

sn14a=drc(SN geomAnd(aar SN) enc<0.18 withIntersection withSingularPoint)
sn14b=drc(SN geomAnd(gtr SN) enc<0.18 withIntersection withSingularPoint)
sn14=geomCat(sn14a sn14b)
errorLayer(sn14 "SN_14:N+AA resistor or N+POLY resistor minimum enclosure by SN is 0.18. The resistor here: SN AND ((RESAA AND AA) OR (RESP1 AND GT))") 

;butsp   = geomButtOrCoin( SP pact )
;L89628=drc(AA butsp 0< ovlp<0.100)
sp15a=geomAndNot(AA geomOr(geomGetEdge(AA coincident SP wholeEdge) geomGetEdge(AA butting SP wholeEdge)))
sp15=drc(SP sp15a ovlp<0.1 opposite withIntersection shielded)
errorLayer(sp15 "SP_15: SP and AA minimum overlap >= 0.100")

L13014=drc(SP_ni area<0.110)
errorLayer(L13014
    "SP_16: SP minimum area (um^2) (The INST connected area apply SRAM design rule) = 0.110")

rule_srsp16a=drc(SP area<0.072)
rule_srsp16=geomAndNot(rule_srsp16a geomOutside(rule_srsp16a INST))
errorLayer(rule_srsp16 "SRSP_16:SP minimum area is 0.072")

;srsp19_a=geomAnd(pact_in NW)
;srsp19_b=geomOr(geomGetEdge(srsp19_a coincident ntap) geomGetEdge(srsp19_a butting ntap))
;srsp19_c=geomAndNot(srsp19_a srsp19_b)
;rule_srsp19=drc(srsp19_c SP sep<0.0325)
;errorLayer(rule_srsp19 "SRSP_19:Minimum enclosure of a SP beyond a P+ AA in NW is 0.0325")

L29819=geomHoles(SP innermost)
L21385=geomAndNot(L29819 SP)
L23075=drc(L21385 area<0.110)
errorLayer(L23075 "SP_18: Minimum enclosed area of SP >= 0.110")

;butsn   = geomButtOrCoin( SN nact )
;L71300=drc(AA butsn 0< ovlp<0.100)
sn15a=geomAndNot(AA geomOr(geomGetEdge(AA coincident SN wholeEdge) geomGetEdge(AA butting SN wholeEdge)))
sn15=drc(SN sn15a ovlp<0.100 opposite withIntersection shielded)
errorLayer(sn15 "SN_15: SN and AA minimum overlap >= 0.100")

L48268=drc(SN_ni area<0.110)
errorLayer(L48268
    "SN_16: SN minimum area (um^2) (The INST connected area apply SRAM design rule) = 0.110")

rule_srsn16=drc(SN area<0.0823)
srsn16=geomAndNot(rule_srsn16 geomOutside(rule_srsn16 INST))
errorLayer(srsn16 "SRSN_16:SN minimum area is 0.0823")

L29757=geomHoles(SN innermost)
L87204=geomOutside(geomAndNot(L29757 SN) INST)
L82948=drc(L87204 area<0.110)
errorLayer(L82948 "SN_18: Minimum enclosed area of SN >= 0.110")

srsn18_a=geomHoles(SN innermost)
srsn18_b=geomAndNot(srsn18_a SN)
rule_srsn18=drc(srsn18_b area<0.0728)
srsn18=geomAndNot(rule_srsn18 geomOutside(rule_srsn18 INST))
errorLayer(srsn18 "SRSN_18:SN minimum area is 0.11um")

;L44987=drc(L87615 ptap enc<0.020)
;errorLayer(L44987
    ;"SP_20: Minimum AA butted p-well contact enclosure by SP >= 0.020")

;skip SRSP.20

spx=geomAndNot(geomStraddle(SP AA) geomEnclose(SP AA))
sp_butted=geomAndNot(geomAnd(spx AA) NW)
L47884=drc(geomButtOrOver(sp_butted CT) area<0.030)
errorLayer(L47884
    "SP_20a: AA butted p-well minimum contact area (um^2) >= 0.030")

;L31920=drc(SN ntap 0<enc<0.020)
;errorLayer(L31920
   ; "SN_20: Minimum AA butted n-well contact enclosure by SN >= 0.020")

;L90450=drc(ntap_butted area<0.030)
;errorLayer(L90450
;"SN_20a: AA butted n-well minimum contact area (um^2) >= 0.030")
;SN.20a covered by SP.21a

L51596=geomAnd(SN SP)
errorLayer(L51596 "SP_SN_17: SN and SP overlap is forbidden")

L2945=geomOr(geomGetEdge(ntap butting pact) geomGetEdge(ntap coincident pact))
L31284=drc(ntap L2945 ovlp<0.080)
errorLayer(L31284
    "SP_21: N+ butted AA in NW contact extension of SP is 0.08")

snx=geomAndNot(geomStraddle(SN AA) geomEnclose(SN AA))
sn_butted=geomAnd(geomAnd(snx AA) NW)
sp_21a=drc(geomButtOrOver(sn_butted CT) area<0.030)
errorLayer(sp_21a
    "SP_21a: AA butted n-well minimum contact area (um2) >= 0.03")

L74729=drc(SN width<0.280)
L74730=geomButtOrOver(L74729 gate)
errorLayer(L74730
    "SN_22: SN minimum width, if there is gate within SN >= 0.280")

;ptap_bn=geomButtOnly(ptap nact)
;sn_21a=drc(ptap_bn area< 0.03)
;errorLayer(sn_21a
;    "SN_21a: AA butted p-well minimum contact area (um2) >= 0.03")
;SN.21a covered by SP.20a

L34529=geomOr(geomGetEdge(ptap coincident nact) geomGetEdge(ptap butting nact))
L12615=drc(ptap L34529 ovlp<0.080)
errorLayer(L12615
    "SN_21: AA butted p-well contact minimum extension of SN >= 0.080")



L79574=drc(SAB width<0.200)
errorLayer(L79574 "SAB_1: SAB minimum width >= 0.200")

L21688=drc(SAB sepNotch<0.200 withIntersection withSingularPoint)
errorLayer(L21688 "SAB_2: Minimum space between two SABs >= 0.200")

L62800=geomAndNot(drc(AA SAB enc<0.200 withIntersection withSingularPoint) OCOVL)
errorLayer(L62800
    "SAB_3: Minimum extension of related AA outside of SAB >= 0.200")

L10259=drc(AA SAB sep<0.160 withIntersection withSingularPoint)
errorLayer(L10259 "SAB_4: Minimum space between SAB and unrelated AA >= 0.160")

L19981=drc(SAB gate sep<0.240 withIntersection withSingularPoint)
errorLayer(L19981 "SAB_5: Minimum space between SAB and poly gate >= 0.240")

L10497=geomAndNot(drc(SAB AA enc<0.180 withIntersection withSingularPoint) OCOVL)
errorLayer(L10497 "SAB_8: Minimum extension of SAB outside of AA >= 0.180")

L64495=drc(SAB intergt enc<0.200)
errorLayer(L64495
    "SAB_6: Minimum extension of SAB outside of poly on field oxide >= 0.200")

sab15=drc(geomButtOrOver(GT RESP1) SAB enc<0.4 withIntersection withSingularPoint)
errorLayer(sab15
    "SAB_15: Minimum resistor poly extension to SAB is 0.4,The resistor: GT interact RESP1")

sab11a=geomAndNot(geomAvoiding(GT SAB) geomOr(AA AADUM))
L1873=drc(SAB sab11a sep<0.240 withIntersection withSingularPoint)
errorLayer(L1873
    "SAB_11: Minimum space between a SAB to unrelated poly on field oxide >= 0.240")

;SAB.12 is covered by SAB.7
;skip SAB.13 and SAB.14

L86689=geomStraddle(CT SAB)
L72681=geomStraddle(SAB CT)
L47695=geomAnd(L72681 L86689)
sab07a=geomAndNot(drc(SAB CT sep<0.2 withIntersection withSingularPoint) OCOVL)
sab07b=geomAndNot(geomAnd(CT SAB) OCOVL)
sab07=geomCat(sab07a sab07b)
errorLayer(sab07 "SAB_7: Minimum space between SAB and CT >= 0.200")

L18213=drc(SAB area<0.2)
errorLayer(L18213 "SAB_10: SAB minimum area (um^2) >= 0.200")

L37830=geomHoles(SAB innermost)
L17792=geomAndNot(L37830 SAB)
L85147=drc(L17792 area<0.370)
errorLayer(L85147 "SAB_10a: SAB minimum enclosed area (um^2) >= 0.370")

;CT - Contact DRC

rect=geomContactCheck(geomAndNot(CT geomOutside(CT INST)) width==0.06 length==0.16)

ct1a=geomContactCheck(CTi aspectRatio==1)
L18382=geomContactCheck(ct1a width==0.060 length==0.060 ignore)
errorLayer(L18382 "CT_1: Fixed CT size (square shape) == 0.060")

ct1a1=geomContactCheck(CTi aspectRatio==1)
ct1a2=geomAndNot(CT ct1a1)
ct1a3=geomAndNot(geomAndNot(ct1a2 geomInside(ct1a2 geomOr(EFUSE INST))) OCOVL)
errorLayer(ct1a3 "CT_1a:Non-square CT only allowed inside of [EFUSE, seal ring(MARKS), SRAM(INST)]")

L41607=drc(sqct sepNotch<0.080 withIntersection withSingularPoint)
errorLayer(L41607 "CT_2: Minimum space between two contacts >= 0.080,SRCT_2, Minimum space between two contacts is 0.080")

L7679=geomOutside(drc(sqct sep<0.110 diffNet) INST)
errorLayer(L7679
    "CT_2a: Minimum space between two contacts on different net >= 0.110")

srct2a1=drc(sqct sep<0.088 withIntersection diffNet)
srct2a2=geomAndNot(srct2a1 geomOutside(srct2a1 INST))
errorLayer(srct2a2 "SRCT_2a:Minimum space between two contacts on different net is 0.088")

test1=geomSize(sqct 0.09)
test2=geomSize(test1 -0.30)
ct_array2=geomSize(test2 0.21)
L51856=drc(geomOutside(ct_array2 SRAM) sepNotch<0.110 opposite )
ct3 = geomWithEdge(L51856 geomGetLength(L51856 keep >0.34))
errorLayer(ct3
    "CT_3: CT array minimum space to CT array for run length > 0.34 um >= 0.110")

ct3a1=geomAnd(geomSize(geomSize(geomOutside(CT SRAM) 0.06) -0.06) M1)
ct3a2=geomSize(ct3a1 -0.235 downUp)
ct3a3=geomButtOrOver(CT ct3a2)
ct3a=geomInside(drc(ct3a3 sepNotch<0.08 withIntersection withSingularPoint) M1)
errorLayer(ct3a
    "CT_3a: Minimum space between two contacts in CT array: contact array is larger or equal to 4x4 CT. Two contact regions whose space is within 0.12um at same M1 are considered to be in the same array >= 0.080")

;srct3=geomOverlap(ct_array2 INST)
;rule_srct3=drc(srct3 sep<0.223 opposite)
;errorLayer(rule_srct3 "SRCT_3:CT array minimum space to CT array for run length > 0.000 mCT array minimum space to CT array for run length > 0.000 is 0.223")

L85356=drc(AA geomOutside(interct INST) sep<0.040 withIntersection withSingularPoint)
errorLayer(L85356
    "CT_4: Minimum space between AA region and contact overlap poly >= 0.040")

sqct_in=geomAndNot(sqct geomOutside(sqct INST))
srct4_a=geomAnd(sqct_in GT)
rule_srct4=drc(srct4_a AA sep<0.032 withIntersection withSingularPoint)
errorLayer(rule_srct4 "SRCT_4:Minimum space between AA region and contact overlap poly is 0.032")

L42304=drc(geomOutside(act_ct INST) geomOutside(gate INST) sep<0.040 withIntersection withSingularPoint)
errorLayer(L42304
    "CT_5: 0.9/1.1/1.2V device minimum space between gate and contact overlap AA >= 0.040")

srct5_a=geomAnd(sqct AA)
srct5_b=drc(srct5_a gate sep<0.028 withIntersection withSingularPoint)
rule_srct5=geomAndNot(srct5_b geomOutside(srct5_b INST))
errorLayer(rule_srct5 "SRCT_5:Minimum space between Gate and contact overlap AA is 0.028")

L26432=drc(act_ct geomAnd(gate geomOr(DG TG)) sep<0.080 withIntersection withSingularPoint)
errorLayer(L26432
    "CT_5a: 1.8/2.5V device minimum space between gate (enclosure by TG or DG) to contact overlap AA >= 0.080")

ct7ab1=geomOutside(CT SRAM)

ct6abd1=geomAndNot(geomAndNot(geomButtOrOver(geomOutside(CT SRAM) AA) AA) EFUSE)
aaandm1=geomButtOrOver(geomAnd(geomAndNot(AA GT) M1) geomOutside(CT SRAM))
ct6abd_1a=geomOr(drc(AA geomAndNot(geomOutside(CT SRAM) tap) venc(encAll<0.01)) geomAndNot(geomOutside(CT SRAM) AA))
ct6abd_1b=geomOr(drc(AA geomAndNot(geomOutside(CT SRAM) tap) venc(enc1<0.03 enc2<0.05 enc3<0.03 enc4<0.05)) geomAndNot(geomOutside(CT SRAM) AA))
rulect6_1ar=geomWithEdge(ct7ab1 ct6abd_1a)
rulect6_1br=geomWithEdge(ct7ab1 ct6abd_1b)
bad_CT6=geomAnd(rulect6_1ar rulect6_1br)
rule_ct6a=geomAndNot(geomButtOrOver(bad_CT6 aaandm1) EFUSE)
rule_ct6abd=geomCat(ct6abd1 rule_ct6a)
errorLayer(rule_ct6abd
    "CT_6abd: At least one CT, per M1 and AA intersection containing a CT, must meet rule CT_6a or CT_6b. Minimum CT enclosure by AA >= 0.010 . Minimum CT enclosure by AA for two opposite sides when the other two opposite sides<0.01um, >=0.005um >= 0.030,Minimum CT enclosure by picku-up AA for two opposite sides when either opposite sides<0.01um, >=0.005um")


ct6acd_1a=geomOr(drc(AA geomAnd(geomOutside(CT SRAM) tap) venc(encAll<0.01)) geomAndNot(geomOutside(CT SRAM) AA))
ct6acd_1b=geomOr(drc(AA geomAnd(geomOutside(CT SRAM) tap) venc(enc1<0.02 enc2<0.05 enc3<0.02 enc4<0.05)) geomAndNot(geomOutside(CT SRAM) AA))
rulect6cd_1ar=geomWithEdge(ct7ab1 ct6acd_1a)
rulect6cd_1br=geomWithEdge(ct7ab1 ct6acd_1b)
bad_CT6cd=geomAnd(rulect6cd_1ar rulect6cd_1br)
rule_ct6acd=geomAndNot(geomButtOrOver(bad_CT6cd aaandm1) EFUSE)
errorLayer(rule_ct6acd "CT_6acd:CT enclosure by AA four sides >=0.01,CT enclosure by pick-up AA for two opposite sides when either opposite sides<0.01,>=0.005,>=0.02,CT enclosure by AA  >=0.005")

;srct6_a=geomButtOrOver(sqct_in AA)
;srct6_b=geomSize(srct6_a -0.011)
;rule_srct6=geomAndNot(srct6_b AA)
;errorLayer(rule_srct6 "SRCT_6:CT touching INST, Minimum CT enclosure by AA is -0.011")

ct7ab2=geomAndNot(geomAndNot(geomButtOrOver(ct7ab1 GT) GT) EFUSE)
ctandm1=geomButtOrOver(geomAnd(GT M1) geomOutside(CT SRAM))
rulect7_1a=geomOr(drc(GT geomOutside(CT SRAM) venc(encAll<0.01)) geomAndNot(geomOutside(CT SRAM) GT))
rulect7_1b=geomOr(drc(GT geomOutside(CT SRAM) venc(enc1<0.02 enc2<0 enc3<0.02 enc4<0)) geomAndNot(geomOutside(CT SRAM) GT))
rulect7_1ar=geomWithEdge(ct7ab1 rulect7_1a)
rulect7_1br=geomWithEdge(ct7ab1 rulect7_1b)
bad_CT7=geomAnd(rulect7_1ar rulect7_1br)
rule_ct7a=geomAndNot(geomButtOrOver(bad_CT7 ctandm1) EFUSE)
rule_ct7=geomCat(ct7ab2 rule_ct7a)
errorLayer(rule_ct7
    "CT_7ab: At least one CT, per M1 and Poly intersection containing a CT, must meet rule CT_7a or CT_7b. Minimum CT enclosure by Poly >= 0.01. Minimum CT enclosure by Poly for two opposite sides when the other two opposite sides<0.01um, >=0um. >=0.02")


;srct7_a=geomButtOrOver(sqct_in GT)
;srct7_b=geomSize(srct7_a -0.003)
;rule_srct7=geomAndNot(srct7_b GT)
;errorLayer(rule_srct7 "SRCT_7:Minimum CT enclosure by Poly is -0.003")

L48738=drc(SP act_ct enc<0.030 withIntersection withSingularPoint)
errorLayer(L48738 "CT_8: Minimum CT(on AA) enclosure by SP >= 0.030")

L95968=drc(SN act_ct enc<0.030 withIntersection withSingularPoint)
errorLayer(L95968 "CT_9: Minimum CT(on AA) enclosure by SN >= 0.030")

ct10a=geomAnd(CT gate)
ct10b=geomOr(ct10a geomAndNot(CT geomOr(geomOr(AA AADUM) GT)))
ct10c=geomAnd(ct10a geomOr(geomOr(LOGO INDMY) MOMDMY))
ct10d=geomAnd(geomAndNot(CT geomOr(AA AADUM)) INST)
ct10e=geomAndNot(geomAndNot(geomAndNot(ct10b ct10c) ct10d) geomOr(rect EFUSE))
errorLayer(ct10e "CT_10: CT overlap (gate or (STI not GT)) region is forbidden.  Waive the CT overlap gate in (LOGO, INDMY, MOMDMY). Waive the CT overlap STI for (CT straddles STI in INST). Waive rectangle CT in (INST or EFUSE) violation of this rule.")

ct11a=geomAndNot(CT geomOutside(CT AA))
L60121=geomAndNot(geomButtOrOver(ct11a SN) geomInside(CT SN))
L60183=geomAndNot(geomButtOrOver(ct11a SP) geomInside(CT SP))
ct11=geomCat(L60121 L60183)
errorLayer(ct11 "CT_11:It is not allowed that (CT not outside AA) touches or straddles on (SN or SP) edge,CT overlap AA with 0 SN/SP space is forbidden")

L79110=geomGetNon90(CT)
errorLayer(L79110 "CT_13: 45 degree rotated contacts are not allowed")

L41303=geomAndNot(geomAnd(CT SAB) OCOVL)
errorLayer(L41303 "CT_12: Non-salicided contacts are not allowed")
if( !avSwitch("Recommended_rules_check")  then
ct19r1=geomAnd(geomAnd(geomAnd(HRP HRPDMY) SAB) GT)
ct19r2=geomEnclose(geomAndNot(geomEnclose(GT ct19r1) ct19r1) CT keep==1)
ct19r3=geomAnd(geomAnd(RESP1 SAB) GT)
ct19r4=geomEnclose(geomAndNot(geomEnclose(GT ct19r3) ct19r3) CT keep==1)
ct19r5=geomAnd(geomAnd(SAB RESAA) AA)
ct19r6=geomEnclose(geomAndNot(geomEnclose(AA ct19r5) ct19r5) CT keep==1)
ct19r7=geomEnclose(geomAndNot(geomEnclose(AA aa_difres) aa_difres) CT keep==1)
ct19r8=geomEnclose(geomButtOnly(AA nwrsti) CT keep==1)
ct19r9=geomEnclose(geomHoles(geomEnclose(SAB resnwaa)) CT keep==1)
ct19r10=geomEnclose(geomAndNot(geomEnclose(GT gtp) gtp) CT keep==1)
ct19r11=geomEnclose(geomOr(nsd psd) CT keep==1)
ct19r12=geomEnclose(geomAndNot(geomEnclose(GT gate) gate) CT keep==1)
ct19r=geomOutside(geomOr(geomOr(geomOr(geomOr(geomOr(geomOr(geomOr(geomOr(ct19r2 ct19r4) ct19r6) ct19r7) ct19r8) ct19r9) ct19r10) ct19r11) ct19r12) SRAM)
errorLayer(ct19r "CT_19_R:Recommend to have redundant CT to prevent high contact resistance,On the resistor connection,Gate Source/Drain, and poly For large transistor, spread the CT necessary for current all over the S/D area,DRC highlight single CT connection")
);end Recommended_rules_check

srct102_a=drc(sqct V1i sep<0.075 diffNet)
rule_srct102=geomAndNot(srct102_a geomOutside(srct102_a INST))
errorLayer(rule_srct102 "SRCT_102:CT min space to V1 on different net is 0.075")

;srct_105_a=geomAvoiding(CT INST)
;rule_srct105=drc(sqct_in srct_105_a sep<0.1)
;errorLayer(rule_srct105 "SRCT_105:CT touching INST distance to CT no touching INST is 0.1")

rule_srrct_101_102=geomAndNot( geomAndNot(geomAndNot(CT geomOutside(CT INST)) sqct) rect)
errorLayer(rule_srrct_101_102 "SRRCT_101_102:Rectangle CT width and length is 0.06 and 0.016")

rule_srrct_103=drc(rect sep<0.074 withIntersection withSingularPoint)
errorLayer(rule_srrct_103 "SRRCT_103:Rectangle CT min space to Rectangle CT is 0.074")

;ct_ni=geomAvoiding(CT INST)
;rule_srrct_104=drc(ct_ni rect sep<0.073)
;errorLayer(rule_srrct_104 "SRRCT_104:Rectangle CT min space to CT  no touching INST is 0.073")

rule_srrct_104c=drc(rect ct_in sep<0.07 0<withIntersection<90 withSingularPoint)
errorLayer(rule_srrct_104c "SRRCT_104c:Rectangle CT min space to  CT touching INST with touching prohibited is 0.07")

srrct_end1=geomGetLength(rect keep==0.06)
srrct_end=geomOr(geomGetEdge(rect coincident srrct_end1) geomGetEdge(rect butting srrct_end1))
srrct_side=geomAndNot(rect geomOr(geomGetEdge(rect coincident srrct_end) geomGetEdge(rect butting srrct_end)))

rule_srrct_106=drc(srrct_end AA sep<0.133 opposite)
errorLayer(rule_srrct_106 "SRRCT_106:Rectangle CT end min space to AA is 0.133,with run length>0")

rule_srrct_106a=drc(srrct_side AA sep<0.069)
errorLayer(rule_srrct_106a "SRRCT_106a:Rectangle CT side min space to AA is 0.069")

rule_srrct_107=drc(srrct_end GT sep<0.037)
errorLayer(rule_srrct_107 "SRRCT_107:Rectangle CT end min space to Poly is 0.037")

rule_srrct_107a=drc(srrct_side GT sep<0.082)
errorLayer(rule_srrct_107a "SRRCT_107a:Rectangle CT side min space to Poly is 0.082")

rule_srrct_108=drc(rect M1 sep<0.057 withIntersection withSingularPoint)
errorLayer(rule_srrct_108 "SRRCT_108:Rectangle CT min space to M1 is 0.057")

L53507=drc(M1 width<0.070)
errorLayer(L53507 "M1_1: M1 minimum width >= 0.070")

m12a1=geomAndNot(M1 INDMY)
m12a2=geomAnd(M1 INDMY)
m12a3=geomWidth(m12a1 keep>4.5)
m12a4=drc(m12a2 width<4.501)
m12a5=geomAndNot(m12a2 m12a4)
m12a6=geomWidth(m12a2 keep>4.5)
m12a7=geomWidth(geomButtOrOver(m12a5 m12a6) keep>4.5)
errorLayer(m12a7 "M1_2:M1 maximum width is 4.5")

M1_in=geomAndNot(M1 geomOutside(M1 INST))

L17559=drc(M1 sepNotch<0.070 withIntersection <89.99 withSingularPoint)
m103=geomOutside(L17559 SRAM)
errorLayer(m103 "M1_3: M1 minimum space >= 0.070")

rule_srm13a=drc(geomAndNot(M1 INDMY) sep<0.064 cornerToCorner)
rule_srm13=geomAndNot(rule_srm13a geomOutside(rule_srm13a INST))
errorLayer(rule_srm13 "SRM1_3sa:M1 outer vertex to outer vertex distance is 0.064")

L48505=drc(geomOutside(M1 INST) area<0.0196)
errorLayer(L48505
    "M1_4: M1 minimum area (um^2)(For M2, The INST connected area apply SRAM design rule) >= 0.0196")

rule_srm14a=drc(M1 area<0.0168)
rule_srm14=geomAndNot(rule_srm14a geomOutside(rule_srm14a INST))
errorLayer(rule_srm14 "SRM1_4:M1 minimum area is 0.0168")

;rulesrm17_1a=drc(M1 ct_in venc( encAll<0.008 ))
srm17ab1=geomAndNot(geomAndNot(CT geomOutside(CT INST)) rect)
srm17ab2=geomAndNot(srm17ab1 geomInside(srm17ab1 M1))
rulesrm17_1b=drc(M1 srm17ab1 venc( enc1<0.012 enc2<0 enc3<0.012 enc4<0 ))
;rulesrm17_1ar=geomWithEdge(ct_in rulesrm17_1a)
rulesrm17_1br=geomWithEdge(srm17ab1 rulesrm17_1b)
bad_srm17=geomOr(srm17ab1 rulesrm17_1br)
errorLayer(rulesrm17_1br "SRM1_7ab:CT minimum within M1, not applicable to share contact is 0.08,M1 minimum overlap past CT for two opposite sides with the other two sides 0m, not applicable to share contact is 0.012")

L23092=geomHoles(M1 innermost)
L60945=geomAndNot(L23092 M1)
L97716=drc(L60945 area<0.2)
errorLayer(L97716 "M1_5: M1 minimum enclosed area (um^2) >= 0.2")

Mn_6(M1i 0.3 0.22 0.08)
errorLayer(mts "M1_6: Minimum space between two run length >= 0.3um parallel metal lines with one or both metal line width is >= 0.22um >= 0.080")

Mn_6a(M1i 0.6 0.7 0.12)
errorLayer(mts
    "M1_6a: Minimum space between two length > 0.3 parallel metal lines with both metal line width is > 0.22 is 0.08")

Mn_6b(M1i 0.6 0.22 0.7 0.14)
errorLayer(mts
    "M1_6b: Minimum space between two length > 0.6 parallel metal lines with one metal line width is > 0.22 and other metal line width is >0.7um is 0.14")

Mn_6c(M1i 1.5 1.5 0.3)
errorLayer(mts
    "M1_6c:Minimum space between two length > 1.5 parallel metal lines with one or both metal line width is >1.5um is 0.3")

m17ctm1=geomOutside(geomAndNot(sqct M1) INST)
errorLayer(m17ctm1 "M1_7: CT must be within M1")

m17bcaa1=geomButtOrOver(geomAnd(geomAndNot(AA GT) M1) geomOutside(CT INST))
m17bcaa2=drc(M1 geomOutside(CT INST) venc(enc1<0.025 enc2<0 enc3<0.025 enc4<0 ))
m17bcaa3=drc(M1 geomOutside(CT INST) venc(encAll<0.015 ))
m17bcaa4=geomWithEdge(geomOutside(CT INST) m17bcaa2)
m17bcaa5=geomWithEdge(geomOutside(CT INST) m17bcaa3)
m17bcaa6=geomButtOrOver(geomAnd(m17bcaa4  m17bcaa5) m17bcaa1)
errorLayer(m17bcaa6 "M1_7bc_AA:per (AA NOT GT) and M1 intersection containing a CT must meet rule M1_7b or M1_7c,M1 minimum overlap past CT for two opposite sides with the other two sides >=0um is 0.025,Or all 4 sides with enlcosure of 0.015 is also correct")

m17bcgt1=geomButtOrOver(geomAnd(GT M1) geomOutside(CT INST))
m17bcgt2=drc(M1 geomOutside(CT INST) venc(enc1<0.025 enc2<0 enc3<0.025 enc4<0 ))
m17bcgt3=drc(M1 geomOutside(CT INST) venc(encAll<0.015 ))
m17bcgt4=geomWithEdge(geomOutside(CT INST) m17bcgt2)
m17bcgt5=geomWithEdge(geomOutside(CT INST) m17bcgt3)
m17bcgt6=geomButtOrOver(geomAnd(m17bcgt4  m17bcgt5) m17bcgt1)
errorLayer(m17bcgt6 "M1_7bc_GT:per Poly and M1 intersection containing a CT must meet rule M1_7b or M1_7c M1 minimum overlap past CT for two opposite sides with the other two sides >=0um is 0.025 Or all 4 sides with enlcosure of 0.015 is also correct")

m17e1=geomWidth(M1 keep>0.7)
m17e2=drc(m17e1 sqct enc<0.03 opposite)
m17e3=geomButtOrOver(CT m17e2)
m17e4=drc(M1 m17e3 enc<0.03 opposite) 
errorLayer(m17e4 "M1_7e:CT minimum enclosure by M1 (M1 width > 0.7um) is 0.03um.")

L55164=drc(M2 width<0.070)
errorLayer(L55164 "M2_1: M2 minimum width >= 0.070")


;L46486=geomWidth(M2 keep>4.500)
;errorLayer(L46486 "M2_2: M2 maximum width <= 4.500")
slwide_m2 = geomButtOrOver( M2 geomSize( M2 -2.25))
slwdm2_45 = geomGetAngledEdge( slwide_m2  0 < keep < 90 )
slwdm2_90 = geomGetAngledEdge( slwide_m2  0 < ignore < 90 )
slwdm2_exp_45 = geomSize( slwdm2_45 -3.1815 edges )
slwdm2_exp_90 = geomSize( geomStretch( slwdm2_90 2.25 ) -2.25 edges )
slthin_m2_tmp = geomAndNot( slwide_m2  geomOr( slwdm2_exp_45 slwdm2_exp_90 ) )
slthin_m2 = geomSnap( slthin_m2_tmp 0.001 )
sltnm2_45 = geomGetAngledEdge( slthin_m2  0 < keep < 90 )
sltnm2_90 = geomGetAngledEdge( slthin_m2  0 < ignore < 90 )
sltnm2_exp_45_tmp = geomSize( sltnm2_45 3.1815 edges )
sltnm2_exp_45 = geomSnap( sltnm2_exp_45_tmp 0.001 )
sltnm2_exp_90 = geomSize( geomStretch( sltnm2_90 2.25 ) 2.25 edges )
sltnm2_exp = geomOr( sltnm2_exp_45 sltnm2_exp_90 )
slwdm2_pre = geomOr( sltnm2_exp slthin_m2 )
m2wide1 = geomAndNot( M2 slwdm2_exp_90 )
m2wide2 = geomWidth( m2wide1 keep>4.5 )
m2wide3 = geomSize( geomSize( M2 -2.25 ) 2.25 )
m2wide4 = geomAnd( geomOr( m2wide2 slwdm2_pre) m2wide3 )
errorLayer( m2wide4 "M2_2: M2 maximum width <= 4.500")

M2_in=geomAndNot(M2 geomOutside(M2 INST))

L40040=drc(M2 sepNotch<0.070 withIntersection withSingularPoint)
m203=geomOutside(L40040 INST)
errorLayer(m203 "M2_3: M2 minimum space >= 0.070")

rule_srm23a=drc(M2 sepNotch<0.065 withIntersection withSingularPoint)
rule_srm23=geomAndNot(rule_srm23a geomOutside(rule_srm23a INST))
errorLayer(rule_srm23 "SRM2_3:Mn minimum space is 0.065")

L7130=drc(geomOutside(M2 INST) area<0.0196)
errorLayer(L7130
    "M2_4: M2 minimum area (um^2)(For M2, The INST connected area apply SRAM design rule) >= 0.0196")

rule_srm24a=drc(M2 area<0.0192)
rule_srm24=geomAndNot(rule_srm24a geomOutside(rule_srm24a INST))
errorLayer(rule_srm24 "SRM2_4:Mn minimum area is 0.0192")

L23123=geomHoles(M2 innermost )
L84121=geomAndNot(L23123 M2)
L1664=drc(L84121 area<0.2)
errorLayer(L1664 "M2_5: M2 minimum enclosed area (um^2) >= 0.2")

Mn_6(M2i 0.3 0.22 0.1)
errorLayer(mts
    "M2_6: Minimum space between two (run length >= 0.3um) parallel metal lines with  both metal line width is >= 0.22um >= 0.100")

Mn_6a(M2i 0.6 0.7 0.12)
errorLayer(mts
    "M2_6a: Minimum space between two (run length >= 0.3um) parallel metal lines with both metal line width is >= 0.7um >= 0.175")

Mn_6b(M2i 0.6 0.22 0.7 0.14)
errorLayer(mts
    "M2_6b: Minimum space between two (run length >= 0.3um) parallel metal lines with one metal line width is > 0.22um and other metal line width is > 0.7um >= 0.140")

Mn_6c(M2i 1.5 1.5 0.3)
errorLayer(mts
    "M2_6c: Minimum space between two (run length >= 1.5um) parallel metal lines with one or both metal line width is >1.5um >= 0.300")

L96539=drc(M3 width<0.070)
errorLayer(L96539 "M3_1: M3 minimum width >= 0.070")

;L49493=geomWidth(M3 keep>4.500)
;errorLayer(L49493 "M3_2: M3 maximum width <= 4.500")
slwide_m3 = geomButtOrOver( M3 geomSize( M3 -2.25))
slwdm3_45 = geomGetAngledEdge( slwide_m3  0 < keep < 90 )
slwdm3_90 = geomGetAngledEdge( slwide_m3  0 < ignore < 90 )
slwdm3_exp_45 = geomSize( slwdm3_45 -3.1815 edges )
slwdm3_exp_90 = geomSize( geomStretch( slwdm3_90 2.25 ) -2.25 edges )
slthin_m3_tmp = geomAndNot( slwide_m3  geomOr( slwdm3_exp_45 slwdm3_exp_90 ) )
slthin_m3 = geomSnap( slthin_m3_tmp 0.001 )
sltnm3_45 = geomGetAngledEdge( slthin_m3  0 < keep < 90 )
sltnm3_90 = geomGetAngledEdge( slthin_m3  0 < ignore < 90 )
sltnm3_exp_45_tmp = geomSize( sltnm3_45 3.1815 edges )
sltnm3_exp_45 = geomSnap( sltnm3_exp_45_tmp 0.001 )
sltnm3_exp_90 = geomSize( geomStretch( sltnm3_90 2.25 ) 2.25 edges )
sltnm3_exp = geomOr( sltnm3_exp_45 sltnm3_exp_90 )
slwdm3_pre = geomOr( sltnm3_exp slthin_m3 )
m3wide1 = geomAndNot( M3 slwdm3_exp_90 )
m3wide2 = geomWidth( m3wide1 keep>4.5 )
m3wide3 = geomSize( geomSize( M3 -2.25 ) 2.25 )
m3wide4 = geomAnd( geomOr( m3wide2 slwdm3_pre) m3wide3 )
errorLayer( m3wide4 "M3_2: M3 maximum width <= 4.500")

M3_in=geomAndNot(M3 geomOutside(M3 INST))

L30343=drc(M3 sepNotch<0.070 withIntersection withSingularPoint)
errorLayer(L30343 "M3_3: M2 minimum space >= 0.070")

L65755=drc(M3 area<0.0196)
errorLayer(L65755
    "M3_4: M3 minimum area (um^2)(For M2, The INST connected area apply SRAM design rule) >= 0.0196")

L23154=geomHoles(M3 innermost)
L95126=geomAndNot(L23154 M3)
L62149=drc(L95126 area<0.2)
errorLayer(L62149 "M3_5: M3 minimum enclosed area (um^2) >= 0.2")

Mn_6(M3i 0.3 0.22 0.1)
errorLayer(mts
    "M3_6: Minimum space between two (run length > 0.3um) parallel metal lines with both metal line width is > 0.22um >= 0.100")

Mn_6a(M3i 0.6 0.7 0.12)
errorLayer(mts
    "M3_6a: Minimum space between two (run length > 0.6um) parallel metal lines with both metal line width is > 0.7um >= 0.12")

Mn_6b(M3i 0.6 0.22 0.7 0.14)
errorLayer(mts
    "M3_6b: Minimum space between two (run length >= 0.6um) parallel metal lines with one metal line width is > 0.22um and other metal line width is > 0.7um >= 0.140")

Mn_6c(M3i 1.5 1.5 0.3)
errorLayer(mts
    "M3_6c: Minimum space between two (run length >= 1.5um) parallel metal lines with one or both metal line width is >1.5um >= 0.300")


procedure( switchProc205()
L37914=drc(M4 width<0.070)
errorLayer(L37914 "M4_1: M4 minimum width >= 0.070")

;L52500=geomWidth(M4 keep>4.500)
;errorLayer(L52500 "M4_2: M4 maximum width <= 4.500")
slwide_m4 = geomButtOrOver( M4 geomSize( M4 -2.25))
slwdm4_45 = geomGetAngledEdge( slwide_m4  0 < keep < 90 )
slwdm4_90 = geomGetAngledEdge( slwide_m4  0 < ignore < 90 )
slwdm4_exp_45 = geomSize( slwdm4_45 -3.1815 edges )
slwdm4_exp_90 = geomSize( geomStretch( slwdm4_90 2.25 ) -2.25 edges )
slthin_m4_tmp = geomAndNot( slwide_m4  geomOr( slwdm4_exp_45 slwdm4_exp_90 ) )
slthin_m4 = geomSnap( slthin_m4_tmp 0.001 )
sltnm4_45 = geomGetAngledEdge( slthin_m4  0 < keep < 90 )
sltnm4_90 = geomGetAngledEdge( slthin_m4  0 < ignore < 90 )
sltnm4_exp_45_tmp = geomSize( sltnm4_45 3.1815 edges )
sltnm4_exp_45 = geomSnap( sltnm4_exp_45_tmp 0.001 )
sltnm4_exp_90 = geomSize( geomStretch( sltnm4_90 2.25 ) 2.25 edges )
sltnm4_exp = geomOr( sltnm4_exp_45 sltnm4_exp_90 )
slwdm4_pre = geomOr( sltnm4_exp slthin_m4 )
m4wide1 = geomAndNot( M4 slwdm4_exp_90 )
m4wide2 = geomWidth( m4wide1 keep>4.5 )
m4wide3 = geomSize( geomSize( M4 -2.25 ) 2.25 )
m4wide4 = geomAnd( geomOr( m4wide2 slwdm4_pre) m4wide3 )
errorLayer( m4wide4 "M4_2: M4 maximum width <= 4.500")

M4_in=geomAndNot(M4 geomOutside(M4 INST))

m403a=drc(M4 sepNotch<0.070 withIntersection withSingularPoint)
errorLayer(m403a "M4_3: M2 minimum space >= 0.070")

L42916=drc(M4 area<0.0196)
errorLayer(L42916
    "M4_4: M4 minimum area (um^2)(For M4, The INST connected area apply SRAM design rule) >= 0.0196")

L23185=geomHoles(M4 innermost)
L61165=geomAndNot(L23185 M4)
L5569=drc(L61165 area<0.2)
errorLayer(L5569 "M4_5: M4 minimum enclosed area (um^2) >= 0.2")

Mn_6(M4i 0.3 0.22 0.1)
errorLayer(mts
    "M4_6: Minimum space between two (run length >= 0.3um) parallel metal lines with one or both metal line width is >= 0.22um >= 0.100")

Mn_6a(M4i 0.6 0.7 0.12)
errorLayer(mts
    "M4_6a: Minimum space between two (run length >= 0.6um) parallel metal lines with one or both metal line width is >= 0.7um >= 0.12")

Mn_6b(M4i 0.6 0.22 0.7 0.14)
errorLayer(mts
    "M4_6b: Minimum space between two (run length >= 0.6um) parallel metal lines with one metal line width is > 0.22um and other metal line width is > 0.7um >= 0.140")

Mn_6c(M4i 1.5 1.5 0.3)
errorLayer(mts
    "M4_6c: Minimum space between two (run length >= 1.5um) parallel metal lines with one or both metal line width is >1.5um >= 0.300")

if( avSwitch("DENSITY_CHECKS") then

    processCoverage( backup measure( windowSize=110 stepSize=55
        L54222=calculate(area(m4all)/area()) ))
    errorLayer(geomAndNot(geomGetCoverage(L54222 0.10<=ignore<=0.85) MARKG)
        "M4_7_7a: M4 minimum/maximum density (%) in 110um*110um window with step size 55um 10% <= density <= 85%")
    processCoverage( backup measure( windowSize=200
        rule_den=calculate(area(m4all)/area()) ))
    errorLayer(geomAndNot(geomGetCoverage(rule_den keep>=0 gradient>0.5) MARKG)
        "M4_7b: M4 maximum density difference (%) between any two 200um adjacent window (stepped without overlapping ) <= 50%")

    processCoverage( backup measure( windowSize=840
        L6259=calculate(area(m4all)/area()) ))
    errorLayer(geomAndNot(geomGetCoverage(L6259 keep>0.70) MARKG)
        "M4_7c: M4 maximum density (%) with 840 um*840um window <= 70%")

    processCoverage( backup measure( windowSize=200 stepSize=100
        L6260=calculate(area(m4_gt2p8_m3)/area()) ))
    errorLayer(geomAndNot(geomGetCoverage(L6260 keep>0.70) MARKG)
        "M4_7d: [(M4 with width > 2.8 um) over M3] maximum density (%) with 200 um*200um <= 70%")

    processCoverage( backup measure( windowSize=200 stepSize=100
        L6261=calculate(area(m3_gt2p8_m4)/area()) ))
    errorLayer(geomAndNot(geomGetCoverage(L6261 keep>0.70) MARKG)
        "M4_7e: [M4 over [M3 with width > 2.8 um] maximum density (%) with 200 um*200um <= 70%")

     processCoverage( backup measure( 
        L6262=calculate(area(m4all)/area()) ))
    errorLayer(geomAndNot(geomGetCoverage(L6262 keep<0.20) MARKG)
        "M4_7f: Mn density over the whole chip is >=20%")

)

m48a=geomGetAngledEdge(M4 keep==45 fig)
L86876=drc(m48a width<0.17 opposite)
errorLayer(L86876 "M4_8: (M4 at 45) minimum width (run length > 0 um) >= 0.17")

L58277=drc(m48a sep<0.17 opposite)
errorLayer(L58277
    "M4_9: (M4 at 45 ) minimum space to parallel M4 (run length > 0 um) >= 0.17")

m4end1=geomGetLength(M4 keep>0.001)
m4end=geomSelectEdge(m4end1 length keep<=0.11 angle1(keep==90 length keep>=0.08) angle2(keep==90 length keep>=0.08))

m410a=geomOutside(drc(m4end M4 sep<0.07 opposite) INST)
errorLayer(m410a "M4_10a: Minimum space between an Mn line end to an Mn (the parallel run length >0um) is 0.07")

m410b1=drc(m4end M4 sep<0.07 opposite)
m410b2=geomOr(geomGetEdge(m4end coincident m410b1) geomGetEdge(m4end butting m410b1))
m410b3=drc(m410b2 V4 enc<0.05 opposite)
m410b4=drc(m410b2 V4 enc<0.03 opposite)
m410b5=geomButtOrOver(V4 m410b3)
m410b6=geomButtOrOver(V4 m410b4)
m410b7=geomAndNot(m410b5 m410b6)
m410b7=geomOutside(geomButtOnly(m410b1 geomButtOrOver(m410b3 m410b7)) INST)
errorLayer(m410b7 "M4_10b: Minimum space between an Mn line end (with Vn) to an Mn (the parallel run length >0um) is 0.07. The Mn line end extend Q from Vn, 0.03 <= Q <0.05um")

M4_LINE_END=geomLineEnd(M4 0.099 legs(0.08))
M4_X1=drc(M4_LINE_END V3 enc<0.05 opposite)
M4_X2=geomButtOrOver(V3 M4_X1)
M4_X3=geomInside(M4_X2 geomAnd(M3 M4))
M4_X8=geomOr(geomGetEdge( M4_X3 butting M4_X1 wholeEdge) geomGetEdge( M4_X3 coincident M4_X1 wholeEdge))
M4_LINE_END_SHAPE=geomSize(M4_LINE_END -0.095 edges)
M4_LINE_SIDE_a=geomOr( geomGetEdge(M4 butting M4_LINE_END_SHAPE) geomGetEdge(M4 coincident M4_LINE_END_SHAPE) edges)
M4_LINE_SIDE_b=geomOr( geomGetEdge(M4_LINE_SIDE_a butting M4_LINE_END) geomGetEdge(M4_LINE_SIDE_a coincident M4_LINE_END) edges)
M4_LINE_SIDE=geomAndNot(M4_LINE_SIDE_a M4_LINE_SIDE_b edges)
M4_LINE_SIDE1=drc(M4_LINE_SIDE M4_X3 enc<0.03 opposite)
M4_V3_EDGE_a=geomOr(M4_LINE_SIDE1 M4_X3) 
M4_V3_EDGE=geomOr( geomGetEdge(M4_V3_EDGE_a butting M4_X8 wholeEdge) geomGetEdge(M4_V3_EDGE_a coincident M4_X8 wholeEdge) edges)
M4_LINE_END_EXP_a=geomStretch(M4_V3_EDGE 0.031)
M4_LINE_END_EXP=geomSize(M4_LINE_END_EXP_a -0.001 edges)
M4_LINE_SIDE_EXP=geomSize(M4_LINE_SIDE -0.001 edges)
M4_LINE_END_1=geomOr( geomGetEdge(M4_LINE_END_EXP butting M4_V3_EDGE wholeEdge) geomGetEdge(M4_LINE_END_EXP coincident M4_V3_EDGE wholeEdge) edges)
M4_LINE_SIDE_1=geomOr( geomGetEdge(M4_LINE_SIDE_EXP butting M4_LINE_SIDE wholeEdge) geomGetEdge(M4_LINE_SIDE_EXP coincident M4_LINE_SIDE wholeEdge) edges)
M4_E1=drc(M4_LINE_END_1 M4 sep<0.12 opposite with_perp edgea)
M4_E2=drc(M4_LINE_SIDE_1 M4 sep<0.08 opposite with_perp edgea)
M4_LINE_END_E1=geomOr(geomGetEdge(M4_LINE_END_1 butting M4_E1 wholeEdge) geomGetEdge(M4_LINE_END_1 coincident M4_E1 wholeEdge) edges)
M4_LINE_SIDE_E2=geomOr(geomGetEdge(M4_LINE_SIDE_1 butting M4_E2 wholeEdge) geomGetEdge(M4_LINE_SIDE_1 coincident M4_E2 wholeEdge) edges)
M4_V42_a=geomOr( geomGetEdge(M4_X8 butting M4_LINE_END_E1 wholeEdge) geomGetEdge(M4_X8 coincident M4_LINE_END_E1 wholeEdge) edges)
M4_V42=geomWithEdge(M4_X3 M4_V42_a)
M4_X5=geomButtOrOver(V3 M4_V42)
M4_X6=geomAndNot(V3 M4_X5)
M4_X7=geomEnclose(geomEnclose( geomAnd(M3 M4) M4_X5) M4_X6)
M4_LINE_END_E1_a=geomSize(M4_LINE_END_E1 -0.001 edges)
M4_LINE_SIDE_E2_a=geomSize(M4_LINE_SIDE_E2 -0.001 edges)
M4_CORNER1=drc(M4_LINE_END_E1_a M4_LINE_SIDE_E2_a sep<=0.002 only_perp withIntersection)
M4_CORNER1_a=geomAnd(M4_LINE_END_E1_a M4_LINE_SIDE_E2_a)
M4_CORNER1_b=geomGetEdge(M4_CORNER1_a coincident M4_LINE_END_E1)
M4_CORNER1_c=geomGetEdge(M4_CORNER1_a coincident M4_LINE_SIDE_E2)
M4_CORNER1=geomWithEdge(geomWithEdge(M4_CORNER1_a M4_CORNER1_b) M4_CORNER1_c)
rule_M4_11=geomOutside(geomAvoiding(M4_CORNER1 M4_X7) INST)
errorLayer(rule_M4_11 "M4_11:Space between Vn-1,Vn-1 is enclosed by Mn[A] to neighbouring metal line Mn[B], when the layout structures meet the following conditions:Mn[A] line end definition: line width W <0.1um,Vn-1 enclosure by Mn[A] line end: E < 0.05um,The parallel run length of Mn[A] and Mn[B]:E1 >=-0.03um,Space between Mn[A] to the neighbouring parallel metal line: Ds<0.08um,Any one edge distance from the corner of the two edges of Mn[A]: K1 <0.095um,At least one Vn-1 in the Mn[A] and Mn-1 intersection meet this rule is ok,This rule is not applicable for SRAM region DRC check")

M412_LINE_END=geomLineEnd(M4 0.099 legs(0.07))
M412_LINE_END_SHAPE=geomSize(M412_LINE_END -0.064 edges)
M412_LINE_SIDE_a=geomGetEdge(M4 coincident M412_LINE_END_SHAPE)
M412_LINE_SIDE_b=geomGetEdge(M412_LINE_SIDE_a coincident M412_LINE_END)
M412_LINE_SIDE=geomAndNot(M412_LINE_SIDE_a M412_LINE_SIDE_b edges)
M412_LINE_END_EXP_a=geomStretch(M412_LINE_END 0.031)
M412_LINE_END_EXP=geomSize(M412_LINE_END_EXP_a -0.001 edges)
M412_LINE_SIDE_EXP_a=geomStretch(M412_LINE_SIDE 0.031)
M412_LINE_SIDE_EXP=geomSize(M412_LINE_SIDE_EXP_a -0.001 edges)
M412_LINE_END_1=geomGetEdge(M412_LINE_END_EXP coincident M412_LINE_END wholeEdge)
M412_LINE_SIDE_1=geomGetEdge(M412_LINE_SIDE_EXP coincident M412_LINE_SIDE wholeEdge)
M4E1=drc(M412_LINE_END_1 M4 sep<0.1 opposite with_perp edgea)
M4E2=drc(M412_LINE_SIDE_1 M4 sep<0.1 opposite with_perp edgea)
M412_LINE_END_E1=geomGetEdge(M412_LINE_END_1 coincident M4E1 wholeEdge)
M412_LINE_SIDE_E2=geomGetEdge(M412_LINE_SIDE_1 coincident M4E2 wholeEdge)
M4_CORNER=drc(M412_LINE_END_E1 M412_LINE_SIDE_E2 ovlp<=0.002 only_perp)
MOM_M4=geomButtOrOver(geomOr(geomOr(M3 M4) M5) geomButtOrOver(MnPIN geomSize(MOMDMY 0.114)))
rule_M4_12=geomAndNot(geomOutside(geomButtOrOver(M412_LINE_END_SHAPE M4_CORNER) INST) geomOr(MOM_M4 MOMDMY))
errorLayer(rule_M4_12 "M4_12:Minimum Mn to Mn space S at Mn line-end 0.1. Width W < 0.1um.The minimum space can be line end head to other Mn or line end side to other M1.  Rule check:S >= (Dh or Ds ).  E1 =0.03, K1=0.095 , Dh=Ds=0.1 in the illustration,Outside of SRAM(INST) area,Waive extrusion F < 0.07")

L85984=geomContactCheck(V3 width==0.070 length==0.070 ignore)
errorLayer(L85984 "V3_1: V3 exact length and width == 0.070")

L94836=drc(V3 sepNotch<0.070 withIntersection withSingularPoint)
errorLayer(L94836 "V3_2: V3 minimum space >= 0.070")

L63695=drc(V3i sep<0.1 diffNet opposite)
L63696=geomOutside(L63695 INST)
errorLayer(L63696
    "V3_5: minimum space in different net for run length > 0um >= 0.11")

v35a1=drc(V3i sep<0.09 diffNet )
errorLayer(v35a1
    "V3_5a: minimum space in different net for run length > 0um >= 0.11")


v33a1=geomSize(geomSize(V3 0.05) -0.05)
v33a2=geomSize(v33a1 -0.17 downUp)
v33a3=geomButtOrOver(V3 v33a2)
v33a4a=drc(v33a3 sepNotch<0.09 opposite edge)
v33a4=geomGetLength(v33a4a keep>0)
v33a5=geomWithEdge(v33a3 v33a4 keep>=2)
errorLayer(v33a5 "V3_3:Space between Vns (with run length>=0) at least two least two sides is 0.09, when array equal to or greater than 3x3,Two Via areas whose space is within 0.10um are considered to be in the same array. An array does not have both row and column greater than or equal to 3 can apply smaller spacing Vn.2 instead of Vn.3")


L52464=geomAndNot(V3 M3)
rule_V3_6a=geomCat(L52464 rule_V3_6)
errorLayer(rule_V3_6a
    "V3_6abc: At least one V3, per M3 and M4 intersection containing a V3, must meet rule V3_6a, V3_6b or V3_6c. V3 within M3 with width > 0.14um must meet rule V3_6a")

L52495=geomAndNot(V3 M4)
rule_V3_7a=geomCat(L52464 rule_V3_7)
errorLayer(rule_V3_7a
    "V3_7abc: At least one V3, per M3 and M4 intersection containing a V3, must meet rule V3_7a, V3_7b or V3_7c. V3 within M4 with width > 0.14um must meet rule V3_7a")


errorLayer(rule_V3_8
    "V3_8: At least two V3 vias must connect M3 to M4 when the M3 or M4 width is > 0.26um")

errorLayer(rule_V3_9
    "V3_9: At least three V3 vias must connect M3 to M4 when the M3 or M4 width is > 0.52um")

errorLayer(rule_V3_10
    "V3_10: At least four V3 vias must connect M3 to M4 when the M3 or M4 width is > 0.645um")

V3_square=geomGetRectangle(V3 aspectRatio==1)
v3_empty=geomOr(EMPTY geomInside(V3_square geomAnd(M3 M4)))
v3_inter_empty=geomOr(EMPTY geomAnd(M3 M4))
v3_16x1a=geomWidth(M3 keep>0.24)
v3_16x1b=geomWidth(M4 keep>0.24)
v3_16wide=geomOr(v3_16x1a v3_16x1b)
v3_empty1=geomInside(v3_empty v3_16wide)
geomConnect(
   incremental
    buttOrOver( v3_empty v3_inter_empty )
    buttOrOver( v3_empty1 v3_inter_empty )
)

v3_16x2=geomEnclose(geomAnd(M3 M4) V3_square)
v3_16x3=geomInside(V3_square v3_16x2)
v3_16x5c=drc(v3_empty1 v3_empty sep<=0.16 withIntersection sameNet)
v3_16x6c=geomEnclose(v3_16x2 v3_16x5c)
v3_16x7=geomEnclose(geomAnd(geomSize(v3_16x3 0.325) v3_16x2) V3 keep>2)
v3_16x7c=geomEnclose(v3_16x2 v3_16x7)
v3_16x=geomEnclose(geomAndNot(geomAndNot(v3_16x2 v3_16x6c) v3_16x7c) geomInside(V3_square v3_16wide))
v3_16all=geomOutside(v3_16x INST)
errorLayer(v3_16all "V3_16:At least two V3s with space <=0.16um when one of  M3 or M4 with both length and width  >0.24um")

/*
v3_17x1a=geomWidth(M3 keep>0.24)
v3_17x1b=geomWidth(M4 keep>0.24)
v3_17wide=geomOr(v3_17x1a v3_17x1b)
v3_17x2=geomEnclose(geomAnd(M3 M4) V3_square)
v3_17x3=geomInside(V3_square v3_17x2)
v3_17x5c=drc(geomButtOrOver(v3_17x3 v3_17wide) v3_17x3 sep<=0.16 withIntersection opposite)
v3_17x6c=geomEnclose(v3_17x2 v3_17x5c)
v3_17x4a=drc(v3_17x1a geomInside(v3_17x3 geomButtOrOver(M3 v3_17x1a)) sep<1.1 withIntersection opposite shielded)
v3_17x4b=drc(v3_17x1b geomInside(v3_17x3 geomButtOrOver(M4 v3_17x1b)) sep<1.1 withIntersection opposite shielded)
v3_17x7a=geomWithEdge(geomButtOrOver(v3_17x4a geomButtOrOver(M3 v3_17x1a)) geomGetLength(v3_17x1a keep>0))
v3_17x7b=geomWithEdge(geomButtOrOver(v3_17x4b geomButtOrOver(M4 v3_17x1b)) geomGetLength(v3_17x1b keep>0))
v3_17x7=geomOr(v3_17x7a v3_17x7b)
v3_17x5a=drc(geomInside(v3_17x3 geomButtOrOver(M3 v3_17x1a)) geomButtOrOver(v3_17x3 v3_17x7) sep<=0.16 withIntersection opposite)
v3_17x5b=drc(geomInside(v3_17x3 geomButtOrOver(M4 v3_17x1b)) geomButtOrOver(v3_17x3 v3_17x7) sep<=0.16 withIntersection opposite)
v3_17x5=geomOr(v3_17x5a v3_17x5b)
v3_17x6=geomEnclose(v3_17x2 v3_17x5)
v3_17x8=geomButtOnly(v3_17x7 geomAndNot(V3_square geomWithEdge(V3_square geomGetEdge(geomInside(V3_square v3_17x2) coincident v3_17wide wholeEdge))))
v3_17all1=geomAndNot(geomButtOrOver(geomInside(geomAndNot(v3_17x2 v3_17x6) geomButtOrOver(M3 v3_17x1a)) v3_17x8) v3_17x6c)
v3_17all2=geomAndNot(geomButtOrOver(geomInside(geomAndNot(v3_17x2 v3_17x6) geomButtOrOver(M4 v3_17x1b)) v3_17x8) v3_17x6c)
v3_17all=geomCat(v3_17all1 v3_17all2)
errorLayer(v3_17all "V3_17:At least two Vns with space S1<=0.14um when either wide metal of Mn or Mn+1 with both length L>0.24um and width W>0.24um, and the distance D<=1.2um away from this wide metal")
*/

v3_a=geomButtOrOver(V3_square wm3_exp)
geomConnect(
incremental
  buttOrOver(v3_a M3)
  buttOrOver(V3 M3 )
  buttOrOver(WM3 M3)
  )

WM4=geomWidth(M4 keep>0.24)
wm4_edge=geomGetLength(WM4 keep>0)
wm4_exp=geomSize(wm4_edge 1.1 edges)
wm4_l1=geomButtOnly(geomAndNot(M4 WM4) WM4)
v3_a2=geomButtOrOver(V3_square wm4_exp)
geomConnect(
incremental
  buttOrOver(v3_a2 M4)
  buttOrOver(WM4 M4)
)


wm3_ext=drc(WM3 v3_a sep<1.1 0<=withIntersection<90 opposite sameNet edgeb)
v3_b=geomWithEdge(V3_square wm3_ext)
v3bx1=geomEnclose(geomAnd(M3 M4) V3_square keep>1)
v3sing1=geomButtOrOver(geomAndNot(geomAnd(geomAnd(M3 M4) geomAnd(wm3_l1 wm3_exp)) v3bx1) v3_b keep==1)
v3singall1=geomOutside(v3sing1 INST)

wm4_ext=drc(WM4 v3_a2 sep<1.1 0<=withIntersection<90 opposite sameNet edgeb)
v3_b2=geomWithEdge(V3_square wm4_ext)
v3sing2=geomButtOrOver(geomAndNot(geomAnd(geomAnd(M3 M4) geomAnd(wm4_l1 wm4_exp)) v3bx1) v3_b2 keep==1)
v3singall2=geomOutside(v3sing2 INST)
v3_17all=geomCat(v3singall1 v3singall2)
errorLayer(v3_17all "V3_17:At least two V3s with space S1<=0.16um when either wide metal of M3 or M4 with both length L>0.24um and width W>0.24um, and the distance D<=1.1um away from this wide metal")

if( !avSwitch("CUSTOMER_DUMMY_CHECKS") then


errorLayer(rule_M4DUMC18
    "DUMC_18: Mx Dummy must not touch (Mx, LOGO, PTCT), where Mx=M1-M8,TM1, TM2.")

L46417=drc(MnDUB_metal4 MnDUM_metal4 sep<0.6 withIntersection withSingularPoint)
errorLayer(L46417
    "DUMC_20: Mx Dummy space to (MxDUB, DUMBM, LOGO, PTCT), where Mx=M1-M8. >=0.60")

L18048=drc(DUPL MnDUM_metal4 sep<0.6 withIntersection withSingularPoint)
errorLayer(L18048
    "DUMC_20: Mx Dummy space to (MxDUB, DUMBM, LOGO, PTCT), where Mx=M1-M8. >=0.60")

L32388=drc(geomAvoiding(MnDUM_metal4 INDMY) M4 sep<0.6 withIntersection withSingularPoint)
errorLayer(L32388 "DUMC_21_M4: M4 Dummy space to M4, where Mx=M1-M8. >= 0.60")

LPI=geomOr(geomOr(geomOr(LOGO PTCT) INDMY) MARKG)
    dumc22v3=geomButtOrOver(VnDUM_via3 geomOr(geomOr(V3 LPI) geomOr(M3 M4)))
    errorLayer(dumc22v3
    "DUMC_22_V3: Vx Dummy must not touch (Vx, LOGO, PTCT, INDMY),where Vx=V1-V7.")

L74479=geomContactCheck(VnDUM_via3 width==.07 length==.07 ignore)
L74480=geomContactCheck(VnDUM_via3 width==.077 length==.077)
errorLayer(geomAndNot(L74479 L74480)
    "DUMC_23_24_V3: Vx Dummy exact width, where Vx=V1-V7 ==0.070 or 0.077. Vx Dummy must be square.")

L96996=geomAnd(MIM MnDUM_metal4)
errorLayer(L96996
    "DUMC_38: Dummy metal should not be next layer to MIM. Next Layer: means upper or lower metal layer.")

m3d_and_m4d=geomAnd(MnDUM_metal3 MnDUM_metal4)
v3dm1d=drc(m3d_and_m4d VnDUM_via3 enc<0.06 withIntersection withSingularPoint)
L8473=geomAndNot(VnDUM_via3 m3d_and_m4d)
errorLayer(geomCat(v3dm1d L8473)
    "DUMC_25_a_b_V3: Vx Dummy must be within Mx Dummy, where Vx=V1-V7 and Mx= metal level below Vx. >= 0.030")

L94858=geomAnd(MOMDMY MnDUM_metal4)
errorLayer(L94858 "DUMC_39: Dummy metal must not be in MOM area")

L6850=geomAndNot(MnDUM_metal4 BORDER_all)
errorLayer(L6850
    "DUMC_31: xx Dummy must be within BORDER, where xx=all metal and via levels")

L67181=geomAndNot(VnDUM_via3 BORDER_all)
errorLayer(L67181
    "DUMC_31: xx Dummy must be within BORDER, where xx=all metal and via levels")

L51705=drc(MnDUM_metal4 width<0.22)
errorLayer(L51705 "DUMC_32: Min. width of Mx Dummy, where Mx=M1-M8. >= 0.220")

L23877=drc(MnDUM_metal4 sepNotch<0.22 withIntersection withSingularPoint)
errorLayer(L23877 "DUMC_33_M4: Min. space of Mx Dummy, where Mx=M1-M8.>= 0.220")

)

if( avSwitch("DFM_priority_3_CHECKS") then

    L47385=drc(M4 width<0.08)
    errorLayer(L47385 "DFM_22_M4: M4 minimum width >= 0.080")

    L9095=drc(M4 sepNotch<0.08)
    errorLayer(L9095 "DFM_23_M4: M4 minimum space >= 0.080")

    L52569=drc(M4W sep<0.12 opposite parallel)
    L10463=geomWithEdge(L52569 geomGetLength(L52569 keep>0.300))
    errorLayer(L10463
        "DFM_24_M4: Minimum space between two length > 0.3um parallel lines with one or both metal line width is >= 0.22um >= 0.120")

    rule_DFM25_V3=drc(V3i sep<0.100 diffNet opposite)
    errorLayer(rule_DFM25_V3
        "DFM_25_V3: minimum space in different net for run length > 0 um")

)

)

procedure( switchProc206()

L79289=drc(M5 width<0.070)
errorLayer(L79289 "M5_1: M5 minimum width >= 0.070")

;L11789=geomWidth(M5 keep>4.500)
;errorLayer(L11789 "M5_2: M5 maximum width <= 4.500")
slwide_m5 = geomButtOrOver( M5 geomSize( M5 -2.25))
slwdm5_45 = geomGetAngledEdge( slwide_m5  0 < keep < 90 )
slwdm5_90 = geomGetAngledEdge( slwide_m5  0 < ignore < 90 )
slwdm5_exp_45 = geomSize( slwdm5_45 -3.1815 edges )
slwdm5_exp_90 = geomSize( geomStretch( slwdm5_90 2.25 ) -2.25 edges )
slthin_m5_tmp = geomAndNot( slwide_m5  geomOr( slwdm5_exp_45 slwdm5_exp_90 ) )
slthin_m5 = geomSnap( slthin_m5_tmp 0.001 )
sltnm5_45 = geomGetAngledEdge( slthin_m5  0 < keep < 90 )
sltnm5_90 = geomGetAngledEdge( slthin_m5  0 < ignore < 90 )
sltnm5_exp_45_tmp = geomSize( sltnm5_45 3.1815 edges )
sltnm5_exp_45 = geomSnap( sltnm5_exp_45_tmp 0.001 )
sltnm5_exp_90 = geomSize( geomStretch( sltnm5_90 2.25 ) 2.25 edges )
sltnm5_exp = geomOr( sltnm5_exp_45 sltnm5_exp_90 )
slwdm5_pre = geomOr( sltnm5_exp slthin_m5 )
m5wide1 = geomAndNot( M5 slwdm5_exp_90 )
m5wide2 = geomWidth( m5wide1 keep>4.5 )
m5wide3 = geomSize( geomSize( M5 -2.25 ) 2.25 )
m5wide4 = geomAnd( geomOr( m5wide2 slwdm5_pre) m5wide3 )
errorLayer( m5wide4 "M5_2: M5 maximum width <= 4.500")

M5_in=geomAndNot(M5 geomOutside(M5 INST))

m503a=drc(M5 sepNotch<0.070 withIntersection withSingularPoint)
errorLayer(m503a "M5_3: M5 minimum space >= 0.070")

L84291=drc(M5 area<0.0196)
errorLayer(L84291
    "M5_4: M5 minimum area (um^2)(For M5, The INST connected area apply SRAM design rule) >= 0.0196")

L23216=geomHoles(M5 innermost)
L37989=geomAndNot(L23216 M5)
L89314=drc(L37989 area<0.2)
errorLayer(L89314 "M5_5: M5 minimum enclosed area (um^2) >= 0.2")

Mn_6(M5i 0.3 0.22 0.1)
errorLayer(mts
    "M5_6: Minimum space between two (run length >= 0.3um) parallel metal lines with one or both metal line width is >= 0.22um >= 0.100")

Mn_6a(M5i 0.6 0.7 0.12)
errorLayer(mts
    "M5_6a: Minimum space between two (run length >= 0.3um) parallel metal lines with one or both metal line width is >= 0.7um >= 0.175")

Mn_6b(M5i 0.6 0.22 0.7 0.14)
errorLayer(mts
    "M5_6b: Minimum space between two (run length >= 0.3um) parallel metal lines with one metal line width is > 0.22um and other metal line width is > 0.7um >= 0.210")

Mn_6c(M5i 1.5 1.5 0.3)
errorLayer(mts
    "M5_6c: Minimum space between two (run length >= 1.5um) parallel metal lines with one or both metal line width is >1.5um >= 0.500")

if( avSwitch("DENSITY_CHECKS") then

    processCoverage( backup measure( windowSize=110 stepSize=55
        L78894=calculate(area(m5_all)/area()) ))
    errorLayer(geomAndNot(geomGetCoverage(L78894 0.10<=ignore<=0.85) MARKG)
        "M5_7_7a: M5 minimum/maximum density (%) in 110um*110um window with step size 55um 10% <= density <= 85%")
    processCoverage( backup measure( windowSize=200
        rule_den=calculate(area(m5_all)/area()) ))
    errorLayer(geomAndNot(geomGetCoverage(rule_den keep>0 gradient>0.5) MARKG)
        "M5_7b: M5 maximum density difference (%) between any two 200um adjacent window (stepped without overlapping ) <= 50%")

    processCoverage( backup measure( windowSize=840
        L36050=calculate(area(m5_all)/area()) ))
    errorLayer(geomAndNot(geomGetCoverage(L36050 keep>0.70) MARKG)
        "M5_7c: M5 maximum density (%) with 840 um*840um window <= 70%")

    processCoverage( backup measure( windowSize=200 stepSize=100
        L36051=calculate(area(m5_gt2p8_m4)/area()) ))
    errorLayer(geomAndNot(geomGetCoverage(L36051 keep>0.70) MARKG)
        "M5_7d: [(M5 with width > 2.8 um) over M4] maximum density (%) with 200 um*200um <= 70%")

    processCoverage( backup measure( windowSize=200 stepSize=100
        L36052=calculate(area(m4_gt2p8_m5)/area()) ))
    errorLayer(geomAndNot(geomGetCoverage(L36052 keep>0.70) MARKG)
        "M5_7e: [M5 over [M4 with width > 2.8 um] maximum density (%) with 200 um*200um <= 70%")

   processCoverage( backup measure(
        L36053=calculate(area(m5all)/area()) ))
    errorLayer(geomAndNot(geomGetCoverage(L36053 keep<0.2) MARKG)
        "M5_7f: Mn density over the whole chip is >=20%")

)

m58a=geomGetAngledEdge(M5 keep==45 fig)
L57346=drc(m58a width<0.17 opposite)
errorLayer(L57346 "M5_8: (M5 at 45) minimum width (run length > 0 um) >= 0.17")

L80924=drc(m58a sep<0.17 opposite)
errorLayer(L80924
    "M5_9: (M5 at 45 ) minimum space to parallel M5 (run length > 0 um) >= 0.17")

m5end1=geomGetLength(M5 keep>0.001)
m5end=geomSelectEdge(m5end1 length keep<=0.11 angle1(keep==90 length keep>=0.08) angle2(keep==90 length keep>=0.08))

m510a=geomOutside(drc(m5end M5 sep<0.07 opposite) INST)
errorLayer(m510a "M5_10a: Minimum space between an Mn line end to an Mn (the parallel run length >0um) is 0.07")

m510b1=drc(m5end M5 sep<0.07 opposite)
m510b2=geomOr(geomGetEdge(m5end coincident m510b1) geomGetEdge(m5end butting m510b1))
m510b3=drc(m510b2 V5 enc<0.05 opposite)
m510b4=drc(m510b2 V5 enc<0.03 opposite)
m510b5=geomButtOrOver(V5 m510b3)
m510b6=geomButtOrOver(V5 m510b4)
m510b7=geomAndNot(m510b5 m510b6)
m510b7=geomOutside(geomButtOnly(m510b1 geomButtOrOver(m510b3 m510b7)) INST)
errorLayer(m510b7 "M5_10b: Minimum space between an Mn line end (with Vn) to an Mn (the parallel run length >0um) is 0.07. The Mn line end extend Q from Vn, 0.03 <= Q <0.05um")

M5_LINE_END=geomLineEnd(M5 0.099 legs(0.08))
M5_X1=drc(M5_LINE_END V4 enc<0.05 opposite)
M5_X2=geomButtOrOver(V4 M5_X1)
M5_X3=geomInside(M5_X2 geomAnd(M4 M5))
M5_X8=geomOr(geomGetEdge( M5_X3 butting M5_X1 wholeEdge) geomGetEdge( M5_X3 coincident M5_X1 wholeEdge))
M5_LINE_END_SHAPE=geomSize(M5_LINE_END -0.095 edges)
M5_LINE_SIDE_a=geomOr( geomGetEdge(M5 butting M5_LINE_END_SHAPE) geomGetEdge(M5 coincident M5_LINE_END_SHAPE) edges)
M5_LINE_SIDE_b=geomOr( geomGetEdge(M5_LINE_SIDE_a butting M5_LINE_END) geomGetEdge(M5_LINE_SIDE_a coincident M5_LINE_END) edges)
M5_LINE_SIDE=geomAndNot(M5_LINE_SIDE_a M5_LINE_SIDE_b edges)
M5_LINE_SIDE1=drc(M5_LINE_SIDE M5_X3 enc<0.03 opposite)
M5_V4_EDGE_a=geomOr(M5_LINE_SIDE1 M5_X3) 
M5_V4_EDGE=geomOr( geomGetEdge(M5_V4_EDGE_a butting M5_X8 wholeEdge) geomGetEdge(M5_V4_EDGE_a coincident M5_X8 wholeEdge) edges)
M5_LINE_END_EXP_a=geomStretch(M5_V4_EDGE 0.031)
M5_LINE_END_EXP=geomSize(M5_LINE_END_EXP_a -0.001 edges)
M5_LINE_SIDE_EXP=geomSize(M5_LINE_SIDE -0.001 edges)
M5_LINE_END_1=geomOr( geomGetEdge(M5_LINE_END_EXP butting M5_V4_EDGE wholeEdge) geomGetEdge(M5_LINE_END_EXP coincident M5_V4_EDGE wholeEdge) edges)
M5_LINE_SIDE_1=geomOr( geomGetEdge(M5_LINE_SIDE_EXP butting M5_LINE_SIDE wholeEdge) geomGetEdge(M5_LINE_SIDE_EXP coincident M5_LINE_SIDE wholeEdge) edges)
M5_E1=drc(M5_LINE_END_1 M5 sep<0.12 opposite with_perp edgea)
M5_E2=drc(M5_LINE_SIDE_1 M5 sep<0.08 opposite with_perp edgea)
M5_LINE_END_E1=geomOr(geomGetEdge(M5_LINE_END_1 butting M5_E1 wholeEdge) geomGetEdge(M5_LINE_END_1 coincident M5_E1 wholeEdge) edges)
M5_LINE_SIDE_E2=geomOr(geomGetEdge(M5_LINE_SIDE_1 butting M5_E2 wholeEdge) geomGetEdge(M5_LINE_SIDE_1 coincident M5_E2 wholeEdge) edges)
M5_V42_a=geomOr( geomGetEdge(M5_X8 butting M5_LINE_END_E1 wholeEdge) geomGetEdge(M5_X8 coincident M5_LINE_END_E1 wholeEdge) edges)
M5_V42=geomWithEdge(M5_X3 M5_V42_a)
M5_X5=geomButtOrOver(V4 M5_V42)
M5_X6=geomAndNot(V4 M5_X5)
M5_X7=geomEnclose(geomEnclose( geomAnd(M4 M5) M5_X5) M5_X6)
M5_LINE_END_E1_a=geomSize(M5_LINE_END_E1 -0.001 edges)
M5_LINE_SIDE_E2_a=geomSize(M5_LINE_SIDE_E2 -0.001 edges)
M5_CORNER1=drc(M5_LINE_END_E1_a M5_LINE_SIDE_E2_a sep<=0.002 only_perp withIntersection)
M5_CORNER1_a=geomAnd(M5_LINE_END_E1_a M5_LINE_SIDE_E2_a)
M5_CORNER1_b=geomGetEdge(M5_CORNER1_a coincident M5_LINE_END_E1)
M5_CORNER1_c=geomGetEdge(M5_CORNER1_a coincident M5_LINE_SIDE_E2)
M5_CORNER1=geomWithEdge(geomWithEdge(M5_CORNER1_a M5_CORNER1_b) M5_CORNER1_c)
rule_M5_11=geomOutside(geomAvoiding(M5_CORNER1 M5_X7) INST)
errorLayer(rule_M5_11 "M5_11:Space between Vn-1,Vn-1 is enclosed by Mn[A] to neighbouring metal line Mn[B], when the layout structures meet the following conditions:Mn[A] line end definition: line width W <0.1um,Vn-1 enclosure by Mn[A] line end: E < 0.05um,The parallel run length of Mn[A] and Mn[B]:E1 >=-0.03um,Space between Mn[A] to the neighbouring parallel metal line: Ds<0.08um,Any one edge distance from the corner of the two edges of Mn[A]: K1 <0.095um,At least one Vn-1 in the Mn[A] and Mn-1 intersection meet this rule is ok,This rule is not applicable for SRAM region DRC check")

M512_LINE_END=geomLineEnd(M5 0.099 legs(0.07))
M512_LINE_END_SHAPE=geomSize(M512_LINE_END -0.064 edges)
M512_LINE_SIDE_a=geomGetEdge(M5 coincident M512_LINE_END_SHAPE)
M512_LINE_SIDE_b=geomGetEdge(M512_LINE_SIDE_a coincident M512_LINE_END)
M512_LINE_SIDE=geomAndNot(M512_LINE_SIDE_a M512_LINE_SIDE_b edges)
M512_LINE_END_EXP_a=geomStretch(M512_LINE_END 0.031)
M512_LINE_END_EXP=geomSize(M512_LINE_END_EXP_a -0.001 edges)
M512_LINE_SIDE_EXP_a=geomStretch(M512_LINE_SIDE 0.031)
M512_LINE_SIDE_EXP=geomSize(M512_LINE_SIDE_EXP_a -0.001 edges)
M512_LINE_END_1=geomGetEdge(M512_LINE_END_EXP coincident M512_LINE_END wholeEdge)
M512_LINE_SIDE_1=geomGetEdge(M512_LINE_SIDE_EXP coincident M512_LINE_SIDE wholeEdge)
M5E1=drc(M512_LINE_END_1 M5 sep<0.1 opposite with_perp edgea)
M5E2=drc(M512_LINE_SIDE_1 M5 sep<0.1 opposite with_perp edgea)
M512_LINE_END_E1=geomGetEdge(M512_LINE_END_1 coincident M5E1 wholeEdge)
M512_LINE_SIDE_E2=geomGetEdge(M512_LINE_SIDE_1 coincident M5E2 wholeEdge)
M5_CORNER=drc(M512_LINE_END_E1 M512_LINE_SIDE_E2 ovlp<=0.002 only_perp)
MOM_M5=geomButtOrOver(geomOr(geomOr(M4 M5) M6) geomButtOrOver(MnPIN geomSize(MOMDMY 0.114)))
rule_M5_12=geomAndNot(geomOutside(geomButtOrOver(M512_LINE_END_SHAPE M5_CORNER) INST) geomOr(MOM_M5 MOMDMY))
errorLayer(rule_M5_12 "M5_12:Minimum Mn to Mn space S at Mn line-end 0.1. Width W < 0.1um.The minimum space can be line end head to other Mn or line end side to other M1.  Rule check:S >= (Dh or Ds ).  E1 =0.03, K1=0.095 , Dh=Ds=0.1 in the illustration,Outside of SRAM(INST) area,Waive extrusion F < 0.07")


L14271=geomContactCheck(V4 width==0.070 length==0.070 ignore)
errorLayer(L14271 "V4_1: V4 exact length and width == 0.070")

L12117=drc(V4 sepNotch<0.070 withIntersection withSingularPoint)
errorLayer(L12117 "V4_2: V4 minimum space >= 0.070")

L27150=drc(V4i sep<0.1 diffNet opposite)
L27151=geomOutside(L27150 INST)
errorLayer(L27151
    "V4_5: minimum space in different net for run length > 0um >= 0.11")

v45a1=drc(V4i sep<0.09 diffNet )
errorLayer(v45a1
    "V4_5a: minimum space in different net for run length > 0um >= 0.11")



v43a1=geomSize(geomSize(V4 0.05) -0.05)
v43a2=geomSize(v43a1 -0.17 downUp)
v43a3=geomButtOrOver(V4 v43a2)
v43a4a=drc(v43a3 sepNotch<0.09 opposite edge)
v43a4=geomGetLength(v43a4a keep>0)
v43a5=geomWithEdge(v43a3 v43a4 keep>=2)
errorLayer(v43a5 "V4_3:Space between Vns (with run length>=0) at least two least two sides is 0.09, when array equal to or greater than 3x3,Two Via areas whose space is within 0.10um are considered to be in the same array. An array does not have both row and column greater than or equal to 3 can apply smaller spacing Vn.2 instead of Vn.3")



L76016=geomAndNot(V4 M4)
rule_V4_6a=geomCat(L76016 rule_V4_6)
errorLayer(rule_V4_6a
    "V4_6abc: At least one V4, per M4 and M5 intersection containing a V4, must meet rule V4_6a, V4_6b or V4_6c. V4 within M4 with width > 0.14um must meet rule V4_6a")

L76047=geomAndNot(V4 M5)
rule_V4_7a=geomCat(L76047 rule_V4_7)
errorLayer(rule_V4_7a
    "V4_7abc: At least one V4, per M4 and M5 intersection containing a V4, must meet rule V4_7a, V4_7b or V4_7c. V4 within M5 with width > 0.14um must meet rule V4_7a or V4_7d")

errorLayer(rule_V4_8
    "V4_8: At least two V4 vias must connect M4 to M5 when the M4 or M5 width is > 0.26um")

errorLayer(rule_V4_9
    "V4_9: At least three V4 vias must connect M4 to M5 when the M4 or M5 width is > 0.52um")

errorLayer(rule_V4_10
    "V4_10: At least four V4 vias must connect M4 to M5 when the M4 or M5 width is > 0.645um")

V4_square=geomGetRectangle(V4 aspectRatio==1)
v4_empty=geomOr(EMPTY geomInside(V4_square geomAnd(M4 M5)))
v4_inter_empty=geomOr(EMPTY geomAnd(M4 M5))
v4_16x1a=geomWidth(M4 keep>0.24)
v4_16x1b=geomWidth(M5 keep>0.24)
v4_16wide=geomOr(v4_16x1a v4_16x1b)
v4_empty1=geomInside(v4_empty v4_16wide)
geomConnect(
 incremental
    buttOrOver( v4_empty v4_inter_empty )
    buttOrOver( v4_empty1 v4_inter_empty )
)

v4_16x2=geomEnclose(geomAnd(M4 M5) V4_square)
v4_16x3=geomInside(V4_square v4_16x2)
v4_16x5c=drc(v4_empty1 v4_empty sep<=0.16 withIntersection sameNet)
v4_16x6c=geomEnclose(v4_16x2 v4_16x5c)
v4_16x7=geomEnclose(geomAnd(geomSize(v4_16x3 0.325) v4_16x2) V4 keep>2)
v4_16x7c=geomEnclose(v4_16x2 v4_16x7)
v4_16x=geomEnclose(geomAndNot(geomAndNot(v4_16x2 v4_16x6c) v4_16x7c) geomInside(V4_square v4_16wide))
v4_16all=geomOutside(v4_16x INST)
errorLayer(v4_16all "V4_16:At least two V4s with space <=0.16um when one of  M4 or M5 with both length and width  >0.24um")

v4_a=geomButtOrOver(V4_square wm4_exp)
geomConnect(
 incremental
 buttOrOver(v4_a M4)
 buttOrOver(WM4 M4)
)
WM5=geomWidth(M5 keep>0.24)
wm5_edge=geomGetLength(WM5 keep>0)
wm5_exp=geomSize(wm5_edge 1.1 edges)
wm5_l1=geomButtOnly(geomAndNot(M5 WM5) WM5)
v4_a2=geomButtOrOver(V4_square wm5_exp)
geomConnect(
incremental
  buttOrOver(v4_a2 M5) 
  buttOrOver(WM5 M5) 
)

wm4_ext=drc(WM4 v4_a sep<1.1 0<=withIntersection<90 opposite sameNet edgeb)
v4_b=geomWithEdge(V4_square wm4_ext)
v4bx1=geomEnclose(geomAnd(M4 M5) V4_square keep>1)
v4sing1=geomButtOrOver(geomAndNot(geomAnd(geomAnd(M4 M5) geomAnd(wm4_l1 wm4_exp)) v4bx1) v4_b keep==1)
v4singall1=geomOutside(v4sing1 INST)

wm5_ext=drc(WM5 v4_a2 sep<1.1 0<=withIntersection<90 opposite sameNet edgeb)
v4_b2=geomWithEdge(V4_square wm5_ext)
v4sing2=geomButtOrOver(geomAndNot(geomAnd(geomAnd(M4 M5) geomAnd(wm5_l1 wm5_exp)) v4bx1) v4_b2 keep==1)
v4singall2=geomOutside(v4sing2 INST)
v4_17all=geomCat(v4singall1 v4singall2)
errorLayer(v4_17all "V4_17:At least two V4s with space S1<=0.16um when either wide metal of M4 or M5 with both length L>0.24um and width W>0.24um, and the distance D<=1.1um away from this wide metal")


if( !avSwitch("CUSTOMER_DUMMY_CHECKS") then

errorLayer(rule_M5DUMC18
    "DUMC_18: Mx Dummy must not touch (Mx, LOGO, PTCT), where Mx=M1-M8,TM1, TM2.")

L62767=drc(MnDUB_metal5 MnDUM_metal5 sep<0.6 withIntersection withSingularPoint)
errorLayer(L62767
    "DUMC_20: Mx Dummy space to (MxDUB, DUMBM, LOGO, PTCT), where Mx=M1-M8. >=0.60")

L66689=drc(DUPL MnDUM_metal5 sep<0.6 withIntersection withSingularPoint)
errorLayer(L66689
    "DUMC_20: Mx Dummy space to (MxDUB, DUMBM, LOGO, PTCT), where Mx=M1-M8. >=0.60")

L25724=drc(geomAvoiding(MnDUM_metal5 INDMY) M5 sep<0.6 withIntersection withSingularPoint)
errorLayer(L25724 "DUMC_21_M5: M5 Dummy space to M5, where Mx=M1-M8. >= 0.60")

L88976=geomContactCheck(VnDUM_via4 width==.07 length==.07 ignore)
L88977=geomContactCheck(VnDUM_via4 width==.077 length==.077)
errorLayer(geomAndNot(L88976 L88977)
    "DUMC_23_24_V4: Vx Dummy exact width, where Vx=V1-V7 ==0.070 or 0.077. Vx Dummy must be square.")

LPI=geomOr(geomOr(geomOr(LOGO PTCT) INDMY) MARKG)
    dumc22v4=geomButtOrOver(VnDUM_via4 geomOr(geomOr(V4 LPI) geomOr(M4 M5)))
    errorLayer(dumc22v4
    "DUMC_22_V4: Vx Dummy must not touch (Vx, LOGO, PTCT, INDMY),where Vx=V1-V7.")

L96965=geomAnd(MIM MnDUM_metal5)
errorLayer(L96965
    "DUMC_38: Dummy metal should not be next layer to MIM. Next Layer: means upper or lower metal layer.")

m4d_and_m5d=geomAnd(MnDUM_metal4 MnDUM_metal5)
v4dm1d=drc(m4d_and_m5d VnDUM_via4 enc<0.06 withIntersection withSingularPoint)
L8474=geomAndNot(VnDUM_via4 m4d_and_m5d)
errorLayer(geomCat(v4dm1d L8474)
    "DUMC_25_a_b_V4: Vx Dummy must be within Mx Dummy, where Vx=V1-V7 and Mx= metal level below Vx. >= 0.030")

L94889=geomAnd(MOMDMY MnDUM_metal5)
errorLayer(L94889 "DUMC_39: Dummy metal must not be in MOM area")

L5983=geomAndNot(MnDUM_metal5 BORDER_all)
errorLayer(L5983
    "DUMC_31: xx Dummy must be within BORDER, where xx=all metal and via levels")

L87282=geomAndNot(VnDUM_via4 BORDER_all)
errorLayer(L87282
    "DUMC_31: xx Dummy must be within BORDER, where xx=all metal and via levels")

L48698=drc(MnDUM_metal5 width<0.22)
errorLayer(L48698 "DUMC_32: Min. width of Mx Dummy, where Mx=M1-M8. >= 0.220")

L10300=drc(MnDUM_metal5 sepNotch<0.22 withIntersection withSingularPoint)
errorLayer(L10300 "DUMC_33_M5: Min. space of Mx Dummy, where Mx=M1-M8.>= 0.220")

)

if( avSwitch("DFM_priority_3_CHECKS") then

    L50392=drc(M5 width<0.08)
    errorLayer(L50392 "DFM_22_M5: M5 minimum width >= 0.080")

    L25082=drc(M5 sepNotch<0.08)
    errorLayer(L25082 "DFM_23_M5: M5 minimum space >= 0.080")

    L88204=drc(M5W sep<0.12 opposite parallel)
    L84538=geomWithEdge(L88204 geomGetLength(L88204 keep>0.300))
    errorLayer(L84538 "DFM_24_M5: Minimum space between two length > 0.3um parallel lines with one or both metal line width is >= 0.22um >= 0.120")
  
    rule_DFM25_V4=drc(V4i sep<0.100 diffNet opposite)
    errorLayer(rule_DFM25_V4
    "DFM_25_V4: minimum space in different net for run length > 0 um")

)

)

m13x01=geomEnclose(M1 CT keep==1)
m13x1=geomWidth(m13x01 keep>0.12)
m13x=drc(M1 m13x1 sep<=0.08 withIntersection opposite shielded edgeb)
m13x0=drc(M1 m13x1 sep<=0.08 withIntersection opposite shielded)
m13gap=geomWithEdge(m13x0 geomGetLength(m13x keep>0.27))
m13x2=geomButtOrOver(geomButtOrOver(m13gap m13x1) m13x0)
m13x3=geomInside(CT geomOr(geomAnd(M1 AA) geomAnd(M1 GT)))
m13x4=drc(geomInside(m13x3 m13x1) geomButtOrOver(M1 m13x2) sep<0.085 withIntersection opposite)
m13y=geomSize(geomGetLength(m13x keep>0.27) 0.001 edges)
m13x5=geomButtOrOver(geomButtOrOver(geomButtOrOver(geomButtOrOver(geomButtOrOver(m13x4 M1) geomAnd(m13x2 m13x4)) m13x1) geomAnd(m13x0 m13x4)) geomAnd(m13y m13x4))
m13xall=geomOutside(m13x5 INST)
errorLayer(m13xall "M1_13:Minimum space CT to M1 is 0.085, when the M1 and adjacent M1 meet the following conditions:M1(enclosed CT) width >0.12um,M1(enclosed CT) to adjacent M1 space <=0.08um,The projected parallel run length R of M1[A] to M1[B]. R >= 0.27um,Waive if there is redundant CT in the same [(M1 and AA intersection) or (M1 and GT) intersection]")


inter_ma=geomEnclose(geomOr(geomAnd(M1 GT) geomAnd(M1 AA)) CT keep==1)
inter_mt=geomEnclose(geomAnd(M1 M2) V1 keep==1)

ct_inter=geomInside(CT inter_ma)
LINE_END=geomLineEnd(geomButtOrOver(M1 geomOr(inter_ma inter_mt)) 0.089 legs(0.07))

ct_edge=drc(LINE_END ct_inter enc<0.1 withIntersection opposite edgeb)
ct_edge1=drc(ct_edge M1 sep<0.1 withIntersection opposite edgea)
ct_sing=geomWithEdge(ct_inter ct_edge1)

v1_inter=geomInside(V1 inter_mt)
v1_edge=drc(LINE_END v1_inter enc<0.1 withIntersection opposite edgeb)
v1_edge1=drc(v1_edge M1 sep<0.1 withIntersection opposite edgea)
v1_sing=geomWithEdge(v1_inter v1_edge1)


LINE_END_SHAPE=geomSize(LINE_END -0.044 edges)
LINE_SIDE_a=geomGetEdge(M1 coincident LINE_END_SHAPE) 
LINE_SIDE_b=geomGetEdge(LINE_SIDE_a coincident LINE_END) 
LINE_SIDE=geomAndNot(LINE_SIDE_a LINE_SIDE_b edges)
LINE_END_EXP_a=geomStretch(LINE_END 0.021)
LINE_END_EXP=geomSize(LINE_END_EXP_a -0.001 edges)
LINE_SIDE_EXP_a=geomStretch(LINE_SIDE 0.021)
LINE_SIDE_EXP=geomSize(LINE_SIDE_EXP_a -0.001 edges)
LINE_END_1=geomGetEdge(LINE_END_EXP coincident LINE_END wholeEdge) 
LINE_SIDE_1=geomGetEdge(LINE_SIDE_EXP coincident LINE_SIDE wholeEdge)
E1=drc(LINE_END_1 M1 sep<0.08 opposite with_perp edgea)
E2=drc(LINE_SIDE_1 M1 sep<0.08 opposite with_perp edgea)
E3=drc(LINE_SIDE_1 M1 sep<=0.11 opposite with_perp edgea)
LINE_END_E1=geomGetEdge(LINE_END_1 coincident E1 wholeEdge) 
LINE_SIDE_E2=geomGetEdge(LINE_SIDE_1 coincident E2 wholeEdge) 
LINE_SIDE_E3=geomGetEdge(LINE_SIDE_1 coincident E3 wholeEdge)
M1_CORNER=drc(LINE_END_E1 LINE_SIDE_E2 ovlp<=0.002 only_perp)
M2_CORNER=drc(LINE_END_E1 LINE_SIDE_E3 ovlp<=0.002 only_perp)
M_CORNER2=geomButtOrOver(geomSize(LINE_END 0.001 edges) M1_CORNER keep==2)
M_CORNER3=geomButtOrOver(geomButtOrOver(geomSize(LINE_END 0.001 edges) geomAndNot(M2_CORNER M1_CORNER))  M1_CORNER)
rule_M1_14=geomOutside(geomButtOrOver(geomButtOrOver(LINE_END_SHAPE geomOr(M_CORNER2 M_CORNER3)) geomOr(ct_sing v1_sing)) INST) 
errorLayer(rule_M1_14 "M1_14:Minimum M1 to M1 space S at M1 line-end. Width W < W0. The minimum space can be line end head to other M1 or line end side to other M1 Rule check,S >= (Dh or Ds ).E1 =0.02, K1=0.065, W0=0.09um, Dh=Ds=0.08 in the illustration.Outside of SRAM(INST) area,Waive extrusion E < 0.07")



m1_line_end=geomLineEnd( M1 0.11 legs(0.08) )
m1length=geomGetLength(M1 keep>0.001)
m1_11a=drc(m1_line_end M1 sep<0.07 opposite)
errorLayer(m1_11a "M1_11a:Minimum space between an M1 line end to an M1 line (the parallel run length >0um) is 0.07")

m1_11b1=drc(m1_line_end M1 sep<0.07 opposite)
m1_11b2=geomOr(geomGetEdge(m1_line_end coincident m1_11b1) geomGetEdge(m1_line_end butting m1_11b1))
m1_11b3=drc(m1_11b2 geomOr(CT V1) enc<0.05 opposite)
m1_11b4=drc(m1_11b2 geomOr(CT V1) enc<0.03 opposite)
m1_11b5=geomButtOrOver(geomOr(CT V1) m1_11b3)
m1_11b6=geomButtOrOver(geomOr(CT V1) m1_11b4)
m1_11b7=geomAndNot(m1_11b5 m1_11b6)
m1_11b8=geomButtOnly(m1_11b1 geomButtOrOver(m1_11b3 m1_11b7))
errorLayer(m1_11b8 "M1_11b:Minimum space between an M1 line end (with (CT or V1)) to an M1 (the parallel run length >0um) is 0.07, when this M1 line end extend Q from (CT or V1),0.03 <= Q <0.05um") 

m19a=geomGetAngledEdge(M1 keep==45 fig)
L77729=drc(m19a width<0.17 opposite)
errorLayer(L77729 "M1_9: (M1 at 45) minimum width (run length > 0 um) >= 0.17")

L3804=drc(M1 m19a sep<0.170 opposite parallel)
errorLayer(L3804
    "M1_10: (M1 at 45 ) minimum space to M1 (run length > 0 um) >= 0.170")

m28a=geomGetAngledEdge(M2 keep==45 fig)
L33507=drc(m28a width<0.17 opposite)
errorLayer(L33507 "M2_8: (M2 at 45) minimum width (run length > 0 um) >= 0.17")

L43900=drc(m28a sep<0.17 opposite )
errorLayer(L43900
    "M2_9: (M2 at 45 ) minimum space to parallel M2 (run length > 0 um) >= 0.17")

m2end1=geomGetLength(M2 keep>0.001)
m2end=geomSelectEdge(m2end1 length keep<=0.11 angle1(keep==90 length keep>=0.08) angle2(keep==90 length keep>=0.08))

m210a=geomOutside(drc(m2end M2 sep<0.07 opposite) INST)
errorLayer(m210a "M2_10a: Minimum space between an Mn line end to an Mn (the parallel run length >0um) is 0.07")

m210b1=drc(m2end M2 sep<0.07 opposite)
m210b2=geomOr(geomGetEdge(m2end coincident m210b1) geomGetEdge(m2end butting m210b1))
m210b3=drc(m210b2 V2 enc<0.05 opposite)
m210b4=drc(m210b2 V2 enc<0.03 opposite)
m210b5=geomButtOrOver(V2 m210b3)
m210b6=geomButtOrOver(V2 m210b4)
m210b7=geomAndNot(m210b5 m210b6)
m210b7=geomOutside(geomButtOnly(m210b1 geomButtOrOver(m210b3 m210b7)) INST)
errorLayer(m210b7 "M2_10b: Minimum space between an Mn line end (with Vn) to an Mn (the parallel run length >0um) is 0.07. The Mn line end extend Q from Vn, 0.03 <= Q <0.05um")

M2_LINE_END=geomLineEnd(M2 0.099 legs(0.08))
M2_X1=drc(M2_LINE_END V1 enc<0.05 opposite)
M2_X2=geomButtOrOver(V1 M2_X1)
M2_X3=geomInside(M2_X2 geomAnd(M1 M2))
M2_X8=geomOr(geomGetEdge( M2_X3 butting M2_X1 wholeEdge) geomGetEdge( M2_X3 coincident M2_X1 wholeEdge))
M2_LINE_END_SHAPE=geomSize(M2_LINE_END -0.095 edges)
M2_LINE_SIDE_a=geomOr( geomGetEdge(M2 butting M2_LINE_END_SHAPE) geomGetEdge(M2 coincident M2_LINE_END_SHAPE) edges)
M2_LINE_SIDE_b=geomOr( geomGetEdge(M2_LINE_SIDE_a butting M2_LINE_END) geomGetEdge(M2_LINE_SIDE_a coincident M2_LINE_END) edges)
M2_LINE_SIDE=geomAndNot(M2_LINE_SIDE_a M2_LINE_SIDE_b edges)
M2_LINE_SIDE1=drc(M2_LINE_SIDE M2_X3 enc<0.03 opposite)
M2_V1_EDGE_a=geomOr(M2_LINE_SIDE1 M2_X3) 
M2_V1_EDGE=geomOr( geomGetEdge(M2_V1_EDGE_a butting M2_X8 wholeEdge) geomGetEdge(M2_V1_EDGE_a coincident M2_X8 wholeEdge) edges)
M2_LINE_END_EXP_a=geomStretch(M2_V1_EDGE 0.031)
M2_LINE_END_EXP=geomSize(M2_LINE_END_EXP_a -0.001 edges)
M2_LINE_SIDE_EXP=geomSize(M2_LINE_SIDE -0.001 edges)
M2_LINE_END_1=geomOr( geomGetEdge(M2_LINE_END_EXP butting M2_V1_EDGE wholeEdge) geomGetEdge(M2_LINE_END_EXP coincident M2_V1_EDGE wholeEdge) edges)
M2_LINE_SIDE_1=geomOr( geomGetEdge(M2_LINE_SIDE_EXP butting M2_LINE_SIDE wholeEdge) geomGetEdge(M2_LINE_SIDE_EXP coincident M2_LINE_SIDE wholeEdge) edges)
M2_E1=drc(M2_LINE_END_1 M2 sep<0.12 opposite with_perp edgea)
M2_E2=drc(M2_LINE_SIDE_1 M2 sep<0.08 opposite with_perp edgea)
M2_LINE_END_E1=geomOr(geomGetEdge(M2_LINE_END_1 butting M2_E1 wholeEdge) geomGetEdge(M2_LINE_END_1 coincident M2_E1 wholeEdge) edges)
M2_LINE_SIDE_E2=geomOr(geomGetEdge(M2_LINE_SIDE_1 butting M2_E2 wholeEdge) geomGetEdge(M2_LINE_SIDE_1 coincident M2_E2 wholeEdge) edges)
M2_V42_a=geomOr( geomGetEdge(M2_X8 butting M2_LINE_END_E1 wholeEdge) geomGetEdge(M2_X8 coincident M2_LINE_END_E1 wholeEdge) edges)
M2_V42=geomWithEdge(M2_X3 M2_V42_a)
M2_X5=geomButtOrOver(V1 M2_V42)
M2_X6=geomAndNot(V1 M2_X5)
M2_X7=geomEnclose(geomEnclose( geomAnd(M1 M2) M2_X5) M2_X6)
M2_LINE_END_E1_a=geomSize(M2_LINE_END_E1 -0.001 edges)
M2_LINE_SIDE_E2_a=geomSize(M2_LINE_SIDE_E2 -0.001 edges)
M2_CORNER1=drc(M2_LINE_END_E1_a M2_LINE_SIDE_E2_a sep<=0.002 only_perp withIntersection)
M2_CORNER1_a=geomAnd(M2_LINE_END_E1_a M2_LINE_SIDE_E2_a)
M2_CORNER1_b=geomGetEdge(M2_CORNER1_a coincident M2_LINE_END_E1)
M2_CORNER1_c=geomGetEdge(M2_CORNER1_a coincident M2_LINE_SIDE_E2)
M2_CORNER1=geomWithEdge(geomWithEdge(M2_CORNER1_a M2_CORNER1_b) M2_CORNER1_c)
rule_M2_11=geomOutside(geomAvoiding(M2_CORNER1 M2_X7) INST)
errorLayer(rule_M2_11 "M2_11:Space between Vn-1,Vn-1 is enclosed by Mn[A] to neighbouring metal line Mn[B], when the layout structures meet the following conditions:Mn[A] line end definition: line width W <0.1um,Vn-1 enclosure by Mn[A] line end: E < 0.05um,The parallel run length of Mn[A] and Mn[B]:E1 >=-0.03um,Space between Mn[A] to the neighbouring parallel metal line: Ds<0.08um,Any one edge distance from the corner of the two edges of Mn[A]: K1 <0.095um,At least one Vn-1 in the Mn[A] and Mn-1 intersection meet this rule is ok,This rule is not applicable for SRAM region DRC check")

M212_LINE_END=geomLineEnd(M2 0.099 legs(0.07))
M212_LINE_END_SHAPE=geomSize(M212_LINE_END -0.064 edges)
M212_LINE_SIDE_a=geomGetEdge(M2 coincident M212_LINE_END_SHAPE)
M212_LINE_SIDE_b=geomGetEdge(M212_LINE_SIDE_a coincident M212_LINE_END)
M212_LINE_SIDE=geomAndNot(M212_LINE_SIDE_a M212_LINE_SIDE_b edges)
M212_LINE_END_EXP_a=geomStretch(M212_LINE_END 0.031)
M212_LINE_END_EXP=geomSize(M212_LINE_END_EXP_a -0.001 edges)
M212_LINE_SIDE_EXP_a=geomStretch(M212_LINE_SIDE 0.031)
M212_LINE_SIDE_EXP=geomSize(M212_LINE_SIDE_EXP_a -0.001 edges)
M212_LINE_END_1=geomGetEdge(M212_LINE_END_EXP coincident M212_LINE_END wholeEdge)
M212_LINE_SIDE_1=geomGetEdge(M212_LINE_SIDE_EXP coincident M212_LINE_SIDE wholeEdge)
M2E1=drc(M212_LINE_END_1 M2 sep<0.1 opposite with_perp edgea)
M2E2=drc(M212_LINE_SIDE_1 M2 sep<0.1 opposite with_perp edgea)
M212_LINE_END_E1=geomGetEdge(M212_LINE_END_1 coincident M2E1 wholeEdge)
M212_LINE_SIDE_E2=geomGetEdge(M212_LINE_SIDE_1 coincident M2E2 wholeEdge)
M2_CORNER=drc(M212_LINE_END_E1 M212_LINE_SIDE_E2 ovlp<=0.002 only_perp)
MOM=geomButtOrOver(geomOr(geomOr(M1 M2) M3) geomButtOrOver(MnPIN geomSize(MOMDMY 0.114)))
rule_M2_12=geomAndNot(geomOutside(geomButtOrOver(M212_LINE_END_SHAPE M2_CORNER) INST) geomOr(MOM MOMDMY))
errorLayer(rule_M2_12 "M2_12:Minimum Mn to Mn space S at Mn line-end 0.1. Width W < 0.1um.The minimum space can be line end head to other Mn or line end side to other M1.  Rule check:S >= (Dh or Ds ).E1 =0.03, K1=0.095 , Dh=Ds=0.1 in the illustration,Outside of SRAM(INST) area,Waive extrusion F < 0.07")


m38a=geomGetAngledEdge(M3 keep==45 fig)
L10715=drc(m38a width<0.17 opposite)
errorLayer(L10715 "M3_8: (M3 at 45) minimum width (run length > 0 um) >= 0.17")

L71995=drc(m38a sep<0.17 opposite)
errorLayer(L71995
    "M3_9: (M3 at 45 ) minimum space to parallel M3 (run length > 0 um) >= 0.17")

m3end1=geomGetLength(M3 keep>0.001)
m3end=geomSelectEdge(m3end1 length keep<=0.11 angle1(keep==90 length keep>=0.08) angle2(keep==90 length keep>=0.08))

m310a=geomOutside(drc(m3end M3 sep<0.07 opposite) INST)
errorLayer(m310a "M3_10a: Minimum space between an Mn line end to an Mn (the parallel run length >0um) is 0.07")

m310b1=drc(m3end M3 sep<0.07 opposite)
m310b2=geomOr(geomGetEdge(m3end coincident m310b1) geomGetEdge(m3end butting m310b1))
m310b3=drc(m310b2 V3 enc<0.05 opposite)
m310b4=drc(m310b2 V3 enc<0.03 opposite)
m310b5=geomButtOrOver(V3 m310b3)
m310b6=geomButtOrOver(V3 m310b4)
m310b7=geomAndNot(m310b5 m310b6)
m310b7=geomOutside(geomButtOnly(m310b1 geomButtOrOver(m310b3 m310b7)) INST)
errorLayer(m310b7 "M3_10b: Minimum space between an Mn line end (with Vn) to an Mn (the parallel run length >0um) is 0.07. The Mn line end extend Q from Vn, 0.03 <= Q <0.05um")

M3_LINE_END=geomLineEnd(M3 0.099 legs(0.08))
M3_X1=drc(M3_LINE_END V2 enc<0.05 opposite)
M3_X2=geomButtOrOver(V2 M3_X1)
M3_X3=geomInside(M3_X2 geomAnd(M3 M2))
M3_X8=geomOr(geomGetEdge( M3_X3 butting M3_X1 wholeEdge) geomGetEdge( M3_X3 coincident M3_X1 wholeEdge))
M3_LINE_END_SHAPE=geomSize(M3_LINE_END -0.095 edges)
M3_LINE_SIDE_a=geomOr( geomGetEdge(M3 butting M3_LINE_END_SHAPE) geomGetEdge(M3 coincident M3_LINE_END_SHAPE) edges)
M3_LINE_SIDE_b=geomOr( geomGetEdge(M3_LINE_SIDE_a butting M3_LINE_END) geomGetEdge(M3_LINE_SIDE_a coincident M3_LINE_END) edges)
M3_LINE_SIDE=geomAndNot(M3_LINE_SIDE_a M3_LINE_SIDE_b edges)
M3_LINE_SIDE1=drc(M3_LINE_SIDE M3_X3 enc<0.03 opposite)
M3_V2_EDGE_a=geomOr(M3_LINE_SIDE1 M3_X3) 
M3_V2_EDGE=geomOr( geomGetEdge(M3_V2_EDGE_a butting M3_X8 wholeEdge) geomGetEdge(M3_V2_EDGE_a coincident M3_X8 wholeEdge) edges)
M3_LINE_END_EXP_a=geomStretch(M3_V2_EDGE 0.031)
M3_LINE_END_EXP=geomSize(M3_LINE_END_EXP_a -0.001 edges)
M3_LINE_SIDE_EXP=geomSize(M3_LINE_SIDE -0.001 edges)
M3_LINE_END_1=geomOr( geomGetEdge(M3_LINE_END_EXP butting M3_V2_EDGE wholeEdge) geomGetEdge(M3_LINE_END_EXP coincident M3_V2_EDGE wholeEdge) edges)
M3_LINE_SIDE_1=geomOr( geomGetEdge(M3_LINE_SIDE_EXP butting M3_LINE_SIDE wholeEdge) geomGetEdge(M3_LINE_SIDE_EXP coincident M3_LINE_SIDE wholeEdge) edges)
M3_E1=drc(M3_LINE_END_1 M3 sep<0.12 opposite with_perp edgea)
M3_E2=drc(M3_LINE_SIDE_1 M3 sep<0.08 opposite with_perp edgea)
M3_LINE_END_E1=geomOr(geomGetEdge(M3_LINE_END_1 butting M3_E1 wholeEdge) geomGetEdge(M3_LINE_END_1 coincident M3_E1 wholeEdge) edges)
M3_LINE_SIDE_E2=geomOr(geomGetEdge(M3_LINE_SIDE_1 butting M3_E2 wholeEdge) geomGetEdge(M3_LINE_SIDE_1 coincident M3_E2 wholeEdge) edges)
M3_V42_a=geomOr( geomGetEdge(M3_X8 butting M3_LINE_END_E1 wholeEdge) geomGetEdge(M3_X8 coincident M3_LINE_END_E1 wholeEdge) edges)
M3_V42=geomWithEdge(M3_X3 M3_V42_a)
M3_X5=geomButtOrOver(V2 M3_V42)
M3_X6=geomAndNot(V2 M3_X5)
M3_X7=geomEnclose(geomEnclose( geomAnd(M3 M2) M3_X5) M3_X6)
M3_LINE_END_E1_a=geomSize(M3_LINE_END_E1 -0.001 edges)
M3_LINE_SIDE_E2_a=geomSize(M3_LINE_SIDE_E2 -0.001 edges)
M3_CORNER1=drc(M3_LINE_END_E1_a M3_LINE_SIDE_E2_a sep<=0.002 only_perp withIntersection)
M3_CORNER1_a=geomAnd(M3_LINE_END_E1_a M3_LINE_SIDE_E2_a)
M3_CORNER1_b=geomGetEdge(M3_CORNER1_a coincident M3_LINE_END_E1)
M3_CORNER1_c=geomGetEdge(M3_CORNER1_a coincident M3_LINE_SIDE_E2)
M3_CORNER1=geomWithEdge(geomWithEdge(M3_CORNER1_a M3_CORNER1_b) M3_CORNER1_c)
rule_M3_11=geomOutside(geomAvoiding(M3_CORNER1 M3_X7) INST)
errorLayer(rule_M3_11 "M3_11:Space between Vn-1,Vn-1 is enclosed by Mn[A] to neighbouring metal line Mn[B], when the layout structures meet the following conditions:Mn[A] line end definition: line width W <0.1um,Vn-1 enclosure by Mn[A] line end: E < 0.05um,The parallel run length of Mn[A] and Mn[B]:E1 >=-0.03um,Space between Mn[A] to the neighbouring parallel metal line: Ds<0.08um,Any one edge distance from the corner of the two edges of Mn[A]: K1 <0.095um,At least one Vn-1 in the Mn[A] and Mn-1 intersection meet this rule is ok,This rule is not applicable for SRAM region DRC check")

M312_LINE_END=geomLineEnd(M3 0.099 legs(0.07))
M312_LINE_END_SHAPE=geomSize(M312_LINE_END -0.064 edges)
M312_LINE_SIDE_a=geomGetEdge(M3 coincident M312_LINE_END_SHAPE)
M312_LINE_SIDE_b=geomGetEdge(M312_LINE_SIDE_a coincident M312_LINE_END)
M312_LINE_SIDE=geomAndNot(M312_LINE_SIDE_a M312_LINE_SIDE_b edges)
M312_LINE_END_EXP_a=geomStretch(M312_LINE_END 0.031)
M312_LINE_END_EXP=geomSize(M312_LINE_END_EXP_a -0.001 edges)
M312_LINE_SIDE_EXP_a=geomStretch(M312_LINE_SIDE 0.031)
M312_LINE_SIDE_EXP=geomSize(M312_LINE_SIDE_EXP_a -0.001 edges)
M312_LINE_END_1=geomGetEdge(M312_LINE_END_EXP coincident M312_LINE_END wholeEdge)
M312_LINE_SIDE_1=geomGetEdge(M312_LINE_SIDE_EXP coincident M312_LINE_SIDE wholeEdge)
M3E1=drc(M312_LINE_END_1 M3 sep<0.1 opposite with_perp edgea)
M3E2=drc(M312_LINE_SIDE_1 M3 sep<0.1 opposite with_perp edgea)
M312_LINE_END_E1=geomGetEdge(M312_LINE_END_1 coincident M3E1 wholeEdge)
M312_LINE_SIDE_E2=geomGetEdge(M312_LINE_SIDE_1 coincident M3E2 wholeEdge)
M3_CORNER=drc(M312_LINE_END_E1 M312_LINE_SIDE_E2 ovlp<=0.002 only_perp)
MOM_M3=geomButtOrOver(geomOr(geomOr(M2 M3) M4) geomButtOrOver(MnPIN geomSize(MOMDMY 0.114)))
rule_M3_12=geomAndNot(geomOutside(geomButtOrOver(M312_LINE_END_SHAPE M3_CORNER) INST) geomOr(MOM_M3 MOMDMY))
errorLayer(rule_M3_12 "M3_12:Minimum Mn to Mn space S at Mn line-end 0.1. Width W < 0.1um.The minimum space can be line end head to other Mn or line end side to other M1.  Rule check:S >= (Dh or Ds ).  E1 =0.03, K1=0.095 , Dh=Ds=0.1 in the illustration,Outside of SRAM(INST) area,Waive extrusion F < 0.07")

L19198=geomContactCheck(V1 width==0.070 length==0.070 ignore)
errorLayer(L19198 "V1_1: Fixed V1 size (square shape) == 0.070")

L60274=drc(V1 sepNotch<0.070)
errorLayer(L60274 "V1_2: V1 minimum space >= 0.070")

L36785=drc(V1i sep<0.1 diffNet opposite)
rule_V1_5=geomOutside(L36785 INST)
errorLayer(rule_V1_5
    "V1_5: V1 (different net) minimum space for run length > 0um >= 0.11")

rule_V1_5a_1=drc(V1i sep<0.09 diffNet)
errorLayer(rule_V1_5a_1 "V1_5a: V1 (different net) (outside of SRAM)  minimum space is 0.09um")

V1arry=geomSize(geomSize(geomSize(V1 0.05) -0.05) -0.05 downUp)
V1gap1=geomAndNot(V1arry M1)
V1gap2=geomAndNot(V1arry M2
)

v13a1=geomSize(geomSize(V1 0.05) -0.05)
v13a2=geomSize(v13a1 -0.17 downUp)
v13a3=geomButtOrOver(V1 v13a2)
v13a4a=drc(v13a3 sepNotch<0.09 opposite edge)
v13a4=geomGetLength(v13a4a keep>0)
v13a5=geomWithEdge(v13a3 v13a4 keep>=2)
errorLayer(v13a5
    "V1_3: Minimum space between V1s, when array equal to or greater than 3x3. Two Via areas whose space is within 0.11um are considered to be in the same array. An array does not have both row and column greater than 4 can apply smaller spacing V1_2 instead of V1_3")


L81057=geomContactCheck(V2 width==0.070 length==0.070 ignore)
errorLayer(L81057 "V2_1: V2 exact length and width == 0.070")

L77555=drc(V2 sepNotch<0.070 withIntersection withSingularPoint)
errorLayer(L77555 "V2_2: V2 minimum space >= 0.070")

L240=drc(V2i sep<0.1 diffNet opposite)
L241=geomOutside(L240 INST)
errorLayer(L241
    "V2_5: minimum space in different net for run length > 0um >= 0.11")

v25a1=drc(V2i sep<0.09 diffNet )
errorLayer(v25a1
    "V2_5a: minimum space in different net for run length > 0um >= 0.11")

v23a1=geomSize(geomSize(V2 0.05) -0.05)
v23a2=geomSize(v23a1 -0.17 downUp)
v23a3=geomButtOrOver(V2 v23a2)
v23a4a=drc(v23a3 sepNotch<0.09 opposite edge)
v23a4=geomGetLength(v23a4a keep>0)
v23a5=geomWithEdge(v23a3 v23a4 keep>=2)
errorLayer(v23a5
    "V2_3: Minimum space between V2s, when array equal to or greater than 3x3. Two Via areas whose space is within 0.10um are considered to be in the same array. An array does not have both row and column greater than 4 can apply smaller spacing V2_2 instead of V2_3")

L5360=geomAndNot(geomOutside(V1 INST) M1)
rule_V1_6a=geomCat(L5360 rule_V1_6)
errorLayer(rule_V1_6a
    "V1_6abc: At least one V1, per M1 and M2 intersection containing a V1, V1_6: V1 must be within M1,must meet rule V1_6a, V1_6b or V1_6c. V1 within M1 with width > 0.14um must meet rule V1_6a")


V1_in=geomAndNot(V1 geomOutside(V1 INST))
rule_srv16=drc(M1 V1_in venc( enc1<0.015 enc2<0 enc3<0.015 enc4<0 ))
errorLayer(rule_srv16 "SRV1_6ac:M1 minimum overlap past V1 for two opposite sides with the other two sides  0m is 0.015")

L5391=geomAndNot(V1 M2)
rule_V1_7a=geomCat(L5391 rule_V1_7)
errorLayer(rule_V1_7a
    "V1_7abc: At least one V1, per M1 and M2 intersection containing a V1, must meet rule V1_7a, V1_7b or V1_7c. V1 within M2 with width > 0.14um must meet rule V1_7a or V1_7d")

L28912=geomAndNot(V2 M2)
rule_V2_6a=geomCat(L28912 rule_V2_6)
errorLayer(rule_V2_6a
    "V2_6abc: At least one V2, per M2 and M3 intersection containing a V2, must meet rule V2_6a, V2_6b or V2_6c. V2 within M2 with width > 0.14um must meet rule V2_6a")

srv2_6=geomAndNot(V2 geomOutside(V2 INST))
srv2_6a=geomAndNot(srv2_6 geomInside(srv2_6 M2))
errorLayer(srv2_6a "SRV2_6:Vn minimum within Mn is 0.005,Mn minimum overlap past Vn for two opposite sides with the other two sides  0 is 0.008")

L28943=geomAndNot(V2 M3)
rule_V2_7a=geomCat(L28943 rule_V2_7)
errorLayer(rule_V2_7a
    "V2_7abc: At least one V2, per M2 and M3 intersection containing a V2, must meet rule V2_7a, V2_7b or V2_7c. V2 within M3 with width > 0.14um must meet rule V2_7a")

errorLayer(rule_V1_8
    "V1_8: At least two V1 vias must connect M1 to M2 when the M1 or M2 width is > 0.26um")

errorLayer(rule_V2_8
    "V2_8: At least two V2 vias must connect M2 to M3 when the M2 or M3 width is > 0.26um")

errorLayer(rule_V1_9
    "V1_9: At least three V1 vias must connect M1 to M2 when the M1 or M2 width is > 0.52um")

errorLayer(rule_V2_9
    "V2_9: At least three V2 vias must connect M2 to M3 when the M2 or M3 width is > 0.52um")


errorLayer(rule_V1_10
    "V1_10: At least four V1 vias must connect M1 to M2 when the M1 or M2 width is > 0.645um")


V1_square=geomGetRectangle(V1 aspectRatio==1)
v1_empty=geomOr(EMPTY geomInside(V1 geomAnd(M1 M2)))
v1_inter_empty=geomOr(EMPTY geomAnd(M1 M2))
v1_16x1a=geomWidth(M1 keep>0.24)
v1_16x1b=geomWidth(M2 keep>0.24)
v1_16wide=geomOr(v1_16x1a v1_16x1b)
v1_empty1=geomInside(v1_empty v1_16wide)
geomConnect(
incremental
    buttOrOver( v1_empty v1_inter_empty )
    buttOrOver( v1_empty1 v1_inter_empty )
)

v1_16x2=geomEnclose(geomAnd(M1 M2) V1)
v1_16x3=geomInside(V1 v1_16x2)
v1_16x5c=drc(v1_empty1 v1_empty sep<=0.16 withIntersection sameNet)
v1_16x6c=geomEnclose(v1_16x2 v1_16x5c)
v1_16x7=geomEnclose(geomAnd(geomSize(v1_16x3 0.325) v1_16x2) V1 keep>2)
v1_16x7c=geomEnclose(v1_16x2 v1_16x7)
v1_16x=geomEnclose(geomAndNot(geomAndNot(v1_16x2 v1_16x6c) v1_16x7c) geomInside(V1 v1_16wide))
v1_16all=geomOutside(v1_16x INST)
errorLayer(v1_16all "V1_16:At least two V1s with space <=0.16um when one of  M1 or M2 with both length and width  >0.24um")
/*
v1_17x1a=geomWidth(M1 keep>0.24)
v1_17x1b=geomWidth(M2 keep>0.24)
v1_17wide=geomOr(v1_17x1a v1_17x1b)
v1_17x2=geomEnclose(geomAnd(M1 M2) V1)
v1_17x3=geomInside(V1 v1_17x2)
v1_17x5c=drc(geomButtOrOver(v1_17x3 v1_17wide) v1_17x3 sep<=0.16 withIntersection opposite)
v1_17x6c=geomEnclose(v1_17x2 v1_17x5c)
v1_17x4a=drc(v1_17x1a geomInside(v1_17x3 geomButtOrOver(M1 v1_17x1a)) sep<1.1 withIntersection opposite shielded)
v1_17x4b=drc(v1_17x1b geomInside(v1_17x3 geomButtOrOver(M2 v1_17x1b)) sep<1.1 withIntersection opposite shielded)
v1_17x7a=geomWithEdge(geomButtOrOver(v1_17x4a geomButtOrOver(M1 v1_17x1a)) geomGetLength(v1_17x1a keep>0))
v1_17x7b=geomWithEdge(geomButtOrOver(v1_17x4b geomButtOrOver(M2 v1_17x1b)) geomGetLength(v1_17x1b keep>0))
v1_17x7=geomOr(v1_17x7a v1_17x7b)
v1_17x5a=drc(geomInside(v1_17x3 geomButtOrOver(M1 v1_17x1a)) geomButtOrOver(v1_17x3 v1_17x7) sep<=0.16 withIntersection opposite)
v1_17x5b=drc(geomInside(v1_17x3 geomButtOrOver(M2 v1_17x1b)) geomButtOrOver(v1_17x3 v1_17x7) sep<=0.16 withIntersection opposite)
v1_17x5=geomOr(v1_17x5a v1_17x5b)
v1_17x6=geomEnclose(v1_17x2 v1_17x5)
v1_17x8=geomButtOnly(v1_17x7 geomAndNot(V1 geomWithEdge(V1 geomGetEdge(geomInside(V1 v1_17x2) coincident v1_17wide wholeEdge))))
v1_17all1=geomAndNot(geomButtOrOver(geomInside(geomAndNot(v1_17x2 v1_17x6) geomButtOrOver(M1 v1_17x1a)) v1_17x8) v1_17x6c)
v1_17all2=geomAndNot(geomButtOrOver(geomInside(geomAndNot(v1_17x2 v1_17x6) geomButtOrOver(M2 v1_17x1b)) v1_17x8) v1_17x6c)
v1_17all=geomCat(v1_17all1 v1_17all2)
errorLayer(v1_17all "V1_17:At least two V1s with space S1<=0.16um when either wide metal of M1 or M2 with both length L>0.24um and width W>0.24um, and the distance D<=1.1um away from this wide metal")
*/

WM1=geomWidth(M1 keep>0.24)
wm1_edge=geomGetLength(WM1 keep>0)
wm1_exp=geomSize(wm1_edge 1.1 edges)
v1_a=geomButtOrOver(V1_square wm1_exp)
geomConnect(
 incremental
 buttOrOver(v1_a M1)
 buttOrOver(WM1 M1)
)

WM2=geomWidth(M2 keep>0.24)
wm2_edge=geomGetLength(WM2 keep>0)
wm2_exp=geomSize(wm2_edge 1.1 edges)
wm2_l1=geomButtOnly(geomAndNot(M2 WM2) WM2)
v1_a2=geomButtOrOver(V1_square wm2_exp)
geomConnect(
 incremental
 buttOrOver(v1_a2 M2)
 buttOrOver(WM2 M2)
)

wm1_l1=geomButtOnly(geomAndNot(M1 WM1) WM1)
wm1_ext=drc(WM1 v1_a sep<1.1 0<=withIntersection<90 opposite sameNet edgeb)
v1_b=geomWithEdge(V1_square wm1_ext)
v1bx1=geomEnclose(geomAnd(M1 M2) V1_square keep>1)
v1sing1=geomButtOrOver(geomAndNot(geomAnd(geomAnd(M1 M2) geomAnd(wm1_l1 wm1_exp)) v1bx1) v1_b keep==1)
v1singall1=geomOutside(v1sing1 INST)

wm2_ext=drc(WM2 v1_a2 sep<1.1 0<=withIntersection<90 opposite sameNet edgeb)
v1_b2=geomWithEdge(V1_square wm2_ext)
v1sing2=geomButtOrOver(geomAndNot(geomAnd(geomAnd(M1 M2) geomAnd(wm2_l1 wm2_exp)) v1bx1) v1_b2 keep==1)
v1singall2=geomOutside(v1sing2 INST)
v1_17all=geomCat(v1singall1 v1singall2)
errorLayer(v1_17all "V1_17:At least two V1s with space S1<=0.16um when either wide metal of M1 or M2 with both length L>0.24um and width W>0.24um, and the distance D<=1.1um away from this wide metal")

errorLayer(rule_V2_10
    "V2_10: At least four V2 vias must connect M2 to M3 when the M2 or M3 width is > 0.645um")

V2_square=geomGetRectangle(V2 aspectRatio==1)
v2_empty=geomOr(EMPTY geomInside(V2_square geomAnd(M2 M3)))
v2_inter_empty=geomOr(EMPTY geomAnd(M2 M3))
v2_16x1a=geomWidth(M2 keep>0.24)
v2_16x1b=geomWidth(M3 keep>0.24)
v2_16wide=geomOr(v2_16x1a v2_16x1b)
v2_empty1=geomInside(v2_empty v2_16wide)
geomConnect(
incremental
    buttOrOver( v2_empty v2_inter_empty )
    buttOrOver( v2_empty1 v2_inter_empty )
)

v2_16x2=geomEnclose(geomAnd(M2 M3) V2_square)
v2_16x3=geomInside(V2_square v2_16x2)
v2_16x5c=drc(v2_empty1 v2_empty sep<=0.16 withIntersection sameNet)
v2_16x6c=geomEnclose(v2_16x2 v2_16x5c)
v2_16x7=geomEnclose(geomAnd(geomSize(v2_16x3 0.325) v2_16x2) V2 keep>2)
v2_16x7c=geomEnclose(v2_16x2 v2_16x7)
v2_16x=geomEnclose(geomAndNot(geomAndNot(v2_16x2 v2_16x6c) v2_16x7c) geomInside(V2_square v2_16wide))
v2_16all=geomOutside(v2_16x INST)
errorLayer(v2_16all "V2_16:At least two V2s with space <=0.16um when one of  M2 or M3 with both length and width  >0.24um")

/*
v2_17x1a=geomWidth(M2 keep>0.24)
v2_17x1b=geomWidth(M3 keep>0.24)
v2_17wide=geomOr(v2_17x1a v2_17x1b)
v2_17x2=geomEnclose(geomAnd(M2 M3) V2_square)
v2_17x3=geomInside(V2_square v2_17x2)
v2_17x5c=drc(geomButtOrOver(v2_17x3 v2_17wide) v2_17x3 sep<=0.16 withIntersection opposite)
v2_17x6c=geomEnclose(v2_17x2 v2_17x5c)
v2_17x4a=drc(v2_17x1a geomInside(v2_17x3 geomButtOrOver(M2 v2_17x1a)) sep<1.1 withIntersection opposite shielded)
v2_17x4b=drc(v2_17x1b geomInside(v2_17x3 geomButtOrOver(M3 v2_17x1b)) sep<1.1 withIntersection opposite shielded)
v2_17x7a=geomWithEdge(geomButtOrOver(v2_17x4a geomButtOrOver(M2 v2_17x1a)) geomGetLength(v2_17x1a keep>0))
v2_17x7b=geomWithEdge(geomButtOrOver(v2_17x4b geomButtOrOver(M3 v2_17x1b)) geomGetLength(v2_17x1b keep>0))
v2_17x7=geomOr(v2_17x7a v2_17x7b)
v2_17x5a=drc(geomInside(v2_17x3 geomButtOrOver(M2 v2_17x1a)) geomButtOrOver(v2_17x3 v2_17x7) sep<=0.16 withIntersection opposite)
v2_17x5b=drc(geomInside(v2_17x3 geomButtOrOver(M3 v2_17x1b)) geomButtOrOver(v2_17x3 v2_17x7) sep<=0.16 withIntersection opposite)
v2_17x5=geomOr(v2_17x5a v2_17x5b)
v2_17x6=geomEnclose(v2_17x2 v2_17x5)
v2_17x8=geomButtOnly(v2_17x7 geomAndNot(V2_square geomWithEdge(V2_square geomGetEdge(geomInside(V2_square v2_17x2) coincident v2_17wide wholeEdge))))
v2_17all1=geomAndNot(geomButtOrOver(geomInside(geomAndNot(v2_17x2 v2_17x6) geomButtOrOver(M2 v2_17x1a)) v2_17x8) v2_17x6c)
v2_17all2=geomAndNot(geomButtOrOver(geomInside(geomAndNot(v2_17x2 v2_17x6) geomButtOrOver(M3 v2_17x1b)) v2_17x8) v2_17x6c)
v2_17all=geomCat(v2_17all1 v2_17all2)
errorLayer(v2_17all "V2_17:At least two Vns with space S1<=0.14um when either wide metal of Mn or Mn+1 with both length L>0.24um and width W>0.24um, and the distance D<=1.2um away from this wide metal")
*/

v2_a=geomButtOrOver(V2_square wm2_exp)
geomConnect(
 incremental
 buttOrOver(V2 M2)
 buttOrOver(v2_a M2)
 buttOrOver(WM2 M2)
)

WM3=geomWidth(M3 keep>0.24)
wm3_edge=geomGetLength(WM3 keep>0)
wm3_exp=geomSize(wm3_edge 1.1 edges)
wm3_l1=geomButtOnly(geomAndNot(M3 WM3) WM3)
v2_a2=geomButtOrOver(V2_square wm3_exp)
geomConnect(
  incremental
  buttOrOver(v2_a2 M3)
  buttOrOver(WM3 M3)
)

wm2_ext=drc(WM2 v2_a sep<1.1 0<=withIntersection<90 opposite sameNet edgeb)
v2_b=geomWithEdge(V2_square wm2_ext)
v2bx1=geomEnclose(geomAnd(M2 M3) V2_square keep>1)
v2sing1=geomButtOrOver(geomAndNot(geomAnd(geomAnd(M2 M3) geomAnd(wm2_l1 wm2_exp)) v2bx1) v2_b keep==1)
v2singall1=geomOutside(v2sing1 INST)

wm3_ext=drc(WM3 v2_a2 sep<1.1 0<=withIntersection<90 opposite sameNet edgeb)
v2_b2=geomWithEdge(V2_square wm3_ext)
v2sing2=geomButtOrOver(geomAndNot(geomAnd(geomAnd(M2 M3) geomAnd(wm3_l1 wm3_exp)) v2bx1) v2_b2 keep==1)
v2singall2=geomOutside(v2sing2 INST)
v2_17all=geomCat(v2singall1 v2singall2)
errorLayer(v2_17all "V2_17:At least two V2s with space S1<=0.16um when either wide metal of M2 or M3 with both length L>0.24um and width W>0.24um, and the distance D<=1.1um away from this wide metal")


L78773=geomContactCheck(TV2 width==0.36 length==0.36 ignore)
errorLayer(L78773 "TV2_1: Fixed TV2 size (square shape) == 0.360")

L13753=drc(TV2 sepNotch<0.34 withIntersection withSingularPoint)
errorLayer(L13753 "TV2_2: Space between two TV2 >= 0.340")

L94059=drc(tv2_in_array sepNotch<0.5 withIntersection withSingularPoint)
errorLayer(L94059
    "TV2_3: Space between two tv2_in_array regions in case tv2_in_array array is larger than or equal to 3x3. Two Via areas whose space is within 0.5um are considered to be in the same array. An array does not have both row and column greater than 3 can apply smaller spacing TV2_2 instead of TV2_3")
if( avSwitch("UTM_NO")  then
L98237=drc(TM2 width<0.400)
errorLayer(L98237 "TM2_1: TM2 width >= 0.400")

L66388=geomWidth(TM2 keep>12)
tm212=geomAvoiding(L66388 MD)
errorLayer(tm212 "TM2_12: TM2 maximum width <= 12")

L24379=drc(TM2 sepNotch<0.400 withIntersection withSingularPoint)
errorLayer(L24379 "TM2_2: Space between two TM2 >= 0.400")

L20552=drc(TM2 area<0.56)
errorLayer(L20552 "TM2_8: TM2 area (um^2) >= 0.560")

 tm2_3_4a=geomAndNot(TV2 TM2)
  tm2_3_4b=drc(TM2 TV2 venc(enc1<0.02 enc2<0.03 enc3<0.02 enc4<0.03))
    errorLayer(geomOr(tm2_3_4a tm2_3_4b)
        "TM2_3_4_TV2_7: TV1 enclosure by TM2 >= 0.020, Extension of TM2 line end outside of TV2 >= 0.030")

L78657=geomHoles(TM2 innermost)
L27403=geomAndNot(L78657 TM2)
L20393=drc(L27403 area<0.8)
errorLayer(L20393 "TM2_9: Dielectric area enclosed by TM2 (um^2) >= 0.800")


     TM56(TM2i 1.5 2.0 0.5)
     errorLayer(tms
    "TM2_5: Minimum space between two length > 1.500um parallel TM2 lines with one or both metal line width is > 2.000um >= 0.500")


     TM56(TM2i 4.5 4.5 1.2)
     errorLayer(tms
    "TM2_7: Minimum space between two length >= 1.5um parallel TM2 lines with one metal line width is > 2.000um and other meral line width is > 4.000um >= 1.200")
)

L63567=drc(ALPA_ALL width<2.000)
errorLayer(L63567 "ALPA_1: ALPA minimum width >= 2.000")

L56817=drc(ALPA_ALL sepNotch<2.000 withIntersection<89.9 withSingularPoint)
errorLayer(L56817 "ALPA_2: ALPA minimum space >= 2.000")

L93543=geomAndNot(drc(ALRDL LOGO sep<10.000 withIntersection withSingularPoint) MARKG)
errorLayer(L93543
    "ALPA_7: Minimum space between ALRDL and Lmark window >= 10.000")

if( !avSwitch("BUMPING_NO") then

L33432a=drc(ALRDL ALPad sep<10 0<withIntersection<90 withSingularPoint)
L33432=geomAndNot(L33432a MARKG )
errorLayer(L33432
    "ALPA_11: Minimum space between ALRDL and Alpa pad for bumping process >= 10.000")
);end BUMPING_NO
DRC_1=geomBkgnd()
alpa12a=geomAvoiding(DRC_1 ALPA_ALL)
errorLayer(alpa12a "ALPA_12:ALPA must be drawn layer")

L93144=geomAndNot(drc(PA width<2) MARKG)
errorLayer(L93144 "PA_1: PA minum size (square) >= 2.000")

L40835=geomAndNot(drc(PA sepNotch<2 withIntersection withSingularPoint) MARKG)
errorLayer(L40835 "PA_2: Minimum space between two PAs >= 2.000")

pa03b=geomButtOrOver(PA ALPA)
pa03c=geomAndNot(geomOr(geomAndNot(pa03b ALPA) drc(ALPA pa03b enc<0.5 withIntersection withSingularPoint)) MARKG)
errorLayer(pa03c "PA_3: PA enclosured by Alpa > 0.5")

;L80388=geomStraddle(PA TM2)
;L69393=geomAndNot(L80388 TM2)
;errorLayer(L69393 "PA_4: PA enclosured by TM2 == 0.500")
if( avSwitch("UTM_NO")  then
pa4a  = geomGetEdge( geomAndNot( PA MARKG ) outside TM2 )
errorLayer( pa4a "PA_4: PA enclosured by TM2 > 0.500")
L90327=drc(TM2 PA enc<0.5 withIntersection withSingularPoint)
errorLayer(L90327 "PA_4: PA enclosured by TM2 > 0.500")
)

if( avSwitch("UTM_YES")  then
pa4a  = geomGetEdge( geomAndNot( PA MARKG ) outside MTT2 )
errorLayer( pa4a "PA_4: PA enclosured by MTT2 > 0.500")
L90327=drc(MTT2 PA enc<0.5 withIntersection withSingularPoint)
errorLayer(L90327 "PA_4: PA enclosured by MTT2 > 0.500")
)

L60334a=geomAndNot(PA ALPA)
L60334=geomAndNot(L60334a MARKG)
errorLayer(L60334
    "PA_10: PA opening landing on TM2(highest top copper metal layer), this PA without ALPA above it is not allowed.")

L21644=geomAndNot(MD ALPA)
errorLayer(L21644 "MD_1: MD (PA2) enclosured by Alpa is 1.000")
L32997=drc(ALPA MD enc<1 withIntersection withSingularPoint)
errorLayer(L32997 "MD_1: MD (PA2) enclosured by Alpa is 1.000")

L45242=drc(MD width<14)
errorLayer(L45242 "MD_2: MD (PA2) minimum width >= 14.000")

L73857=drc(MD sepNotch<6 withIntersection withSingularPoint)
errorLayer(L73857 "MD_3: MD (PA2) minimum space >= 6.000")
if( !avSwitch("Recommended_rules_check")  then
L62940=geomAndNot(MD BORDER)
errorLayer(L62940 "MD_4_R: MD (PA2) must be within BORDER (CHIPEDGE) == 8.000")
L42011=drc(BORDER MD enc<8 withIntersection withSingularPoint)
errorLayer(L42011 "MD_4_R: MD (PA2) must be within BORDER (CHIPEDGE) == 8.000")
);end Recommended_rules_check
L12986=drc(MD PA sep<1.7 withSingularPoint shielded) 
errorLayer(L12986
    "MD_5: MD (PA2) minimum space to PA, if MD not touch with PA >= 1.700")
if( !avSwitch("Recommended_rules_check")  then
rule_MD6_1=geomSize(BORDER_all -1.0)
rule_MD6_2=geomSize(BORDER_all -199.001)
;rule_MD6=geomGetEdge(MD over rule_MD6_2)
rule_MD6=geomAnd(rule_MD6_2 MD)
errorLayer(rule_MD6
    "MD_6_R: MD (PA2) wire-bond pad opening maximum to BORDER (CHIPEDGE) <= 200.000")
);end Recommended_rules_check

L39184=geomAnd(INDMY MD)
errorLayer(L39184
    "MD_8: Inductor is prohibited over MD (PA2) wire-bond pad opening")

DRC_1=geomBkgnd()
md10a=geomAvoiding(DRC_1 geomAndNot(MD MARKG))
errorLayer(md10a "MD_10:MD (passivation 2) must be a drawn layer")

;L16669=geomAnd(MD rule_PA_10)
MD_11a = geomButtOrOver( PA MD )
MD_11  = drc( MD_11a width < 3 )
errorLayer(MD_11
    "MD_11: MD(PA2) is prohibited to overlap or touch with rule_PA_10(rule_PA_10 size <=3um)")


if( !avSwitch("CUSTOMER_DUMMY_CHECKS") then
errorLayer(rule_AADUMC11 "DUMC_11: Dummy AA should not be larger than 20x20um")

dumc1a=drc(AADUM width<0.06)
dumc1b=drc(AADUM sepNotch<0.08 withIntersection withSingularPoint)
errorLayer(geomOr(dumc1a dumc1b) "DUMC_1:Dummy AA should comply with AA_1, AA_4a rules,Min Dummy AA width is 0.06 (AA_1),Min Dummy AA space is 0.08 (AA_4a)")

errorLayer(rule_AADUMC2
    "DUMC_2: Dummy AA must not touch (AA, GT, GTFUSE, LOGO, PTCT, AAING, RESNW).")

errorLayer(rule_AADUMC10 "DUMC_10: Dummy AA cannot insert at RESNW area")

errorLayer(rule_AADUMC12
    "DUMC_12: Dummy GT must not touch (GT, AA,LOGO, PTCT, MARKG, RESAA, RESNW, DIFRES)")

L68185=geomStraddle(AADUM NW)
errorLayer(L68185
    "DUMC_3: Dummy AA cannot straddle N-Well boundaries. Dummy AA space to NW.>= 0.260")
L81225=drc(AADUM NW sep<0.26 withIntersection withSingularPoint)
errorLayer(L81225
    "DUMC_8: Dummy AA cannot straddle N-Well boundaries. Dummy AA space to NW.>= 0.260")

L13683=drc(GTDUM sepNotch<0.11 withIntersection withSingularPoint)
errorLayer(L13683 "DUMC_14: Dummy GT minimum space >=0.110")

L28111=drc(GTDUM width<0.044)
errorLayer(L28111 "DUMC_13: Dummy GT minimum width >=0.044")

L99358=drc(AA AADUM sep<0.71 withIntersection withSingularPoint)
errorLayer(L99358 "DUMC_5: Dummy AA space to AA >=0.710")

L73515=drc(GTDUM geomButtOrOver(GT AA) sep<0.15 withIntersection withSingularPoint)
errorLayer(L73515 "DUMC_15: Dummy GT space to GT on AA. >=0.150")

L1=drc(GTDUM AA sep<0.22 withIntersection withSingularPoint)
L3=drc(GTDUM LOGO sep<0.22 withIntersection withSingularPoint)
L4=drc(GTDUM PTCT sep<0.22 withIntersection withSingularPoint)
L5=drc(GTDUM DIFRES sep<0.22 withIntersection withSingularPoint)
L7=drc(GTDUM HRPDMY sep<0.22 withIntersection withSingularPoint)
L8=drc(GTDUM MARKG sep<0.22 withIntersection withSingularPoint)
L9=drc(GTDUM RESAA sep<0.22 withIntersection withSingularPoint)
L10=drc(GTDUM RESNW sep<0.22 withIntersection withSingularPoint)
L11 = geomCat( L1 L3 L4 L5 L7 L8 L9 L10 )
errorLayer(L11 "DUMC_16: Dummy GT space to(AA, LOGO, PTCT, MARKG, RESAA, RESNW, DIFRES, HRPDMY) >=0.220")

L10114=drc(GTDUM GTFUSE sep<3.33 withIntersection withSingularPoint)
errorLayer(L10114 "DUMC_17: Dummy GT space to GTFUSE. >=3.330")

L27632=drc(AADUM L11119 sep<0.22 withIntersection withSingularPoint)
errorLayer(L27632 "DUMC_6:Dummy AA space to (GT, LOGO, PTCT, MARKG, RESP1, RESNW,  PLRES, HRPDMY) >=0.220")

L10829=drc(AA GTDUM sep<0.033 withIntersection withSingularPoint)
errorLayer(L10829 "DUMC_16a: Dummy GT space to AA >=0.033")

L49523=drc(AADUM GTFUSE sep<3.330 withIntersection withSingularPoint)
errorLayer(L49523 "DUMC_7: Dummy AA space to GTFUSE. >=3.330")

;L93245=geomStraddle(AADUM DNW)
;L2045=geomStraddle(DNW AADUM)
;L73094=geomAnd(L2045 L93245)
;errorLayer(L73094 "DUMC_9: Dummy AA space to DNW.>= 0.260")
;L6945=drc(AADUM DNW sep<0.26)
;errorLayer(L6945 "DUMC_9: Dummy AA space to DNW.>= 0.260")

L8822=drc(GTDUM geomAvoiding(GT AA) sep<0.110 withIntersection withSingularPoint)
errorLayer(L8822 "DUMC_15a: Dummy GT space to GT on field OX >= 0.110")

L28061=drc(GTFUSE MnDUM_metal1 sep<3.33 withIntersection withSingularPoint)
errorLayer(L28061
    "DUMC_19: Mx Dummy space to GTFUSE with touching prohibited, where Mx=M1, M2. >=3.330")

L23298=drc(GTFUSE MnDUM_metal2 sep<3.33 withIntersection withSingularPoint)
errorLayer(L23298
    "DUMC_19: Mx Dummy space to GTFUSE with touching prohibited, where Mx=M1, M2. >=3.330")

L60623=drc(MnDUB_metal1  MnDUM_metal1 sep<0.6 withIntersection withSingularPoint)
errorLayer(L60623
    "DUMC_20: Mx Dummy space to (MxDUB, DUMBM, LOGO, PTCT), where Mx=M1-M8. >=0.60")

L62467=drc(DUPL MnDUM_metal1 sep<0.6 withIntersection withSingularPoint)
errorLayer(L62467
    "DUMC_20: Mx Dummy space to (MxDUB, DUMBM, LOGO, PTCT), where Mx=M1-M8. >=0.60")

L97489=drc(MnDUB_metal2 MnDUM_metal2 sep<0.6 withIntersection withSingularPoint)
errorLayer(L97489
    "DUMC_20: Mx Dummy space to (MxDUB, DUMBM, LOGO, PTCT), where Mx=M1-M8. >=0.60")

L53470=drc(DUPL MnDUM_metal2 sep<0.6 withIntersection withSingularPoint)
errorLayer(L53470
    "DUMC_20: Mx Dummy space to (MxDUB, DUMBM, LOGO, PTCT), where Mx=M1-M8. >=0.60")

L11695=drc(MnDUB_metal3 MnDUM_metal3 sep<0.6 withIntersection withSingularPoint)
errorLayer(L11695
    "DUMC_20: Mx Dummy space to (MxDUB, DUMBM, LOGO, PTCT), where Mx=M1-M8. >=0.60")

L97889=drc(DUPL MnDUM_metal3 sep<0.6 withIntersection withSingularPoint)
errorLayer(L97889
    "DUMC_20: Mx Dummy space to (MxDUB, DUMBM, LOGO, PTCT), where Mx=M1-M8. >=0.60")

errorLayer(rule_M1DUMC18
    "DUMC_18: Mx Dummy must not touch (Mx, LOGO, PTCT), where Mx=M1-M8,TM1, TM2.")

errorLayer(rule_M2DUMC18
    "DUMC_18: Mx Dummy must not touch (Mx, LOGO, PTCT), where Mx=M1-M8,TM1, TM2.")

errorLayer(rule_M3DUMC18
    "DUMC_18: Mx Dummy must not touch (Mx, LOGO, PTCT), where Mx=M1-M8,TM1, TM2.")

errorLayer(rule_TM2DUMC18
    "DUMC_18: Mx Dummy must not touch (Mx, LOGO, PTCT), where Mx=M1-M8,TM1, TM2.")

errorLayer(rule_TTM2DUMC18
    "DUMC_18: Mx Dummy must not touch (Mx, LOGO, PTCT), where Mx=M1-M8,TM1, TM2.")

 errorLayer(rule_TM1DUMC18
        "DUMC_18: Mx Dummy must not touch (Mx, LOGO, PTCT), where Mx=M1-M8,TM1, TM2.")

    L21064=geomAndNot(MnDUM_topmetal1a BORDER_all)
    errorLayer(L21064
        "DUMC_31: xx Dummy must be within BORDER, where xx=all metal and via levels")

errorLayer(rule_MxDUMC19
    "DUMC_19: Mx Dummy space to GTFUSE with touching prohibited, where Mx=M1, M2.")

L39428=drc(geomAvoiding(MnDUM_metal1 INDMY) M1 sep<0.6 withIntersection withSingularPoint)
errorLayer(L39428 "DUMC_21_M1: M1 Dummy space to M1, where Mx=M1-M8. >= 0.60")

L81316=drc(geomAvoiding(MnDUM_metal2 INDMY) M2 sep<0.6 withIntersection withSingularPoint)
errorLayer(L81316 "DUMC_21_M2: M2 Dummy space to M2, where Mx=M1-M8. >= 0.60")

L76796=drc(geomAvoiding(MnDUM_metal3 INDMY) M3 sep<0.6 withIntersection withSingularPoint)
errorLayer(L76796 "DUMC_21_M3: M3 Dummy space to M3, where Mx=M1-M8. >= 0.60")

dumc21am1=drc(M1 geomButtOrOver(MnDUM_metal1 INDMY) sep<0.53 withIntersection withSingularPoint)
errorLayer(dumc21am1 "DUMC_21a_M1:Mx Dummy space to Mx (when Mx Dummy touching INDMY), where Mx=M1-M8_0.53")

dumc21am2=drc(M2 geomButtOrOver(MnDUM_metal2 INDMY) sep<0.53 withIntersection withSingularPoint)
errorLayer(dumc21am2 "DUMC_21a_M2:Mx Dummy space to Mx (when Mx Dummy touching INDMY), where Mx=M1-M8_0.53")

dumc21am3=drc(M3 geomButtOrOver(MnDUM_metal3 INDMY) sep<0.53 withIntersection withSingularPoint)
errorLayer(dumc21am3 "DUMC_21a_M3:Mx Dummy space to Mx (when Mx Dummy touching INDMY), where Mx=M1-M8_0.53")

dumc21am4=drc(M4 geomButtOrOver(MnDUM_metal4 INDMY) sep<0.53 withIntersection withSingularPoint)
errorLayer(dumc21am4 "DUMC_21a_M4:Mx Dummy space to Mx (when Mx Dummy touching INDMY), where Mx=M1-M8_0.53")

dumc21am5=drc(M5 geomButtOrOver(MnDUM_metal5 INDMY) sep<0.53 withIntersection withSingularPoint)
errorLayer(dumc21am5 "DUMC_21a_M5:Mx Dummy space to Mx (when Mx Dummy touching INDMY), where Mx=M1-M8_0.53")

dumc21am6=drc(M6 geomButtOrOver(MnDUM_metal6 INDMY) sep<0.53 withIntersection withSingularPoint)
errorLayer(dumc21am6 "DUMC_21a_M6:Mx Dummy space to Mx (when Mx Dummy touching INDMY), where Mx=M1-M8_0.53")

dumc21am7=drc(M7 geomButtOrOver(MnDUM_metal7 INDMY) sep<0.53 withIntersection withSingularPoint)
errorLayer(dumc21am7 "DUMC_21a_M7:Mx Dummy space to Mx (when Mx Dummy touching INDMY), where Mx=M1-M8_0.53")

dumc21am8=drc(M8 geomButtOrOver(MnDUM_metal8 INDMY) sep<0.53 withIntersection withSingularPoint)
errorLayer(dumc21am8 "DUMC_21a_M8:Mx Dummy space to Mx (when Mx Dummy touching INDMY), where Mx=M1-M8_0.53")

L34093=geomContactCheck(VnDUM_via1 width==.07 length==.07 ignore)
L34094=geomContactCheck(VnDUM_via1 width==.077 length==.077 )
errorLayer(geomAndNot(L34093 L34094)
    "DUMC_23_24_V1: Vx Dummy exact width, where Vx=V1-V7 ==0.070 or 0.077. Vx Dummy must be square.")

L97058=geomAnd(MIM MnDUM_metal2)
errorLayer(L97058
    "DUMC_38: Dummy metal should not be next layer to MIM. Next Layer: means upper or lower metal layer.")

m1d_and_m2d=geomAnd(MnDUM_metal1 MnDUM_metal2)
v1dm1d=drc(m1d_and_m2d VnDUM_via1 enc<0.06 withIntersection withSingularPoint)
L8471=geomAndNot(VnDUM_via1 m1d_and_m2d)
errorLayer(geomCat(v1dm1d L8471)
    "DUMC_25_a_b_V1: Vx Dummy must be within Mx Dummy, where Vx=V1-V7 and Mx= metal level below Vx. >= 0.030")

m2d_and_m3d=geomAnd(MnDUM_metal2 MnDUM_metal3)
v2dm1d=drc(m2d_and_m3d VnDUM_via2 enc<0.06 withIntersection withSingularPoint)
L8472=geomAndNot(VnDUM_via2 m2d_and_m3d)
errorLayer(geomCat(v2dm1d L8472)
    "DUMC_25_a_b_V2: Vx Dummy must be within Mx Dummy, where Vx=V1-V7 and Mx= metal level below Vx. >= 0.030")


L94765=geomAnd(MOMDMY MnDUM_metal1)
errorLayer(L94765 "DUMC_39: Dummy metal must not be in MOM area")

L97089=geomAnd(MIM MnDUM_metal1)
errorLayer(L97089
    "DUMC_38: Dummy metal should not be next layer to MIM. Next Layer: means upper or lower metal layer.")

L29362=geomContactCheck(VnDUM_via2 width==.07 length==.07 ignore)
L29363=geomContactCheck(VnDUM_via2 width==.077 length==.077)
errorLayer(geomAndNot(L29362 L29363)
    "DUMC_23_24_V2: Vx Dummy exact width, where Vx=V1-V7 ==0.070 or 0.077. Vx Dummy must be square.")

L97027=geomAnd(MIM MnDUM_metal3)
errorLayer(L97027
    "DUMC_38: Dummy metal should not be next layer to MIM. Next Layer: means upper or lower metal layer.")

L94796=geomAnd(MOMDMY MnDUM_metal2)
errorLayer(L94796 "DUMC_39: Dummy metal must not be in MOM area")

L94827=geomAnd(MOMDMY MnDUM_metal3)
errorLayer(L94827 "DUMC_39: Dummy metal must not be in MOM area")

LPI=geomOr(geomOr(geomOr(LOGO PTCT) INDMY) MARKG)
    dumc22v1=geomButtOrOver(VnDUM_via1 geomOr(geomOr(V1 LPI) geomOr(M1 M2)))
    errorLayer(dumc22v1
     "DUMC_22_V1: Vx Dummy must not touch (Vx, LOGO, PTCT, INDMY ),where Vx=V1-V7.")

LPI=geomOr(geomOr(geomOr(LOGO PTCT) INDMY) MARKG)
    dumc22v2=geomButtOrOver(VnDUM_via2 geomOr(geomOr(V2 LPI) geomOr(M2 M3)))
    errorLayer(dumc22v2
    "DUMC_22_V2: Vx Dummy must not touch (Vx, LOGO, PTCT, INDMY),where Vx=V1-V7.")

L38351=drc(MnDUM_topmetal2a TM2 sep<0.6 withIntersection withSingularPoint)
errorLayer(L38351
    "DUMC_26: TMx Dummy space to (TMx, TMxDUB, TM2, PTCT, DUMBM), where TMx=TM1, MnDUM_topmetal2. >= 0.60")

L98632=drc(MnDUB_topmetal2 MnDUM_topmetal2a sep<0.6 withIntersection withSingularPoint)
errorLayer(L98632
    "DUMC_26: TMx Dummy space to (TMx, TMxDUB, MnDUB_topmetal2, PTCT, DUMBM), where TMx=TM1, MnDUM_topmetal2. >= 0.60")

L22265=drc(LOGO MnDUM_topmetal2a sep<0.6 withIntersection withSingularPoint)
errorLayer(L22265
    "DUMC_26: TMx Dummy space to (TMx, TMxDUB, LOGO, PTCT, DUMBM), where TMx=TM1, MnDUM_topmetal2. >= 0.60")

L46942=drc(PTCT MnDUM_topmetal2a sep<0.6 withIntersection withSingularPoint)
errorLayer(L46942
    "DUMC_26: TMx Dummy space to (TMx, TMxDUB, DUMBM, PTCT, DUMBM), where TMx=TM1, MnDUM_topmetal2. >= 0.60")

L46943=drc(MARKG MnDUM_topmetal2a sep<0.6 withIntersection withSingularPoint)
errorLayer(L46943
    "DUMC_26: TMx Dummy space to (TMx, TMxDUB, DUMBM, PTCT, DUMBM), where TMx=TM1, MnDUM_topmetal2. >= 0.60")

L38352=drc(MnDUM_topmetal1a TM1 sep<0.6 withIntersection withSingularPoint)
errorLayer(L38352
    "DUMC_26: TMx Dummy space to (TMx, TMxDUB, TM2, PTCT, DUMBM), where TMx=TM1, MnDUM_topmetal2. >= 0.60")

L98633=drc(MnDUM_topmetal1a MnDUB_topmetal1 sep<0.6 withIntersection withSingularPoint)
errorLayer(L98633
    "DUMC_26: TMx Dummy space to (TMx, TMxDUB, MnDUB_topmetal2, PTCT, DUMBM), where TMx=TM1, MnDUM_topmetal2. >= 0.60")

L22266=drc(LOGO MnDUM_topmetal1a sep<0.6 withIntersection withSingularPoint)
errorLayer(L22266
    "DUMC_26: TMx Dummy space to (TMx, TMxDUB, LOGO, PTCT, DUMBM), where TMx=TM1, MnDUM_topmetal2. >= 0.60")

L22268=drc(PTCT MnDUM_topmetal1a sep<0.6 withIntersection withSingularPoint)
errorLayer(L22268
    "DUMC_26: TMx Dummy space to (TMx, TMxDUB, DUMBM, PTCT, DUMBM), where TMx=TM1, MnDUM_topmetal2. >= 0.60")

L22269=drc(MARKG MnDUM_topmetal1a sep<0.6 withIntersection withSingularPoint)
errorLayer(L22269
    "DUMC_26: TMx Dummy space to (TMx, TMxDUB, DUMBM, PTCT, DUMBM), where TMx=TM1, MnDUM_topmetal2. >= 0.60")



dumc26a=drc(MTT2DM geomOr(geomOr(MTT2 MTT2DB) LPM) sep<1.77 withIntersection withSingularPoint)
errorLayer(dumc26a "DUMC_26a:MTT2 Dummy(MTT2DM) space to (MTT2, MTT2DB, LOGO, PTCT, MARKS) >=1.77")

L13137=drc(ALDUM ALPA sep<2.84 withIntersection withSingularPoint)
errorLayer(L13137
    "DUMC_28: ALPA Dummy space to (ALPA, ALDUB, LOGO, PTCT). >=2.84")

L57449=drc(ALDUB ALDUM sep<2.84 withIntersection withSingularPoint)
errorLayer(L57449
    "DUMC_28: ALPA Dummy space to (ALPA, ALDUB, LOGO, PTCT). >=2.84")

L33184=drc(ALDUM LOGO sep<2.84 withIntersection withSingularPoint)
errorLayer(L33184
    "DUMC_28: ALPA Dummy space to (ALPA, ALDUB, LOGO, PTCT). >=2.84")

L33185=drc(ALDUM PTCT sep<2.84 withIntersection withSingularPoint)
errorLayer(L33185
    "DUMC_28: ALPA Dummy space to (ALPA, ALDUB, LOGO, PTCT). >=2.84")

L33186=drc(ALDUM MARKG sep<2.84 withIntersection withSingularPoint)
errorLayer(L33186
    "DUMC_28: ALPA Dummy space to (ALPA, ALDUB, LOGO, PTCT). >=2.84")

dumc27=geomButtOrOver(ALDUM geomOr(ALPA LPM))
errorLayer(dumc27
    "DUMC_27: ALPA Dummy must not touch (ALPA, LOGO, PTCT,MARKG)")

dumc29a=drc(ALDUM INDMY sep<2.84 withIntersection withSingularPoint)
dumc29b=geomAnd(ALDUM INDMY)
dumc29=geomCat(dumc29a dumc29b)
errorLayer(dumc29
    "DUMC_29: ALPA Dummy space to INDMY with touching prohibited")

L32553=drc(ALDUM width<4.44)
errorLayer(L32553 "DUMC_36: Min. width of ALPA Dummy. >= 4.44")

L74095=drc(ALDUM sepNotch<2.84)
errorLayer(L74095 "DUMC_37: Min. space of ALPA Dummy. >= 2.84")

dumc31_mttdum = geomAndNot( MTT2DM BORDER_all )
errorLayer(dumc31_mttdum
    "DUMC_31: xx Dummy must be within BORDER, where xx=all metal and via levels")

dumc31_aldum = geomAndNot( ALDUM BORDER_all )
errorLayer(dumc31_aldum
    "DUMC_31: xx Dummy must be within BORDER, where xx=all metal and via levels")

dumc31_aadum = geomAndNot( AADUM BORDER_all )
errorLayer(dumc31_aadum
    "DUMC_31: xx Dummy must be within BORDER, where xx=all metal and via levels")

dumc31_gtdum = geomAndNot( GTDUM BORDER_all )
errorLayer(dumc31_gtdum
    "DUMC_31: xx Dummy must be within BORDER, where xx=all metal and via levels")

L10757=geomAndNot(MnDUM_metal1 BORDER_all)
errorLayer(L10757
    "DUMC_31: xx Dummy must be within BORDER, where xx=all metal and via levels")

L65220=geomAndNot(MnDUM_metal2 BORDER_all)
errorLayer(L65220
    "DUMC_31: xx Dummy must be within BORDER, where xx=all metal and via levels")

L47613=geomAndNot(MnDUM_metal3 BORDER_all)
errorLayer(L47613
    "DUMC_31: xx Dummy must be within BORDER, where xx=all metal and via levels")


L33399=geomAndNot(MnDUM_topmetal2 BORDER_all)
errorLayer(L33399
    "DUMC_31: xx Dummy must be within BORDER, where xx=all metal and via levels")

L8811=geomAndNot(VnDUM_via1 BORDER_all)
errorLayer(L8811
    "DUMC_31: xx Dummy must be within BORDER, where xx=all metal and via levels")

L45652=geomAndNot(VnDUM_via2 BORDER_all)
errorLayer(L45652
    "DUMC_31: xx Dummy must be within BORDER, where xx=all metal and via levels")


L6571=drc(MnDUM_metal1 width<0.22)
errorLayer(L6571 "DUMC_32: Min. width of Mx Dummy, where Mx=M1-M8. >= 0.220")

L26408=drc(MnDUM_metal1 sepNotch<0.22 withIntersection withSingularPoint)
errorLayer(L26408 "DUMC_33_M1: Min. space of Mx Dummy, where Mx=M1-M8.>= 0.220")

L57719=drc(MnDUM_metal2 width<0.22)
errorLayer(L57719 "DUMC_32: Min. width of Mx Dummy, where Mx=M1-M8. >= 0.220")

L92231=drc(MnDUM_metal2 sepNotch<0.22 withIntersection withSingularPoint)
errorLayer(L92231 "DUMC_33_M2: Min. space of Mx Dummy, where Mx=M1-M8.>= 0.220")

L54712=drc(MnDUM_metal3 width<0.22)
errorLayer(L54712 "DUMC_32: Min. width of Mx Dummy, where Mx=M1-M8. >= 0.220")

L58054=drc(MnDUM_metal3 sepNotch<0.22 withIntersection withSingularPoint)
errorLayer(L58054 "DUMC_33_M3: Min. space of Mx Dummy, where Mx=M1-M8.>= 0.220")


L34590=drc(MnDUM_topmetal2a width<0.44)
errorLayer(L34590 "DUMC_34: Min. width of TMx Dummy, where TMx=TM1-TM2.>=0.440")

L34591=drc(MTT2DM width<0.44)
errorLayer(L34591 "DUMC_34: Min. width of TMx Dummy, where TMx=TM1-TM2.>=0.440")

L1344=drc(MnDUM_topmetal2 sepNotch<0.6 withIntersection withSingularPoint)
errorLayer(L1344 "DUMC_35: Min. space of TMx Dummy, where TMx=TM1-TM2. >=0.60")

L1345=drc(MTT2DM sepNotch<0.6 withIntersection withSingularPoint)
errorLayer(L1345 "DUMC_35: Min. space of TMx Dummy, where TMx=TM1-TM2. >=0.60")

    L37597=drc(MnDUM_topmetal1a width<0.44)
    errorLayer(L37597
        "DUMC_34: Min. width of TMx Dummy, where TMx=TM1-TM2.>=0.440")

    L67167=drc(MnDUM_topmetal1 sepNotch<0.6 withIntersection withSingularPoint)
    errorLayer(L67167
        "DUMC_35: Min. space of TMx Dummy, where TMx=TM1-TM2. >=0.60")

)

if( avSwitch("CUSTOMER_DUMMY_CHECKS") then

dumcn01=drc(AADUM width<0.06)
errorLayer(dumcn01 "DUMCN_1:Dummy AA minimum width        AA_1")

dumcn02a=drc(AADUM sep<0.08 withIntersection withSingularPoint)
dumcn02b=drc(AADUM AA sep<0.08 withIntersection withSingularPoint)
dumcn02=geomCat(dumcn02a dumcn02b)
errorLayer(dumcn02 "DUMCN_2:Dummy AA minimum space to (AA, dummy AA)      AA_4a")


L22242=drc(AADUM GT sep<0.030)
errorLayer(L22242
    "DUMCN_3: Minimum space between AADUM and poly on field oxide >= 0.030")

L22243=geomOr(AA GT)
L22244=geomOr(L22243 RESNW)
L22245=geomButtOrOver(AADUM L22244)
errorLayer(L22245
    "DUMCN_4: Dummy AA must not touch(AA,GT,RESNW)")

;L22246=geomStraddle(AADUM NW)
;L22247=geomStraddle(NW AADUM)
;L22248=geomAnd(L22246 L22247)
;errorLayer(L22248
;    "DUMCN_5: Dummy AA cannot straddle on N-Well boundaries.")

L65256=drc(GTDUM width<0.040) 
errorLayer(L65256  
    "DUMCN_6: Dummy GT minimum width >= 0.040")

L65257=drc(GTDUM sepNotch<0.1)
L65258=drc(GTDUM GT sep<0.1)
L65259=geomOr(L65257 L65258)
errorLayer(L65259
    "DUMCN_7: Dummy GT minimum space to (GT, dummy GT) >=0.1")

L65260=drc(AA GTDUM sep<0.03)
errorLayer(L65260 "DUMCN_8: Dummy GT space to AA >=0.03")

L65261=geomButtOrOver(GTDUM GT)
L65262=geomButtOrOver(GTDUM AA)
L65263=geomOr(L65261 L65262)
errorLayer(L65263 "DUMCN_9: Dummy GT must not touch(GT,AA)")

L10831=drc(MnDUM_metal1 width<0.07)
errorLayer(L10831 "DUMCN_10: Min. width of Mx Dummy, where Mx=M1-M8. >= 0.07")

L19831=drc(MnDUM_metal2 width<0.07)
errorLayer(L19831 "DUMCN_10: Min. width of Mx Dummy, where Mx=M1-M8. >= 0.07")

L19832=drc(MnDUM_metal3 width<0.07)
errorLayer(L19832 "DUMCN_10: Min. width of Mx Dummy, where Mx=M1-M8. >= 0.07")

L10832=drc(MnDUM_metal1 sepNotch<0.07)
L10833=drc(MnDUM_metal1 M1 sep<0.07)
L10834=geomOr(L10832 L10833)
errorLayer(L10834 "DUMCN_11: Min. space of Mx Dummy, where Mx=M1-M8.>= 0.07")

L10835=drc(MnDUM_metal2 sepNotch<0.07)
L10836=drc(MnDUM_metal2 M2 sep<0.07)
L10837=geomOr(L10835 L10836)
errorLayer(L10837 "DUMCN_11: Min. space of Mx Dummy, where Mx=M1-M8.>= 0.07")

L10838=drc(MnDUM_metal3 sepNotch<0.07)
L10839=drc(MnDUM_metal3 M3 sep<0.07)
L10840=geomOr(L10838 L10839)
errorLayer(L10840 "DUMCN_11: Min. space of Mx Dummy, where Mx=M1-M8.>= 0.07")

L65264=geomButtOrOver(MnDUM_metal1 M1)
errorLayer(L65264 "DUMCN_12: Mx Dummy must not touch Mx, where Mx=M1-M8, TM1, TM2")

L65265=geomButtOrOver(MnDUM_metal2 M2)
errorLayer(L65265 "DUMCN_12: Mx Dummy must not touch Mx, where Mx=M1-M8, TM1, TM2")

L65266=geomButtOrOver(MnDUM_metal3 M3)
errorLayer(L65266 "DUMCN_12: Mx Dummy must not touch Mx, where Mx=M1-M8, TM1, TM2")

L65273=geomButtOrOver(MnDUM_topmetal2 TM2)
errorLayer(L65273 "DUMCN_12: Mx Dummy must not touch Mx, where Mx=M1-M8, TM1, TM2")

L19199=geomContactCheck(VnDUM_via1 width==0.070 length==0.070 ignore)
dumcn13av1=geomContactCheck(VnDUM_via1 width==0.077 length==0.077 ignore)
dumcn13bv1=geomContactCheck(VnDUM_via1 width==0.12 length==0.12 ignore)
dumcn13v1=geomOr(dumcn13bv1 geomOr(L19199 dumcn13av1))
errorLayer(dumcn13v1 "DUMCN_13_16_V1: Fixed Dummy V1 size (square shape) == 0.070")

L19200=geomContactCheck(VnDUM_via2 width==0.070 length==0.070 ignore)
dumcn13av2=geomContactCheck(VnDUM_via2 width==0.077 length==0.077 ignore)
dumcn13bv2=geomContactCheck(VnDUM_via2 width==0.12 length==0.12 ignore)
dumcn13v2=geomOr(dumcn13bv2 geomOr(L19200 dumcn13av2))
errorLayer(dumcn13v2 "DUMCN_13_16_V2: Fixed Dummy V2 size (square shape) == 0.070")

L60275=geomOr(VnDUM_via1 V1)
L60276=drc(VnDUM_via1 L60275 sep<0.070)
errorLayer(L60276 "DUMCN_14: V1 Dummy minimum space to (V1, V1 Dummy) >= 0.070")

L60277=geomOr(VnDUM_via2 V2)
L60278=drc(VnDUM_via2 L60277 sep<0.070)
errorLayer(L60278 "DUMCN_14: V2 Dummy minimum space to (V2, V2 Dummy) >= 0.070")

L12222=geomButtOrOver(VnDUM_via1 V1)
L12223=geomButtOrOver(VnDUM_via1 M1)
L12224=geomButtOrOver(VnDUM_via1 M2)
L12225=geomOr(L12222 L12223)
L12226=geomOr(L12224 L12225)
errorLayer(L12226 "DUMCN_15: Vn Dummy must not touch (Vn, Mn, Mn+1), where n=1-7")

L12227=geomButtOrOver(VnDUM_via2 V2)
L12228=geomButtOrOver(VnDUM_via2 M2)
L12229=geomButtOrOver(VnDUM_via2 M3)
L12230=geomOr(L12227 L12228)
L12231=geomOr(L12229 L12230)
errorLayer(L12231 "DUMCN_15: Vn Dummy must not touch (Vn, Mn, Mn+1), where n=1-7")

M1D_AND_M2D=geomAnd(MnDUM_metal2 MnDUM_metal1)
dumcn17v1a=geomAndNot(VnDUM_via1 M1D_AND_M2D)
dumcn17v1b=drc(M1D_AND_M2D VnDUM_via1 enc<0.015 withIntersection withSingularPoint)
errorLayer(geomOr(dumcn17v1a dumcn17v1b) "DUMCN_17_V1: Vn Dummy must be within (Mn dummy and Mn+1 Dummy), where n=1-7")

M2D_AND_M3D=geomAnd(MnDUM_metal2 MnDUM_metal3)
dumcn17v2a=geomAndNot(VnDUM_via2 M2D_AND_M3D)
dumcn17v2b=drc(M2D_AND_M3D VnDUM_via2 enc<0.015 withIntersection withSingularPoint)
errorLayer(geomOr(dumcn17v2a dumcn17v2b) "DUMCN_17_V2: Vn Dummy must be within (Mn dummy and Mn+1 Dummy), where n=1-7")

dumcn23_al=geomAndNot(ALDUM BORDER_all)
errorLayer(dumcn23_al "DUMCN_23: AL Dummy must be within BORDER, where xx=all metal and via levels")

dumcn23_mtt2=geomAndNot(MTT2DM BORDER_all)
errorLayer(dumcn23_mtt2 "DUMCN_23: MTT2 Dummy must be within BORDER, where xx=all metal and via levels")

L74101=geomAndNot(MnDUM_metal1 BORDER_all)
errorLayer(L74101 "DUMCN_23: M1 Dummy must be within BORDER, where xx=all metal and via levels")

L74100=geomAndNot(VnDUM_via1 BORDER_all)
errorLayer(L74100 "DUMCN_23: V1 Dummy must be within BORDER, where xx=all metal and via levels")

L74102=geomAndNot(MnDUM_metal2 BORDER_all)
errorLayer(L74102 "DUMCN_23: M2 Dummy must be within BORDER, where xx=all metal and via levels")

L74103=geomAndNot(VnDUM_via2 BORDER_all)
errorLayer(L74103 "DUMCN_23: V2 Dummy must be within BORDER, where xx=all metal and via levels")

L74104=geomAndNot(MnDUM_metal3 BORDER_all)
errorLayer(L74104 "DUMCN_23: M3 Dummy must be within BORDER, where xx=all metal and via levels")

L74118=geomAndNot(MnDUM_topmetal2 BORDER_all)
errorLayer(L74118 "DUMCN_23: TM2 Dummy must be within BORDER, where xx=all metal and via levels")

L39614=drc(MnDUM_topmetal2 width<0.400)
errorLayer(L39614 "DUMCN_18: TMx Dummy minimum width, where TMx=TM1, TM2 is 0.4")

dumcn18_mtt2=drc(MTT2DM width<0.400)
errorLayer(dumcn18_mtt2 "DUMCN_18: TMx Dummy minimum width, where TMx=TM1, TM2 is 0.4")

L85322=drc(MnDUM_topmetal2 sepNotch<0.400)
L85323=drc(MnDUM_topmetal2 TM2 sep<0.4)
L85324=geomOr(L85322 L85323)
errorLayer(L85324 "DUMCN_19: TMx Dummy minimum space to (TMx and TMx dummy) , where TMx=TM1,TM2 >= 0.400")

dumcn19mtta=drc(MTT2DM sepNotch<0.4)
dumcn19mttb=drc(MTT2DM MTT2 sep<0.4)
dumcn19mtt=geomOr(dumcn19mtta dumcn19mttb)
errorLayer(dumcn19mtt "DUMCN_19: TMx Dummy minimum space to (TMx and TMx dummy) , where TMx=TM1,TM2 >= 0.400")

L32554=drc(ALDUM width<4)
errorLayer(L32554 "DUMCN_20: Min. width of ALPA Dummy. >= 4")

L74096=drc(ALDUM sepNotch<2 withIntersection withSingularPoint)
L74097=drc(ALDUM ALPA sep<2 withIntersection withSingularPoint)
L74098=geomOr(L74096 L74097)
errorLayer(L74098 "DUMCN_21: Min. space ALPA Dummy to ALPA,ALPA dummy >= 2")

L74099=geomButtOrOver(ALDUM ALPA)
errorLayer(L74099 "DUMCN_22: ALPA Dummy must not touch ALPA")

procedure( switchProc2050()

L19833=drc(MnDUM_metal4 width<0.07)
errorLayer(L19833 "DUMCN_10: Min. width of Mx Dummy, where Mx=M1-M8. >= 0.07")

L10841=drc(MnDUM_metal4 sepNotch<0.07)
L10842=drc(MnDUM_metal4 M4 sep<0.07)
L10843=geomOr(L10841 L10842)
errorLayer(L10843 "DUMCN_11: Min. space of Mx Dummy, where Mx=M1-M8.>= 0.07")

L65267=geomButtOrOver(MnDUM_metal4 M4)
errorLayer(L65267 "DUMCN_12: Mx Dummy must not touch Mx, where Mx=M1-M8, TM1, TM2")

L19201=geomContactCheck(VnDUM_via3 width==0.070 length==0.070 ignore)
dumcn13v3a=geomContactCheck(VnDUM_via3 width==0.077 length==0.077 ignore)
dumcn13v3b=geomContactCheck(VnDUM_via3 width==0.12 length==0.12 ignore)
dumcn13v3=geomOr(geomOr(L19201  dumcn13v3a) dumcn13v3b)
errorLayer(dumcn13v3 "DUMCN_13_16_V3: Fixed Dummy V3 size (square shape) == 0.070")

L60279=geomOr(VnDUM_via3 V3)
L60280=drc(VnDUM_via3 L60279 sep<0.070)
errorLayer(L60280 "DUMCN_14: V3 Dummy minimum space to (V3, V3 Dummy) >= 0.070")

L12232=geomButtOrOver(VnDUM_via3 V3)
L12233=geomButtOrOver(VnDUM_via3 M3)
L12234=geomButtOrOver(VnDUM_via3 M4)
L12235=geomOr(L12232 L12233)
L12236=geomOr(L12234 L12235)
errorLayer(L12236 "DUMCN_15: Vn Dummy must not touch (Vn, Mn, Mn+1), where n=1-7")

M3D_AND_M4D=geomAnd(MnDUM_metal4 MnDUM_metal3)
dumcn17v3a=geomAndNot(VnDUM_via3 M3D_AND_M4D)
dumcn17v3b=drc(M3D_AND_M4D VnDUM_via3 enc<0.015 withIntersection withSingularPoint)
errorLayer(geomOr(dumcn17v3a dumcn17v3b) "DUMCN_17_V3: Vn Dummy must be within (Mn dummy and Mn+1 Dummy), where n=1-7")

L74105=geomAndNot(VnDUM_via3 BORDER_all)
errorLayer(L74105 "DUMCN_23: V3 Dummy must be within BORDER, where xx=all metal and via levels")

L74106=geomAndNot(MnDUM_metal4 BORDER_all)
errorLayer(L74106 "DUMCN_23: M4 Dummy must be within BORDER, where xx=all metal and via levels")

)

procedure( switchProc2060()

L19834=drc(MnDUM_metal5 width<0.07)
errorLayer(L19834 "DUMCN_10: Min. width of Mx Dummy, where Mx=M1-M8. >= 0.07")

L10844=drc(MnDUM_metal5 sepNotch<0.07)
L10845=drc(MnDUM_metal5 M5 sep<0.07)
L10846=geomOr(L10844 L10845)
errorLayer(L10846 "DUMCN_11: Min. space of Mx Dummy, where Mx=M1-M8.>= 0.07")

L65268=geomButtOrOver(MnDUM_metal5 M5)
errorLayer(L65268 "DUMCN_12: Mx Dummy must not touch Mx, where Mx=M1-M8, TM1, TM2")

L19202=geomContactCheck(VnDUM_via4 width==0.070 length==0.070 ignore)
dumcn14v4a=geomContactCheck(VnDUM_via4 width==0.077 length==0.077 ignore)
dumcn14v4b=geomContactCheck(VnDUM_via4 width==0.12 length==0.12 ignore)
dumcn14v4=geomOr(geomOr(L19202 dumcn14v4a) dumcn14v4b)
errorLayer(dumcn14v4 "DUMCN_13_16_V4: Fixed Dummy V4 size (square shape) == 0.070")

L60281=geomOr(VnDUM_via4 V4)
L60282=drc(VnDUM_via4 L60281 sep<0.070)
errorLayer(L60282 "DUMCN_14: V4 Dummy minimum space to (V4, V4 Dummy) >= 0.070")

L12237=geomButtOrOver(VnDUM_via4 V4)
L12238=geomButtOrOver(VnDUM_via4 M5)
L12239=geomButtOrOver(VnDUM_via4 M5)
L12240=geomOr(L12237 L12238)
L12241=geomOr(L12239 L12240)
errorLayer(L12241 "DUMCN_15: Vn Dummy must not touch (Vn, Mn, Mn+1), where n=1-7")

M4D_AND_M5D=geomAnd(MnDUM_metal4 MnDUM_metal5)
dumcn17v4a=geomAndNot(VnDUM_via4 M4D_AND_M5D)
dumcn17v4b=drc(M4D_AND_M5D VnDUM_via4 enc<0.015 withIntersection withSingularPoint)
errorLayer(geomOr(dumcn17v4a dumcn17v4b) "DUMCN_17_V4: Vn Dummy must be within (Mn dummy and Mn+1 Dummy), where n=1-7")

L74107=geomAndNot(VnDUM_via4 BORDER_all)
errorLayer(L74107 "DUMCN_23: V4 Dummy must be within BORDER, where xx=all metal and via levels")

L74108=geomAndNot(MnDUM_metal5 BORDER_all)
errorLayer(L74108 "DUMCN_23: M5 Dummy must be within BORDER, where xx=all metal and via levels")

)

procedure( switchProc200()

L19835=drc(MnDUM_metal6 width<0.07)
errorLayer(L19835 "DUMCN_10: Min. width of Mx Dummy, where Mx=M1-M8. >= 0.07")

L10850=drc(MnDUM_metal6 sepNotch<0.07)
L10851=drc(MnDUM_metal6 M6 sep<0.07)
L10852=geomOr(L10850 L10851)
errorLayer(L10852 "DUMCN_11: Min. space of Mx Dummy, where Mx=M1-M8.>= 0.07")

L65269=geomButtOrOver(MnDUM_metal6 M6)
errorLayer(L65269 "DUMCN_12: Mx Dummy must not touch Mx, where Mx=M1-M8, TM1, TM2")

L19203=geomContactCheck(VnDUM_via5 width==0.070 length==0.070 ignore)
dumcn13v5a=geomContactCheck(VnDUM_via5 width==0.077 length==0.077 ignore)
dumcn13v5b=geomContactCheck(VnDUM_via5 width==0.12 length==0.12 ignore)
dumcn13v5=geomOr(geomOr(L19203 dumcn13v5a) dumcn13v5b)
errorLayer(dumcn13v5 "DUMCN_13_16_V5: Fixed Dummy V5 size (square shape) == 0.070")

L60283=geomOr(VnDUM_via5 V5)
L60284=drc(VnDUM_via5 L60283 sep<0.070)
errorLayer(L60284 "DUMCN_14: V5 Dummy minimum space to (V5, V5 Dummy) >= 0.070")

L12242=geomButtOrOver(VnDUM_via5 V5)
L12243=geomButtOrOver(VnDUM_via5 M5)
L12244=geomButtOrOver(VnDUM_via5 M6)
L12245=geomOr(L12242 L12243)
L12246=geomOr(L12244 L12245)
errorLayer(L12246 "DUMCN_15: Vn Dummy must not touch (Vn, Mn, Mn+1), where n=1-7")

M5D_AND_M6D=geomAnd(MnDUM_metal6 MnDUM_metal5)
dumcn17v5a=geomAndNot(VnDUM_via5 M5D_AND_M6D)
dumcn17v5b=drc(M5D_AND_M6D VnDUM_via5 enc<0.015 withIntersection withSingularPoint)
errorLayer(geomOr(dumcn17v5a dumcn17v5b) "DUMCN_17_V5: Vn Dummy must be within (Mn dummy and Mn+1 Dummy), where n=1-7")

L74109=geomAndNot(VnDUM_via5 BORDER_all)
errorLayer(L74109 "DUMCN_23: V5 Dummy must be within BORDER, where xx=all metal and via levels")

L74110=geomAndNot(MnDUM_metal6 BORDER_all)
errorLayer(L74110 "DUMCN_23: M6 Dummy must be within BORDER, where xx=all metal and via levels")
)

procedure( switchProc250()

L19836=drc(MnDUM_metal7 width<0.07)
errorLayer(L19836 "DUMCN_10: Min. width of Mx Dummy, where Mx=M1-M8. >= 0.07")

L10853=drc(MnDUM_metal7 sepNotch<0.07)
L10854=drc(MnDUM_metal7 M7 sep<0.07)
L10855=geomOr(L10853 L10854)
errorLayer(L10855 "DUMCN_11: Min. space of Mx Dummy, where Mx=M1-M8.>= 0.07")

L65270=geomButtOrOver(MnDUM_metal7 M7)
errorLayer(L65270 "DUMCN_12: Mx Dummy must not touch Mx, where Mx=M1-M8, TM1, TM2")

L19204=geomContactCheck(VnDUM_via6 width==0.070 length==0.070 ignore)
dumcn13v6a=geomContactCheck(VnDUM_via6 width==0.077 length==0.077 ignore)
dumcn13v6b=geomContactCheck(VnDUM_via6 width==0.12 length==0.12 ignore)
dumcn13v6=geomOr(geomOr(L19204 dumcn13v6a) dumcn13v6b)
errorLayer(dumcn13v6 "DUMCN_13_16_V6: Fixed Dummy V6 size (square shape) == 0.070")

L60285=geomOr(VnDUM_via6 V6)
L60286=drc(VnDUM_via6 L60285 sep<0.070)
errorLayer(L60286 "DUMCN_14: V6 Dummy minimum space to (V6, V6 Dummy) >= 0.070")

L12247=geomButtOrOver(VnDUM_via6 V6)
L12248=geomButtOrOver(VnDUM_via6 M6)
L12249=geomButtOrOver(VnDUM_via6 M7)
L12250=geomOr(L12247 L12248)
L12251=geomOr(L12249 L12250)
errorLayer(L12251 "DUMCN_15: Vn Dummy must not touch (Vn, Mn, Mn+1), where n=1-7")

M6D_AND_M7D=geomAnd(MnDUM_metal6 MnDUM_metal7)
dumcn17v6a=geomAndNot(VnDUM_via6 M6D_AND_M7D)
dumcn17v6b=drc(M6D_AND_M7D VnDUM_via6 enc<0.015 withIntersection withSingularPoint)
errorLayer(geomOr(dumcn17v6a dumcn17v6b) "DUMCN_17_V6: Vn Dummy must be within (Mn dummy and Mn+1 Dummy), where n=1-7")

L74111=geomAndNot(VnDUM_via6 BORDER_all)
errorLayer(L74111 "DUMCN_23: V6 Dummy must be within BORDER, where xx=all metal and via levels")

L74112=geomAndNot(MnDUM_metal7 BORDER_all)
errorLayer(L74112 "DUMCN_23: M7 Dummy must be within BORDER, where xx=all metal and via levels")
)

procedure( switchProc300()

L19837=drc(MnDUM_metal8 width<0.07)
errorLayer(L19837 "DUMCN_10: Min. width of Mx Dummy, where Mx=M1-M8. >= 0.07")

L10856=drc(MnDUM_metal8 sepNotch<0.07)
L10857=drc(MnDUM_metal8 M8 sep<0.07)
L10858=geomOr(L10856 L10857)
errorLayer(L10858 "DUMCN_11: Min. space of Mx Dummy, where Mx=M1-M8.>= 0.07")

L65271=geomButtOrOver(MnDUM_metal8 M8)
errorLayer(L65271 "DUMCN_12: Mx Dummy must not touch Mx, where Mx=M1-M8, TM1, TM2")

L19205=geomContactCheck(VnDUM_via7 width==0.070 length==0.070 ignore)
dumcn13v7a=geomContactCheck(VnDUM_via7 width==0.077 length==0.077 ignore)
dumcn13v7b=geomContactCheck(VnDUM_via7 width==0.12 length==0.12 ignore)
dumcn13v7=geomOr(geomOr(L19205 dumcn13v7a) dumcn13v7b)
errorLayer(dumcn13v7 "DUMCN_13_16_V7: Fixed Dummy V7 size (square shape) == 0.070")

L60287=geomOr(VnDUM_via7 V7)
L60288=drc(VnDUM_via7 L60287 sep<0.070)
errorLayer(L60288 "DUMCN_14: V7 Dummy minimum space to (V7, V7 Dummy) >= 0.070")

L12252=geomButtOrOver(VnDUM_via7 V7)
L12253=geomButtOrOver(VnDUM_via7 M7)
L12254=geomButtOrOver(VnDUM_via7 M8)
L12255=geomOr(L12252 L12253)
L12256=geomOr(L12254 L12255)
errorLayer(L12256 "DUMCN_15: Vn Dummy must not touch (Vn, Mn, Mn+1), where n=1-7")

M7D_AND_M8D=geomAnd(MnDUM_metal8 MnDUM_metal7)
dumcn17v7a=geomAndNot(VnDUM_via7 M7D_AND_M8D)
dumcn17v7b=drc(M7D_AND_M8D VnDUM_via7 enc<0.015 withIntersection withSingularPoint)
errorLayer(geomOr(dumcn17v7a dumcn17v7b) "DUMCN_17_V7: Vn Dummy must be within (Mn dummy and Mn+1 Dummy), where n=1-7")

L74113=geomAndNot(VnDUM_via7 BORDER_all)
errorLayer(L74113 "DUMCN_23: V7 Dummy must be within BORDER, where xx=all metal and via levels")

L74114=geomAndNot(MnDUM_metal8 BORDER_all)
errorLayer(L74114 "DUMCN_23: M8 Dummy must be within BORDER, where xx=all metal and via levels")
)
)

procedure( switchProc350()
if( avSwitch("CUSTOMER_DUMMY_CHECKS")  then
L65272=geomButtOrOver(MnDUM_topmetal1a TM1)
errorLayer(L65272 "DUMCN_12: Mx Dummy must not touch Mx, where Mx=M1-M8, TM1, TM2")

L74117=geomAndNot(MnDUM_topmetal1a BORDER_all)
errorLayer(L74117 "DUMCN_23: TM1 Dummy must be within BORDER, where xx=all metal and via levels")

L39613=drc(MnDUM_topmetal1a width<0.400)
errorLayer(L39613 "DUMCN_18: TMx Dummy minimum width, where TMx=TM1, TM2 is 0.4")

L85319=drc(MnDUM_topmetal1a sepNotch<0.400)
L85320=drc(MnDUM_topmetal1a TM1 sep<0.4)
L85321=geomOr(L85319 L85320)
errorLayer(L85321 "DUMCN_19: TMx Dummy minimum space to (TMx and TMx dummy) , where TMx=TM1,TM2 >= 0.400")

)
)

hrpr=geomAnd(GT HRPDMY)
hrp_poly=geomButtOrOver( geomAnd(GT HRPDMY) HRP)
hrp_sp=geomButtOrOver( SP hrp_poly)
hrp_sab=geomButtOrOver( SAB hrp_poly)
hrp_gt=geomAnd(hrpr HRPDMY)

rule_hrp2=drc(HRP hrp_poly enc<0.22 withIntersection withSingularPoint)
errorLayer(rule_hrp2 "HRP_2: Min HRP extension outside of poly resistor region is 0.22")

gt_mos=geomButtOrOver(GT gate)
rule_hrp34=drc(HRP gt_mos sep<0.2 withIntersection withSingularPoint)
errorLayer(rule_hrp34 "HRP_3_4: Minimum space from HRP region to Poly gate of NMOS/PMOS is 0.2um")

hrp05a=geomButtOrOver(SP HRP)
hrp05b=geomButtOrOver(SAB HRP)
hrp05c=geomAnd(hrp05a hrp05b)
hrp05d=drc(hrp05c width<0.3)
hrp05e=geomSize(hrp05c -0.15 downUp)
rule_hrp5=geomCat(hrp05d hrp05e)
errorLayer(rule_hrp5 "HRP_5:P+ region for pickup overlap with SAB is 0.3fixed")

hrp07a=geomButtOrOver(HRPDMY HRP)
hrp07b=geomGetEdge(GT inside hrp07a)
rule_hrp7=drc(hrp07b width<2)
errorLayer(rule_hrp7 "HRP_7:Minimum width of Poly region for high resistance poly resistor is 2um")

hrp_end=geomSize(geomAndNot(geomButtOrOver(GT HRPDMY) HRPDMY) 0.3)
hrp_mid=geomAndNot(geomButtOrOver(GT HRPDMY) hrp_end)
hrp09=geomAnd(geomOr(SN SP) hrp_mid)
errorLayer(hrp09 "HRP_9:SN, SP layers are not allowed in the HRPDMY region when check the rule, size down the HRPDMY by 0.3um along the current direction")

rule_hrp11=drc(HRP sep<0.18)
errorLayer(rule_hrp11 "HRP_11:HRP min space is 0.18")

hrp12a=geomAnd(geomButtOrOver(SAB geomAnd(HRP HRPDMY)) GT)
hrp12b=geomAnd(HRPDMY GT)
rule_hrp12=geomXor(hrp12a hrp12b)
errorLayer(rule_hrp12 "HRP_12:HRPDMY and SAB on GT should have coincident edge")

rule_hrp13=drc(HRP width<0.18)
errorLayer(rule_hrp13 "HRP_13:HRP min Width is 0.18um")

if( avSwitch("UTM_YES") then
rule_mtt1=drc(MTT2 width<1.5)
errorLayer(rule_mtt1 "MTT2_1:Minimum width of MTT region is 1.5um")

rule_mtt2=drc(MTT2 sepNotch<1.5 withIntersection<89.9 withSingularPoint)
errorLayer(rule_mtt2 "MTT2_2:Minimum space between two MTT regions is 1.5um")

rule_mtt2a_1=geomWidth(MTT2 keep>=16)
rule_mtt2a_2=drc(rule_mtt2a_1 MTT2 sep < 2 opposite)
rule_mtt2a_3=geomGetLength(rule_mtt2a_2 keep>2)
rule_mtt2a=geomWithEdge(rule_mtt2a_2 rule_mtt2a_3)
errorLayer(rule_mtt2a "MTT2_2a:Minimum space between two MTTs having parallel segment larger than 2um with one or both MTT width larger than or equal to 16um is 2um")

rule_mtt3_1=geomAndNot(TV2 MTT2)
rule_mtt3_2=drc(MTT2 TV2 enc<0.3)
rule_mtt34=geomCat(rule_mtt3_1 rule_mtt3_2)
errorLayer(rule_mtt34 "MTT2_3_4:Minimum extension of MTT region beyond top Via is 0.3")

rule_mtt5_a=geomButtOrOver(MTT2i geomAnd(MTT2i INDMY))
mtt5x=geomAndNot(MTT2i rule_mtt5_a)
geomConnect(
 incremental
    buttOrOver(rule_mtt5_a mtt5x)
    buttOrOver(rule_mtt5_a MTT2i)
    buttOrOver(mtt5x MTT2i)

)

rule_mtt5=drc(rule_mtt5_a mtt5x sep<30 withIntersection withSingularPoint diffNet)
errorLayer(rule_mtt5 "MTT2_5:Minimum space from MTT used as Inductor to other MTT region is 30")

rule_mtt6=drc(MTT2 area<2.25)
errorLayer(rule_mtt6 "MTT2_6:Minimum area of MTT region is 2.25um")

mtt2all=geomOr(MTT2i MTT2DMi) 
 processCoverage( backup measure( windowSize=200 stepSize=100
        rule_mtt7=calculate(area(mtt2all)/area()) ))
    errorLayer(geomAndNot(geomGetCoverage(rule_mtt7 0.3<=ignore) MARKG)
        "MTT2_7: Minimum density of MTT area. Window size:200um*200um, step size:100um is 30%")

processCoverage( backup measure( 
        rule_mtt7=calculate(area(mtt2all)/area()) ))
    errorLayer(geomAndNot(geomGetCoverage(rule_mtt7 keep<0.2) MARKG)
        "MTT2_7a:MTT2 density  over the whole chip is >=20%")

processCoverage( backup measure( windowSize=840 stepSize=420
        rule_mtt7=calculate(area(mtt2all)/area()) ))
    errorLayer(geomAndNot(geomGetCoverage(rule_mtt7 keep>0.15) MARKG)
        "MTT2_7b: INDMY area density in window size 840um*840um with step 420um is <=15%")

mtt8_1a=geomButtOrOver(gate CT)
mtt8_1=geomAnd(geomAndNot(gate mtt8_1a) INDMY)
mtt8_2=geomAnd(RESAA INDMY)
mtt8_3=geomAnd(RESNW INDMY)
mtt8_4=geomAnd(RESP1 INDMY)
mtt8_5=geomAnd(PLRES INDMY)
mtt8_6=geomAnd(DIFRES INDMY)
mtt8_7=geomAnd(DSTR INDMY)
mtt8_8=geomAnd(BIPOLA INDMY)
mtt8_9=geomAnd(HRPDMY INDMY)
mtt8_10=geomAnd(MOMDMY INDMY)
mtt8_11=geomAnd(M1R INDMY)
mtt8_12=geomAnd(M2R INDMY)
mtt8_13=geomAnd(M3R INDMY)
mtt8_14=geomAnd(M4R INDMY)
mtt8_15=geomAnd(M5R INDMY)
mtt8_16=geomAnd(M6R INDMY)
mtt8_17=geomAnd(M7R INDMY)
mtt8_18=geomAnd(M8R INDMY)
mtt8_19=geomAnd(TM1R INDMY)
rule_mtt8=geomCat(mtt8_1 mtt8_2 mtt8_3 mtt8_4 mtt8_5 mtt8_6 mtt8_7 mtt8_8 mtt8_9 mtt8_10 mtt8_11 mtt8_12 mtt8_13 mtt8_14 mtt8_15 mtt8_16 mtt8_17 mtt8_18 mtt8_19)
errorLayer(rule_mtt8 "MTT2_8:All devices listed in device table inside Inductor region are prohibited")

mtt9a=geomButtOrOver(MTT2 INDMY)
rule_mtt9=drc(INDMY mtt9a enc<15 withIntersection withSingularPoint)
errorLayer(rule_mtt9 "MTT2_9:Minimum extension of dummy layer INDMY beyond MTT region used as Inductor is 15")

rule_mtt11a=geomWidth(MTT2 keep>50)
rule_mtt11=geomAvoiding(rule_mtt11a MD)
errorLayer(rule_mtt11 "MTT2_11:Max MTT line width allowed.  MTT underneath of MD does not follow this rule is 50")

    processCoverage( backup measure( rule_mtt12=calculate(area(mtt2all)/area()) ))
    errorLayer(geomAndNot(geomGetCoverage(rule_mtt12 ignore<=0.55) MARKG)
        "MTT2_12:Max.MTT pattern density on the whole chip( including dummy patterns) is 55%")
)

;E fuse dimension rule

efu0102a=drc(geomGetEdge(geomAndNot(GTFUSE GT) butting GT wholeEdge) sep<0.222 withIntersection)
efu0102b=geomGetRectangle(geomAnd(GT GTFUSE) width==0.045 length==0.222 ignore)
efu0102=geomCat(efu0102a efu0102b)
errorLayer(efu0102 "EFU_1_2:(GT AND GTFUSE) width (vertical to current flow)=0.045,(GT AND GTFUSE) length (parallel to current flow) is	=0.222")

efu03=geomAndNot(geomAnd(EFUSE GT) geomAndNot(SP NW))
errorLayer(efu03 "EFU_3:Only SP implant is allowed in EFUSE area (NW is not allowed in EFUSE area),Highlight part: (EFUSE AND GT) NOT (SP NOT NW)")

efu04=geomAndNot(GTFUSE geomInside(GTFUSE EFUSE))
errorLayer(efu04 "EFU_4:GTFUSE should be within EFUSE area to identify EFUSE function area")

if( !avSwitch("Guidline_rules_check")  then

;LDMOS design Guideline for IO 2.5V gate OX device

ldmos=geomAnd(LDBK TG)
gate_ld=geomAnd(gate ldmos)
pgate_ld=geomAnd(pgate ldmos)
ngate_ld=geomAnd(ngate ldmos)

pgate_lde=geomAnd(pgate_ld NW)
ngate_lde=geomAndNot(ngate_ld NW)

stia1=geomGetEdge(gate_ld inside AA)
stia=geomOr(geomGetEdge(stia1 coincident GT) geomGetEdge(stia1 butting GT))
stib=geomSize(stia -0.005 edges)
stic=geomAndNot(gate_ld geomOr(geomGetEdge(gate_ld coincident stib wholeEdge) geomGetEdge(gate_ld butting stib wholeEdge)))
sti=geomSize(stic 0.15 edges)



ld_1a=drc(ngate_lde width<0.28)
errorLayer(ld_1a "LD_1a_G: Min Effective Channel length for NLDMOS transistors is 0.28")

ld_1b=drc(pgate_lde width<0.26)
errorLayer(ld_1b "LD_1b_G: Min Effective Channel length for PLDMOS transistors is 0.26")

ld2a=geomAndNot(AA gate_ld)
ld2b=geomOr(geomGetEdge(ld2a coincident sti) geomGetEdge(ld2a butting sti))
;ld2b1=geomAndNot(AA geomOr(geomGetEdge(AA coincident ld2b) geomGetEdge(AA butting ld2b)))
;ld2=drc(ld2b ld2b1 ovlp<0.2 opposite)
ld2=drc(ld2b width<0.2 opposite)
errorLayer(ld2 "LD_2_G: Min Drain AA width along source/drain direction for LDMOS transistors is 0.2")

ld3a=geomAndNot(sti geomButtOnly(sti ld2a keep==1))
errorLayer(ld3a "LD_3_G: Fixed STI width along source/drain direction is 0.15")

ld4a=drc(GT stic enc<0.05 withIntersection opposite)
errorLayer(ld4a "LD_4_G:Min Overlap of GT and STI along source/drain direction is 0.05")

ld5an=geomAnd(ngate_ld NW)
ld5bn=geomSize(ld5an -0.11 downUp)
ld5cn=drc(ld5an width<0.22 )
ld5n=geomCat(ld5bn ld5cn)

ld5ap=geomAndNot(pgate_ld NW)
ld5bp=geomSize(ld5ap -0.11 downUp)
ld5cp=drc(ld5ap width<0.22 )
ld5p=geomCat(ld5bp ld5cp)
ld5=geomCat(ld5n ld5p)
errorLayer(ld5 "LD_5_G: Fixed N LDMOS gate overlaps with NW in source/drain direction length is 0.22_Fixed P LDMOS gate not in NW in source/drain direction length is 0.22")

ld6a=geomOr(geomGetEdge(gate_ld coincident GT) geomGetEdge(gate_ld butting GT))
ld6=geomGetLength(ld6a keep<2)
errorLayer(ld6 "LD_6_G: Min LDMOS channel width is 2")

ld7a1=geomEnclose(AA gate_ld)
ld7a2=geomGetEdge(ld7a1 inside GT)
ld7a3=geomAndNot(ld7a1 geomOr(geomGetEdge(ld7a1 coincident ld7a2 wholeEdge) geomGetEdge(ld7a1 butting ld7a2 wholeEdge)))
ld7a=drc(ld7a3 tap sep<0.6 withIntersection)
errorLayer(ld7a "LD_7a_G:Min Space between LDMOS source side AA and pickup AA along source/drain direction is 0.6")

ld7b1=geomSize(ld6a -0.005 edges)
ld7b3=geomOr(geomGetEdge(ld7a1 coincident ld7b1 wholeEdge) geomGetEdge(ld7a1 butting ld7b1 wholeEdge))
ld7b4=geomAndNot(ld7b3 geomOr(geomGetEdge(ld7b3 coincident GT wholeEdge) geomGetEdge(ld7b3 butting GT wholeEdge)))
ld7b5=geomAndNot(tap geomOr(geomGetEdge(tap coincident gate) geomGetEdge(tap butting gate)))
ld7b=drc(ld7b4 ld7b5 sep<0.9 withIntersection)
errorLayer(ld7b "LD_7b_G:Min Space between LDMOS source side AA and pickup AA along gate poly direction is 0.9")

ld8a=geomOr(geomGetEdge(AA coincident sti wholeEdge) geomGetEdge(AA butting sti wholeEdge))
ld8b=geomSize(ld8a -0.005 edges)
ld8d=geomOr(geomGetEdge(AA coincident ld8b wholeEdge) geomGetEdge(AA butting ld8b wholeEdge))
ld8e=geomAndNot(ld8d geomOr(geomGetEdge(ld8d coincident ld8a wholeEdge) geomGetEdge(ld8d butting ld8a wholeEdge)))
ld8a1=drc(NW ld8e enc<0.25 withIntersection)
ld8a2=drc(NW ld8e sep<0.25 withIntersection)
ld8=geomCat(ld8a1 ld8a2)
errorLayer(ld8 "LD_8_G: Min NW extension outside of N LDMOS AA along gate poly direction is 0.25_Min NW space to P LDMOS AA along gate poly direction is 0.25")

ld9a=geomHoles(geomButtOrOver(NW pgate_ld))
ld9b=geomButtOrOver(NW ngate_ld)
ld9c=geomButtOrOver(AA geomOr(ld9a ld9b))
ld9=drc(LDBK ld9c enc<0.4 withIntersection shielded)
errorLayer(ld9 "LD_9_G: LDMOS block layer (LDBK) is used to identify LDMOS function area.Min LDBK extension outside of (gate, source, drain)'s AA is 0.4")
); end Guidline_rules_check

L65246=drc(ESD1 width<0.33)
errorLayer(L65246 "ESD_1: Minimum width of an ESD1 implant region >= 0.33")

L49476=drc(ESD1 sepNotch<0.33 withIntersection withSingularPoint)
errorLayer(L49476
    "ESD_2: Minimum space between two ESD1 implant regions. Merge if the spec is less than this space >= 0.33")

esd3=drc(ESD1 area<0.7)
errorLayer(esd3
    "ESD_3: Minimum area of ESD1 >= 0.8um")

esd1_hole=geomHoles(ESD1 innermost)
esd1_hole_1=geomAndNot(esd1_hole ESD1)
esd1_earea=drc(esd1_hole_1 area<0.7)
errorLayer(esd1_earea "ESD_4: ESD1 enclosed area >=0.7")

esd05a=drc(ESD1 ngate sep<0.2 withIntersection withSingularPoint)
esd05b=geomButtOrOver(ngate ESD1) 
L68312=geomOr(esd05a esd05b)
errorLayer(L68312
    "ESD_5: Minimum clearance from an ESD implant region to a N-channel Poly ngate along the direction of poly ngate >= 0.200")

L39949=geomOr(geomAndNot(ESD1 AA) drc(AA geomAndNot(ESD1 MARKG) enc<0.2 withIntersection withSingularPoint))
errorLayer(L39949
    "ESD_6: Minimum ESD1 enclosed by AA at least >= 0.2")

L30052=geomAnd(ESD1 SP)
errorLayer(L30052
    "ESD_7: ESD1 implant region is not allowed to overlap with SP")

esd8=geomButtOrOver(ESD1 GT)
errorLayer(esd8
    "ESD_8: ESD1 should be drawn directly at the location to have ESD implant. It should not interact with GT.")

esd09=drc(ESD1 CT enc<0.2 withIntersection withSingularPoint)
errorLayer(esd09 "ESD_9: CT enclosure by ESD1 >=0.2")

if( !avSwitch("Recommended_rules_check")  then
esd9a=drc(ESD1 CT enc<0.4 withIntersection withSingularPoint)
errorLayer(esd09 "ESD_9a_R: CT enclosure by ESD1 >=0.2")
);end Recommended_rules_check

errorLayer(rule_LATCHUP3_nmos
    "LATCHUP_3: Maximum space (S2) from any point within the N+ Source/Drain region to the nearest P+ pickup AA region inside the same well for I/O and internal circuits <= 30.000")

errorLayer(rule_LATCHUP3_pmos
    "LATCHUP_3: Maximum space (S2) from any point within the P+ Source/Drain region to the nearest N+ pickup AA region inside the same well for I/O and internal circuits <= 30.000")

if( avSwitch("DENSITY_CHECKS") then switchProc9() )

if( avSwitch("DFM_priority_1_CHECKS") then switchProc10() )

if( avSwitch("DFM_priority_2_CHECKS") then switchProc11() )

if( avSwitch("DFM_priority_3_CHECKS") then switchProc12() )

if( avSwitch("METAL_OPTION_10LM_2TM") then switchProc13() )

if( avSwitch("METAL_OPTION_7LM_1TM") then switchProc14() )

if( avSwitch("METAL_OPTION_8LM_1TM") then switchProc15() )

if( avSwitch("METAL_OPTION_8LM_2TM") then switchProc16() )

if( avSwitch("METAL_OPTION_9LM_1TM") then switchProc17() )

if( avSwitch("METAL_OPTION_9LM_2TM") then switchProc18() )

if( avSwitch("METAL_OPTION_7LM_2TM") then switchProc214() )

if( avSwitch("METAL_OPTION_6LM_2TM") then switchProc215() )

if( avSwitch("METAL_OPTION_5LM_2TM") then switchProc216() )

if( avSwitch("METAL_OPTION_6LM_1TM") then switchProc217() )

if( avSwitch("METAL_OPTION_5LM_1TM") then switchProc218() )

if( avSwitch("METAL_OPTION_4LM_1TM") then switchProc219() )


if( !avSwitch("METAL_OPTION_4LM_1TM") && !avSwitch("METAL_OPTION_5LM_2TM") then
    switchProc205() )

if( !avSwitch("METAL_OPTION_4LM_1TM") && !avSwitch("METAL_OPTION_5LM_2TM") &&
    avSwitch("CUSTOMER_DUMMY_CHECKS") then
    switchProc2050() )

if( !avSwitch("METAL_OPTION_4LM_1TM") && !avSwitch("METAL_OPTION_5LM_2TM") &&
    !avSwitch("METAL_OPTION_5LM_1TM") && !avSwitch("METAL_OPTION_6LM_2TM") then
    switchProc206() )

if( !avSwitch("METAL_OPTION_4LM_1TM") && !avSwitch("METAL_OPTION_5LM_2TM") &&
    !avSwitch("METAL_OPTION_5LM_1TM") && !avSwitch("METAL_OPTION_6LM_2TM") &&
    avSwitch("CUSTOMER_DUMMY_CHECKS") then
    switchProc2060() )

if( !avSwitch("METAL_OPTION_6LM_1TM") && !avSwitch("METAL_OPTION_7LM_2TM") &&
    !avSwitch("METAL_OPTION_6LM_2TM") && !avSwitch("METAL_OPTION_5LM_2TM") &&
    !avSwitch("METAL_OPTION_5LM_1TM") && !avSwitch("METAL_OPTION_4LM_1TM") then
    switchProc20() )

if( !avSwitch("METAL_OPTION_6LM_1TM") && !avSwitch("METAL_OPTION_7LM_2TM") &&
    !avSwitch("METAL_OPTION_6LM_2TM") && !avSwitch("METAL_OPTION_5LM_2TM") &&
    !avSwitch("METAL_OPTION_5LM_1TM") && !avSwitch("METAL_OPTION_4LM_1TM") && 
    avSwitch("CUSTOMER_DUMMY_CHECKS") then
    switchProc200() )

if( !avSwitch("METAL_OPTION_7LM_1TM") && !avSwitch("METAL_OPTION_8LM_2TM") &&
    !avSwitch("METAL_OPTION_6LM_2TM") && !avSwitch("METAL_OPTION_5LM_2TM") &&
    !avSwitch("METAL_OPTION_5LM_1TM") && !avSwitch("METAL_OPTION_4LM_1TM") &&
    !avSwitch("METAL_OPTION_6LM_1TM") && !avSwitch("METAL_OPTION_7LM_2TM") && 
    avSwitch("CUSTOMER_DUMMY_CHECKS") then
    switchProc250() )

if( !avSwitch("METAL_OPTION_8LM_1TM") && !avSwitch("METAL_OPTION_9LM_2TM") &&
    !avSwitch("METAL_OPTION_7LM_1TM") && !avSwitch("METAL_OPTION_8LM_2TM") &&
    !avSwitch("METAL_OPTION_6LM_2TM") && !avSwitch("METAL_OPTION_5LM_2TM") &&
    !avSwitch("METAL_OPTION_5LM_1TM") && !avSwitch("METAL_OPTION_4LM_1TM") &&
    !avSwitch("METAL_OPTION_6LM_1TM") && !avSwitch("METAL_OPTION_7LM_2TM") &&
    avSwitch("CUSTOMER_DUMMY_CHECKS") then
    switchProc300() )

if( !avSwitch("METAL_OPTION_6LM_1TM") && !avSwitch("METAL_OPTION_7LM_2TM") &&
    !avSwitch("METAL_OPTION_6LM_2TM") && !avSwitch("METAL_OPTION_5LM_2TM") &&
    !avSwitch("METAL_OPTION_5LM_1TM") && !avSwitch("METAL_OPTION_4LM_1TM") &&
    avSwitch("DFM_priority_3_CHECKS") then switchProc21() )

if( avSwitch("DFM_priority_1_CHECKS") && !avSwitch("METAL_OPTION_6LM_1TM") &&
    !avSwitch("METAL_OPTION_6LM_2TM") && !avSwitch("METAL_OPTION_5LM_2TM") &&
    !avSwitch("METAL_OPTION_5LM_1TM") && !avSwitch("METAL_OPTION_4LM_1TM") &&
    !avSwitch("METAL_OPTION_7LM_2TM") then switchProc22() )

if( avSwitch("DFM_priority_3_CHECKS") && !avSwitch("METAL_OPTION_6LM_1TM") &&
    !avSwitch("METAL_OPTION_6LM_2TM") && !avSwitch("METAL_OPTION_5LM_2TM") &&
    !avSwitch("METAL_OPTION_5LM_1TM") && !avSwitch("METAL_OPTION_4LM_1TM") &&
    !avSwitch("METAL_OPTION_7LM_2TM") then switchProc23() )

if( !avSwitch("METAL_OPTION_6LM_1TM") && !avSwitch("METAL_OPTION_7LM_2TM") &&
    !avSwitch("METAL_OPTION_6LM_2TM") && !avSwitch("METAL_OPTION_5LM_2TM") &&
    !avSwitch("METAL_OPTION_5LM_1TM") && !avSwitch("METAL_OPTION_4LM_1TM") &&
    !avSwitch("METAL_OPTION_7LM_1TM") && !avSwitch("METAL_OPTION_8LM_2TM") then
    switchProc24() )

if( !avSwitch("METAL_OPTION_7LM_1TM") && !avSwitch("METAL_OPTION_8LM_2TM") &&
    !avSwitch("METAL_OPTION_6LM_2TM") && !avSwitch("METAL_OPTION_5LM_2TM") &&
    !avSwitch("METAL_OPTION_5LM_1TM") && !avSwitch("METAL_OPTION_4LM_1TM") &&
    !avSwitch("METAL_OPTION_6LM_1TM") && !avSwitch("METAL_OPTION_7LM_2TM") then
    switchProc25() )

if( !avSwitch("METAL_OPTION_7LM_1TM") && !avSwitch("METAL_OPTION_8LM_2TM") &&
    !avSwitch("METAL_OPTION_6LM_1TM") && !avSwitch("METAL_OPTION_7LM_2TM") &&
    !avSwitch("METAL_OPTION_6LM_2TM") && !avSwitch("METAL_OPTION_5LM_2TM") &&
    !avSwitch("METAL_OPTION_5LM_1TM") && !avSwitch("METAL_OPTION_4LM_1TM") &&
    avSwitch("DFM_priority_3_CHECKS") then switchProc26() )

if( avSwitch("DFM_priority_1_CHECKS") && !avSwitch("METAL_OPTION_6LM_1TM") &&
    !avSwitch("METAL_OPTION_7LM_2TM") && !avSwitch("METAL_OPTION_7LM_1TM") &&
    !avSwitch("METAL_OPTION_6LM_2TM") && !avSwitch("METAL_OPTION_5LM_2TM") &&
    !avSwitch("METAL_OPTION_5LM_1TM") && !avSwitch("METAL_OPTION_4LM_1TM") &&
    !avSwitch("METAL_OPTION_8LM_2TM") then switchProc27() )

if( avSwitch("DFM_priority_3_CHECKS") && !avSwitch("METAL_OPTION_6LM_1TM") &&
    !avSwitch("METAL_OPTION_7LM_2TM") && !avSwitch("METAL_OPTION_7LM_1TM") &&
    !avSwitch("METAL_OPTION_6LM_2TM") && !avSwitch("METAL_OPTION_5LM_2TM") &&
    !avSwitch("METAL_OPTION_5LM_1TM") && !avSwitch("METAL_OPTION_4LM_1TM") &&
    !avSwitch("METAL_OPTION_8LM_2TM") then switchProc28() )

if( !avSwitch("METAL_OPTION_6LM_1TM") && !avSwitch("METAL_OPTION_7LM_2TM") &&
    !avSwitch("METAL_OPTION_7LM_1TM") && !avSwitch("METAL_OPTION_8LM_2TM") &&
    !avSwitch("METAL_OPTION_6LM_2TM") && !avSwitch("METAL_OPTION_5LM_2TM") &&
    !avSwitch("METAL_OPTION_5LM_1TM") && !avSwitch("METAL_OPTION_4LM_1TM") &&
    !avSwitch("METAL_OPTION_8LM_1TM") && !avSwitch("METAL_OPTION_9LM_2TM") then
    switchProc29() )

if( !avSwitch("METAL_OPTION_8LM_1TM") && !avSwitch("METAL_OPTION_9LM_2TM") &&
    !avSwitch("METAL_OPTION_7LM_1TM") && !avSwitch("METAL_OPTION_8LM_2TM") &&
    !avSwitch("METAL_OPTION_6LM_2TM") && !avSwitch("METAL_OPTION_5LM_2TM") &&
    !avSwitch("METAL_OPTION_5LM_1TM") && !avSwitch("METAL_OPTION_4LM_1TM") &&
    !avSwitch("METAL_OPTION_6LM_1TM") && !avSwitch("METAL_OPTION_7LM_2TM") then
    switchProc30() )

if( !avSwitch("METAL_OPTION_8LM_1TM") && !avSwitch("METAL_OPTION_9LM_2TM") &&
    !avSwitch("METAL_OPTION_7LM_1TM") && !avSwitch("METAL_OPTION_8LM_2TM") &&
    !avSwitch("METAL_OPTION_6LM_1TM") && !avSwitch("METAL_OPTION_7LM_2TM") &&
    !avSwitch("METAL_OPTION_6LM_2TM") && !avSwitch("METAL_OPTION_5LM_2TM") &&
    !avSwitch("METAL_OPTION_5LM_1TM") && !avSwitch("METAL_OPTION_4LM_1TM") &&
    avSwitch("DFM_priority_3_CHECKS") then switchProc31() )

if( avSwitch("DFM_priority_1_CHECKS") && !avSwitch("METAL_OPTION_6LM_1TM") &&
    !avSwitch("METAL_OPTION_7LM_2TM") && !avSwitch("METAL_OPTION_7LM_1TM") &&
    !avSwitch("METAL_OPTION_8LM_2TM") && !avSwitch("METAL_OPTION_8LM_1TM") &&
    !avSwitch("METAL_OPTION_6LM_2TM") && !avSwitch("METAL_OPTION_5LM_2TM") &&
    !avSwitch("METAL_OPTION_5LM_1TM") && !avSwitch("METAL_OPTION_4LM_1TM") &&
    !avSwitch("METAL_OPTION_9LM_2TM") then switchProc32() )

if( avSwitch("DFM_priority_3_CHECKS") && !avSwitch("METAL_OPTION_6LM_1TM") &&
    !avSwitch("METAL_OPTION_7LM_2TM") && !avSwitch("METAL_OPTION_7LM_1TM") &&
    !avSwitch("METAL_OPTION_8LM_2TM") && !avSwitch("METAL_OPTION_8LM_1TM") &&
    !avSwitch("METAL_OPTION_6LM_2TM") && !avSwitch("METAL_OPTION_5LM_2TM") &&
    !avSwitch("METAL_OPTION_5LM_1TM") && !avSwitch("METAL_OPTION_4LM_1TM") &&
    !avSwitch("METAL_OPTION_9LM_2TM") then switchProc33() )

if( avSwitch("METAL_OPTION_10LM_2TM") || avSwitch("METAL_OPTION_8LM_2TM") ||
    avSwitch("METAL_OPTION_9LM_2TM")  || avSwitch("METAL_OPTION_7LM_2TM") ||
    avSwitch("METAL_OPTION_6LM_2TM")  || avSwitch("METAL_OPTION_5LM_2TM") then switchProc34() )

if( avSwitch("METAL_OPTION_10LM_2TM") || avSwitch("METAL_OPTION_7LM_2TM") ||
    avSwitch("METAL_OPTION_8LM_2TM")  || avSwitch("METAL_OPTION_9LM_2TM") ||
    avSwitch("METAL_OPTION_6LM_2TM")  || avSwitch("METAL_OPTION_5LM_2TM")
    then switchProc350() )

TM2DUM_INDMY=geomAnd(MnDUM_topmetal2 INDMY)
MTT2DM_INDMY=geomAnd(MTT2DMi INDMY)
if( avSwitch("CUSTOMER_DUMMY_CHECKS") && avSwitch("DENSITY_CHECKS") && avSwitch("UTM_NO") then
processCoverage( backup measure( 
    L28348=calculate(area(TM2DUM_INDMY)/area(INDMY)) ))
errorLayer(geomGetCoverage(L28348 keep>0.12)
    "DUMC_30: Maximum xx Dummy density within INDMY. (Where xx=M1~M8, TM1, TM2. Only check dummy metal density) 12%")
)
if( avSwitch("CUSTOMER_DUMMY_CHECKS") && avSwitch("DENSITY_CHECKS") && avSwitch("UTM_YES") then
processCoverage( backup measure( 
    L38348=calculate(area(MTT2DM_INDMY)/area(INDMY)) ))
errorLayer(geomGetCoverage(L38348 keep>0.12)
    "DUMC_30: Maximum xx Dummy density within INDMY. (Where xx=M1~M8, TM1, TM2. Only check dummy metal density) 12%")
)

if( avSwitch("DENSITY_CHECKS") then switchProc36() )

if( !avSwitch("METAL_OPTION_6LM_2TM") && !avSwitch("METAL_OPTION_5LM_1TM") &&
    avSwitch("DENSITY_CHECKS") && !avSwitch("CUSTOMER_DUMMY_CHECKS") then switchProc371() )

if( !avSwitch("METAL_OPTION_6LM_2TM") && !avSwitch("METAL_OPTION_5LM_2TM") &&
    !avSwitch("METAL_OPTION_5LM_1TM") && !avSwitch("METAL_OPTION_4LM_1TM") &&
    avSwitch("DENSITY_CHECKS") && !avSwitch("CUSTOMER_DUMMY_CHECKS")
    then switchProc370() )

if( !avSwitch("METAL_OPTION_6LM_1TM") && !avSwitch("METAL_OPTION_7LM_2TM") &&
    !avSwitch("METAL_OPTION_6LM_2TM") && !avSwitch("METAL_OPTION_5LM_2TM") &&
    !avSwitch("METAL_OPTION_5LM_1TM") && !avSwitch("METAL_OPTION_4LM_1TM") &&
    avSwitch("DENSITY_CHECKS") && !avSwitch("CUSTOMER_DUMMY_CHECKS")
    then switchProc37() )

if( avSwitch("DENSITY_CHECKS") && !avSwitch("METAL_OPTION_6LM_1TM") &&
    !avSwitch("METAL_OPTION_6LM_2TM") && !avSwitch("METAL_OPTION_5LM_2TM") &&
    !avSwitch("METAL_OPTION_5LM_1TM") && !avSwitch("METAL_OPTION_4LM_1TM") &&
    !avSwitch("METAL_OPTION_7LM_2TM") then switchProc38() )

if( !avSwitch("METAL_OPTION_7LM_1TM") && !avSwitch("METAL_OPTION_8LM_2TM") &&
    !avSwitch("METAL_OPTION_6LM_1TM") && !avSwitch("METAL_OPTION_7LM_2TM") &&
    !avSwitch("METAL_OPTION_6LM_2TM") && !avSwitch("METAL_OPTION_5LM_2TM") &&
    !avSwitch("METAL_OPTION_5LM_1TM") && !avSwitch("METAL_OPTION_4LM_1TM") &&
    avSwitch("DENSITY_CHECKS") && !avSwitch("CUSTOMER_DUMMY_CHECKS")
    then switchProc39() )

if( avSwitch("DENSITY_CHECKS") && !avSwitch("METAL_OPTION_7LM_1TM") &&
    !avSwitch("METAL_OPTION_8LM_2TM") && !avSwitch("METAL_OPTION_6LM_1TM") &&
    !avSwitch("METAL_OPTION_6LM_2TM") && !avSwitch("METAL_OPTION_5LM_2TM") &&
    !avSwitch("METAL_OPTION_5LM_1TM") && !avSwitch("METAL_OPTION_4LM_1TM") &&
    !avSwitch("METAL_OPTION_7LM_2TM") then switchProc40() )

if( !avSwitch("METAL_OPTION_8LM_1TM") && !avSwitch("METAL_OPTION_9LM_2TM") &&
    !avSwitch("METAL_OPTION_7LM_1TM") && !avSwitch("METAL_OPTION_8LM_2TM") &&
    !avSwitch("METAL_OPTION_6LM_1TM") && !avSwitch("METAL_OPTION_7LM_2TM") &&
    !avSwitch("METAL_OPTION_6LM_2TM") && !avSwitch("METAL_OPTION_5LM_2TM") &&
    !avSwitch("METAL_OPTION_5LM_1TM") && !avSwitch("METAL_OPTION_4LM_1TM") &&
    avSwitch("DENSITY_CHECKS") && !avSwitch("CUSTOMER_DUMMY_CHECKS")
    then switchProc41() )

if( avSwitch("DENSITY_CHECKS") && !avSwitch("METAL_OPTION_8LM_1TM") &&
    !avSwitch("METAL_OPTION_9LM_2TM") && !avSwitch("METAL_OPTION_7LM_1TM") &&
    !avSwitch("METAL_OPTION_8LM_2TM") && !avSwitch("METAL_OPTION_6LM_1TM") &&
    !avSwitch("METAL_OPTION_6LM_2TM") && !avSwitch("METAL_OPTION_5LM_2TM") &&
    !avSwitch("METAL_OPTION_5LM_1TM") && !avSwitch("METAL_OPTION_4LM_1TM") &&
    !avSwitch("METAL_OPTION_7LM_2TM") then switchProc42() )

if( avSwitch("METAL_OPTION_10LM_2TM") && avSwitch("DENSITY_CHECKS") ||
    avSwitch("METAL_OPTION_8LM_2TM") && avSwitch("DENSITY_CHECKS") ||
    avSwitch("METAL_OPTION_7LM_2TM") && avSwitch("DENSITY_CHECKS") ||
    avSwitch("METAL_OPTION_6LM_2TM") && avSwitch("DENSITY_CHECKS") ||
    avSwitch("METAL_OPTION_5LM_2TM") && avSwitch("DENSITY_CHECKS") ||
    avSwitch("METAL_OPTION_9LM_2TM") && avSwitch("DENSITY_CHECKS") then
    switchProc43() )

if( avSwitch("METAL_OPTION_10LM_2TM") || avSwitch("METAL_OPTION_7LM_2TM") ||
    avSwitch("METAL_OPTION_6LM_2TM")  || avSwitch("METAL_OPTION_5LM_2TM") ||
    avSwitch("METAL_OPTION_8LM_2TM") || avSwitch("METAL_OPTION_9LM_2TM") then
    switchProc44() )

if( avSwitch("ANTENNA_CHECKS") then switchProc45() )

if( avSwitch("ANTENNA_CHECKS") && !avSwitch("METAL_OPTION_6LM_1TM") &&
    !avSwitch("METAL_OPTION_6LM_2TM") && !avSwitch("METAL_OPTION_5LM_2TM") &&
    !avSwitch("METAL_OPTION_5LM_1TM") && !avSwitch("METAL_OPTION_4LM_1TM") &&
    !avSwitch("METAL_OPTION_7LM_2TM") then switchProc46() )

if( avSwitch("ANTENNA_CHECKS") && !avSwitch("METAL_OPTION_6LM_1TM") &&
    !avSwitch("METAL_OPTION_7LM_1TM") && !avSwitch("METAL_OPTION_7LM_2TM") &&
    !avSwitch("METAL_OPTION_6LM_2TM") && !avSwitch("METAL_OPTION_5LM_2TM") &&
    !avSwitch("METAL_OPTION_5LM_1TM") && !avSwitch("METAL_OPTION_4LM_1TM") &&
    !avSwitch("METAL_OPTION_8LM_2TM") then switchProc47() )

if( avSwitch("ANTENNA_CHECKS") && !avSwitch("METAL_OPTION_6LM_1TM") &&
    !avSwitch("METAL_OPTION_7LM_1TM") && !avSwitch("METAL_OPTION_7LM_2TM") &&
    !avSwitch("METAL_OPTION_8LM_1TM") && !avSwitch("METAL_OPTION_8LM_2TM") &&
    !avSwitch("METAL_OPTION_6LM_2TM") && !avSwitch("METAL_OPTION_5LM_2TM") &&
    !avSwitch("METAL_OPTION_5LM_1TM") && !avSwitch("METAL_OPTION_4LM_1TM") &&
    !avSwitch("METAL_OPTION_9LM_2TM") then switchProc48() )

if( avSwitch("ANTENNA_CHECKS") && avSwitch("METAL_OPTION_9LM_1TM") then
    switchProc49() )

if( avSwitch("ANTENNA_CHECKS") && avSwitch("METAL_OPTION_8LM_1TM") then
    switchProc50() )

if( avSwitch("ANTENNA_CHECKS") && avSwitch("METAL_OPTION_7LM_1TM") then
    switchProc51() )

if( avSwitch("ANTENNA_CHECKS") && avSwitch("METAL_OPTION_6LM_1TM") then
    switchProc52() )

if( avSwitch("ANTENNA_CHECKS") && avSwitch("METAL_OPTION_7LM_2TM") then
    switchProc53() )

if( avSwitch("ANTENNA_CHECKS") && avSwitch("METAL_OPTION_8LM_2TM") then
    switchProc54() )

if( avSwitch("ANTENNA_CHECKS") && avSwitch("METAL_OPTION_9LM_2TM") then
    switchProc55() )

if( avSwitch("ANTENNA_CHECKS") && avSwitch("METAL_OPTION_10LM_2TM") then
    switchProc56() )

if( avSwitch("ANTENNA_CHECKS") then switchProc57() )

if( avSwitch("ANTENNA_CHECKS") && avSwitch("METAL_OPTION_6LM_1TM") then
    switchProc58() )

if( avSwitch("ANTENNA_CHECKS") && avSwitch("METAL_OPTION_6LM_2TM") then
    switchProc580() )

if( avSwitch("ANTENNA_CHECKS") && avSwitch("METAL_OPTION_5LM_2TM") then
    switchProc581() )

if( avSwitch("ANTENNA_CHECKS") && avSwitch("METAL_OPTION_5LM_1TM") then
    switchProc582() )

if( avSwitch("ANTENNA_CHECKS") && avSwitch("METAL_OPTION_4LM_1TM") then
    switchProc583() )

if( avSwitch("ANTENNA_CHECKS") && avSwitch("METAL_OPTION_7LM_1TM") then
    switchProc59() )

if( avSwitch("ANTENNA_CHECKS") && avSwitch("METAL_OPTION_8LM_1TM") then
    switchProc60() )

if( avSwitch("ANTENNA_CHECKS") && avSwitch("METAL_OPTION_9LM_1TM") then
    switchProc61() )

if( avSwitch("ANTENNA_CHECKS") && avSwitch("METAL_OPTION_7LM_2TM") then
    switchProc62() )

if( avSwitch("ANTENNA_CHECKS") && avSwitch("METAL_OPTION_8LM_2TM") then
    switchProc63() )

if( avSwitch("ANTENNA_CHECKS") && avSwitch("METAL_OPTION_9LM_2TM") then
    switchProc64() )

if( avSwitch("ANTENNA_CHECKS") && avSwitch("METAL_OPTION_10LM_2TM") then
    switchProc65() )

if( avSwitch("ANTENNA_CHECKS") && avSwitch("METAL_OPTION_7LM_1TM") then
    switchProc66() )

if( avSwitch("ANTENNA_CHECKS") && avSwitch("METAL_OPTION_8LM_1TM") then
    switchProc67() )

if( avSwitch("ANTENNA_CHECKS") && avSwitch("METAL_OPTION_9LM_1TM") then
    switchProc68() )

if( avSwitch("ANTENNA_CHECKS") && avSwitch("METAL_OPTION_7LM_2TM") then
    switchProc69() )

if( avSwitch("ANTENNA_CHECKS") && avSwitch("METAL_OPTION_8LM_2TM") then
    switchProc70() )

if( avSwitch("ANTENNA_CHECKS") && avSwitch("METAL_OPTION_9LM_2TM") then
    switchProc71() )

if( avSwitch("ANTENNA_CHECKS") && avSwitch("METAL_OPTION_10LM_2TM") then
    switchProc72() )

if( avSwitch("ANTENNA_CHECKS") && avSwitch("METAL_OPTION_8LM_1TM") then
    switchProc73() )

if( avSwitch("ANTENNA_CHECKS") && avSwitch("METAL_OPTION_9LM_1TM") then
    switchProc74() )

if( avSwitch("ANTENNA_CHECKS") && avSwitch("METAL_OPTION_8LM_2TM") then
    switchProc75() )

if( avSwitch("ANTENNA_CHECKS") && avSwitch("METAL_OPTION_9LM_2TM") then
    switchProc76() )

if( avSwitch("ANTENNA_CHECKS") && avSwitch("METAL_OPTION_10LM_2TM") then
    switchProc77() )

if( avSwitch("ANTENNA_CHECKS") && avSwitch("METAL_OPTION_9LM_1TM") then
    switchProc78() )

if( avSwitch("ANTENNA_CHECKS") && avSwitch("METAL_OPTION_9LM_2TM") then
    switchProc79() )

if( avSwitch("ANTENNA_CHECKS") && avSwitch("METAL_OPTION_10LM_2TM") then
    switchProc80() )

if( avSwitch("ANTENNA_CHECKS") then switchProc81() )

if( avSwitch("ANTENNA_CHECKS") && avSwitch("METAL_OPTION_6LM_1TM") then
    switchProc82() )

if( avSwitch("ANTENNA_CHECKS") && avSwitch("METAL_OPTION_7LM_1TM") then
    switchProc83() )

if( avSwitch("ANTENNA_CHECKS") && avSwitch("METAL_OPTION_8LM_1TM") then
    switchProc84() )

if( avSwitch("ANTENNA_CHECKS") && avSwitch("METAL_OPTION_9LM_1TM") then
    switchProc85() )

if( avSwitch("ANTENNA_CHECKS") && avSwitch("METAL_OPTION_7LM_2TM") then
    switchProc86() )

if( avSwitch("ANTENNA_CHECKS") && avSwitch("METAL_OPTION_8LM_2TM") then
    switchProc87() )

if( avSwitch("ANTENNA_CHECKS") && avSwitch("METAL_OPTION_9LM_2TM") then
    switchProc88() )

if( avSwitch("ANTENNA_CHECKS") && avSwitch("METAL_OPTION_10LM_2TM") then
    switchProc89() )

if( avSwitch("ANTENNA_CHECKS") && avSwitch("METAL_OPTION_7LM_1TM") then
    switchProc90() )

if( avSwitch("ANTENNA_CHECKS") && avSwitch("METAL_OPTION_8LM_1TM") then
    switchProc91() )

if( avSwitch("ANTENNA_CHECKS") && avSwitch("METAL_OPTION_9LM_1TM") then
    switchProc92() )

if( avSwitch("ANTENNA_CHECKS") && avSwitch("METAL_OPTION_7LM_2TM") then
    switchProc93() )

if( avSwitch("ANTENNA_CHECKS") && avSwitch("METAL_OPTION_8LM_2TM") then
    switchProc94() )

if( avSwitch("ANTENNA_CHECKS") && avSwitch("METAL_OPTION_9LM_2TM") then
    switchProc95() )

if( avSwitch("ANTENNA_CHECKS") && avSwitch("METAL_OPTION_10LM_2TM") then
    switchProc96() )

if( avSwitch("ANTENNA_CHECKS") && avSwitch("METAL_OPTION_8LM_1TM") then
    switchProc97() )

if( avSwitch("ANTENNA_CHECKS") && avSwitch("METAL_OPTION_9LM_1TM") then
    switchProc98() )

if( avSwitch("ANTENNA_CHECKS") && avSwitch("METAL_OPTION_8LM_2TM") then
    switchProc99() )

if( avSwitch("ANTENNA_CHECKS") && avSwitch("METAL_OPTION_9LM_2TM") then
    switchProc100() )

if( avSwitch("ANTENNA_CHECKS") && avSwitch("METAL_OPTION_10LM_2TM") then
    switchProc101() )

if( avSwitch("ANTENNA_CHECKS") && avSwitch("METAL_OPTION_9LM_1TM") then
    switchProc102() )

if( avSwitch("ANTENNA_CHECKS") && avSwitch("METAL_OPTION_9LM_2TM") then
    switchProc103() )

if( avSwitch("ANTENNA_CHECKS") && avSwitch("METAL_OPTION_10LM_2TM") then
    switchProc104() )

;Seal Ring

CTm = geomAnd( CTi MARKG )
V1m = geomAnd( V1i MARKG )
V2m = geomAnd( V2i MARKG )
V3m = geomAnd( V3i MARKG )
V4m = geomAnd( V4i MARKG )
V5m = geomAnd( V5i MARKG )
V6m = geomAnd( V6i MARKG )
V7m = geomAnd( V7i MARKG )
TV1m = geomAnd( TV1i MARKG )
TV2m = geomAnd( TV2i MARKG )

CT_s	= geomGetRectangle( CTm )
CT_l	= geomAndNot( CTm CT_s )
V1_s	= geomGetRectangle( V1m )
V1_l	= geomAndNot( V1m V1_s )
V2_s	= geomGetRectangle( V2m )
V2_l	= geomAndNot( V2m V2_s )
V3_s	= geomGetRectangle( V3m )
V3_l	= geomAndNot( V3m V3_s )
V4_s	= geomGetRectangle( V4m )
V4_l	= geomAndNot( V4m V4_s )
V5_s	= geomGetRectangle( V5m )
V5_l	= geomAndNot( V5m V5_s )
V6_s	= geomGetRectangle( V6m )
V6_l	= geomAndNot( V6m V6_s )
V7_s	= geomGetRectangle( V7m )
V7_l	= geomAndNot( V7m V7_s )
TV1_s	= geomGetRectangle( TV1m )
TV1_l	= geomAndNot( TV1m TV1_s )
TV2_s	= geomGetRectangle( TV2m )
TV2_l	= geomAndNot( TV2m TV2_s )


gr1_ct1a = geomGetAngledEdge( CT_l keep == 90 )
gr1_ct1b = geomGetAngledEdge( CT_l keep == 0 )
gr1_ct1c = geomGetAngledEdge( CT_l 44.9 < keep < 45.1 )
gr1_ct1V = drc( gr1_ct1a width < 10 opposite )
gr1_ct1H = drc( gr1_ct1b width < 10 opposite )
gr1_ct1D = drc( gr1_ct1c width < 10 opposite )
gr1_ct1  = drc( CT_l width < 0.059 )
gr1_ct2  = geomWidth( gr1_ct1V keep > 0.061 ) 
gr1_ct3  = geomWidth( gr1_ct1H keep > 0.061 ) 
gr1_ct4  = geomWidth( gr1_ct1D keep > 0.085 ) 
errorLayer( geomCat( gr1_ct1 gr1_ct2 gr1_ct3 gr1_ct4 ) "GRC_1: CT slot width is 0.06" )

gr1_v1a = geomGetAngledEdge( V1_l keep == 90 )
gr1_v1b = geomGetAngledEdge( V1_l keep == 0 )
gr1_v1c = geomGetAngledEdge( V1_l 44.9 < keep < 45.1 )
gr1_v1V = drc( gr1_v1a width < 10 opposite )
gr1_v1H = drc( gr1_v1b width < 10 opposite )
gr1_v1D = drc( gr1_v1c width < 10 opposite )
gr1_v11  = drc( V1_l width < 0.069 )
gr1_v12  = geomWidth( gr1_v1V keep > 0.071 ) 
gr1_v13  = geomWidth( gr1_v1H keep > 0.071 ) 
gr1_v14  = geomWidth( gr1_v1D keep > 0.099 ) 
errorLayer( geomCat( gr1_v11 gr1_v12 gr1_v13 gr1_v14 ) "GRC_2_V1: V1 slot width is 0.07" )

gr1_v2a = geomGetAngledEdge( V2_l keep == 90 )
gr1_v2b = geomGetAngledEdge( V2_l keep == 0 )
gr1_v2c = geomGetAngledEdge( V2_l 44.9 < keep < 45.1 )
gr1_v2V = drc( gr1_v2a width < 10 opposite )
gr1_v2H = drc( gr1_v2b width < 10 opposite )
gr1_v2D = drc( gr1_v2c width < 10 opposite )
gr1_v21  = drc( V2_l width < 0.069 )
gr1_v22  = geomWidth( gr1_v2V keep > 0.071 ) 
gr1_v23  = geomWidth( gr1_v2H keep > 0.071 ) 
gr1_v24  = geomWidth( gr1_v2D keep > 0.099 ) 
errorLayer( geomCat( gr1_v21 gr1_v22 gr1_v23 gr1_v24 ) "GRC_2_V2: V2 slot width is 0.07" )

gr1_v3a = geomGetAngledEdge( V3_l keep == 90 )
gr1_v3b = geomGetAngledEdge( V3_l keep == 0 )
gr1_v3c = geomGetAngledEdge( V3_l 44.9 < keep < 45.1 )
gr1_v3V = drc( gr1_v3a width < 10 opposite )
gr1_v3H = drc( gr1_v3b width < 10 opposite )
gr1_v3D = drc( gr1_v3c width < 10 opposite )
gr1_v31  = drc( V3_l width < 0.069 )
gr1_v32  = geomWidth( gr1_v3V keep > 0.071 ) 
gr1_v33  = geomWidth( gr1_v3H keep > 0.071 ) 
gr1_v34  = geomWidth( gr1_v3D keep > 0.099 ) 
errorLayer( geomCat( gr1_v31 gr1_v32 gr1_v33 gr1_v34 ) "GRC_2_V3: V3 slot width is 0.07" )

gr1_v4a = geomGetAngledEdge( V4_l keep == 90 )
gr1_v4b = geomGetAngledEdge( V4_l keep == 0 )
gr1_v4c = geomGetAngledEdge( V4_l 44.9 < keep < 45.1 )
gr1_v4V = drc( gr1_v4a width < 10 opposite )
gr1_v4H = drc( gr1_v4b width < 10 opposite )
gr1_v4D = drc( gr1_v4c width < 10 opposite )
gr1_v41  = drc( V4_l width < 0.069 )
gr1_v42  = geomWidth( gr1_v4V keep > 0.071 ) 
gr1_v43  = geomWidth( gr1_v4H keep > 0.071 ) 
gr1_v44  = geomWidth( gr1_v4D keep > 0.099 ) 
errorLayer( geomCat( gr1_v41 gr1_v42 gr1_v43 gr1_v44 ) "GRC_2_V4: V4 slot width is 0.07" )

gr1_v5a = geomGetAngledEdge( V5_l keep == 90 )
gr1_v5b = geomGetAngledEdge( V5_l keep == 0 )
gr1_v5c = geomGetAngledEdge( V5_l 44.9 < keep < 45.1 )
gr1_v5V = drc( gr1_v5a width < 10 opposite )
gr1_v5H = drc( gr1_v5b width < 10 opposite )
gr1_v5D = drc( gr1_v5c width < 10 opposite )
gr1_v51  = drc( V5_l width < 0.069 )
gr1_v52  = geomWidth( gr1_v5V keep > 0.071 ) 
gr1_v53  = geomWidth( gr1_v5H keep > 0.071 ) 
gr1_v54  = geomWidth( gr1_v5D keep > 0.099 ) 
errorLayer( geomCat( gr1_v51 gr1_v52 gr1_v53 gr1_v54 ) "GRC_2_V5: V5 slot width is 0.07" )

gr1_v6a = geomGetAngledEdge( V6_l keep == 90 )
gr1_v6b = geomGetAngledEdge( V6_l keep == 0 )
gr1_v6c = geomGetAngledEdge( V6_l 44.9 < keep < 45.1 )
gr1_v6V = drc( gr1_v6a width < 10 opposite )
gr1_v6H = drc( gr1_v6b width < 10 opposite )
gr1_v6D = drc( gr1_v6c width < 10 opposite )
gr1_v61  = drc( V6_l width < 0.069 )
gr1_v62  = geomWidth( gr1_v6V keep > 0.071 ) 
gr1_v63  = geomWidth( gr1_v6H keep > 0.071 ) 
gr1_v64  = geomWidth( gr1_v6D keep > 0.099 ) 
errorLayer( geomCat( gr1_v61 gr1_v62 gr1_v63 gr1_v64 ) "GRC_2_V6: V6 slot width is 0.07" )

gr1_v7a = geomGetAngledEdge( V7_l keep == 90 )
gr1_v7b = geomGetAngledEdge( V7_l keep == 0 )
gr1_v7c = geomGetAngledEdge( V7_l 44.9 < keep < 45.1 )
gr1_v7V = drc( gr1_v7a width < 10 opposite )
gr1_v7H = drc( gr1_v7b width < 10 opposite )
gr1_v7D = drc( gr1_v7c width < 10 opposite )
gr1_v71  = drc( V6_l width < 0.069 )
gr1_v72  = geomWidth( gr1_v7V keep > 0.071 ) 
gr1_v73  = geomWidth( gr1_v7H keep > 0.071 ) 
gr1_v74  = geomWidth( gr1_v7D keep > 0.099 ) 
errorLayer( geomCat( gr1_v71 gr1_v72 gr1_v73 gr1_v74 ) "GRC_2_V7: V7 slot width is 0.07" )


gr1_tv1a = geomGetAngledEdge( TV1_l keep == 90 )
gr1_tv1b = geomGetAngledEdge( TV1_l keep == 0 )
gr1_tv1c = geomGetAngledEdge( TV1_l 44.9 < keep < 45.1 )
gr1_tv1V = drc( gr1_tv1a width < 10 opposite )
gr1_tv1H = drc( gr1_tv1b width < 10 opposite )
gr1_tv1D = drc( gr1_tv1c width < 10 opposite )
gr1_tv11  = drc( TV1_l width < 0.359 )
gr1_tv12  = geomWidth( gr1_tv1V keep > 0.361 ) 
gr1_tv13  = geomWidth( gr1_tv1H keep > 0.361 ) 
gr1_tv14  = geomWidth( gr1_tv1D keep > 0.510 ) 
errorLayer( geomCat( gr1_tv11 gr1_tv12 gr1_tv13 gr1_tv14 ) "GRC_3_TV1: TV1 slot width is 0.36" )

gr1_tv2a = geomGetAngledEdge( TV2_l keep == 90 )
gr1_tv2b = geomGetAngledEdge( TV2_l keep == 0 )
gr1_tv2c = geomGetAngledEdge( TV2_l 44.9 < keep < 45.1 )
gr1_tv2V = drc( gr1_tv2a width < 10 opposite )
gr1_tv2H = drc( gr1_tv2b width < 10 opposite )
gr1_tv2D = drc( gr1_tv2c width < 10 opposite )
gr1_tv21  = drc( TV2_l width < 0.359 )
gr1_tv22  = geomWidth( gr1_tv2V keep > 0.361 ) 
gr1_tv23  = geomWidth( gr1_tv2H keep > 0.361 ) 
gr1_tv24  = geomWidth( gr1_tv2D keep > 0.510 ) 
errorLayer( geomCat( gr1_tv21 gr1_tv22 gr1_tv23 gr1_tv24 ) "GRC_3_TV2: TV2 slot width is 0.36" )


gr4	= geomContactCheck( CT_s length == 0.06 width == 0.06 ignore)
errorLayer( gr4 "GRC_4: Square CT size is 0.06" )

gr5_v1 = geomContactCheck( V1_s length == 0.07 width == 0.07 ignore)
errorLayer( gr5_v1 "GRC_5: Square V1 size is 0.07" )

gr5_v2 = geomContactCheck( V2_s length == 0.07 width == 0.07 ignore)
errorLayer( gr5_v2 "GRC_5: Square V2 size is 0.07" )

gr5_v3 = geomContactCheck( V3_s length == 0.07 width == 0.07 ignore)
errorLayer( gr5_v3 "GRC_5: Square V3 size is 0.07" )

gr5_v4 = geomContactCheck( V4_s length == 0.07 width == 0.07 ignore)
errorLayer( gr5_v4 "GRC_5: Square V4 size is 0.07" )

gr5_v5 = geomContactCheck( V5_s length == 0.07 width == 0.07 ignore)
errorLayer( gr5_v5 "GRC_5: Square V5 size is 0.07" )

gr5_v6 = geomContactCheck( V6_s length == 0.07 width == 0.07 ignore)
errorLayer( gr5_v6 "GRC_5: Square V6 size is 0.07" )

gr5_v7 = geomContactCheck( V7_s length == 0.07 width == 0.07 ignore)
errorLayer( gr5_v7 "GRC_5: Square V7 size is 0.07" )

gr6_TV1 = geomContactCheck( TV1_s length == 0.36 width == 0.36 ignore)
errorLayer( gr6_TV1 "GRC_6: Square TV1 size is 0.36" )

gr6_TV2 = geomContactCheck( TV2_s length == 0.36 width == 0.36 ignore)
errorLayer( gr6_TV2 "GRC_6: Square TV2 size is 0.36" )

rule_srdop101=geomAndNot( geomAndNot(gate geomOutside(gate SDOP)) SDOP)
errorLayer( rule_srdop101 "SRDOP_101:Gate touching SDOP must be covered by SDOP")

rule_srdop102=drc(SDOP width<0.18)
errorLayer( rule_srdop102 "SRDOP_102:SDOP min width is 0.18")

rule_srdop103=drc(SDOP area<0.1)
errorLayer(rule_srdop103 "SRDOP_103:SDOP min area is 0.1")

rule_srdop104=geomAndNot(SDOP INST)
errorLayer(rule_srdop104 "SRDOP_104:SDOP is must be in INST")

rule_srdop105=drc(SDOP gate enc<0.056 withIntersection withSingularPoint)
errorLayer(rule_srdop105 "SRDOP_105:SDOP must enclose gate is 0.056")

; ULVT: Ultra Low Vt devices Rules

ulvt1=drc(ULVT width<0.33 parallel)
errorLayer(ulvt1 "ULVT_1:ULVT width (Parallel side to side width) is >=0.33")

ulvt2=drc(ULVT sepNotch<0.33 withIntersection opposite)
errorLayer(ulvt2 "ULVT_2:Space between two ULVTs (with run length>0) is >=0.33")

ulvt3=drc(ULVT mos enc<0.2 withIntersection)
errorLayer(ulvt3 "ULVT_3:AA with transistor enclosure by ULVT(include AA area not under poly) is >=0.2")

ulvt4=drc(ULVT gate enc<0.25 withIntersection)
errorLayer(ulvt4 "ULVT_4:Gate enclosure by ULVT is > =0.25")

ulvt5mos=geomButtOrOver(AA GT)
ulvt5res=geomButtOrOver(AA geomOr(DIFRES RESAA))
ulvt5dio1=geomButtOrOver(AA geomSize(geomAvoiding(DSTR PSUB) 0.3))
ulvt5dio2=geomButtOrOver(AA geomSize(geomButtOrOver(DSTR PSUB) 0.4))
ulvt5npnpnp=geomButtOrOver(AA DMPNP)
ulvt5all=geomAndNot(geomOr(geomOr(geomOr(ulvt5mos ulvt5res) geomOr(ulvt5dio1 ulvt5dio2)) ulvt5npnpnp) INST)
ulvt5a=drc(ULVT ulvt5all sep<0.2 withIntersection withSingularPoint)
ulvt5b=geomAnd(geomStraddle(ulvt5mos ULVT) ULVT)
ulvt5=geomCat(ulvt5a ulvt5b)
errorLayer(ulvt5 "ULVT_5:Space between ULVT and AA with device (include all the devices described in the design truth table 7.1.9) is >=0.2. Prohibit overlap of ULVT and other voltage AA with transistor")

ulvt6=drc(ULVT gate sep<0.25 withIntersection)
errorLayer(ulvt6 "ULVT_6:Space between ULVT and gate  is >=0.25")

ulvt7=drc(ULVT area<0.463)
errorLayer(ulvt7 "ULVT_7: ULVT area is >=0.463")

ulvt8=drc(geomAndNot(geomHoles(ULVT innermost) ULVT) area<0.463)
errorLayer(ulvt8 "ULVT_8:ULVT enclosed area  > =0.463")

ulvt9=drc(ULVT geomOr(DG TG) sep<0.33 withIntersection)
errorLayer(ulvt9 "ULVT_9:Space between ULVT and (DG or TG) >=0.33")

;SRAM Device Dimension Check

gate_inst= geomInside(gate geomSize(INST -1.5))
gate_inst_pd=geomOutside( geomOutside(gate_inst NW) SDOP)
gate_inst_pg=geomInside(geomOutside(gate_inst NW) SDOP)
gate_inst_pu=geomInside(gate_inst NW)

srdevice1a=geomInside(gate_inst geomOr(geomOr( geomOr(DNSRAM LRSRAM) D2SRAM) RFSRAM))
srdevice1=geomAndNot(gate_inst srdevice1a)
errorLayer(srdevice1 "SRDevice_1: All Gates inside INST must be inside DNSRAM (SP299), LRSRAM (SP374), D2SRAM (DP589) or RFSRAM (DP741)")

srdevsp299pdw1=geomInside(gate_inst_pd DNSRAM)

srdevsp299pdw2=geomOr(geomGetEdge(GT coincident srdevsp299pdw1) geomGetEdge(GT butting srdevsp299pdw1))
srdevsp299pdw=geomGetLength(srdevsp299pdw2 ignore==0.142)
errorLayer(srdevsp299pdw "SRDEV_SP299_PD_W: SP299 PD gate channel width FIX is 0.142")

srdevsp299pdl1=geomInside(gate_inst_pd DNSRAM)
srdevsp299pdl2=geomOr(geomGetEdge(AA coincident srdevsp299pdl1) geomGetEdge(AA butting srdevsp299pdl1))
srdevsp299pdl=geomGetLength(srdevsp299pdl2 ignore==0.055)
errorLayer(srdevsp299pdl "SRDEV_SP299_PD_L: SP299 PD gate channel length FIX is 0.055")

srdevsp299pgw1=geomInside(gate_inst_pg DNSRAM)
srdevsp299pgw2=geomOr(geomGetEdge(GT coincident srdevsp299pgw1) geomGetEdge(GT butting srdevsp299pgw1))
srdevsp299pgw=geomGetLength(srdevsp299pgw2 ignore==0.11)
errorLayer(srdevsp299pgw "SRDEV_SP299_PG_W: SP299 PG gate channel width FIX is 0.11")

srdevsp299pgl1=geomInside(gate_inst_pg DNSRAM)
srdevsp299pgl2=geomOr(geomGetEdge(AA coincident srdevsp299pgl1) geomGetEdge(AA butting srdevsp299pgl1))
srdevsp299pgl=geomGetLength(srdevsp299pgl2 ignore==0.059)
errorLayer(srdevsp299pgl "SRDEV_SP299_PG_L: SP299 PG gate channel length FIX is 0.059")

srdevsp299puw1=geomInside(gate_inst_pu DNSRAM)
srdevsp299puw2=geomOr(geomGetEdge(GT coincident srdevsp299puw1) geomGetEdge(GT butting srdevsp299puw1))
srdevsp299puw=geomGetLength(srdevsp299puw2 ignore==0.06)
errorLayer(srdevsp299puw "SRDEV_SP299_PU_W: SP299 PU gate channel width FIX is 0.06")

srdevsp299pul1=geomInside(gate_inst_pu DNSRAM)
srdevsp299pul2=geomOr(geomGetEdge(AA coincident srdevsp299pul1) geomGetEdge(AA butting srdevsp299pul1))
srdevsp299pul=geomGetLength(srdevsp299pul2 ignore==0.055)
errorLayer(srdevsp299pul "SRDEV_SP299_PU_L: SP299 PU gate channel length FIX is 0.055")

srdevsp374pdw1=geomInside(gate_inst_pd LRSRAM)
srdevsp374pdw2=geomOr(geomGetEdge(GT coincident srdevsp374pdw1) geomGetEdge(GT butting srdevsp374pdw1))
srdevsp374pdw=geomGetLength(srdevsp374pdw2 ignore==0.233)
errorLayer(srdevsp374pdw "SRDEV_SP374_PD_W: SP374 PD gate channel width FIX is 0.233")

srdevsp374pdl1=geomInside(gate_inst_pd LRSRAM)
srdevsp374pdl2=geomOr(geomGetEdge(AA coincident srdevsp374pdl1) geomGetEdge(AA butting srdevsp374pdl1))
srdevsp374pdl=geomGetLength(srdevsp374pdl2 ignore==0.055)
errorLayer(srdevsp374pdl "SRDEV_SP374_PD_L: SP374 PD gate channel length FIX is 0.055")

srdevsp374pgw1=geomInside(gate_inst_pg LRSRAM)
srdevsp374pgw2=geomOr(geomGetEdge(GT coincident srdevsp374pgw1) geomGetEdge(GT butting srdevsp374pgw1))
srdevsp374pgw=geomGetLength(srdevsp374pgw2 ignore==0.183)
errorLayer(srdevsp374pgw "SRDEV_SP374_PG_W: SP374 PG gate channel width FIX is 0.183")

srdevsp374pgl1=geomInside(gate_inst_pg LRSRAM)
srdevsp374pgl2=geomOr(geomGetEdge(AA coincident srdevsp374pgl1) geomGetEdge(AA butting srdevsp374pgl1))
srdevsp374pgl=geomGetLength(srdevsp374pgl2 ignore==0.063)
errorLayer(srdevsp374pgl "SRDEV_SP374_PG_L: SP374 PG gate channel length FIX is 0.063")

srdevsp374puw1=geomInside(gate_inst_pu LRSRAM)
srdevsp374puw2=geomOr(geomGetEdge(GT coincident srdevsp374puw1) geomGetEdge(GT butting srdevsp374puw1))
srdevsp374puw=geomGetLength(srdevsp374puw2 ignore==0.07)
errorLayer(srdevsp374puw "SRDEV_SP374_PU_W: SP374 PU gate channel width FIX is 0.07")

srdevsp374pul1=geomInside(gate_inst_pu LRSRAM)
srdevsp374pul2=geomOr(geomGetEdge(AA coincident srdevsp374pul1) geomGetEdge(AA butting srdevsp374pul1))
srdevsp374pul=geomGetLength(srdevsp374pul2 ignore==0.055)
errorLayer(srdevsp374pul "SRDEV_SP374_PU_L: SP374 PU gate channel length FIX is 0.055")

srdevsp589pdw1=geomInside(gate_inst_pd D2SRAM)
srdevsp589pdw2=geomOr(geomGetEdge(GT coincident srdevsp589pdw1) geomGetEdge(GT butting srdevsp589pdw1))
srdevsp589pdw=geomGetLength(srdevsp589pdw2 ignore==0.305)
errorLayer(srdevsp589pdw "SRDEV_SP589_PD_W: SP589 PD gate channel width FIX is 0.305")

srdevsp589pdl1=geomInside(gate_inst_pd D2SRAM)
srdevsp589pdl2=geomOr(geomGetEdge(AA coincident srdevsp589pdl1) geomGetEdge(AA butting srdevsp589pdl1))
srdevsp589pdl=geomGetLength(srdevsp589pdl2 ignore==0.055)
errorLayer(srdevsp589pdl "SRDEV_SP589_PD_L: SP589 PD gate channel length FIX is 0.055")

srdevsp589pgw1=geomInside(gate_inst_pg D2SRAM)
srdevsp589pgw2=geomOr(geomGetEdge(GT coincident srdevsp589pgw1) geomGetEdge(GT butting srdevsp589pgw1))
srdevsp589pgw=geomGetLength(srdevsp589pgw2 ignore==0.154)
errorLayer(srdevsp589pgw "SRDEV_SP589_PG_W: SP589 PG gate channel width FIX is 0.154")

srdevsp589pgl1=geomInside(gate_inst_pg D2SRAM)
srdevsp589pgl2=geomOr(geomGetEdge(AA coincident srdevsp589pgl1) geomGetEdge(AA butting srdevsp589pgl1))
srdevsp589pgl=geomGetLength(srdevsp589pgl2 ignore==0.067)
errorLayer(srdevsp589pgl "SRDEV_SP589_PG_L: SP589 PG gate channel length FIX is 0.067")

srdevsp589puw1=geomInside(gate_inst_pu D2SRAM)
srdevsp589puw2=geomOr(geomGetEdge(GT coincident srdevsp589puw1) geomGetEdge(GT butting srdevsp589puw1))
srdevsp589puw=geomGetLength(srdevsp589puw2 ignore==0.06)
errorLayer(srdevsp589puw "SRDEV_SP589_PU_W: SP589 PU gate channel width FIX is 0.06")

srdevsp589pul1=geomInside(gate_inst_pu D2SRAM)
srdevsp589pul2=geomOr(geomGetEdge(AA coincident srdevsp589pul1) geomGetEdge(AA butting srdevsp589pul1))
srdevsp589pul=geomGetLength(srdevsp589pul2 ignore==0.055)
errorLayer(srdevsp589pul "SRDEV_SP589_PU_L: SP589 PU gate channel length FIX is 0.055")

srdevsp741pdw1=geomInside(gate_inst_pd RFSRAM)
srdevsp741pdw2=geomOr(geomGetEdge(GT coincident srdevsp741pdw1) geomGetEdge(GT butting srdevsp741pdw1))
srdevsp741pdw=geomGetLength(srdevsp741pdw2 ignore==0.438)
errorLayer(srdevsp741pdw "SRDEV_SP741_PD_W: SP741 PD gate channel width FIX is 0.438")

srdevsp741pdl1=geomInside(gate_inst_pd RFSRAM)
srdevsp741pdl2=geomOr(geomGetEdge(AA coincident srdevsp741pdl1) geomGetEdge(AA butting srdevsp741pdl1))
srdevsp741pdl=geomGetLength(srdevsp741pdl2 ignore==0.055)
errorLayer(srdevsp741pdl "SRDEV_SP741_PD_L: SP741 PD gate channel length FIX is 0.055")

srdevsp741pgw1=geomInside(gate_inst_pg RFSRAM)
srdevsp741pgw2=geomOr(geomGetEdge(GT coincident srdevsp741pgw1) geomGetEdge(GT butting srdevsp741pgw1))
srdevsp741pgw=geomGetLength(srdevsp741pgw2 ignore==0.168)
errorLayer(srdevsp741pgw "SRDEV_SP741_PG_W: SP741 PG gate channel width FIX is 0.168")

srdevsp741pgl1=geomInside(gate_inst_pg RFSRAM)
srdevsp741pgl2=geomOr(geomGetEdge(AA coincident srdevsp741pgl1) geomGetEdge(AA butting srdevsp741pgl1))
srdevsp741pgl=geomGetLength(srdevsp741pgl2 ignore==0.063)
errorLayer(srdevsp741pgl "SRDEV_SP741_PG_L: SP741 PG gate channel length FIX is 0.063")

srdevsp741puw1=geomInside(gate_inst_pu RFSRAM)
srdevsp741puw2=geomOr(geomGetEdge(GT coincident srdevsp741puw1) geomGetEdge(GT butting srdevsp741puw1))
srdevsp741puw=geomGetLength(srdevsp741puw2 ignore==0.08)
errorLayer(srdevsp741puw "SRDEV_SP741_PU_W: SP741 PU gate channel width FIX is 0.08")

srdevsp741pul1=geomInside(gate_inst_pu RFSRAM)
srdevsp741pul2=geomOr(geomGetEdge(AA coincident srdevsp741pul1) geomGetEdge(AA butting srdevsp741pul1))
srdevsp741pul=geomGetLength(srdevsp741pul2 ignore==0.055)
errorLayer(srdevsp741pul "SRDEV_SP741_PU_L: SP741 PU gate channel length FIX is 0.055")

; SRAM Marker Layer Check

srmarker4=geomAndNot(geomOr(geomOr(geomOr(DNSRAM LRSRAM) RFSRAM) D2SRAM) INST)
errorLayer(srmarker4 "SRMarker_4:Marker layer DNSRAM, LRSRAM, D2SRAM, RFSRAM must be within SRAM marker INST")

srmarker5=geomOutside(geomOr(LRSRAM RFSRAM) HPBL)
errorLayer(srmarker5 "SRMarker_5:For high performance SRAM bit cell(LRSRAM (SP374),  RFSRAM (DP741)), there must be high performance marker layer HPBL overlapped.")

srmarker6a=geomHoles(INST)
srmarker6b=geomHoles(DNSRAM)
srmarker6c=geomHoles(LRSRAM)
srmarker6d=geomHoles(D2SRAM)
srmarker6e=geomHoles(RFSRAM)
srmarker6=geomCat(srmarker6a srmarker6b srmarker6c srmarker6d srmarker6e)
errorLayer(srmarker6 "SRMarker_6: No hole or slot is permitted in one SRAM marker layer(DNSRAM, LRSRAM, D2SRAM, RFSRAM, INST)")

srmarker8a=geomOr(geomButtOrOver(DNSRAM LRSRAM) geomButtOrOver(DNSRAM D2SRAM))
srmarker8b=geomOr(geomOr(srmarker8a geomButtOrOver(DNSRAM RFSRAM)) geomButtOrOver(LRSRAM D2SRAM))
srmarker8c=geomOr(srmarker8b geomButtOrOver(LRSRAM RFSRAM))
srmarker8=geomOr(srmarker8c geomButtOrOver(D2SRAM RFSRAM))
errorLayer(srmarker8 "SRMarker_8: DNSRAM, LRSRAM, D2SRAM, RFSRAM should not overlap with each other(touch is permitted)")

srmarker9=geomAnd(geomOr(DNSRAM D2SRAM) HPBL)
errorLayer(srmarker9 "SRMarker_9: No Overlap of (DNSRAM(SP299) or D2SRAM(DP589)) with HPBL is permitted")

if( !avSwitch("Guidline_rules_check")  then

;BUMP UBM pad design guideline

bump01x=geomGetBBox(BUMP outputCenterMarker 0.01)
bump01=drc(bump01x sep<166.66)
errorLayer(bump01 "BUMP_1_G:BUMP Pitch (center to center space) >=166.67")

bump2g=drc(geomInside(MD BUMP) width<61.11 parallel)
errorLayer(bump2g "BUMP_2_G:MD width(parallel edge to edge) inside BUMP  >=61.11")

bump3ga=drc(BUMP width<88.89 parallel)
bump3gaa=geomGetLength(BUMP keep>0.001)
bump3gb=geomSelectEdge(bump3gaa angle1(keep>180) angle2(keep>0))
bump3gc=drc(bump3gb width<88.89)
bump3g=geomOr(geomOr(bump3ga bump3gb) bump3gc)
errorLayer(bump3g "BUMP_3_G:UMP width (parallel edge to edge) is >=88.89")

bump4g=drc(BUMP MD enc<15.56)
errorLayer(bump4g "BUMP_4_G:MD enclosed by BUMP >=15.56")

bump5g=drc(ALPA_ALL BUMP enc<6.67)  
bump5ga=geomAndNot(BUMP ALPA_ALL)
bump5=geomOr(bump5g bump5ga)
errorLayer(bump5 "BUMP_5_G:BUMP enclosure by ALPA >=6.67")

bump7g=drc(BUMP sep<77.78 withIntersection)
errorLayer(bump7g "BUMP_7_G:BUMP space is >=77.78")

;DUP (Device Under Pad) Pad Guidelines

dup_area=geomAnd(DUPMK1 MD)

dup01=geomAndNot(geomButtOrOver(MD DUPMK1) DUPMK1)
;notice: coding not match DR3R
errorLayer(dup01 "DUP_1_G:DUPMK1 must enclose PA for DUP pad area")

dup02b=geomEnclose(dup_area geomAndNot(dup_area TM1))
errorLayer(dup02b "DUP_2_1_G:Two metal layers (TM and TM-1) are needed in DUP pad area, these two metal layers design must be solid")

if( avSwitch("UTM_NO")  then
dup02a=geomEnclose(dup_area geomAndNot(dup_area TM2))
errorLayer(dup02a "DUP_2_G:Two metal layers (TM and TM-1) are needed in DUP pad area, these two metal layers design must be solid")
) ;end UTM_NO

if( avSwitch("UTM_YES")  then
dup02=geomEnclose(dup_area geomAndNot(dup_area  MTT2))
errorLayer(dup02 "DUP_2_G:Two metal layers (TM and TM-1) are needed in DUP pad area, these two metal layers design must be solid")
) ;end UTM_YES

dup03a=geomAnd(geomOr(geomOr(geomOr(geomOr(ALPAR MOMDMY) INDMY) TM1R) TM2R) dup_area)
errorLayer(dup03a "DUP_3_G:ALPAR, MOMDMY, INDMY, TM2R, TM-1R(TM-1 resistor mark layer) must be outside of DUP pad area")

dup04a=geomAnd(TV1 dup_area)
errorLayer(dup04a "DUP_4_G:  TV-1 pattern must be outside of DUP pad area")

tv2array=geomSize(geomSize(geomSize(geomInside(TV2 dup_area) 0.28) -0.28) -0.85 downUp)
dup05=geomAndNot(dup_area geomEnclose(dup_area tv2array))
errorLayer(dup05 "DUP_5_G: DUP pad area must have TV array between TM and TM-1,Two Via areas whose space is within 0.56um are considered to be in the same array,TV space within array in DUP pad opening area should follow TV2.3")

);Guidline_rules_check

)
